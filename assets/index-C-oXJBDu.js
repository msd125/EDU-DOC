(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();function uu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var kc={exports:{}},_i={},Ec={exports:{}},ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mh;function zg(){if(mh)return ft;mh=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function y(z){return z===null||typeof z!="object"?null:(z=v&&z[v]||z["@@iterator"],typeof z=="function"?z:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,w={};function S(z,T,J){this.props=z,this.context=T,this.refs=w,this.updater=J||E}S.prototype.isReactComponent={},S.prototype.setState=function(z,T){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,T,"setState")},S.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function O(){}O.prototype=S.prototype;function R(z,T,J){this.props=z,this.context=T,this.refs=w,this.updater=J||E}var C=R.prototype=new O;C.constructor=R,k(C,S.prototype),C.isPureReactComponent=!0;var L=Array.isArray,X=Object.prototype.hasOwnProperty,W={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function V(z,T,J){var H,I={},ne=null,fe=null;if(T!=null)for(H in T.ref!==void 0&&(fe=T.ref),T.key!==void 0&&(ne=""+T.key),T)X.call(T,H)&&!M.hasOwnProperty(H)&&(I[H]=T[H]);var ye=arguments.length-2;if(ye===1)I.children=J;else if(1<ye){for(var le=Array(ye),de=0;de<ye;de++)le[de]=arguments[de+2];I.children=le}if(z&&z.defaultProps)for(H in ye=z.defaultProps,ye)I[H]===void 0&&(I[H]=ye[H]);return{$$typeof:e,type:z,key:ne,ref:fe,props:I,_owner:W.current}}function G(z,T){return{$$typeof:e,type:z.type,key:T,ref:z.ref,props:z.props,_owner:z._owner}}function oe(z){return typeof z=="object"&&z!==null&&z.$$typeof===e}function B(z){var T={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(J){return T[J]})}var K=/\/+/g;function me(z,T){return typeof z=="object"&&z!==null&&z.key!=null?B(""+z.key):T.toString(36)}function he(z,T,J,H,I){var ne=typeof z;(ne==="undefined"||ne==="boolean")&&(z=null);var fe=!1;if(z===null)fe=!0;else switch(ne){case"string":case"number":fe=!0;break;case"object":switch(z.$$typeof){case e:case r:fe=!0}}if(fe)return fe=z,I=I(fe),z=H===""?"."+me(fe,0):H,L(I)?(J="",z!=null&&(J=z.replace(K,"$&/")+"/"),he(I,T,J,"",function(de){return de})):I!=null&&(oe(I)&&(I=G(I,J+(!I.key||fe&&fe.key===I.key?"":(""+I.key).replace(K,"$&/")+"/")+z)),T.push(I)),1;if(fe=0,H=H===""?".":H+":",L(z))for(var ye=0;ye<z.length;ye++){ne=z[ye];var le=H+me(ne,ye);fe+=he(ne,T,J,le,I)}else if(le=y(z),typeof le=="function")for(z=le.call(z),ye=0;!(ne=z.next()).done;)ne=ne.value,le=H+me(ne,ye++),fe+=he(ne,T,J,le,I);else if(ne==="object")throw T=String(z),Error("Objects are not valid as a React child (found: "+(T==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":T)+"). If you meant to render a collection of children, use an array instead.");return fe}function we(z,T,J){if(z==null)return z;var H=[],I=0;return he(z,H,"","",function(ne){return T.call(J,ne,I++)}),H}function Oe(z){if(z._status===-1){var T=z._result;T=T(),T.then(function(J){(z._status===0||z._status===-1)&&(z._status=1,z._result=J)},function(J){(z._status===0||z._status===-1)&&(z._status=2,z._result=J)}),z._status===-1&&(z._status=0,z._result=T)}if(z._status===1)return z._result.default;throw z._result}var Ee={current:null},Se={transition:null},Y={ReactCurrentDispatcher:Ee,ReactCurrentBatchConfig:Se,ReactCurrentOwner:W};function xe(){throw Error("act(...) is not supported in production builds of React.")}return ft.Children={map:we,forEach:function(z,T,J){we(z,function(){T.apply(this,arguments)},J)},count:function(z){var T=0;return we(z,function(){T++}),T},toArray:function(z){return we(z,function(T){return T})||[]},only:function(z){if(!oe(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},ft.Component=S,ft.Fragment=t,ft.Profiler=s,ft.PureComponent=R,ft.StrictMode=i,ft.Suspense=h,ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,ft.act=xe,ft.cloneElement=function(z,T,J){if(z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+z+".");var H=k({},z.props),I=z.key,ne=z.ref,fe=z._owner;if(T!=null){if(T.ref!==void 0&&(ne=T.ref,fe=W.current),T.key!==void 0&&(I=""+T.key),z.type&&z.type.defaultProps)var ye=z.type.defaultProps;for(le in T)X.call(T,le)&&!M.hasOwnProperty(le)&&(H[le]=T[le]===void 0&&ye!==void 0?ye[le]:T[le])}var le=arguments.length-2;if(le===1)H.children=J;else if(1<le){ye=Array(le);for(var de=0;de<le;de++)ye[de]=arguments[de+2];H.children=ye}return{$$typeof:e,type:z.type,key:I,ref:ne,props:H,_owner:fe}},ft.createContext=function(z){return z={$$typeof:c,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},z.Provider={$$typeof:l,_context:z},z.Consumer=z},ft.createElement=V,ft.createFactory=function(z){var T=V.bind(null,z);return T.type=z,T},ft.createRef=function(){return{current:null}},ft.forwardRef=function(z){return{$$typeof:u,render:z}},ft.isValidElement=oe,ft.lazy=function(z){return{$$typeof:p,_payload:{_status:-1,_result:z},_init:Oe}},ft.memo=function(z,T){return{$$typeof:x,type:z,compare:T===void 0?null:T}},ft.startTransition=function(z){var T=Se.transition;Se.transition={};try{z()}finally{Se.transition=T}},ft.unstable_act=xe,ft.useCallback=function(z,T){return Ee.current.useCallback(z,T)},ft.useContext=function(z){return Ee.current.useContext(z)},ft.useDebugValue=function(){},ft.useDeferredValue=function(z){return Ee.current.useDeferredValue(z)},ft.useEffect=function(z,T){return Ee.current.useEffect(z,T)},ft.useId=function(){return Ee.current.useId()},ft.useImperativeHandle=function(z,T,J){return Ee.current.useImperativeHandle(z,T,J)},ft.useInsertionEffect=function(z,T){return Ee.current.useInsertionEffect(z,T)},ft.useLayoutEffect=function(z,T){return Ee.current.useLayoutEffect(z,T)},ft.useMemo=function(z,T){return Ee.current.useMemo(z,T)},ft.useReducer=function(z,T,J){return Ee.current.useReducer(z,T,J)},ft.useRef=function(z){return Ee.current.useRef(z)},ft.useState=function(z){return Ee.current.useState(z)},ft.useSyncExternalStore=function(z,T,J){return Ee.current.useSyncExternalStore(z,T,J)},ft.useTransition=function(){return Ee.current.useTransition()},ft.version="18.3.1",ft}var gh;function fu(){return gh||(gh=1,Ec.exports=zg()),Ec.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh;function Wg(){if(vh)return _i;vh=1;var e=fu(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(u,h,x){var p,v={},y=null,E=null;x!==void 0&&(y=""+x),h.key!==void 0&&(y=""+h.key),h.ref!==void 0&&(E=h.ref);for(p in h)i.call(h,p)&&!l.hasOwnProperty(p)&&(v[p]=h[p]);if(u&&u.defaultProps)for(p in h=u.defaultProps,h)v[p]===void 0&&(v[p]=h[p]);return{$$typeof:r,type:u,key:y,ref:E,props:v,_owner:s.current}}return _i.Fragment=t,_i.jsx=c,_i.jsxs=c,_i}var wh;function Vg(){return wh||(wh=1,kc.exports=Wg()),kc.exports}var f=Vg(),ee=fu();const xr=uu(ee);var so={},Sc={exports:{}},Zr={},bc={exports:{}},_c={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yh;function $g(){return yh||(yh=1,(function(e){function r(Se,Y){var xe=Se.length;Se.push(Y);e:for(;0<xe;){var z=xe-1>>>1,T=Se[z];if(0<s(T,Y))Se[z]=Y,Se[xe]=T,xe=z;else break e}}function t(Se){return Se.length===0?null:Se[0]}function i(Se){if(Se.length===0)return null;var Y=Se[0],xe=Se.pop();if(xe!==Y){Se[0]=xe;e:for(var z=0,T=Se.length,J=T>>>1;z<J;){var H=2*(z+1)-1,I=Se[H],ne=H+1,fe=Se[ne];if(0>s(I,xe))ne<T&&0>s(fe,I)?(Se[z]=fe,Se[ne]=xe,z=ne):(Se[z]=I,Se[H]=xe,z=H);else if(ne<T&&0>s(fe,xe))Se[z]=fe,Se[ne]=xe,z=ne;else break e}}return Y}function s(Se,Y){var xe=Se.sortIndex-Y.sortIndex;return xe!==0?xe:Se.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var h=[],x=[],p=1,v=null,y=3,E=!1,k=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(Se){for(var Y=t(x);Y!==null;){if(Y.callback===null)i(x);else if(Y.startTime<=Se)i(x),Y.sortIndex=Y.expirationTime,r(h,Y);else break;Y=t(x)}}function L(Se){if(w=!1,C(Se),!k)if(t(h)!==null)k=!0,Oe(X);else{var Y=t(x);Y!==null&&Ee(L,Y.startTime-Se)}}function X(Se,Y){k=!1,w&&(w=!1,O(V),V=-1),E=!0;var xe=y;try{for(C(Y),v=t(h);v!==null&&(!(v.expirationTime>Y)||Se&&!B());){var z=v.callback;if(typeof z=="function"){v.callback=null,y=v.priorityLevel;var T=z(v.expirationTime<=Y);Y=e.unstable_now(),typeof T=="function"?v.callback=T:v===t(h)&&i(h),C(Y)}else i(h);v=t(h)}if(v!==null)var J=!0;else{var H=t(x);H!==null&&Ee(L,H.startTime-Y),J=!1}return J}finally{v=null,y=xe,E=!1}}var W=!1,M=null,V=-1,G=5,oe=-1;function B(){return!(e.unstable_now()-oe<G)}function K(){if(M!==null){var Se=e.unstable_now();oe=Se;var Y=!0;try{Y=M(!0,Se)}finally{Y?me():(W=!1,M=null)}}else W=!1}var me;if(typeof R=="function")me=function(){R(K)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,we=he.port2;he.port1.onmessage=K,me=function(){we.postMessage(null)}}else me=function(){S(K,0)};function Oe(Se){M=Se,W||(W=!0,me())}function Ee(Se,Y){V=S(function(){Se(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Se){Se.callback=null},e.unstable_continueExecution=function(){k||E||(k=!0,Oe(X))},e.unstable_forceFrameRate=function(Se){0>Se||125<Se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<Se?Math.floor(1e3/Se):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return t(h)},e.unstable_next=function(Se){switch(y){case 1:case 2:case 3:var Y=3;break;default:Y=y}var xe=y;y=Y;try{return Se()}finally{y=xe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Se,Y){switch(Se){case 1:case 2:case 3:case 4:case 5:break;default:Se=3}var xe=y;y=Se;try{return Y()}finally{y=xe}},e.unstable_scheduleCallback=function(Se,Y,xe){var z=e.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?z+xe:z):xe=z,Se){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=xe+T,Se={id:p++,callback:Y,priorityLevel:Se,startTime:xe,expirationTime:T,sortIndex:-1},xe>z?(Se.sortIndex=xe,r(x,Se),t(h)===null&&Se===t(x)&&(w?(O(V),V=-1):w=!0,Ee(L,xe-z))):(Se.sortIndex=T,r(h,Se),k||E||(k=!0,Oe(X))),Se},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(Se){var Y=y;return function(){var xe=y;y=Y;try{return Se.apply(this,arguments)}finally{y=xe}}}})(_c)),_c}var kh;function Gg(){return kh||(kh=1,bc.exports=$g()),bc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eh;function Xg(){if(Eh)return Zr;Eh=1;var e=fu(),r=Gg();function t(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,o=1;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,s={};function l(n,a){c(n,a),c(n+"Capture",a)}function c(n,a){for(s[n]=a,n=0;n<a.length;n++)i.add(a[n])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},v={};function y(n){return h.call(v,n)?!0:h.call(p,n)?!1:x.test(n)?v[n]=!0:(p[n]=!0,!1)}function E(n,a,o,d){if(o!==null&&o.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return d?!1:o!==null?!o.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function k(n,a,o,d){if(a===null||typeof a>"u"||E(n,a,o,d))return!0;if(d)return!1;if(o!==null)switch(o.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function w(n,a,o,d,m,g,_){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=d,this.attributeNamespace=m,this.mustUseProperty=o,this.propertyName=n,this.type=a,this.sanitizeURL=g,this.removeEmptyString=_}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){S[n]=new w(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];S[a]=new w(a,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){S[n]=new w(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){S[n]=new w(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){S[n]=new w(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){S[n]=new w(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){S[n]=new w(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){S[n]=new w(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){S[n]=new w(n,5,!1,n.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function R(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(O,R);S[a]=new w(a,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(O,R);S[a]=new w(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(O,R);S[a]=new w(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){S[n]=new w(n,1,!1,n.toLowerCase(),null,!1,!1)}),S.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){S[n]=new w(n,1,!1,n.toLowerCase(),null,!0,!0)});function C(n,a,o,d){var m=S.hasOwnProperty(a)?S[a]:null;(m!==null?m.type!==0:d||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(k(a,o,m,d)&&(o=null),d||m===null?y(a)&&(o===null?n.removeAttribute(a):n.setAttribute(a,""+o)):m.mustUseProperty?n[m.propertyName]=o===null?m.type===3?!1:"":o:(a=m.attributeName,d=m.attributeNamespace,o===null?n.removeAttribute(a):(m=m.type,o=m===3||m===4&&o===!0?"":""+o,d?n.setAttributeNS(d,a,o):n.setAttribute(a,o))))}var L=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,X=Symbol.for("react.element"),W=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),oe=Symbol.for("react.provider"),B=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),Oe=Symbol.for("react.lazy"),Ee=Symbol.for("react.offscreen"),Se=Symbol.iterator;function Y(n){return n===null||typeof n!="object"?null:(n=Se&&n[Se]||n["@@iterator"],typeof n=="function"?n:null)}var xe=Object.assign,z;function T(n){if(z===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);z=a&&a[1]||""}return`
`+z+n}var J=!1;function H(n,a){if(!n||J)return"";J=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ue){var d=ue}Reflect.construct(n,[],a)}else{try{a.call()}catch(ue){d=ue}n.call(a.prototype)}else{try{throw Error()}catch(ue){d=ue}n()}}catch(ue){if(ue&&d&&typeof ue.stack=="string"){for(var m=ue.stack.split(`
`),g=d.stack.split(`
`),_=m.length-1,U=g.length-1;1<=_&&0<=U&&m[_]!==g[U];)U--;for(;1<=_&&0<=U;_--,U--)if(m[_]!==g[U]){if(_!==1||U!==1)do if(_--,U--,0>U||m[_]!==g[U]){var Q=`
`+m[_].replace(" at new "," at ");return n.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",n.displayName)),Q}while(1<=_&&0<=U);break}}}finally{J=!1,Error.prepareStackTrace=o}return(n=n?n.displayName||n.name:"")?T(n):""}function I(n){switch(n.tag){case 5:return T(n.type);case 16:return T("Lazy");case 13:return T("Suspense");case 19:return T("SuspenseList");case 0:case 2:case 15:return n=H(n.type,!1),n;case 11:return n=H(n.type.render,!1),n;case 1:return n=H(n.type,!0),n;default:return""}}function ne(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case M:return"Fragment";case W:return"Portal";case G:return"Profiler";case V:return"StrictMode";case me:return"Suspense";case he:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case B:return(n.displayName||"Context")+".Consumer";case oe:return(n._context.displayName||"Context")+".Provider";case K:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case we:return a=n.displayName||null,a!==null?a:ne(n.type)||"Memo";case Oe:a=n._payload,n=n._init;try{return ne(n(a))}catch{}}return null}function fe(n){var a=n.type;switch(n.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=a.render,n=n.displayName||n.name||"",a.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ne(a);case 8:return a===V?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ye(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function le(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function de(n){var a=le(n)?"checked":"value",o=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),d=""+n[a];if(!n.hasOwnProperty(a)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var m=o.get,g=o.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return m.call(this)},set:function(_){d=""+_,g.call(this,_)}}),Object.defineProperty(n,a,{enumerable:o.enumerable}),{getValue:function(){return d},setValue:function(_){d=""+_},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function pe(n){n._valueTracker||(n._valueTracker=de(n))}function N(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var o=a.getValue(),d="";return n&&(d=le(n)?n.checked?"true":"false":n.value),n=d,n!==o?(a.setValue(n),!0):!1}function _e(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ne(n,a){var o=a.checked;return xe({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??n._wrapperState.initialChecked})}function Qe(n,a){var o=a.defaultValue==null?"":a.defaultValue,d=a.checked!=null?a.checked:a.defaultChecked;o=ye(a.value!=null?a.value:o),n._wrapperState={initialChecked:d,initialValue:o,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Ge(n,a){a=a.checked,a!=null&&C(n,"checked",a,!1)}function Pe(n,a){Ge(n,a);var o=ye(a.value),d=a.type;if(o!=null)d==="number"?(o===0&&n.value===""||n.value!=o)&&(n.value=""+o):n.value!==""+o&&(n.value=""+o);else if(d==="submit"||d==="reset"){n.removeAttribute("value");return}a.hasOwnProperty("value")?Ft(n,a.type,o):a.hasOwnProperty("defaultValue")&&Ft(n,a.type,ye(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(n.defaultChecked=!!a.defaultChecked)}function St(n,a,o){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var d=a.type;if(!(d!=="submit"&&d!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+n._wrapperState.initialValue,o||a===n.value||(n.value=a),n.defaultValue=a}o=n.name,o!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,o!==""&&(n.name=o)}function Ft(n,a,o){(a!=="number"||_e(n.ownerDocument)!==n)&&(o==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+o&&(n.defaultValue=""+o))}var Dt=Array.isArray;function Xt(n,a,o,d){if(n=n.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<n.length;o++)m=a.hasOwnProperty("$"+n[o].value),n[o].selected!==m&&(n[o].selected=m),m&&d&&(n[o].defaultSelected=!0)}else{for(o=""+ye(o),a=null,m=0;m<n.length;m++){if(n[m].value===o){n[m].selected=!0,d&&(n[m].defaultSelected=!0);return}a!==null||n[m].disabled||(a=n[m])}a!==null&&(a.selected=!0)}}function Rr(n,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return xe({},a,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function gr(n,a){var o=a.value;if(o==null){if(o=a.children,a=a.defaultValue,o!=null){if(a!=null)throw Error(t(92));if(Dt(o)){if(1<o.length)throw Error(t(93));o=o[0]}a=o}a==null&&(a=""),o=a}n._wrapperState={initialValue:ye(o)}}function qt(n,a){var o=ye(a.value),d=ye(a.defaultValue);o!=null&&(o=""+o,o!==n.value&&(n.value=o),a.defaultValue==null&&n.defaultValue!==o&&(n.defaultValue=o)),d!=null&&(n.defaultValue=""+d)}function nr(n){var a=n.textContent;a===n._wrapperState.initialValue&&a!==""&&a!==null&&(n.value=a)}function Pr(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lr(n,a){return n==null||n==="http://www.w3.org/1999/xhtml"?Pr(a):n==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var It,ur=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,o,d,m){MSApp.execUnsafeLocalFunction(function(){return n(a,o,d,m)})}:n})(function(n,a){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=a;else{for(It=It||document.createElement("div"),It.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=It.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;a.firstChild;)n.appendChild(a.firstChild)}});function Ze(n,a){if(a){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=a;return}}n.textContent=a}var ht={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ar=["Webkit","ms","Moz","O"];Object.keys(ht).forEach(function(n){ar.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),ht[a]=ht[n]})});function _t(n,a,o){return a==null||typeof a=="boolean"||a===""?"":o||typeof a!="number"||a===0||ht.hasOwnProperty(n)&&ht[n]?(""+a).trim():a+"px"}function ge(n,a){n=n.style;for(var o in a)if(a.hasOwnProperty(o)){var d=o.indexOf("--")===0,m=_t(o,a[o],d);o==="float"&&(o="cssFloat"),d?n.setProperty(o,m):n[o]=m}}var Be=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ie(n,a){if(a){if(Be[n]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function Le(n,a){if(n.indexOf("-")===-1)return typeof a.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var et=null;function Ke(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var xt=null,dt=null,st=null;function bt(n){if(n=ui(n)){if(typeof xt!="function")throw Error(t(280));var a=n.stateNode;a&&(a=yl(a),xt(n.stateNode,n.type,a))}}function Ut(n){dt?st?st.push(n):st=[n]:dt=n}function Rt(){if(dt){var n=dt,a=st;if(st=dt=null,bt(n),a)for(n=0;n<a.length;n++)bt(a[n])}}function nt(n,a){return n(a)}function Tt(){}var Ct=!1;function Et(n,a,o){if(Ct)return n(a,o);Ct=!0;try{return nt(n,a,o)}finally{Ct=!1,(dt!==null||st!==null)&&(Tt(),Rt())}}function Kt(n,a){var o=n.stateNode;if(o===null)return null;var d=yl(o);if(d===null)return null;o=d[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(t(231,a,typeof o));return o}var Xr=!1;if(u)try{var ke={};Object.defineProperty(ke,"passive",{get:function(){Xr=!0}}),window.addEventListener("test",ke,ke),window.removeEventListener("test",ke,ke)}catch{Xr=!1}function je(n,a,o,d,m,g,_,U,Q){var ue=Array.prototype.slice.call(arguments,3);try{a.apply(o,ue)}catch(Te){this.onError(Te)}}var Ue=!1,at=null,b=!1,P=null,A={onError:function(n){Ue=!0,at=n}};function D(n,a,o,d,m,g,_,U,Q){Ue=!1,at=null,je.apply(A,arguments)}function F(n,a,o,d,m,g,_,U,Q){if(D.apply(this,arguments),Ue){if(Ue){var ue=at;Ue=!1,at=null}else throw Error(t(198));b||(b=!0,P=ue)}}function j(n){var a=n,o=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(o=a.return),n=a.return;while(n)}return a.tag===3?o:null}function q(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function ce(n){if(j(n)!==n)throw Error(t(188))}function te(n){var a=n.alternate;if(!a){if(a=j(n),a===null)throw Error(t(188));return a!==n?null:n}for(var o=n,d=a;;){var m=o.return;if(m===null)break;var g=m.alternate;if(g===null){if(d=m.return,d!==null){o=d;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===o)return ce(m),n;if(g===d)return ce(m),a;g=g.sibling}throw Error(t(188))}if(o.return!==d.return)o=m,d=g;else{for(var _=!1,U=m.child;U;){if(U===o){_=!0,o=m,d=g;break}if(U===d){_=!0,d=m,o=g;break}U=U.sibling}if(!_){for(U=g.child;U;){if(U===o){_=!0,o=g,d=m;break}if(U===d){_=!0,d=g,o=m;break}U=U.sibling}if(!_)throw Error(t(189))}}if(o.alternate!==d)throw Error(t(190))}if(o.tag!==3)throw Error(t(188));return o.stateNode.current===o?n:a}function re(n){return n=te(n),n!==null?ae(n):null}function ae(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var a=ae(n);if(a!==null)return a;n=n.sibling}return null}var ve=r.unstable_scheduleCallback,Ae=r.unstable_cancelCallback,Me=r.unstable_shouldYield,Fe=r.unstable_requestPaint,Ce=r.unstable_now,Ye=r.unstable_getCurrentPriorityLevel,Nt=r.unstable_ImmediatePriority,lt=r.unstable_UserBlockingPriority,yt=r.unstable_NormalPriority,Mr=r.unstable_LowPriority,Br=r.unstable_IdlePriority,vr=null,Wt=null;function $s(n){if(Wt&&typeof Wt.onCommitFiberRoot=="function")try{Wt.onCommitFiberRoot(vr,n,void 0,(n.current.flags&128)===128)}catch{}}var Yt=Math.clz32?Math.clz32:im,am=Math.log,sm=Math.LN2;function im(n){return n>>>=0,n===0?32:31-(am(n)/sm|0)|0}var rl=64,nl=4194304;function Gs(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function al(n,a){var o=n.pendingLanes;if(o===0)return 0;var d=0,m=n.suspendedLanes,g=n.pingedLanes,_=o&268435455;if(_!==0){var U=_&~m;U!==0?d=Gs(U):(g&=_,g!==0&&(d=Gs(g)))}else _=o&~m,_!==0?d=Gs(_):g!==0&&(d=Gs(g));if(d===0)return 0;if(a!==0&&a!==d&&(a&m)===0&&(m=d&-d,g=a&-a,m>=g||m===16&&(g&4194240)!==0))return a;if((d&4)!==0&&(d|=o&16),a=n.entangledLanes,a!==0)for(n=n.entanglements,a&=d;0<a;)o=31-Yt(a),m=1<<o,d|=n[o],a&=~m;return d}function lm(n,a){switch(n){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function om(n,a){for(var o=n.suspendedLanes,d=n.pingedLanes,m=n.expirationTimes,g=n.pendingLanes;0<g;){var _=31-Yt(g),U=1<<_,Q=m[_];Q===-1?((U&o)===0||(U&d)!==0)&&(m[_]=lm(U,a)):Q<=a&&(n.expiredLanes|=U),g&=~U}}function zo(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Gu(){var n=rl;return rl<<=1,(rl&4194240)===0&&(rl=64),n}function Wo(n){for(var a=[],o=0;31>o;o++)a.push(n);return a}function Xs(n,a,o){n.pendingLanes|=a,a!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,a=31-Yt(a),n[a]=o}function cm(n,a){var o=n.pendingLanes&~a;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=a,n.mutableReadLanes&=a,n.entangledLanes&=a,a=n.entanglements;var d=n.eventTimes;for(n=n.expirationTimes;0<o;){var m=31-Yt(o),g=1<<m;a[m]=0,d[m]=-1,n[m]=-1,o&=~g}}function Vo(n,a){var o=n.entangledLanes|=a;for(n=n.entanglements;o;){var d=31-Yt(o),m=1<<d;m&a|n[d]&a&&(n[d]|=a),o&=~m}}var At=0;function Xu(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Ku,$o,Yu,Qu,Ju,Go=!1,sl=[],ia=null,la=null,oa=null,Ks=new Map,Ys=new Map,ca=[],um="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qu(n,a){switch(n){case"focusin":case"focusout":ia=null;break;case"dragenter":case"dragleave":la=null;break;case"mouseover":case"mouseout":oa=null;break;case"pointerover":case"pointerout":Ks.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ys.delete(a.pointerId)}}function Qs(n,a,o,d,m,g){return n===null||n.nativeEvent!==g?(n={blockedOn:a,domEventName:o,eventSystemFlags:d,nativeEvent:g,targetContainers:[m]},a!==null&&(a=ui(a),a!==null&&$o(a)),n):(n.eventSystemFlags|=d,a=n.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),n)}function fm(n,a,o,d,m){switch(a){case"focusin":return ia=Qs(ia,n,a,o,d,m),!0;case"dragenter":return la=Qs(la,n,a,o,d,m),!0;case"mouseover":return oa=Qs(oa,n,a,o,d,m),!0;case"pointerover":var g=m.pointerId;return Ks.set(g,Qs(Ks.get(g)||null,n,a,o,d,m)),!0;case"gotpointercapture":return g=m.pointerId,Ys.set(g,Qs(Ys.get(g)||null,n,a,o,d,m)),!0}return!1}function Zu(n){var a=Pa(n.target);if(a!==null){var o=j(a);if(o!==null){if(a=o.tag,a===13){if(a=q(o),a!==null){n.blockedOn=a,Ju(n.priority,function(){Yu(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function il(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var o=Ko(n.domEventName,n.eventSystemFlags,a[0],n.nativeEvent);if(o===null){o=n.nativeEvent;var d=new o.constructor(o.type,o);et=d,o.target.dispatchEvent(d),et=null}else return a=ui(o),a!==null&&$o(a),n.blockedOn=o,!1;a.shift()}return!0}function ef(n,a,o){il(n)&&o.delete(a)}function dm(){Go=!1,ia!==null&&il(ia)&&(ia=null),la!==null&&il(la)&&(la=null),oa!==null&&il(oa)&&(oa=null),Ks.forEach(ef),Ys.forEach(ef)}function Js(n,a){n.blockedOn===a&&(n.blockedOn=null,Go||(Go=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,dm)))}function qs(n){function a(m){return Js(m,n)}if(0<sl.length){Js(sl[0],n);for(var o=1;o<sl.length;o++){var d=sl[o];d.blockedOn===n&&(d.blockedOn=null)}}for(ia!==null&&Js(ia,n),la!==null&&Js(la,n),oa!==null&&Js(oa,n),Ks.forEach(a),Ys.forEach(a),o=0;o<ca.length;o++)d=ca[o],d.blockedOn===n&&(d.blockedOn=null);for(;0<ca.length&&(o=ca[0],o.blockedOn===null);)Zu(o),o.blockedOn===null&&ca.shift()}var cs=L.ReactCurrentBatchConfig,ll=!0;function hm(n,a,o,d){var m=At,g=cs.transition;cs.transition=null;try{At=1,Xo(n,a,o,d)}finally{At=m,cs.transition=g}}function xm(n,a,o,d){var m=At,g=cs.transition;cs.transition=null;try{At=4,Xo(n,a,o,d)}finally{At=m,cs.transition=g}}function Xo(n,a,o,d){if(ll){var m=Ko(n,a,o,d);if(m===null)f0(n,a,d,ol,o),qu(n,d);else if(fm(m,n,a,o,d))d.stopPropagation();else if(qu(n,d),a&4&&-1<um.indexOf(n)){for(;m!==null;){var g=ui(m);if(g!==null&&Ku(g),g=Ko(n,a,o,d),g===null&&f0(n,a,d,ol,o),g===m)break;m=g}m!==null&&d.stopPropagation()}else f0(n,a,d,null,o)}}var ol=null;function Ko(n,a,o,d){if(ol=null,n=Ke(d),n=Pa(n),n!==null)if(a=j(n),a===null)n=null;else if(o=a.tag,o===13){if(n=q(a),n!==null)return n;n=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null);return ol=n,null}function tf(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ye()){case Nt:return 1;case lt:return 4;case yt:case Mr:return 16;case Br:return 536870912;default:return 16}default:return 16}}var ua=null,Yo=null,cl=null;function rf(){if(cl)return cl;var n,a=Yo,o=a.length,d,m="value"in ua?ua.value:ua.textContent,g=m.length;for(n=0;n<o&&a[n]===m[n];n++);var _=o-n;for(d=1;d<=_&&a[o-d]===m[g-d];d++);return cl=m.slice(n,1<d?1-d:void 0)}function ul(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function fl(){return!0}function nf(){return!1}function tn(n){function a(o,d,m,g,_){this._reactName=o,this._targetInst=m,this.type=d,this.nativeEvent=g,this.target=_,this.currentTarget=null;for(var U in n)n.hasOwnProperty(U)&&(o=n[U],this[U]=o?o(g):g[U]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?fl:nf,this.isPropagationStopped=nf,this}return xe(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=fl)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=fl)},persist:function(){},isPersistent:fl}),a}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qo=tn(us),Zs=xe({},us,{view:0,detail:0}),pm=tn(Zs),Jo,qo,ei,dl=xe({},Zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:e0,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ei&&(ei&&n.type==="mousemove"?(Jo=n.screenX-ei.screenX,qo=n.screenY-ei.screenY):qo=Jo=0,ei=n),Jo)},movementY:function(n){return"movementY"in n?n.movementY:qo}}),af=tn(dl),mm=xe({},dl,{dataTransfer:0}),gm=tn(mm),vm=xe({},Zs,{relatedTarget:0}),Zo=tn(vm),wm=xe({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),ym=tn(wm),km=xe({},us,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Em=tn(km),Sm=xe({},us,{data:0}),sf=tn(Sm),bm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_m={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cm(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Tm[n])?!!a[n]:!1}function e0(){return Cm}var Nm=xe({},Zs,{key:function(n){if(n.key){var a=bm[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=ul(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?_m[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:e0,charCode:function(n){return n.type==="keypress"?ul(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ul(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Am=tn(Nm),Fm=xe({},dl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lf=tn(Fm),Dm=xe({},Zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:e0}),Om=tn(Dm),jm=xe({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),Im=tn(jm),Rm=xe({},dl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Pm=tn(Rm),Lm=[9,13,27,32],t0=u&&"CompositionEvent"in window,ti=null;u&&"documentMode"in document&&(ti=document.documentMode);var Mm=u&&"TextEvent"in window&&!ti,of=u&&(!t0||ti&&8<ti&&11>=ti),cf=" ",uf=!1;function ff(n,a){switch(n){case"keyup":return Lm.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function df(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var fs=!1;function Bm(n,a){switch(n){case"compositionend":return df(a);case"keypress":return a.which!==32?null:(uf=!0,cf);case"textInput":return n=a.data,n===cf&&uf?null:n;default:return null}}function Um(n,a){if(fs)return n==="compositionend"||!t0&&ff(n,a)?(n=rf(),cl=Yo=ua=null,fs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return of&&a.locale!=="ko"?null:a.data;default:return null}}var Hm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hf(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!Hm[n.type]:a==="textarea"}function xf(n,a,o,d){Ut(d),a=gl(a,"onChange"),0<a.length&&(o=new Qo("onChange","change",null,o,d),n.push({event:o,listeners:a}))}var ri=null,ni=null;function zm(n){Of(n,0)}function hl(n){var a=ms(n);if(N(a))return n}function Wm(n,a){if(n==="change")return a}var pf=!1;if(u){var r0;if(u){var n0="oninput"in document;if(!n0){var mf=document.createElement("div");mf.setAttribute("oninput","return;"),n0=typeof mf.oninput=="function"}r0=n0}else r0=!1;pf=r0&&(!document.documentMode||9<document.documentMode)}function gf(){ri&&(ri.detachEvent("onpropertychange",vf),ni=ri=null)}function vf(n){if(n.propertyName==="value"&&hl(ni)){var a=[];xf(a,ni,n,Ke(n)),Et(zm,a)}}function Vm(n,a,o){n==="focusin"?(gf(),ri=a,ni=o,ri.attachEvent("onpropertychange",vf)):n==="focusout"&&gf()}function $m(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return hl(ni)}function Gm(n,a){if(n==="click")return hl(a)}function Xm(n,a){if(n==="input"||n==="change")return hl(a)}function Km(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var En=typeof Object.is=="function"?Object.is:Km;function ai(n,a){if(En(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var o=Object.keys(n),d=Object.keys(a);if(o.length!==d.length)return!1;for(d=0;d<o.length;d++){var m=o[d];if(!h.call(a,m)||!En(n[m],a[m]))return!1}return!0}function wf(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function yf(n,a){var o=wf(n);n=0;for(var d;o;){if(o.nodeType===3){if(d=n+o.textContent.length,n<=a&&d>=a)return{node:o,offset:a-n};n=d}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=wf(o)}}function kf(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?kf(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function Ef(){for(var n=window,a=_e();a instanceof n.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)n=a.contentWindow;else break;a=_e(n.document)}return a}function a0(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}function Ym(n){var a=Ef(),o=n.focusedElem,d=n.selectionRange;if(a!==o&&o&&o.ownerDocument&&kf(o.ownerDocument.documentElement,o)){if(d!==null&&a0(o)){if(a=d.start,n=d.end,n===void 0&&(n=a),"selectionStart"in o)o.selectionStart=a,o.selectionEnd=Math.min(n,o.value.length);else if(n=(a=o.ownerDocument||document)&&a.defaultView||window,n.getSelection){n=n.getSelection();var m=o.textContent.length,g=Math.min(d.start,m);d=d.end===void 0?g:Math.min(d.end,m),!n.extend&&g>d&&(m=d,d=g,g=m),m=yf(o,g);var _=yf(o,d);m&&_&&(n.rangeCount!==1||n.anchorNode!==m.node||n.anchorOffset!==m.offset||n.focusNode!==_.node||n.focusOffset!==_.offset)&&(a=a.createRange(),a.setStart(m.node,m.offset),n.removeAllRanges(),g>d?(n.addRange(a),n.extend(_.node,_.offset)):(a.setEnd(_.node,_.offset),n.addRange(a)))}}for(a=[],n=o;n=n.parentNode;)n.nodeType===1&&a.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<a.length;o++)n=a[o],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Qm=u&&"documentMode"in document&&11>=document.documentMode,ds=null,s0=null,si=null,i0=!1;function Sf(n,a,o){var d=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;i0||ds==null||ds!==_e(d)||(d=ds,"selectionStart"in d&&a0(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),si&&ai(si,d)||(si=d,d=gl(s0,"onSelect"),0<d.length&&(a=new Qo("onSelect","select",null,a,o),n.push({event:a,listeners:d}),a.target=ds)))}function xl(n,a){var o={};return o[n.toLowerCase()]=a.toLowerCase(),o["Webkit"+n]="webkit"+a,o["Moz"+n]="moz"+a,o}var hs={animationend:xl("Animation","AnimationEnd"),animationiteration:xl("Animation","AnimationIteration"),animationstart:xl("Animation","AnimationStart"),transitionend:xl("Transition","TransitionEnd")},l0={},bf={};u&&(bf=document.createElement("div").style,"AnimationEvent"in window||(delete hs.animationend.animation,delete hs.animationiteration.animation,delete hs.animationstart.animation),"TransitionEvent"in window||delete hs.transitionend.transition);function pl(n){if(l0[n])return l0[n];if(!hs[n])return n;var a=hs[n],o;for(o in a)if(a.hasOwnProperty(o)&&o in bf)return l0[n]=a[o];return n}var _f=pl("animationend"),Tf=pl("animationiteration"),Cf=pl("animationstart"),Nf=pl("transitionend"),Af=new Map,Ff="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fa(n,a){Af.set(n,a),l(a,[n])}for(var o0=0;o0<Ff.length;o0++){var c0=Ff[o0],Jm=c0.toLowerCase(),qm=c0[0].toUpperCase()+c0.slice(1);fa(Jm,"on"+qm)}fa(_f,"onAnimationEnd"),fa(Tf,"onAnimationIteration"),fa(Cf,"onAnimationStart"),fa("dblclick","onDoubleClick"),fa("focusin","onFocus"),fa("focusout","onBlur"),fa(Nf,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ii="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zm=new Set("cancel close invalid load scroll toggle".split(" ").concat(ii));function Df(n,a,o){var d=n.type||"unknown-event";n.currentTarget=o,F(d,a,void 0,n),n.currentTarget=null}function Of(n,a){a=(a&4)!==0;for(var o=0;o<n.length;o++){var d=n[o],m=d.event;d=d.listeners;e:{var g=void 0;if(a)for(var _=d.length-1;0<=_;_--){var U=d[_],Q=U.instance,ue=U.currentTarget;if(U=U.listener,Q!==g&&m.isPropagationStopped())break e;Df(m,U,ue),g=Q}else for(_=0;_<d.length;_++){if(U=d[_],Q=U.instance,ue=U.currentTarget,U=U.listener,Q!==g&&m.isPropagationStopped())break e;Df(m,U,ue),g=Q}}}if(b)throw n=P,b=!1,P=null,n}function Pt(n,a){var o=a[g0];o===void 0&&(o=a[g0]=new Set);var d=n+"__bubble";o.has(d)||(jf(a,n,2,!1),o.add(d))}function u0(n,a,o){var d=0;a&&(d|=4),jf(o,n,d,a)}var ml="_reactListening"+Math.random().toString(36).slice(2);function li(n){if(!n[ml]){n[ml]=!0,i.forEach(function(o){o!=="selectionchange"&&(Zm.has(o)||u0(o,!1,n),u0(o,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[ml]||(a[ml]=!0,u0("selectionchange",!1,a))}}function jf(n,a,o,d){switch(tf(a)){case 1:var m=hm;break;case 4:m=xm;break;default:m=Xo}o=m.bind(null,a,o,n),m=void 0,!Xr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),d?m!==void 0?n.addEventListener(a,o,{capture:!0,passive:m}):n.addEventListener(a,o,!0):m!==void 0?n.addEventListener(a,o,{passive:m}):n.addEventListener(a,o,!1)}function f0(n,a,o,d,m){var g=d;if((a&1)===0&&(a&2)===0&&d!==null)e:for(;;){if(d===null)return;var _=d.tag;if(_===3||_===4){var U=d.stateNode.containerInfo;if(U===m||U.nodeType===8&&U.parentNode===m)break;if(_===4)for(_=d.return;_!==null;){var Q=_.tag;if((Q===3||Q===4)&&(Q=_.stateNode.containerInfo,Q===m||Q.nodeType===8&&Q.parentNode===m))return;_=_.return}for(;U!==null;){if(_=Pa(U),_===null)return;if(Q=_.tag,Q===5||Q===6){d=g=_;continue e}U=U.parentNode}}d=d.return}Et(function(){var ue=g,Te=Ke(o),De=[];e:{var be=Af.get(n);if(be!==void 0){var He=Qo,We=n;switch(n){case"keypress":if(ul(o)===0)break e;case"keydown":case"keyup":He=Am;break;case"focusin":We="focus",He=Zo;break;case"focusout":We="blur",He=Zo;break;case"beforeblur":case"afterblur":He=Zo;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":He=af;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":He=gm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":He=Om;break;case _f:case Tf:case Cf:He=ym;break;case Nf:He=Im;break;case"scroll":He=pm;break;case"wheel":He=Pm;break;case"copy":case"cut":case"paste":He=Em;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":He=lf}var Ve=(a&4)!==0,Qt=!Ve&&n==="scroll",se=Ve?be!==null?be+"Capture":null:be;Ve=[];for(var Z=ue,ie;Z!==null;){ie=Z;var Re=ie.stateNode;if(ie.tag===5&&Re!==null&&(ie=Re,se!==null&&(Re=Kt(Z,se),Re!=null&&Ve.push(oi(Z,Re,ie)))),Qt)break;Z=Z.return}0<Ve.length&&(be=new He(be,We,null,o,Te),De.push({event:be,listeners:Ve}))}}if((a&7)===0){e:{if(be=n==="mouseover"||n==="pointerover",He=n==="mouseout"||n==="pointerout",be&&o!==et&&(We=o.relatedTarget||o.fromElement)&&(Pa(We)||We[Vn]))break e;if((He||be)&&(be=Te.window===Te?Te:(be=Te.ownerDocument)?be.defaultView||be.parentWindow:window,He?(We=o.relatedTarget||o.toElement,He=ue,We=We?Pa(We):null,We!==null&&(Qt=j(We),We!==Qt||We.tag!==5&&We.tag!==6)&&(We=null)):(He=null,We=ue),He!==We)){if(Ve=af,Re="onMouseLeave",se="onMouseEnter",Z="mouse",(n==="pointerout"||n==="pointerover")&&(Ve=lf,Re="onPointerLeave",se="onPointerEnter",Z="pointer"),Qt=He==null?be:ms(He),ie=We==null?be:ms(We),be=new Ve(Re,Z+"leave",He,o,Te),be.target=Qt,be.relatedTarget=ie,Re=null,Pa(Te)===ue&&(Ve=new Ve(se,Z+"enter",We,o,Te),Ve.target=ie,Ve.relatedTarget=Qt,Re=Ve),Qt=Re,He&&We)t:{for(Ve=He,se=We,Z=0,ie=Ve;ie;ie=xs(ie))Z++;for(ie=0,Re=se;Re;Re=xs(Re))ie++;for(;0<Z-ie;)Ve=xs(Ve),Z--;for(;0<ie-Z;)se=xs(se),ie--;for(;Z--;){if(Ve===se||se!==null&&Ve===se.alternate)break t;Ve=xs(Ve),se=xs(se)}Ve=null}else Ve=null;He!==null&&If(De,be,He,Ve,!1),We!==null&&Qt!==null&&If(De,Qt,We,Ve,!0)}}e:{if(be=ue?ms(ue):window,He=be.nodeName&&be.nodeName.toLowerCase(),He==="select"||He==="input"&&be.type==="file")var $e=Wm;else if(hf(be))if(pf)$e=Xm;else{$e=$m;var Je=Vm}else(He=be.nodeName)&&He.toLowerCase()==="input"&&(be.type==="checkbox"||be.type==="radio")&&($e=Gm);if($e&&($e=$e(n,ue))){xf(De,$e,o,Te);break e}Je&&Je(n,be,ue),n==="focusout"&&(Je=be._wrapperState)&&Je.controlled&&be.type==="number"&&Ft(be,"number",be.value)}switch(Je=ue?ms(ue):window,n){case"focusin":(hf(Je)||Je.contentEditable==="true")&&(ds=Je,s0=ue,si=null);break;case"focusout":si=s0=ds=null;break;case"mousedown":i0=!0;break;case"contextmenu":case"mouseup":case"dragend":i0=!1,Sf(De,o,Te);break;case"selectionchange":if(Qm)break;case"keydown":case"keyup":Sf(De,o,Te)}var qe;if(t0)e:{switch(n){case"compositionstart":var rt="onCompositionStart";break e;case"compositionend":rt="onCompositionEnd";break e;case"compositionupdate":rt="onCompositionUpdate";break e}rt=void 0}else fs?ff(n,o)&&(rt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(rt="onCompositionStart");rt&&(of&&o.locale!=="ko"&&(fs||rt!=="onCompositionStart"?rt==="onCompositionEnd"&&fs&&(qe=rf()):(ua=Te,Yo="value"in ua?ua.value:ua.textContent,fs=!0)),Je=gl(ue,rt),0<Je.length&&(rt=new sf(rt,n,null,o,Te),De.push({event:rt,listeners:Je}),qe?rt.data=qe:(qe=df(o),qe!==null&&(rt.data=qe)))),(qe=Mm?Bm(n,o):Um(n,o))&&(ue=gl(ue,"onBeforeInput"),0<ue.length&&(Te=new sf("onBeforeInput","beforeinput",null,o,Te),De.push({event:Te,listeners:ue}),Te.data=qe))}Of(De,a)})}function oi(n,a,o){return{instance:n,listener:a,currentTarget:o}}function gl(n,a){for(var o=a+"Capture",d=[];n!==null;){var m=n,g=m.stateNode;m.tag===5&&g!==null&&(m=g,g=Kt(n,o),g!=null&&d.unshift(oi(n,g,m)),g=Kt(n,a),g!=null&&d.push(oi(n,g,m))),n=n.return}return d}function xs(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function If(n,a,o,d,m){for(var g=a._reactName,_=[];o!==null&&o!==d;){var U=o,Q=U.alternate,ue=U.stateNode;if(Q!==null&&Q===d)break;U.tag===5&&ue!==null&&(U=ue,m?(Q=Kt(o,g),Q!=null&&_.unshift(oi(o,Q,U))):m||(Q=Kt(o,g),Q!=null&&_.push(oi(o,Q,U)))),o=o.return}_.length!==0&&n.push({event:a,listeners:_})}var eg=/\r\n?/g,tg=/\u0000|\uFFFD/g;function Rf(n){return(typeof n=="string"?n:""+n).replace(eg,`
`).replace(tg,"")}function vl(n,a,o){if(a=Rf(a),Rf(n)!==a&&o)throw Error(t(425))}function wl(){}var d0=null,h0=null;function x0(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var p0=typeof setTimeout=="function"?setTimeout:void 0,rg=typeof clearTimeout=="function"?clearTimeout:void 0,Pf=typeof Promise=="function"?Promise:void 0,ng=typeof queueMicrotask=="function"?queueMicrotask:typeof Pf<"u"?function(n){return Pf.resolve(null).then(n).catch(ag)}:p0;function ag(n){setTimeout(function(){throw n})}function m0(n,a){var o=a,d=0;do{var m=o.nextSibling;if(n.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"){if(d===0){n.removeChild(m),qs(a);return}d--}else o!=="$"&&o!=="$?"&&o!=="$!"||d++;o=m}while(o);qs(a)}function da(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return n}function Lf(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"){if(a===0)return n;a--}else o==="/$"&&a++}n=n.previousSibling}return null}var ps=Math.random().toString(36).slice(2),In="__reactFiber$"+ps,ci="__reactProps$"+ps,Vn="__reactContainer$"+ps,g0="__reactEvents$"+ps,sg="__reactListeners$"+ps,ig="__reactHandles$"+ps;function Pa(n){var a=n[In];if(a)return a;for(var o=n.parentNode;o;){if(a=o[Vn]||o[In]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(n=Lf(n);n!==null;){if(o=n[In])return o;n=Lf(n)}return a}n=o,o=n.parentNode}return null}function ui(n){return n=n[In]||n[Vn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ms(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function yl(n){return n[ci]||null}var v0=[],gs=-1;function ha(n){return{current:n}}function Lt(n){0>gs||(n.current=v0[gs],v0[gs]=null,gs--)}function Ot(n,a){gs++,v0[gs]=n.current,n.current=a}var xa={},br=ha(xa),Kr=ha(!1),La=xa;function vs(n,a){var o=n.type.contextTypes;if(!o)return xa;var d=n.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===a)return d.__reactInternalMemoizedMaskedChildContext;var m={},g;for(g in o)m[g]=a[g];return d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=m),m}function Yr(n){return n=n.childContextTypes,n!=null}function kl(){Lt(Kr),Lt(br)}function Mf(n,a,o){if(br.current!==xa)throw Error(t(168));Ot(br,a),Ot(Kr,o)}function Bf(n,a,o){var d=n.stateNode;if(a=a.childContextTypes,typeof d.getChildContext!="function")return o;d=d.getChildContext();for(var m in d)if(!(m in a))throw Error(t(108,fe(n)||"Unknown",m));return xe({},o,d)}function El(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||xa,La=br.current,Ot(br,n),Ot(Kr,Kr.current),!0}function Uf(n,a,o){var d=n.stateNode;if(!d)throw Error(t(169));o?(n=Bf(n,a,La),d.__reactInternalMemoizedMergedChildContext=n,Lt(Kr),Lt(br),Ot(br,n)):Lt(Kr),Ot(Kr,o)}var $n=null,Sl=!1,w0=!1;function Hf(n){$n===null?$n=[n]:$n.push(n)}function lg(n){Sl=!0,Hf(n)}function pa(){if(!w0&&$n!==null){w0=!0;var n=0,a=At;try{var o=$n;for(At=1;n<o.length;n++){var d=o[n];do d=d(!0);while(d!==null)}$n=null,Sl=!1}catch(m){throw $n!==null&&($n=$n.slice(n+1)),ve(Nt,pa),m}finally{At=a,w0=!1}}return null}var ws=[],ys=0,bl=null,_l=0,cn=[],un=0,Ma=null,Gn=1,Xn="";function Ba(n,a){ws[ys++]=_l,ws[ys++]=bl,bl=n,_l=a}function zf(n,a,o){cn[un++]=Gn,cn[un++]=Xn,cn[un++]=Ma,Ma=n;var d=Gn;n=Xn;var m=32-Yt(d)-1;d&=~(1<<m),o+=1;var g=32-Yt(a)+m;if(30<g){var _=m-m%5;g=(d&(1<<_)-1).toString(32),d>>=_,m-=_,Gn=1<<32-Yt(a)+m|o<<m|d,Xn=g+n}else Gn=1<<g|o<<m|d,Xn=n}function y0(n){n.return!==null&&(Ba(n,1),zf(n,1,0))}function k0(n){for(;n===bl;)bl=ws[--ys],ws[ys]=null,_l=ws[--ys],ws[ys]=null;for(;n===Ma;)Ma=cn[--un],cn[un]=null,Xn=cn[--un],cn[un]=null,Gn=cn[--un],cn[un]=null}var rn=null,nn=null,Mt=!1,Sn=null;function Wf(n,a){var o=xn(5,null,null,0);o.elementType="DELETED",o.stateNode=a,o.return=n,a=n.deletions,a===null?(n.deletions=[o],n.flags|=16):a.push(o)}function Vf(n,a){switch(n.tag){case 5:var o=n.type;return a=a.nodeType!==1||o.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(n.stateNode=a,rn=n,nn=da(a.firstChild),!0):!1;case 6:return a=n.pendingProps===""||a.nodeType!==3?null:a,a!==null?(n.stateNode=a,rn=n,nn=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(o=Ma!==null?{id:Gn,overflow:Xn}:null,n.memoizedState={dehydrated:a,treeContext:o,retryLane:1073741824},o=xn(18,null,null,0),o.stateNode=a,o.return=n,n.child=o,rn=n,nn=null,!0):!1;default:return!1}}function E0(n){return(n.mode&1)!==0&&(n.flags&128)===0}function S0(n){if(Mt){var a=nn;if(a){var o=a;if(!Vf(n,a)){if(E0(n))throw Error(t(418));a=da(o.nextSibling);var d=rn;a&&Vf(n,a)?Wf(d,o):(n.flags=n.flags&-4097|2,Mt=!1,rn=n)}}else{if(E0(n))throw Error(t(418));n.flags=n.flags&-4097|2,Mt=!1,rn=n}}}function $f(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;rn=n}function Tl(n){if(n!==rn)return!1;if(!Mt)return $f(n),Mt=!0,!1;var a;if((a=n.tag!==3)&&!(a=n.tag!==5)&&(a=n.type,a=a!=="head"&&a!=="body"&&!x0(n.type,n.memoizedProps)),a&&(a=nn)){if(E0(n))throw Gf(),Error(t(418));for(;a;)Wf(n,a),a=da(a.nextSibling)}if($f(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"){if(a===0){nn=da(n.nextSibling);break e}a--}else o!=="$"&&o!=="$!"&&o!=="$?"||a++}n=n.nextSibling}nn=null}}else nn=rn?da(n.stateNode.nextSibling):null;return!0}function Gf(){for(var n=nn;n;)n=da(n.nextSibling)}function ks(){nn=rn=null,Mt=!1}function b0(n){Sn===null?Sn=[n]:Sn.push(n)}var og=L.ReactCurrentBatchConfig;function fi(n,a,o){if(n=o.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(t(309));var d=o.stateNode}if(!d)throw Error(t(147,n));var m=d,g=""+n;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===g?a.ref:(a=function(_){var U=m.refs;_===null?delete U[g]:U[g]=_},a._stringRef=g,a)}if(typeof n!="string")throw Error(t(284));if(!o._owner)throw Error(t(290,n))}return n}function Cl(n,a){throw n=Object.prototype.toString.call(a),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n))}function Xf(n){var a=n._init;return a(n._payload)}function Kf(n){function a(se,Z){if(n){var ie=se.deletions;ie===null?(se.deletions=[Z],se.flags|=16):ie.push(Z)}}function o(se,Z){if(!n)return null;for(;Z!==null;)a(se,Z),Z=Z.sibling;return null}function d(se,Z){for(se=new Map;Z!==null;)Z.key!==null?se.set(Z.key,Z):se.set(Z.index,Z),Z=Z.sibling;return se}function m(se,Z){return se=Sa(se,Z),se.index=0,se.sibling=null,se}function g(se,Z,ie){return se.index=ie,n?(ie=se.alternate,ie!==null?(ie=ie.index,ie<Z?(se.flags|=2,Z):ie):(se.flags|=2,Z)):(se.flags|=1048576,Z)}function _(se){return n&&se.alternate===null&&(se.flags|=2),se}function U(se,Z,ie,Re){return Z===null||Z.tag!==6?(Z=pc(ie,se.mode,Re),Z.return=se,Z):(Z=m(Z,ie),Z.return=se,Z)}function Q(se,Z,ie,Re){var $e=ie.type;return $e===M?Te(se,Z,ie.props.children,Re,ie.key):Z!==null&&(Z.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===Oe&&Xf($e)===Z.type)?(Re=m(Z,ie.props),Re.ref=fi(se,Z,ie),Re.return=se,Re):(Re=Jl(ie.type,ie.key,ie.props,null,se.mode,Re),Re.ref=fi(se,Z,ie),Re.return=se,Re)}function ue(se,Z,ie,Re){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==ie.containerInfo||Z.stateNode.implementation!==ie.implementation?(Z=mc(ie,se.mode,Re),Z.return=se,Z):(Z=m(Z,ie.children||[]),Z.return=se,Z)}function Te(se,Z,ie,Re,$e){return Z===null||Z.tag!==7?(Z=Xa(ie,se.mode,Re,$e),Z.return=se,Z):(Z=m(Z,ie),Z.return=se,Z)}function De(se,Z,ie){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=pc(""+Z,se.mode,ie),Z.return=se,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case X:return ie=Jl(Z.type,Z.key,Z.props,null,se.mode,ie),ie.ref=fi(se,null,Z),ie.return=se,ie;case W:return Z=mc(Z,se.mode,ie),Z.return=se,Z;case Oe:var Re=Z._init;return De(se,Re(Z._payload),ie)}if(Dt(Z)||Y(Z))return Z=Xa(Z,se.mode,ie,null),Z.return=se,Z;Cl(se,Z)}return null}function be(se,Z,ie,Re){var $e=Z!==null?Z.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return $e!==null?null:U(se,Z,""+ie,Re);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case X:return ie.key===$e?Q(se,Z,ie,Re):null;case W:return ie.key===$e?ue(se,Z,ie,Re):null;case Oe:return $e=ie._init,be(se,Z,$e(ie._payload),Re)}if(Dt(ie)||Y(ie))return $e!==null?null:Te(se,Z,ie,Re,null);Cl(se,ie)}return null}function He(se,Z,ie,Re,$e){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return se=se.get(ie)||null,U(Z,se,""+Re,$e);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case X:return se=se.get(Re.key===null?ie:Re.key)||null,Q(Z,se,Re,$e);case W:return se=se.get(Re.key===null?ie:Re.key)||null,ue(Z,se,Re,$e);case Oe:var Je=Re._init;return He(se,Z,ie,Je(Re._payload),$e)}if(Dt(Re)||Y(Re))return se=se.get(ie)||null,Te(Z,se,Re,$e,null);Cl(Z,Re)}return null}function We(se,Z,ie,Re){for(var $e=null,Je=null,qe=Z,rt=Z=0,hr=null;qe!==null&&rt<ie.length;rt++){qe.index>rt?(hr=qe,qe=null):hr=qe.sibling;var kt=be(se,qe,ie[rt],Re);if(kt===null){qe===null&&(qe=hr);break}n&&qe&&kt.alternate===null&&a(se,qe),Z=g(kt,Z,rt),Je===null?$e=kt:Je.sibling=kt,Je=kt,qe=hr}if(rt===ie.length)return o(se,qe),Mt&&Ba(se,rt),$e;if(qe===null){for(;rt<ie.length;rt++)qe=De(se,ie[rt],Re),qe!==null&&(Z=g(qe,Z,rt),Je===null?$e=qe:Je.sibling=qe,Je=qe);return Mt&&Ba(se,rt),$e}for(qe=d(se,qe);rt<ie.length;rt++)hr=He(qe,se,rt,ie[rt],Re),hr!==null&&(n&&hr.alternate!==null&&qe.delete(hr.key===null?rt:hr.key),Z=g(hr,Z,rt),Je===null?$e=hr:Je.sibling=hr,Je=hr);return n&&qe.forEach(function(ba){return a(se,ba)}),Mt&&Ba(se,rt),$e}function Ve(se,Z,ie,Re){var $e=Y(ie);if(typeof $e!="function")throw Error(t(150));if(ie=$e.call(ie),ie==null)throw Error(t(151));for(var Je=$e=null,qe=Z,rt=Z=0,hr=null,kt=ie.next();qe!==null&&!kt.done;rt++,kt=ie.next()){qe.index>rt?(hr=qe,qe=null):hr=qe.sibling;var ba=be(se,qe,kt.value,Re);if(ba===null){qe===null&&(qe=hr);break}n&&qe&&ba.alternate===null&&a(se,qe),Z=g(ba,Z,rt),Je===null?$e=ba:Je.sibling=ba,Je=ba,qe=hr}if(kt.done)return o(se,qe),Mt&&Ba(se,rt),$e;if(qe===null){for(;!kt.done;rt++,kt=ie.next())kt=De(se,kt.value,Re),kt!==null&&(Z=g(kt,Z,rt),Je===null?$e=kt:Je.sibling=kt,Je=kt);return Mt&&Ba(se,rt),$e}for(qe=d(se,qe);!kt.done;rt++,kt=ie.next())kt=He(qe,se,rt,kt.value,Re),kt!==null&&(n&&kt.alternate!==null&&qe.delete(kt.key===null?rt:kt.key),Z=g(kt,Z,rt),Je===null?$e=kt:Je.sibling=kt,Je=kt);return n&&qe.forEach(function(Hg){return a(se,Hg)}),Mt&&Ba(se,rt),$e}function Qt(se,Z,ie,Re){if(typeof ie=="object"&&ie!==null&&ie.type===M&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case X:e:{for(var $e=ie.key,Je=Z;Je!==null;){if(Je.key===$e){if($e=ie.type,$e===M){if(Je.tag===7){o(se,Je.sibling),Z=m(Je,ie.props.children),Z.return=se,se=Z;break e}}else if(Je.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===Oe&&Xf($e)===Je.type){o(se,Je.sibling),Z=m(Je,ie.props),Z.ref=fi(se,Je,ie),Z.return=se,se=Z;break e}o(se,Je);break}else a(se,Je);Je=Je.sibling}ie.type===M?(Z=Xa(ie.props.children,se.mode,Re,ie.key),Z.return=se,se=Z):(Re=Jl(ie.type,ie.key,ie.props,null,se.mode,Re),Re.ref=fi(se,Z,ie),Re.return=se,se=Re)}return _(se);case W:e:{for(Je=ie.key;Z!==null;){if(Z.key===Je)if(Z.tag===4&&Z.stateNode.containerInfo===ie.containerInfo&&Z.stateNode.implementation===ie.implementation){o(se,Z.sibling),Z=m(Z,ie.children||[]),Z.return=se,se=Z;break e}else{o(se,Z);break}else a(se,Z);Z=Z.sibling}Z=mc(ie,se.mode,Re),Z.return=se,se=Z}return _(se);case Oe:return Je=ie._init,Qt(se,Z,Je(ie._payload),Re)}if(Dt(ie))return We(se,Z,ie,Re);if(Y(ie))return Ve(se,Z,ie,Re);Cl(se,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,Z!==null&&Z.tag===6?(o(se,Z.sibling),Z=m(Z,ie),Z.return=se,se=Z):(o(se,Z),Z=pc(ie,se.mode,Re),Z.return=se,se=Z),_(se)):o(se,Z)}return Qt}var Es=Kf(!0),Yf=Kf(!1),Nl=ha(null),Al=null,Ss=null,_0=null;function T0(){_0=Ss=Al=null}function C0(n){var a=Nl.current;Lt(Nl),n._currentValue=a}function N0(n,a,o){for(;n!==null;){var d=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),n===o)break;n=n.return}}function bs(n,a){Al=n,_0=Ss=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&a)!==0&&(Qr=!0),n.firstContext=null)}function fn(n){var a=n._currentValue;if(_0!==n)if(n={context:n,memoizedValue:a,next:null},Ss===null){if(Al===null)throw Error(t(308));Ss=n,Al.dependencies={lanes:0,firstContext:n}}else Ss=Ss.next=n;return a}var Ua=null;function A0(n){Ua===null?Ua=[n]:Ua.push(n)}function Qf(n,a,o,d){var m=a.interleaved;return m===null?(o.next=o,A0(a)):(o.next=m.next,m.next=o),a.interleaved=o,Kn(n,d)}function Kn(n,a){n.lanes|=a;var o=n.alternate;for(o!==null&&(o.lanes|=a),o=n,n=n.return;n!==null;)n.childLanes|=a,o=n.alternate,o!==null&&(o.childLanes|=a),o=n,n=n.return;return o.tag===3?o.stateNode:null}var ma=!1;function F0(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jf(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Yn(n,a){return{eventTime:n,lane:a,tag:0,payload:null,callback:null,next:null}}function ga(n,a,o){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(vt&2)!==0){var m=d.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),d.pending=a,Kn(n,o)}return m=d.interleaved,m===null?(a.next=a,A0(d)):(a.next=m.next,m.next=a),d.interleaved=a,Kn(n,o)}function Fl(n,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194240)!==0)){var d=a.lanes;d&=n.pendingLanes,o|=d,a.lanes=o,Vo(n,o)}}function qf(n,a){var o=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,o===d)){var m=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var _={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};g===null?m=g=_:g=g.next=_,o=o.next}while(o!==null);g===null?m=g=a:g=g.next=a}else m=g=a;o={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:d.shared,effects:d.effects},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=a:n.next=a,o.lastBaseUpdate=a}function Dl(n,a,o,d){var m=n.updateQueue;ma=!1;var g=m.firstBaseUpdate,_=m.lastBaseUpdate,U=m.shared.pending;if(U!==null){m.shared.pending=null;var Q=U,ue=Q.next;Q.next=null,_===null?g=ue:_.next=ue,_=Q;var Te=n.alternate;Te!==null&&(Te=Te.updateQueue,U=Te.lastBaseUpdate,U!==_&&(U===null?Te.firstBaseUpdate=ue:U.next=ue,Te.lastBaseUpdate=Q))}if(g!==null){var De=m.baseState;_=0,Te=ue=Q=null,U=g;do{var be=U.lane,He=U.eventTime;if((d&be)===be){Te!==null&&(Te=Te.next={eventTime:He,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var We=n,Ve=U;switch(be=a,He=o,Ve.tag){case 1:if(We=Ve.payload,typeof We=="function"){De=We.call(He,De,be);break e}De=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=Ve.payload,be=typeof We=="function"?We.call(He,De,be):We,be==null)break e;De=xe({},De,be);break e;case 2:ma=!0}}U.callback!==null&&U.lane!==0&&(n.flags|=64,be=m.effects,be===null?m.effects=[U]:be.push(U))}else He={eventTime:He,lane:be,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Te===null?(ue=Te=He,Q=De):Te=Te.next=He,_|=be;if(U=U.next,U===null){if(U=m.shared.pending,U===null)break;be=U,U=be.next,be.next=null,m.lastBaseUpdate=be,m.shared.pending=null}}while(!0);if(Te===null&&(Q=De),m.baseState=Q,m.firstBaseUpdate=ue,m.lastBaseUpdate=Te,a=m.shared.interleaved,a!==null){m=a;do _|=m.lane,m=m.next;while(m!==a)}else g===null&&(m.shared.lanes=0);Wa|=_,n.lanes=_,n.memoizedState=De}}function Zf(n,a,o){if(n=a.effects,a.effects=null,n!==null)for(a=0;a<n.length;a++){var d=n[a],m=d.callback;if(m!==null){if(d.callback=null,d=o,typeof m!="function")throw Error(t(191,m));m.call(d)}}}var di={},Rn=ha(di),hi=ha(di),xi=ha(di);function Ha(n){if(n===di)throw Error(t(174));return n}function D0(n,a){switch(Ot(xi,a),Ot(hi,n),Ot(Rn,di),n=a.nodeType,n){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Lr(null,"");break;default:n=n===8?a.parentNode:a,a=n.namespaceURI||null,n=n.tagName,a=Lr(a,n)}Lt(Rn),Ot(Rn,a)}function _s(){Lt(Rn),Lt(hi),Lt(xi)}function ed(n){Ha(xi.current);var a=Ha(Rn.current),o=Lr(a,n.type);a!==o&&(Ot(hi,n),Ot(Rn,o))}function O0(n){hi.current===n&&(Lt(Rn),Lt(hi))}var Ht=ha(0);function Ol(n){for(var a=n;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var j0=[];function I0(){for(var n=0;n<j0.length;n++)j0[n]._workInProgressVersionPrimary=null;j0.length=0}var jl=L.ReactCurrentDispatcher,R0=L.ReactCurrentBatchConfig,za=0,zt=null,sr=null,fr=null,Il=!1,pi=!1,mi=0,cg=0;function _r(){throw Error(t(321))}function P0(n,a){if(a===null)return!1;for(var o=0;o<a.length&&o<n.length;o++)if(!En(n[o],a[o]))return!1;return!0}function L0(n,a,o,d,m,g){if(za=g,zt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,jl.current=n===null||n.memoizedState===null?hg:xg,n=o(d,m),pi){g=0;do{if(pi=!1,mi=0,25<=g)throw Error(t(301));g+=1,fr=sr=null,a.updateQueue=null,jl.current=pg,n=o(d,m)}while(pi)}if(jl.current=Ll,a=sr!==null&&sr.next!==null,za=0,fr=sr=zt=null,Il=!1,a)throw Error(t(300));return n}function M0(){var n=mi!==0;return mi=0,n}function Pn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?zt.memoizedState=fr=n:fr=fr.next=n,fr}function dn(){if(sr===null){var n=zt.alternate;n=n!==null?n.memoizedState:null}else n=sr.next;var a=fr===null?zt.memoizedState:fr.next;if(a!==null)fr=a,sr=n;else{if(n===null)throw Error(t(310));sr=n,n={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},fr===null?zt.memoizedState=fr=n:fr=fr.next=n}return fr}function gi(n,a){return typeof a=="function"?a(n):a}function B0(n){var a=dn(),o=a.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=n;var d=sr,m=d.baseQueue,g=o.pending;if(g!==null){if(m!==null){var _=m.next;m.next=g.next,g.next=_}d.baseQueue=m=g,o.pending=null}if(m!==null){g=m.next,d=d.baseState;var U=_=null,Q=null,ue=g;do{var Te=ue.lane;if((za&Te)===Te)Q!==null&&(Q=Q.next={lane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),d=ue.hasEagerState?ue.eagerState:n(d,ue.action);else{var De={lane:Te,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null};Q===null?(U=Q=De,_=d):Q=Q.next=De,zt.lanes|=Te,Wa|=Te}ue=ue.next}while(ue!==null&&ue!==g);Q===null?_=d:Q.next=U,En(d,a.memoizedState)||(Qr=!0),a.memoizedState=d,a.baseState=_,a.baseQueue=Q,o.lastRenderedState=d}if(n=o.interleaved,n!==null){m=n;do g=m.lane,zt.lanes|=g,Wa|=g,m=m.next;while(m!==n)}else m===null&&(o.lanes=0);return[a.memoizedState,o.dispatch]}function U0(n){var a=dn(),o=a.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=n;var d=o.dispatch,m=o.pending,g=a.memoizedState;if(m!==null){o.pending=null;var _=m=m.next;do g=n(g,_.action),_=_.next;while(_!==m);En(g,a.memoizedState)||(Qr=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),o.lastRenderedState=g}return[g,d]}function td(){}function rd(n,a){var o=zt,d=dn(),m=a(),g=!En(d.memoizedState,m);if(g&&(d.memoizedState=m,Qr=!0),d=d.queue,H0(sd.bind(null,o,d,n),[n]),d.getSnapshot!==a||g||fr!==null&&fr.memoizedState.tag&1){if(o.flags|=2048,vi(9,ad.bind(null,o,d,m,a),void 0,null),dr===null)throw Error(t(349));(za&30)!==0||nd(o,a,m)}return m}function nd(n,a,o){n.flags|=16384,n={getSnapshot:a,value:o},a=zt.updateQueue,a===null?(a={lastEffect:null,stores:null},zt.updateQueue=a,a.stores=[n]):(o=a.stores,o===null?a.stores=[n]:o.push(n))}function ad(n,a,o,d){a.value=o,a.getSnapshot=d,id(a)&&ld(n)}function sd(n,a,o){return o(function(){id(a)&&ld(n)})}function id(n){var a=n.getSnapshot;n=n.value;try{var o=a();return!En(n,o)}catch{return!0}}function ld(n){var a=Kn(n,1);a!==null&&Cn(a,n,1,-1)}function od(n){var a=Pn();return typeof n=="function"&&(n=n()),a.memoizedState=a.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gi,lastRenderedState:n},a.queue=n,n=n.dispatch=dg.bind(null,zt,n),[a.memoizedState,n]}function vi(n,a,o,d){return n={tag:n,create:a,destroy:o,deps:d,next:null},a=zt.updateQueue,a===null?(a={lastEffect:null,stores:null},zt.updateQueue=a,a.lastEffect=n.next=n):(o=a.lastEffect,o===null?a.lastEffect=n.next=n:(d=o.next,o.next=n,n.next=d,a.lastEffect=n)),n}function cd(){return dn().memoizedState}function Rl(n,a,o,d){var m=Pn();zt.flags|=n,m.memoizedState=vi(1|a,o,void 0,d===void 0?null:d)}function Pl(n,a,o,d){var m=dn();d=d===void 0?null:d;var g=void 0;if(sr!==null){var _=sr.memoizedState;if(g=_.destroy,d!==null&&P0(d,_.deps)){m.memoizedState=vi(a,o,g,d);return}}zt.flags|=n,m.memoizedState=vi(1|a,o,g,d)}function ud(n,a){return Rl(8390656,8,n,a)}function H0(n,a){return Pl(2048,8,n,a)}function fd(n,a){return Pl(4,2,n,a)}function dd(n,a){return Pl(4,4,n,a)}function hd(n,a){if(typeof a=="function")return n=n(),a(n),function(){a(null)};if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function xd(n,a,o){return o=o!=null?o.concat([n]):null,Pl(4,4,hd.bind(null,a,n),o)}function z0(){}function pd(n,a){var o=dn();a=a===void 0?null:a;var d=o.memoizedState;return d!==null&&a!==null&&P0(a,d[1])?d[0]:(o.memoizedState=[n,a],n)}function md(n,a){var o=dn();a=a===void 0?null:a;var d=o.memoizedState;return d!==null&&a!==null&&P0(a,d[1])?d[0]:(n=n(),o.memoizedState=[n,a],n)}function gd(n,a,o){return(za&21)===0?(n.baseState&&(n.baseState=!1,Qr=!0),n.memoizedState=o):(En(o,a)||(o=Gu(),zt.lanes|=o,Wa|=o,n.baseState=!0),a)}function ug(n,a){var o=At;At=o!==0&&4>o?o:4,n(!0);var d=R0.transition;R0.transition={};try{n(!1),a()}finally{At=o,R0.transition=d}}function vd(){return dn().memoizedState}function fg(n,a,o){var d=ka(n);if(o={lane:d,action:o,hasEagerState:!1,eagerState:null,next:null},wd(n))yd(a,o);else if(o=Qf(n,a,o,d),o!==null){var m=Hr();Cn(o,n,d,m),kd(o,a,d)}}function dg(n,a,o){var d=ka(n),m={lane:d,action:o,hasEagerState:!1,eagerState:null,next:null};if(wd(n))yd(a,m);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var _=a.lastRenderedState,U=g(_,o);if(m.hasEagerState=!0,m.eagerState=U,En(U,_)){var Q=a.interleaved;Q===null?(m.next=m,A0(a)):(m.next=Q.next,Q.next=m),a.interleaved=m;return}}catch{}finally{}o=Qf(n,a,m,d),o!==null&&(m=Hr(),Cn(o,n,d,m),kd(o,a,d))}}function wd(n){var a=n.alternate;return n===zt||a!==null&&a===zt}function yd(n,a){pi=Il=!0;var o=n.pending;o===null?a.next=a:(a.next=o.next,o.next=a),n.pending=a}function kd(n,a,o){if((o&4194240)!==0){var d=a.lanes;d&=n.pendingLanes,o|=d,a.lanes=o,Vo(n,o)}}var Ll={readContext:fn,useCallback:_r,useContext:_r,useEffect:_r,useImperativeHandle:_r,useInsertionEffect:_r,useLayoutEffect:_r,useMemo:_r,useReducer:_r,useRef:_r,useState:_r,useDebugValue:_r,useDeferredValue:_r,useTransition:_r,useMutableSource:_r,useSyncExternalStore:_r,useId:_r,unstable_isNewReconciler:!1},hg={readContext:fn,useCallback:function(n,a){return Pn().memoizedState=[n,a===void 0?null:a],n},useContext:fn,useEffect:ud,useImperativeHandle:function(n,a,o){return o=o!=null?o.concat([n]):null,Rl(4194308,4,hd.bind(null,a,n),o)},useLayoutEffect:function(n,a){return Rl(4194308,4,n,a)},useInsertionEffect:function(n,a){return Rl(4,2,n,a)},useMemo:function(n,a){var o=Pn();return a=a===void 0?null:a,n=n(),o.memoizedState=[n,a],n},useReducer:function(n,a,o){var d=Pn();return a=o!==void 0?o(a):a,d.memoizedState=d.baseState=a,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:a},d.queue=n,n=n.dispatch=fg.bind(null,zt,n),[d.memoizedState,n]},useRef:function(n){var a=Pn();return n={current:n},a.memoizedState=n},useState:od,useDebugValue:z0,useDeferredValue:function(n){return Pn().memoizedState=n},useTransition:function(){var n=od(!1),a=n[0];return n=ug.bind(null,n[1]),Pn().memoizedState=n,[a,n]},useMutableSource:function(){},useSyncExternalStore:function(n,a,o){var d=zt,m=Pn();if(Mt){if(o===void 0)throw Error(t(407));o=o()}else{if(o=a(),dr===null)throw Error(t(349));(za&30)!==0||nd(d,a,o)}m.memoizedState=o;var g={value:o,getSnapshot:a};return m.queue=g,ud(sd.bind(null,d,g,n),[n]),d.flags|=2048,vi(9,ad.bind(null,d,g,o,a),void 0,null),o},useId:function(){var n=Pn(),a=dr.identifierPrefix;if(Mt){var o=Xn,d=Gn;o=(d&~(1<<32-Yt(d)-1)).toString(32)+o,a=":"+a+"R"+o,o=mi++,0<o&&(a+="H"+o.toString(32)),a+=":"}else o=cg++,a=":"+a+"r"+o.toString(32)+":";return n.memoizedState=a},unstable_isNewReconciler:!1},xg={readContext:fn,useCallback:pd,useContext:fn,useEffect:H0,useImperativeHandle:xd,useInsertionEffect:fd,useLayoutEffect:dd,useMemo:md,useReducer:B0,useRef:cd,useState:function(){return B0(gi)},useDebugValue:z0,useDeferredValue:function(n){var a=dn();return gd(a,sr.memoizedState,n)},useTransition:function(){var n=B0(gi)[0],a=dn().memoizedState;return[n,a]},useMutableSource:td,useSyncExternalStore:rd,useId:vd,unstable_isNewReconciler:!1},pg={readContext:fn,useCallback:pd,useContext:fn,useEffect:H0,useImperativeHandle:xd,useInsertionEffect:fd,useLayoutEffect:dd,useMemo:md,useReducer:U0,useRef:cd,useState:function(){return U0(gi)},useDebugValue:z0,useDeferredValue:function(n){var a=dn();return sr===null?a.memoizedState=n:gd(a,sr.memoizedState,n)},useTransition:function(){var n=U0(gi)[0],a=dn().memoizedState;return[n,a]},useMutableSource:td,useSyncExternalStore:rd,useId:vd,unstable_isNewReconciler:!1};function bn(n,a){if(n&&n.defaultProps){a=xe({},a),n=n.defaultProps;for(var o in n)a[o]===void 0&&(a[o]=n[o]);return a}return a}function W0(n,a,o,d){a=n.memoizedState,o=o(d,a),o=o==null?a:xe({},a,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Ml={isMounted:function(n){return(n=n._reactInternals)?j(n)===n:!1},enqueueSetState:function(n,a,o){n=n._reactInternals;var d=Hr(),m=ka(n),g=Yn(d,m);g.payload=a,o!=null&&(g.callback=o),a=ga(n,g,m),a!==null&&(Cn(a,n,m,d),Fl(a,n,m))},enqueueReplaceState:function(n,a,o){n=n._reactInternals;var d=Hr(),m=ka(n),g=Yn(d,m);g.tag=1,g.payload=a,o!=null&&(g.callback=o),a=ga(n,g,m),a!==null&&(Cn(a,n,m,d),Fl(a,n,m))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var o=Hr(),d=ka(n),m=Yn(o,d);m.tag=2,a!=null&&(m.callback=a),a=ga(n,m,d),a!==null&&(Cn(a,n,d,o),Fl(a,n,d))}};function Ed(n,a,o,d,m,g,_){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,g,_):a.prototype&&a.prototype.isPureReactComponent?!ai(o,d)||!ai(m,g):!0}function Sd(n,a,o){var d=!1,m=xa,g=a.contextType;return typeof g=="object"&&g!==null?g=fn(g):(m=Yr(a)?La:br.current,d=a.contextTypes,g=(d=d!=null)?vs(n,m):xa),a=new a(o,g),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Ml,n.stateNode=a,a._reactInternals=n,d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=m,n.__reactInternalMemoizedMaskedChildContext=g),a}function bd(n,a,o,d){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,d),a.state!==n&&Ml.enqueueReplaceState(a,a.state,null)}function V0(n,a,o,d){var m=n.stateNode;m.props=o,m.state=n.memoizedState,m.refs={},F0(n);var g=a.contextType;typeof g=="object"&&g!==null?m.context=fn(g):(g=Yr(a)?La:br.current,m.context=vs(n,g)),m.state=n.memoizedState,g=a.getDerivedStateFromProps,typeof g=="function"&&(W0(n,a,g,o),m.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(a=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),a!==m.state&&Ml.enqueueReplaceState(m,m.state,null),Dl(n,o,m,d),m.state=n.memoizedState),typeof m.componentDidMount=="function"&&(n.flags|=4194308)}function Ts(n,a){try{var o="",d=a;do o+=I(d),d=d.return;while(d);var m=o}catch(g){m=`
Error generating stack: `+g.message+`
`+g.stack}return{value:n,source:a,stack:m,digest:null}}function $0(n,a,o){return{value:n,source:null,stack:o??null,digest:a??null}}function G0(n,a){try{console.error(a.value)}catch(o){setTimeout(function(){throw o})}}var mg=typeof WeakMap=="function"?WeakMap:Map;function _d(n,a,o){o=Yn(-1,o),o.tag=3,o.payload={element:null};var d=a.value;return o.callback=function(){$l||($l=!0,lc=d),G0(n,a)},o}function Td(n,a,o){o=Yn(-1,o),o.tag=3;var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var m=a.value;o.payload=function(){return d(m)},o.callback=function(){G0(n,a)}}var g=n.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(o.callback=function(){G0(n,a),typeof d!="function"&&(wa===null?wa=new Set([this]):wa.add(this));var _=a.stack;this.componentDidCatch(a.value,{componentStack:_!==null?_:""})}),o}function Cd(n,a,o){var d=n.pingCache;if(d===null){d=n.pingCache=new mg;var m=new Set;d.set(a,m)}else m=d.get(a),m===void 0&&(m=new Set,d.set(a,m));m.has(o)||(m.add(o),n=Fg.bind(null,n,a,o),a.then(n,n))}function Nd(n){do{var a;if((a=n.tag===13)&&(a=n.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return n;n=n.return}while(n!==null);return null}function Ad(n,a,o,d,m){return(n.mode&1)===0?(n===a?n.flags|=65536:(n.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(a=Yn(-1,1),a.tag=2,ga(o,a,1))),o.lanes|=1),n):(n.flags|=65536,n.lanes=m,n)}var gg=L.ReactCurrentOwner,Qr=!1;function Ur(n,a,o,d){a.child=n===null?Yf(a,null,o,d):Es(a,n.child,o,d)}function Fd(n,a,o,d,m){o=o.render;var g=a.ref;return bs(a,m),d=L0(n,a,o,d,g,m),o=M0(),n!==null&&!Qr?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~m,Qn(n,a,m)):(Mt&&o&&y0(a),a.flags|=1,Ur(n,a,d,m),a.child)}function Dd(n,a,o,d,m){if(n===null){var g=o.type;return typeof g=="function"&&!xc(g)&&g.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(a.tag=15,a.type=g,Od(n,a,g,d,m)):(n=Jl(o.type,null,d,a,a.mode,m),n.ref=a.ref,n.return=a,a.child=n)}if(g=n.child,(n.lanes&m)===0){var _=g.memoizedProps;if(o=o.compare,o=o!==null?o:ai,o(_,d)&&n.ref===a.ref)return Qn(n,a,m)}return a.flags|=1,n=Sa(g,d),n.ref=a.ref,n.return=a,a.child=n}function Od(n,a,o,d,m){if(n!==null){var g=n.memoizedProps;if(ai(g,d)&&n.ref===a.ref)if(Qr=!1,a.pendingProps=d=g,(n.lanes&m)!==0)(n.flags&131072)!==0&&(Qr=!0);else return a.lanes=n.lanes,Qn(n,a,m)}return X0(n,a,o,d,m)}function jd(n,a,o){var d=a.pendingProps,m=d.children,g=n!==null?n.memoizedState:null;if(d.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ot(Ns,an),an|=o;else{if((o&1073741824)===0)return n=g!==null?g.baseLanes|o:o,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:n,cachePool:null,transitions:null},a.updateQueue=null,Ot(Ns,an),an|=n,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=g!==null?g.baseLanes:o,Ot(Ns,an),an|=d}else g!==null?(d=g.baseLanes|o,a.memoizedState=null):d=o,Ot(Ns,an),an|=d;return Ur(n,a,m,o),a.child}function Id(n,a){var o=a.ref;(n===null&&o!==null||n!==null&&n.ref!==o)&&(a.flags|=512,a.flags|=2097152)}function X0(n,a,o,d,m){var g=Yr(o)?La:br.current;return g=vs(a,g),bs(a,m),o=L0(n,a,o,d,g,m),d=M0(),n!==null&&!Qr?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~m,Qn(n,a,m)):(Mt&&d&&y0(a),a.flags|=1,Ur(n,a,o,m),a.child)}function Rd(n,a,o,d,m){if(Yr(o)){var g=!0;El(a)}else g=!1;if(bs(a,m),a.stateNode===null)Ul(n,a),Sd(a,o,d),V0(a,o,d,m),d=!0;else if(n===null){var _=a.stateNode,U=a.memoizedProps;_.props=U;var Q=_.context,ue=o.contextType;typeof ue=="object"&&ue!==null?ue=fn(ue):(ue=Yr(o)?La:br.current,ue=vs(a,ue));var Te=o.getDerivedStateFromProps,De=typeof Te=="function"||typeof _.getSnapshotBeforeUpdate=="function";De||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(U!==d||Q!==ue)&&bd(a,_,d,ue),ma=!1;var be=a.memoizedState;_.state=be,Dl(a,d,_,m),Q=a.memoizedState,U!==d||be!==Q||Kr.current||ma?(typeof Te=="function"&&(W0(a,o,Te,d),Q=a.memoizedState),(U=ma||Ed(a,o,U,d,be,Q,ue))?(De||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(a.flags|=4194308)):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=Q),_.props=d,_.state=Q,_.context=ue,d=U):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{_=a.stateNode,Jf(n,a),U=a.memoizedProps,ue=a.type===a.elementType?U:bn(a.type,U),_.props=ue,De=a.pendingProps,be=_.context,Q=o.contextType,typeof Q=="object"&&Q!==null?Q=fn(Q):(Q=Yr(o)?La:br.current,Q=vs(a,Q));var He=o.getDerivedStateFromProps;(Te=typeof He=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(U!==De||be!==Q)&&bd(a,_,d,Q),ma=!1,be=a.memoizedState,_.state=be,Dl(a,d,_,m);var We=a.memoizedState;U!==De||be!==We||Kr.current||ma?(typeof He=="function"&&(W0(a,o,He,d),We=a.memoizedState),(ue=ma||Ed(a,o,ue,d,be,We,Q)||!1)?(Te||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(d,We,Q),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(d,We,Q)),typeof _.componentDidUpdate=="function"&&(a.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof _.componentDidUpdate!="function"||U===n.memoizedProps&&be===n.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||U===n.memoizedProps&&be===n.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=We),_.props=d,_.state=We,_.context=Q,d=ue):(typeof _.componentDidUpdate!="function"||U===n.memoizedProps&&be===n.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||U===n.memoizedProps&&be===n.memoizedState||(a.flags|=1024),d=!1)}return K0(n,a,o,d,g,m)}function K0(n,a,o,d,m,g){Id(n,a);var _=(a.flags&128)!==0;if(!d&&!_)return m&&Uf(a,o,!1),Qn(n,a,g);d=a.stateNode,gg.current=a;var U=_&&typeof o.getDerivedStateFromError!="function"?null:d.render();return a.flags|=1,n!==null&&_?(a.child=Es(a,n.child,null,g),a.child=Es(a,null,U,g)):Ur(n,a,U,g),a.memoizedState=d.state,m&&Uf(a,o,!0),a.child}function Pd(n){var a=n.stateNode;a.pendingContext?Mf(n,a.pendingContext,a.pendingContext!==a.context):a.context&&Mf(n,a.context,!1),D0(n,a.containerInfo)}function Ld(n,a,o,d,m){return ks(),b0(m),a.flags|=256,Ur(n,a,o,d),a.child}var Y0={dehydrated:null,treeContext:null,retryLane:0};function Q0(n){return{baseLanes:n,cachePool:null,transitions:null}}function Md(n,a,o){var d=a.pendingProps,m=Ht.current,g=!1,_=(a.flags&128)!==0,U;if((U=_)||(U=n!==null&&n.memoizedState===null?!1:(m&2)!==0),U?(g=!0,a.flags&=-129):(n===null||n.memoizedState!==null)&&(m|=1),Ot(Ht,m&1),n===null)return S0(a),n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((a.mode&1)===0?a.lanes=1:n.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(_=d.children,n=d.fallback,g?(d=a.mode,g=a.child,_={mode:"hidden",children:_},(d&1)===0&&g!==null?(g.childLanes=0,g.pendingProps=_):g=ql(_,d,0,null),n=Xa(n,d,o,null),g.return=a,n.return=a,g.sibling=n,a.child=g,a.child.memoizedState=Q0(o),a.memoizedState=Y0,n):J0(a,_));if(m=n.memoizedState,m!==null&&(U=m.dehydrated,U!==null))return vg(n,a,_,d,U,m,o);if(g){g=d.fallback,_=a.mode,m=n.child,U=m.sibling;var Q={mode:"hidden",children:d.children};return(_&1)===0&&a.child!==m?(d=a.child,d.childLanes=0,d.pendingProps=Q,a.deletions=null):(d=Sa(m,Q),d.subtreeFlags=m.subtreeFlags&14680064),U!==null?g=Sa(U,g):(g=Xa(g,_,o,null),g.flags|=2),g.return=a,d.return=a,d.sibling=g,a.child=d,d=g,g=a.child,_=n.child.memoizedState,_=_===null?Q0(o):{baseLanes:_.baseLanes|o,cachePool:null,transitions:_.transitions},g.memoizedState=_,g.childLanes=n.childLanes&~o,a.memoizedState=Y0,d}return g=n.child,n=g.sibling,d=Sa(g,{mode:"visible",children:d.children}),(a.mode&1)===0&&(d.lanes=o),d.return=a,d.sibling=null,n!==null&&(o=a.deletions,o===null?(a.deletions=[n],a.flags|=16):o.push(n)),a.child=d,a.memoizedState=null,d}function J0(n,a){return a=ql({mode:"visible",children:a},n.mode,0,null),a.return=n,n.child=a}function Bl(n,a,o,d){return d!==null&&b0(d),Es(a,n.child,null,o),n=J0(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function vg(n,a,o,d,m,g,_){if(o)return a.flags&256?(a.flags&=-257,d=$0(Error(t(422))),Bl(n,a,_,d)):a.memoizedState!==null?(a.child=n.child,a.flags|=128,null):(g=d.fallback,m=a.mode,d=ql({mode:"visible",children:d.children},m,0,null),g=Xa(g,m,_,null),g.flags|=2,d.return=a,g.return=a,d.sibling=g,a.child=d,(a.mode&1)!==0&&Es(a,n.child,null,_),a.child.memoizedState=Q0(_),a.memoizedState=Y0,g);if((a.mode&1)===0)return Bl(n,a,_,null);if(m.data==="$!"){if(d=m.nextSibling&&m.nextSibling.dataset,d)var U=d.dgst;return d=U,g=Error(t(419)),d=$0(g,d,void 0),Bl(n,a,_,d)}if(U=(_&n.childLanes)!==0,Qr||U){if(d=dr,d!==null){switch(_&-_){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(d.suspendedLanes|_))!==0?0:m,m!==0&&m!==g.retryLane&&(g.retryLane=m,Kn(n,m),Cn(d,n,m,-1))}return hc(),d=$0(Error(t(421))),Bl(n,a,_,d)}return m.data==="$?"?(a.flags|=128,a.child=n.child,a=Dg.bind(null,n),m._reactRetry=a,null):(n=g.treeContext,nn=da(m.nextSibling),rn=a,Mt=!0,Sn=null,n!==null&&(cn[un++]=Gn,cn[un++]=Xn,cn[un++]=Ma,Gn=n.id,Xn=n.overflow,Ma=a),a=J0(a,d.children),a.flags|=4096,a)}function Bd(n,a,o){n.lanes|=a;var d=n.alternate;d!==null&&(d.lanes|=a),N0(n.return,a,o)}function q0(n,a,o,d,m){var g=n.memoizedState;g===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:o,tailMode:m}:(g.isBackwards=a,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=o,g.tailMode=m)}function Ud(n,a,o){var d=a.pendingProps,m=d.revealOrder,g=d.tail;if(Ur(n,a,d.children,o),d=Ht.current,(d&2)!==0)d=d&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Bd(n,o,a);else if(n.tag===19)Bd(n,o,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}d&=1}if(Ot(Ht,d),(a.mode&1)===0)a.memoizedState=null;else switch(m){case"forwards":for(o=a.child,m=null;o!==null;)n=o.alternate,n!==null&&Ol(n)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),q0(a,!1,m,o,g);break;case"backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(n=m.alternate,n!==null&&Ol(n)===null){a.child=m;break}n=m.sibling,m.sibling=o,o=m,m=n}q0(a,!0,o,null,g);break;case"together":q0(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Ul(n,a){(a.mode&1)===0&&n!==null&&(n.alternate=null,a.alternate=null,a.flags|=2)}function Qn(n,a,o){if(n!==null&&(a.dependencies=n.dependencies),Wa|=a.lanes,(o&a.childLanes)===0)return null;if(n!==null&&a.child!==n.child)throw Error(t(153));if(a.child!==null){for(n=a.child,o=Sa(n,n.pendingProps),a.child=o,o.return=a;n.sibling!==null;)n=n.sibling,o=o.sibling=Sa(n,n.pendingProps),o.return=a;o.sibling=null}return a.child}function wg(n,a,o){switch(a.tag){case 3:Pd(a),ks();break;case 5:ed(a);break;case 1:Yr(a.type)&&El(a);break;case 4:D0(a,a.stateNode.containerInfo);break;case 10:var d=a.type._context,m=a.memoizedProps.value;Ot(Nl,d._currentValue),d._currentValue=m;break;case 13:if(d=a.memoizedState,d!==null)return d.dehydrated!==null?(Ot(Ht,Ht.current&1),a.flags|=128,null):(o&a.child.childLanes)!==0?Md(n,a,o):(Ot(Ht,Ht.current&1),n=Qn(n,a,o),n!==null?n.sibling:null);Ot(Ht,Ht.current&1);break;case 19:if(d=(o&a.childLanes)!==0,(n.flags&128)!==0){if(d)return Ud(n,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Ot(Ht,Ht.current),d)break;return null;case 22:case 23:return a.lanes=0,jd(n,a,o)}return Qn(n,a,o)}var Hd,Z0,zd,Wd;Hd=function(n,a){for(var o=a.child;o!==null;){if(o.tag===5||o.tag===6)n.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break;for(;o.sibling===null;){if(o.return===null||o.return===a)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Z0=function(){},zd=function(n,a,o,d){var m=n.memoizedProps;if(m!==d){n=a.stateNode,Ha(Rn.current);var g=null;switch(o){case"input":m=Ne(n,m),d=Ne(n,d),g=[];break;case"select":m=xe({},m,{value:void 0}),d=xe({},d,{value:void 0}),g=[];break;case"textarea":m=Rr(n,m),d=Rr(n,d),g=[];break;default:typeof m.onClick!="function"&&typeof d.onClick=="function"&&(n.onclick=wl)}Ie(o,d);var _;o=null;for(ue in m)if(!d.hasOwnProperty(ue)&&m.hasOwnProperty(ue)&&m[ue]!=null)if(ue==="style"){var U=m[ue];for(_ in U)U.hasOwnProperty(_)&&(o||(o={}),o[_]="")}else ue!=="dangerouslySetInnerHTML"&&ue!=="children"&&ue!=="suppressContentEditableWarning"&&ue!=="suppressHydrationWarning"&&ue!=="autoFocus"&&(s.hasOwnProperty(ue)?g||(g=[]):(g=g||[]).push(ue,null));for(ue in d){var Q=d[ue];if(U=m?.[ue],d.hasOwnProperty(ue)&&Q!==U&&(Q!=null||U!=null))if(ue==="style")if(U){for(_ in U)!U.hasOwnProperty(_)||Q&&Q.hasOwnProperty(_)||(o||(o={}),o[_]="");for(_ in Q)Q.hasOwnProperty(_)&&U[_]!==Q[_]&&(o||(o={}),o[_]=Q[_])}else o||(g||(g=[]),g.push(ue,o)),o=Q;else ue==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,U=U?U.__html:void 0,Q!=null&&U!==Q&&(g=g||[]).push(ue,Q)):ue==="children"?typeof Q!="string"&&typeof Q!="number"||(g=g||[]).push(ue,""+Q):ue!=="suppressContentEditableWarning"&&ue!=="suppressHydrationWarning"&&(s.hasOwnProperty(ue)?(Q!=null&&ue==="onScroll"&&Pt("scroll",n),g||U===Q||(g=[])):(g=g||[]).push(ue,Q))}o&&(g=g||[]).push("style",o);var ue=g;(a.updateQueue=ue)&&(a.flags|=4)}},Wd=function(n,a,o,d){o!==d&&(a.flags|=4)};function wi(n,a){if(!Mt)switch(n.tailMode){case"hidden":a=n.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function Tr(n){var a=n.alternate!==null&&n.alternate.child===n.child,o=0,d=0;if(a)for(var m=n.child;m!==null;)o|=m.lanes|m.childLanes,d|=m.subtreeFlags&14680064,d|=m.flags&14680064,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)o|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=d,n.childLanes=o,a}function yg(n,a,o){var d=a.pendingProps;switch(k0(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tr(a),null;case 1:return Yr(a.type)&&kl(),Tr(a),null;case 3:return d=a.stateNode,_s(),Lt(Kr),Lt(br),I0(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(Tl(a)?a.flags|=4:n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Sn!==null&&(uc(Sn),Sn=null))),Z0(n,a),Tr(a),null;case 5:O0(a);var m=Ha(xi.current);if(o=a.type,n!==null&&a.stateNode!=null)zd(n,a,o,d,m),n.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!d){if(a.stateNode===null)throw Error(t(166));return Tr(a),null}if(n=Ha(Rn.current),Tl(a)){d=a.stateNode,o=a.type;var g=a.memoizedProps;switch(d[In]=a,d[ci]=g,n=(a.mode&1)!==0,o){case"dialog":Pt("cancel",d),Pt("close",d);break;case"iframe":case"object":case"embed":Pt("load",d);break;case"video":case"audio":for(m=0;m<ii.length;m++)Pt(ii[m],d);break;case"source":Pt("error",d);break;case"img":case"image":case"link":Pt("error",d),Pt("load",d);break;case"details":Pt("toggle",d);break;case"input":Qe(d,g),Pt("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!g.multiple},Pt("invalid",d);break;case"textarea":gr(d,g),Pt("invalid",d)}Ie(o,g),m=null;for(var _ in g)if(g.hasOwnProperty(_)){var U=g[_];_==="children"?typeof U=="string"?d.textContent!==U&&(g.suppressHydrationWarning!==!0&&vl(d.textContent,U,n),m=["children",U]):typeof U=="number"&&d.textContent!==""+U&&(g.suppressHydrationWarning!==!0&&vl(d.textContent,U,n),m=["children",""+U]):s.hasOwnProperty(_)&&U!=null&&_==="onScroll"&&Pt("scroll",d)}switch(o){case"input":pe(d),St(d,g,!0);break;case"textarea":pe(d),nr(d);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(d.onclick=wl)}d=m,a.updateQueue=d,d!==null&&(a.flags|=4)}else{_=m.nodeType===9?m:m.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Pr(o)),n==="http://www.w3.org/1999/xhtml"?o==="script"?(n=_.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof d.is=="string"?n=_.createElement(o,{is:d.is}):(n=_.createElement(o),o==="select"&&(_=n,d.multiple?_.multiple=!0:d.size&&(_.size=d.size))):n=_.createElementNS(n,o),n[In]=a,n[ci]=d,Hd(n,a,!1,!1),a.stateNode=n;e:{switch(_=Le(o,d),o){case"dialog":Pt("cancel",n),Pt("close",n),m=d;break;case"iframe":case"object":case"embed":Pt("load",n),m=d;break;case"video":case"audio":for(m=0;m<ii.length;m++)Pt(ii[m],n);m=d;break;case"source":Pt("error",n),m=d;break;case"img":case"image":case"link":Pt("error",n),Pt("load",n),m=d;break;case"details":Pt("toggle",n),m=d;break;case"input":Qe(n,d),m=Ne(n,d),Pt("invalid",n);break;case"option":m=d;break;case"select":n._wrapperState={wasMultiple:!!d.multiple},m=xe({},d,{value:void 0}),Pt("invalid",n);break;case"textarea":gr(n,d),m=Rr(n,d),Pt("invalid",n);break;default:m=d}Ie(o,m),U=m;for(g in U)if(U.hasOwnProperty(g)){var Q=U[g];g==="style"?ge(n,Q):g==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&ur(n,Q)):g==="children"?typeof Q=="string"?(o!=="textarea"||Q!=="")&&Ze(n,Q):typeof Q=="number"&&Ze(n,""+Q):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(s.hasOwnProperty(g)?Q!=null&&g==="onScroll"&&Pt("scroll",n):Q!=null&&C(n,g,Q,_))}switch(o){case"input":pe(n),St(n,d,!1);break;case"textarea":pe(n),nr(n);break;case"option":d.value!=null&&n.setAttribute("value",""+ye(d.value));break;case"select":n.multiple=!!d.multiple,g=d.value,g!=null?Xt(n,!!d.multiple,g,!1):d.defaultValue!=null&&Xt(n,!!d.multiple,d.defaultValue,!0);break;default:typeof m.onClick=="function"&&(n.onclick=wl)}switch(o){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Tr(a),null;case 6:if(n&&a.stateNode!=null)Wd(n,a,n.memoizedProps,d);else{if(typeof d!="string"&&a.stateNode===null)throw Error(t(166));if(o=Ha(xi.current),Ha(Rn.current),Tl(a)){if(d=a.stateNode,o=a.memoizedProps,d[In]=a,(g=d.nodeValue!==o)&&(n=rn,n!==null))switch(n.tag){case 3:vl(d.nodeValue,o,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&vl(d.nodeValue,o,(n.mode&1)!==0)}g&&(a.flags|=4)}else d=(o.nodeType===9?o:o.ownerDocument).createTextNode(d),d[In]=a,a.stateNode=d}return Tr(a),null;case 13:if(Lt(Ht),d=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Mt&&nn!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Gf(),ks(),a.flags|=98560,g=!1;else if(g=Tl(a),d!==null&&d.dehydrated!==null){if(n===null){if(!g)throw Error(t(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(t(317));g[In]=a}else ks(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Tr(a),g=!1}else Sn!==null&&(uc(Sn),Sn=null),g=!0;if(!g)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=o,a):(d=d!==null,d!==(n!==null&&n.memoizedState!==null)&&d&&(a.child.flags|=8192,(a.mode&1)!==0&&(n===null||(Ht.current&1)!==0?ir===0&&(ir=3):hc())),a.updateQueue!==null&&(a.flags|=4),Tr(a),null);case 4:return _s(),Z0(n,a),n===null&&li(a.stateNode.containerInfo),Tr(a),null;case 10:return C0(a.type._context),Tr(a),null;case 17:return Yr(a.type)&&kl(),Tr(a),null;case 19:if(Lt(Ht),g=a.memoizedState,g===null)return Tr(a),null;if(d=(a.flags&128)!==0,_=g.rendering,_===null)if(d)wi(g,!1);else{if(ir!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(_=Ol(n),_!==null){for(a.flags|=128,wi(g,!1),d=_.updateQueue,d!==null&&(a.updateQueue=d,a.flags|=4),a.subtreeFlags=0,d=o,o=a.child;o!==null;)g=o,n=d,g.flags&=14680066,_=g.alternate,_===null?(g.childLanes=0,g.lanes=n,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=_.childLanes,g.lanes=_.lanes,g.child=_.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=_.memoizedProps,g.memoizedState=_.memoizedState,g.updateQueue=_.updateQueue,g.type=_.type,n=_.dependencies,g.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),o=o.sibling;return Ot(Ht,Ht.current&1|2),a.child}n=n.sibling}g.tail!==null&&Ce()>As&&(a.flags|=128,d=!0,wi(g,!1),a.lanes=4194304)}else{if(!d)if(n=Ol(_),n!==null){if(a.flags|=128,d=!0,o=n.updateQueue,o!==null&&(a.updateQueue=o,a.flags|=4),wi(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!Mt)return Tr(a),null}else 2*Ce()-g.renderingStartTime>As&&o!==1073741824&&(a.flags|=128,d=!0,wi(g,!1),a.lanes=4194304);g.isBackwards?(_.sibling=a.child,a.child=_):(o=g.last,o!==null?o.sibling=_:a.child=_,g.last=_)}return g.tail!==null?(a=g.tail,g.rendering=a,g.tail=a.sibling,g.renderingStartTime=Ce(),a.sibling=null,o=Ht.current,Ot(Ht,d?o&1|2:o&1),a):(Tr(a),null);case 22:case 23:return dc(),d=a.memoizedState!==null,n!==null&&n.memoizedState!==null!==d&&(a.flags|=8192),d&&(a.mode&1)!==0?(an&1073741824)!==0&&(Tr(a),a.subtreeFlags&6&&(a.flags|=8192)):Tr(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function kg(n,a){switch(k0(a),a.tag){case 1:return Yr(a.type)&&kl(),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return _s(),Lt(Kr),Lt(br),I0(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 5:return O0(a),null;case 13:if(Lt(Ht),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(t(340));ks()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return Lt(Ht),null;case 4:return _s(),null;case 10:return C0(a.type._context),null;case 22:case 23:return dc(),null;case 24:return null;default:return null}}var Hl=!1,Cr=!1,Eg=typeof WeakSet=="function"?WeakSet:Set,ze=null;function Cs(n,a){var o=n.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(d){Vt(n,a,d)}else o.current=null}function ec(n,a,o){try{o()}catch(d){Vt(n,a,d)}}var Vd=!1;function Sg(n,a){if(d0=ll,n=Ef(),a0(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var d=o.getSelection&&o.getSelection();if(d&&d.rangeCount!==0){o=d.anchorNode;var m=d.anchorOffset,g=d.focusNode;d=d.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var _=0,U=-1,Q=-1,ue=0,Te=0,De=n,be=null;t:for(;;){for(var He;De!==o||m!==0&&De.nodeType!==3||(U=_+m),De!==g||d!==0&&De.nodeType!==3||(Q=_+d),De.nodeType===3&&(_+=De.nodeValue.length),(He=De.firstChild)!==null;)be=De,De=He;for(;;){if(De===n)break t;if(be===o&&++ue===m&&(U=_),be===g&&++Te===d&&(Q=_),(He=De.nextSibling)!==null)break;De=be,be=De.parentNode}De=He}o=U===-1||Q===-1?null:{start:U,end:Q}}else o=null}o=o||{start:0,end:0}}else o=null;for(h0={focusedElem:n,selectionRange:o},ll=!1,ze=a;ze!==null;)if(a=ze,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,ze=n;else for(;ze!==null;){a=ze;try{var We=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(We!==null){var Ve=We.memoizedProps,Qt=We.memoizedState,se=a.stateNode,Z=se.getSnapshotBeforeUpdate(a.elementType===a.type?Ve:bn(a.type,Ve),Qt);se.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var ie=a.stateNode.containerInfo;ie.nodeType===1?ie.textContent="":ie.nodeType===9&&ie.documentElement&&ie.removeChild(ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Re){Vt(a,a.return,Re)}if(n=a.sibling,n!==null){n.return=a.return,ze=n;break}ze=a.return}return We=Vd,Vd=!1,We}function yi(n,a,o){var d=a.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&n)===n){var g=m.destroy;m.destroy=void 0,g!==void 0&&ec(a,o,g)}m=m.next}while(m!==d)}}function zl(n,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var o=a=a.next;do{if((o.tag&n)===n){var d=o.create;o.destroy=d()}o=o.next}while(o!==a)}}function tc(n){var a=n.ref;if(a!==null){var o=n.stateNode;switch(n.tag){case 5:n=o;break;default:n=o}typeof a=="function"?a(n):a.current=n}}function $d(n){var a=n.alternate;a!==null&&(n.alternate=null,$d(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&(delete a[In],delete a[ci],delete a[g0],delete a[sg],delete a[ig])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Gd(n){return n.tag===5||n.tag===3||n.tag===4}function Xd(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Gd(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function rc(n,a,o){var d=n.tag;if(d===5||d===6)n=n.stateNode,a?o.nodeType===8?o.parentNode.insertBefore(n,a):o.insertBefore(n,a):(o.nodeType===8?(a=o.parentNode,a.insertBefore(n,o)):(a=o,a.appendChild(n)),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=wl));else if(d!==4&&(n=n.child,n!==null))for(rc(n,a,o),n=n.sibling;n!==null;)rc(n,a,o),n=n.sibling}function nc(n,a,o){var d=n.tag;if(d===5||d===6)n=n.stateNode,a?o.insertBefore(n,a):o.appendChild(n);else if(d!==4&&(n=n.child,n!==null))for(nc(n,a,o),n=n.sibling;n!==null;)nc(n,a,o),n=n.sibling}var wr=null,_n=!1;function va(n,a,o){for(o=o.child;o!==null;)Kd(n,a,o),o=o.sibling}function Kd(n,a,o){if(Wt&&typeof Wt.onCommitFiberUnmount=="function")try{Wt.onCommitFiberUnmount(vr,o)}catch{}switch(o.tag){case 5:Cr||Cs(o,a);case 6:var d=wr,m=_n;wr=null,va(n,a,o),wr=d,_n=m,wr!==null&&(_n?(n=wr,o=o.stateNode,n.nodeType===8?n.parentNode.removeChild(o):n.removeChild(o)):wr.removeChild(o.stateNode));break;case 18:wr!==null&&(_n?(n=wr,o=o.stateNode,n.nodeType===8?m0(n.parentNode,o):n.nodeType===1&&m0(n,o),qs(n)):m0(wr,o.stateNode));break;case 4:d=wr,m=_n,wr=o.stateNode.containerInfo,_n=!0,va(n,a,o),wr=d,_n=m;break;case 0:case 11:case 14:case 15:if(!Cr&&(d=o.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){m=d=d.next;do{var g=m,_=g.destroy;g=g.tag,_!==void 0&&((g&2)!==0||(g&4)!==0)&&ec(o,a,_),m=m.next}while(m!==d)}va(n,a,o);break;case 1:if(!Cr&&(Cs(o,a),d=o.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=o.memoizedProps,d.state=o.memoizedState,d.componentWillUnmount()}catch(U){Vt(o,a,U)}va(n,a,o);break;case 21:va(n,a,o);break;case 22:o.mode&1?(Cr=(d=Cr)||o.memoizedState!==null,va(n,a,o),Cr=d):va(n,a,o);break;default:va(n,a,o)}}function Yd(n){var a=n.updateQueue;if(a!==null){n.updateQueue=null;var o=n.stateNode;o===null&&(o=n.stateNode=new Eg),a.forEach(function(d){var m=Og.bind(null,n,d);o.has(d)||(o.add(d),d.then(m,m))})}}function Tn(n,a){var o=a.deletions;if(o!==null)for(var d=0;d<o.length;d++){var m=o[d];try{var g=n,_=a,U=_;e:for(;U!==null;){switch(U.tag){case 5:wr=U.stateNode,_n=!1;break e;case 3:wr=U.stateNode.containerInfo,_n=!0;break e;case 4:wr=U.stateNode.containerInfo,_n=!0;break e}U=U.return}if(wr===null)throw Error(t(160));Kd(g,_,m),wr=null,_n=!1;var Q=m.alternate;Q!==null&&(Q.return=null),m.return=null}catch(ue){Vt(m,a,ue)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Qd(a,n),a=a.sibling}function Qd(n,a){var o=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Tn(a,n),Ln(n),d&4){try{yi(3,n,n.return),zl(3,n)}catch(Ve){Vt(n,n.return,Ve)}try{yi(5,n,n.return)}catch(Ve){Vt(n,n.return,Ve)}}break;case 1:Tn(a,n),Ln(n),d&512&&o!==null&&Cs(o,o.return);break;case 5:if(Tn(a,n),Ln(n),d&512&&o!==null&&Cs(o,o.return),n.flags&32){var m=n.stateNode;try{Ze(m,"")}catch(Ve){Vt(n,n.return,Ve)}}if(d&4&&(m=n.stateNode,m!=null)){var g=n.memoizedProps,_=o!==null?o.memoizedProps:g,U=n.type,Q=n.updateQueue;if(n.updateQueue=null,Q!==null)try{U==="input"&&g.type==="radio"&&g.name!=null&&Ge(m,g),Le(U,_);var ue=Le(U,g);for(_=0;_<Q.length;_+=2){var Te=Q[_],De=Q[_+1];Te==="style"?ge(m,De):Te==="dangerouslySetInnerHTML"?ur(m,De):Te==="children"?Ze(m,De):C(m,Te,De,ue)}switch(U){case"input":Pe(m,g);break;case"textarea":qt(m,g);break;case"select":var be=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!g.multiple;var He=g.value;He!=null?Xt(m,!!g.multiple,He,!1):be!==!!g.multiple&&(g.defaultValue!=null?Xt(m,!!g.multiple,g.defaultValue,!0):Xt(m,!!g.multiple,g.multiple?[]:"",!1))}m[ci]=g}catch(Ve){Vt(n,n.return,Ve)}}break;case 6:if(Tn(a,n),Ln(n),d&4){if(n.stateNode===null)throw Error(t(162));m=n.stateNode,g=n.memoizedProps;try{m.nodeValue=g}catch(Ve){Vt(n,n.return,Ve)}}break;case 3:if(Tn(a,n),Ln(n),d&4&&o!==null&&o.memoizedState.isDehydrated)try{qs(a.containerInfo)}catch(Ve){Vt(n,n.return,Ve)}break;case 4:Tn(a,n),Ln(n);break;case 13:Tn(a,n),Ln(n),m=n.child,m.flags&8192&&(g=m.memoizedState!==null,m.stateNode.isHidden=g,!g||m.alternate!==null&&m.alternate.memoizedState!==null||(ic=Ce())),d&4&&Yd(n);break;case 22:if(Te=o!==null&&o.memoizedState!==null,n.mode&1?(Cr=(ue=Cr)||Te,Tn(a,n),Cr=ue):Tn(a,n),Ln(n),d&8192){if(ue=n.memoizedState!==null,(n.stateNode.isHidden=ue)&&!Te&&(n.mode&1)!==0)for(ze=n,Te=n.child;Te!==null;){for(De=ze=Te;ze!==null;){switch(be=ze,He=be.child,be.tag){case 0:case 11:case 14:case 15:yi(4,be,be.return);break;case 1:Cs(be,be.return);var We=be.stateNode;if(typeof We.componentWillUnmount=="function"){d=be,o=be.return;try{a=d,We.props=a.memoizedProps,We.state=a.memoizedState,We.componentWillUnmount()}catch(Ve){Vt(d,o,Ve)}}break;case 5:Cs(be,be.return);break;case 22:if(be.memoizedState!==null){Zd(De);continue}}He!==null?(He.return=be,ze=He):Zd(De)}Te=Te.sibling}e:for(Te=null,De=n;;){if(De.tag===5){if(Te===null){Te=De;try{m=De.stateNode,ue?(g=m.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(U=De.stateNode,Q=De.memoizedProps.style,_=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,U.style.display=_t("display",_))}catch(Ve){Vt(n,n.return,Ve)}}}else if(De.tag===6){if(Te===null)try{De.stateNode.nodeValue=ue?"":De.memoizedProps}catch(Ve){Vt(n,n.return,Ve)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===n)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===n)break e;for(;De.sibling===null;){if(De.return===null||De.return===n)break e;Te===De&&(Te=null),De=De.return}Te===De&&(Te=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:Tn(a,n),Ln(n),d&4&&Yd(n);break;case 21:break;default:Tn(a,n),Ln(n)}}function Ln(n){var a=n.flags;if(a&2){try{e:{for(var o=n.return;o!==null;){if(Gd(o)){var d=o;break e}o=o.return}throw Error(t(160))}switch(d.tag){case 5:var m=d.stateNode;d.flags&32&&(Ze(m,""),d.flags&=-33);var g=Xd(n);nc(n,g,m);break;case 3:case 4:var _=d.stateNode.containerInfo,U=Xd(n);rc(n,U,_);break;default:throw Error(t(161))}}catch(Q){Vt(n,n.return,Q)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function bg(n,a,o){ze=n,Jd(n)}function Jd(n,a,o){for(var d=(n.mode&1)!==0;ze!==null;){var m=ze,g=m.child;if(m.tag===22&&d){var _=m.memoizedState!==null||Hl;if(!_){var U=m.alternate,Q=U!==null&&U.memoizedState!==null||Cr;U=Hl;var ue=Cr;if(Hl=_,(Cr=Q)&&!ue)for(ze=m;ze!==null;)_=ze,Q=_.child,_.tag===22&&_.memoizedState!==null?eh(m):Q!==null?(Q.return=_,ze=Q):eh(m);for(;g!==null;)ze=g,Jd(g),g=g.sibling;ze=m,Hl=U,Cr=ue}qd(n)}else(m.subtreeFlags&8772)!==0&&g!==null?(g.return=m,ze=g):qd(n)}}function qd(n){for(;ze!==null;){var a=ze;if((a.flags&8772)!==0){var o=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Cr||zl(5,a);break;case 1:var d=a.stateNode;if(a.flags&4&&!Cr)if(o===null)d.componentDidMount();else{var m=a.elementType===a.type?o.memoizedProps:bn(a.type,o.memoizedProps);d.componentDidUpdate(m,o.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var g=a.updateQueue;g!==null&&Zf(a,g,d);break;case 3:var _=a.updateQueue;if(_!==null){if(o=null,a.child!==null)switch(a.child.tag){case 5:o=a.child.stateNode;break;case 1:o=a.child.stateNode}Zf(a,_,o)}break;case 5:var U=a.stateNode;if(o===null&&a.flags&4){o=U;var Q=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&o.focus();break;case"img":Q.src&&(o.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var ue=a.alternate;if(ue!==null){var Te=ue.memoizedState;if(Te!==null){var De=Te.dehydrated;De!==null&&qs(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Cr||a.flags&512&&tc(a)}catch(be){Vt(a,a.return,be)}}if(a===n){ze=null;break}if(o=a.sibling,o!==null){o.return=a.return,ze=o;break}ze=a.return}}function Zd(n){for(;ze!==null;){var a=ze;if(a===n){ze=null;break}var o=a.sibling;if(o!==null){o.return=a.return,ze=o;break}ze=a.return}}function eh(n){for(;ze!==null;){var a=ze;try{switch(a.tag){case 0:case 11:case 15:var o=a.return;try{zl(4,a)}catch(Q){Vt(a,o,Q)}break;case 1:var d=a.stateNode;if(typeof d.componentDidMount=="function"){var m=a.return;try{d.componentDidMount()}catch(Q){Vt(a,m,Q)}}var g=a.return;try{tc(a)}catch(Q){Vt(a,g,Q)}break;case 5:var _=a.return;try{tc(a)}catch(Q){Vt(a,_,Q)}}}catch(Q){Vt(a,a.return,Q)}if(a===n){ze=null;break}var U=a.sibling;if(U!==null){U.return=a.return,ze=U;break}ze=a.return}}var _g=Math.ceil,Wl=L.ReactCurrentDispatcher,ac=L.ReactCurrentOwner,hn=L.ReactCurrentBatchConfig,vt=0,dr=null,Zt=null,yr=0,an=0,Ns=ha(0),ir=0,ki=null,Wa=0,Vl=0,sc=0,Ei=null,Jr=null,ic=0,As=1/0,Jn=null,$l=!1,lc=null,wa=null,Gl=!1,ya=null,Xl=0,Si=0,oc=null,Kl=-1,Yl=0;function Hr(){return(vt&6)!==0?Ce():Kl!==-1?Kl:Kl=Ce()}function ka(n){return(n.mode&1)===0?1:(vt&2)!==0&&yr!==0?yr&-yr:og.transition!==null?(Yl===0&&(Yl=Gu()),Yl):(n=At,n!==0||(n=window.event,n=n===void 0?16:tf(n.type)),n)}function Cn(n,a,o,d){if(50<Si)throw Si=0,oc=null,Error(t(185));Xs(n,o,d),((vt&2)===0||n!==dr)&&(n===dr&&((vt&2)===0&&(Vl|=o),ir===4&&Ea(n,yr)),qr(n,d),o===1&&vt===0&&(a.mode&1)===0&&(As=Ce()+500,Sl&&pa()))}function qr(n,a){var o=n.callbackNode;om(n,a);var d=al(n,n===dr?yr:0);if(d===0)o!==null&&Ae(o),n.callbackNode=null,n.callbackPriority=0;else if(a=d&-d,n.callbackPriority!==a){if(o!=null&&Ae(o),a===1)n.tag===0?lg(rh.bind(null,n)):Hf(rh.bind(null,n)),ng(function(){(vt&6)===0&&pa()}),o=null;else{switch(Xu(d)){case 1:o=Nt;break;case 4:o=lt;break;case 16:o=yt;break;case 536870912:o=Br;break;default:o=yt}o=uh(o,th.bind(null,n))}n.callbackPriority=a,n.callbackNode=o}}function th(n,a){if(Kl=-1,Yl=0,(vt&6)!==0)throw Error(t(327));var o=n.callbackNode;if(Fs()&&n.callbackNode!==o)return null;var d=al(n,n===dr?yr:0);if(d===0)return null;if((d&30)!==0||(d&n.expiredLanes)!==0||a)a=Ql(n,d);else{a=d;var m=vt;vt|=2;var g=ah();(dr!==n||yr!==a)&&(Jn=null,As=Ce()+500,$a(n,a));do try{Ng();break}catch(U){nh(n,U)}while(!0);T0(),Wl.current=g,vt=m,Zt!==null?a=0:(dr=null,yr=0,a=ir)}if(a!==0){if(a===2&&(m=zo(n),m!==0&&(d=m,a=cc(n,m))),a===1)throw o=ki,$a(n,0),Ea(n,d),qr(n,Ce()),o;if(a===6)Ea(n,d);else{if(m=n.current.alternate,(d&30)===0&&!Tg(m)&&(a=Ql(n,d),a===2&&(g=zo(n),g!==0&&(d=g,a=cc(n,g))),a===1))throw o=ki,$a(n,0),Ea(n,d),qr(n,Ce()),o;switch(n.finishedWork=m,n.finishedLanes=d,a){case 0:case 1:throw Error(t(345));case 2:Ga(n,Jr,Jn);break;case 3:if(Ea(n,d),(d&130023424)===d&&(a=ic+500-Ce(),10<a)){if(al(n,0)!==0)break;if(m=n.suspendedLanes,(m&d)!==d){Hr(),n.pingedLanes|=n.suspendedLanes&m;break}n.timeoutHandle=p0(Ga.bind(null,n,Jr,Jn),a);break}Ga(n,Jr,Jn);break;case 4:if(Ea(n,d),(d&4194240)===d)break;for(a=n.eventTimes,m=-1;0<d;){var _=31-Yt(d);g=1<<_,_=a[_],_>m&&(m=_),d&=~g}if(d=m,d=Ce()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*_g(d/1960))-d,10<d){n.timeoutHandle=p0(Ga.bind(null,n,Jr,Jn),d);break}Ga(n,Jr,Jn);break;case 5:Ga(n,Jr,Jn);break;default:throw Error(t(329))}}}return qr(n,Ce()),n.callbackNode===o?th.bind(null,n):null}function cc(n,a){var o=Ei;return n.current.memoizedState.isDehydrated&&($a(n,a).flags|=256),n=Ql(n,a),n!==2&&(a=Jr,Jr=o,a!==null&&uc(a)),n}function uc(n){Jr===null?Jr=n:Jr.push.apply(Jr,n)}function Tg(n){for(var a=n;;){if(a.flags&16384){var o=a.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var d=0;d<o.length;d++){var m=o[d],g=m.getSnapshot;m=m.value;try{if(!En(g(),m))return!1}catch{return!1}}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ea(n,a){for(a&=~sc,a&=~Vl,n.suspendedLanes|=a,n.pingedLanes&=~a,n=n.expirationTimes;0<a;){var o=31-Yt(a),d=1<<o;n[o]=-1,a&=~d}}function rh(n){if((vt&6)!==0)throw Error(t(327));Fs();var a=al(n,0);if((a&1)===0)return qr(n,Ce()),null;var o=Ql(n,a);if(n.tag!==0&&o===2){var d=zo(n);d!==0&&(a=d,o=cc(n,d))}if(o===1)throw o=ki,$a(n,0),Ea(n,a),qr(n,Ce()),o;if(o===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=a,Ga(n,Jr,Jn),qr(n,Ce()),null}function fc(n,a){var o=vt;vt|=1;try{return n(a)}finally{vt=o,vt===0&&(As=Ce()+500,Sl&&pa())}}function Va(n){ya!==null&&ya.tag===0&&(vt&6)===0&&Fs();var a=vt;vt|=1;var o=hn.transition,d=At;try{if(hn.transition=null,At=1,n)return n()}finally{At=d,hn.transition=o,vt=a,(vt&6)===0&&pa()}}function dc(){an=Ns.current,Lt(Ns)}function $a(n,a){n.finishedWork=null,n.finishedLanes=0;var o=n.timeoutHandle;if(o!==-1&&(n.timeoutHandle=-1,rg(o)),Zt!==null)for(o=Zt.return;o!==null;){var d=o;switch(k0(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&kl();break;case 3:_s(),Lt(Kr),Lt(br),I0();break;case 5:O0(d);break;case 4:_s();break;case 13:Lt(Ht);break;case 19:Lt(Ht);break;case 10:C0(d.type._context);break;case 22:case 23:dc()}o=o.return}if(dr=n,Zt=n=Sa(n.current,null),yr=an=a,ir=0,ki=null,sc=Vl=Wa=0,Jr=Ei=null,Ua!==null){for(a=0;a<Ua.length;a++)if(o=Ua[a],d=o.interleaved,d!==null){o.interleaved=null;var m=d.next,g=o.pending;if(g!==null){var _=g.next;g.next=m,d.next=_}o.pending=d}Ua=null}return n}function nh(n,a){do{var o=Zt;try{if(T0(),jl.current=Ll,Il){for(var d=zt.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}Il=!1}if(za=0,fr=sr=zt=null,pi=!1,mi=0,ac.current=null,o===null||o.return===null){ir=1,ki=a,Zt=null;break}e:{var g=n,_=o.return,U=o,Q=a;if(a=yr,U.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ue=Q,Te=U,De=Te.tag;if((Te.mode&1)===0&&(De===0||De===11||De===15)){var be=Te.alternate;be?(Te.updateQueue=be.updateQueue,Te.memoizedState=be.memoizedState,Te.lanes=be.lanes):(Te.updateQueue=null,Te.memoizedState=null)}var He=Nd(_);if(He!==null){He.flags&=-257,Ad(He,_,U,g,a),He.mode&1&&Cd(g,ue,a),a=He,Q=ue;var We=a.updateQueue;if(We===null){var Ve=new Set;Ve.add(Q),a.updateQueue=Ve}else We.add(Q);break e}else{if((a&1)===0){Cd(g,ue,a),hc();break e}Q=Error(t(426))}}else if(Mt&&U.mode&1){var Qt=Nd(_);if(Qt!==null){(Qt.flags&65536)===0&&(Qt.flags|=256),Ad(Qt,_,U,g,a),b0(Ts(Q,U));break e}}g=Q=Ts(Q,U),ir!==4&&(ir=2),Ei===null?Ei=[g]:Ei.push(g),g=_;do{switch(g.tag){case 3:g.flags|=65536,a&=-a,g.lanes|=a;var se=_d(g,Q,a);qf(g,se);break e;case 1:U=Q;var Z=g.type,ie=g.stateNode;if((g.flags&128)===0&&(typeof Z.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(wa===null||!wa.has(ie)))){g.flags|=65536,a&=-a,g.lanes|=a;var Re=Td(g,U,a);qf(g,Re);break e}}g=g.return}while(g!==null)}ih(o)}catch($e){a=$e,Zt===o&&o!==null&&(Zt=o=o.return);continue}break}while(!0)}function ah(){var n=Wl.current;return Wl.current=Ll,n===null?Ll:n}function hc(){(ir===0||ir===3||ir===2)&&(ir=4),dr===null||(Wa&268435455)===0&&(Vl&268435455)===0||Ea(dr,yr)}function Ql(n,a){var o=vt;vt|=2;var d=ah();(dr!==n||yr!==a)&&(Jn=null,$a(n,a));do try{Cg();break}catch(m){nh(n,m)}while(!0);if(T0(),vt=o,Wl.current=d,Zt!==null)throw Error(t(261));return dr=null,yr=0,ir}function Cg(){for(;Zt!==null;)sh(Zt)}function Ng(){for(;Zt!==null&&!Me();)sh(Zt)}function sh(n){var a=ch(n.alternate,n,an);n.memoizedProps=n.pendingProps,a===null?ih(n):Zt=a,ac.current=null}function ih(n){var a=n;do{var o=a.alternate;if(n=a.return,(a.flags&32768)===0){if(o=yg(o,a,an),o!==null){Zt=o;return}}else{if(o=kg(o,a),o!==null){o.flags&=32767,Zt=o;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ir=6,Zt=null;return}}if(a=a.sibling,a!==null){Zt=a;return}Zt=a=n}while(a!==null);ir===0&&(ir=5)}function Ga(n,a,o){var d=At,m=hn.transition;try{hn.transition=null,At=1,Ag(n,a,o,d)}finally{hn.transition=m,At=d}return null}function Ag(n,a,o,d){do Fs();while(ya!==null);if((vt&6)!==0)throw Error(t(327));o=n.finishedWork;var m=n.finishedLanes;if(o===null)return null;if(n.finishedWork=null,n.finishedLanes=0,o===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var g=o.lanes|o.childLanes;if(cm(n,g),n===dr&&(Zt=dr=null,yr=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||Gl||(Gl=!0,uh(yt,function(){return Fs(),null})),g=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||g){g=hn.transition,hn.transition=null;var _=At;At=1;var U=vt;vt|=4,ac.current=null,Sg(n,o),Qd(o,n),Ym(h0),ll=!!d0,h0=d0=null,n.current=o,bg(o),Fe(),vt=U,At=_,hn.transition=g}else n.current=o;if(Gl&&(Gl=!1,ya=n,Xl=m),g=n.pendingLanes,g===0&&(wa=null),$s(o.stateNode),qr(n,Ce()),a!==null)for(d=n.onRecoverableError,o=0;o<a.length;o++)m=a[o],d(m.value,{componentStack:m.stack,digest:m.digest});if($l)throw $l=!1,n=lc,lc=null,n;return(Xl&1)!==0&&n.tag!==0&&Fs(),g=n.pendingLanes,(g&1)!==0?n===oc?Si++:(Si=0,oc=n):Si=0,pa(),null}function Fs(){if(ya!==null){var n=Xu(Xl),a=hn.transition,o=At;try{if(hn.transition=null,At=16>n?16:n,ya===null)var d=!1;else{if(n=ya,ya=null,Xl=0,(vt&6)!==0)throw Error(t(331));var m=vt;for(vt|=4,ze=n.current;ze!==null;){var g=ze,_=g.child;if((ze.flags&16)!==0){var U=g.deletions;if(U!==null){for(var Q=0;Q<U.length;Q++){var ue=U[Q];for(ze=ue;ze!==null;){var Te=ze;switch(Te.tag){case 0:case 11:case 15:yi(8,Te,g)}var De=Te.child;if(De!==null)De.return=Te,ze=De;else for(;ze!==null;){Te=ze;var be=Te.sibling,He=Te.return;if($d(Te),Te===ue){ze=null;break}if(be!==null){be.return=He,ze=be;break}ze=He}}}var We=g.alternate;if(We!==null){var Ve=We.child;if(Ve!==null){We.child=null;do{var Qt=Ve.sibling;Ve.sibling=null,Ve=Qt}while(Ve!==null)}}ze=g}}if((g.subtreeFlags&2064)!==0&&_!==null)_.return=g,ze=_;else e:for(;ze!==null;){if(g=ze,(g.flags&2048)!==0)switch(g.tag){case 0:case 11:case 15:yi(9,g,g.return)}var se=g.sibling;if(se!==null){se.return=g.return,ze=se;break e}ze=g.return}}var Z=n.current;for(ze=Z;ze!==null;){_=ze;var ie=_.child;if((_.subtreeFlags&2064)!==0&&ie!==null)ie.return=_,ze=ie;else e:for(_=Z;ze!==null;){if(U=ze,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:zl(9,U)}}catch($e){Vt(U,U.return,$e)}if(U===_){ze=null;break e}var Re=U.sibling;if(Re!==null){Re.return=U.return,ze=Re;break e}ze=U.return}}if(vt=m,pa(),Wt&&typeof Wt.onPostCommitFiberRoot=="function")try{Wt.onPostCommitFiberRoot(vr,n)}catch{}d=!0}return d}finally{At=o,hn.transition=a}}return!1}function lh(n,a,o){a=Ts(o,a),a=_d(n,a,1),n=ga(n,a,1),a=Hr(),n!==null&&(Xs(n,1,a),qr(n,a))}function Vt(n,a,o){if(n.tag===3)lh(n,n,o);else for(;a!==null;){if(a.tag===3){lh(a,n,o);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(wa===null||!wa.has(d))){n=Ts(o,n),n=Td(a,n,1),a=ga(a,n,1),n=Hr(),a!==null&&(Xs(a,1,n),qr(a,n));break}}a=a.return}}function Fg(n,a,o){var d=n.pingCache;d!==null&&d.delete(a),a=Hr(),n.pingedLanes|=n.suspendedLanes&o,dr===n&&(yr&o)===o&&(ir===4||ir===3&&(yr&130023424)===yr&&500>Ce()-ic?$a(n,0):sc|=o),qr(n,a)}function oh(n,a){a===0&&((n.mode&1)===0?a=1:(a=nl,nl<<=1,(nl&130023424)===0&&(nl=4194304)));var o=Hr();n=Kn(n,a),n!==null&&(Xs(n,a,o),qr(n,o))}function Dg(n){var a=n.memoizedState,o=0;a!==null&&(o=a.retryLane),oh(n,o)}function Og(n,a){var o=0;switch(n.tag){case 13:var d=n.stateNode,m=n.memoizedState;m!==null&&(o=m.retryLane);break;case 19:d=n.stateNode;break;default:throw Error(t(314))}d!==null&&d.delete(a),oh(n,o)}var ch;ch=function(n,a,o){if(n!==null)if(n.memoizedProps!==a.pendingProps||Kr.current)Qr=!0;else{if((n.lanes&o)===0&&(a.flags&128)===0)return Qr=!1,wg(n,a,o);Qr=(n.flags&131072)!==0}else Qr=!1,Mt&&(a.flags&1048576)!==0&&zf(a,_l,a.index);switch(a.lanes=0,a.tag){case 2:var d=a.type;Ul(n,a),n=a.pendingProps;var m=vs(a,br.current);bs(a,o),m=L0(null,a,d,n,m,o);var g=M0();return a.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Yr(d)?(g=!0,El(a)):g=!1,a.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,F0(a),m.updater=Ml,a.stateNode=m,m._reactInternals=a,V0(a,d,n,o),a=K0(null,a,d,!0,g,o)):(a.tag=0,Mt&&g&&y0(a),Ur(null,a,m,o),a=a.child),a;case 16:d=a.elementType;e:{switch(Ul(n,a),n=a.pendingProps,m=d._init,d=m(d._payload),a.type=d,m=a.tag=Ig(d),n=bn(d,n),m){case 0:a=X0(null,a,d,n,o);break e;case 1:a=Rd(null,a,d,n,o);break e;case 11:a=Fd(null,a,d,n,o);break e;case 14:a=Dd(null,a,d,bn(d.type,n),o);break e}throw Error(t(306,d,""))}return a;case 0:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:bn(d,m),X0(n,a,d,m,o);case 1:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:bn(d,m),Rd(n,a,d,m,o);case 3:e:{if(Pd(a),n===null)throw Error(t(387));d=a.pendingProps,g=a.memoizedState,m=g.element,Jf(n,a),Dl(a,d,null,o);var _=a.memoizedState;if(d=_.element,g.isDehydrated)if(g={element:d,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){m=Ts(Error(t(423)),a),a=Ld(n,a,d,o,m);break e}else if(d!==m){m=Ts(Error(t(424)),a),a=Ld(n,a,d,o,m);break e}else for(nn=da(a.stateNode.containerInfo.firstChild),rn=a,Mt=!0,Sn=null,o=Yf(a,null,d,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ks(),d===m){a=Qn(n,a,o);break e}Ur(n,a,d,o)}a=a.child}return a;case 5:return ed(a),n===null&&S0(a),d=a.type,m=a.pendingProps,g=n!==null?n.memoizedProps:null,_=m.children,x0(d,m)?_=null:g!==null&&x0(d,g)&&(a.flags|=32),Id(n,a),Ur(n,a,_,o),a.child;case 6:return n===null&&S0(a),null;case 13:return Md(n,a,o);case 4:return D0(a,a.stateNode.containerInfo),d=a.pendingProps,n===null?a.child=Es(a,null,d,o):Ur(n,a,d,o),a.child;case 11:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:bn(d,m),Fd(n,a,d,m,o);case 7:return Ur(n,a,a.pendingProps,o),a.child;case 8:return Ur(n,a,a.pendingProps.children,o),a.child;case 12:return Ur(n,a,a.pendingProps.children,o),a.child;case 10:e:{if(d=a.type._context,m=a.pendingProps,g=a.memoizedProps,_=m.value,Ot(Nl,d._currentValue),d._currentValue=_,g!==null)if(En(g.value,_)){if(g.children===m.children&&!Kr.current){a=Qn(n,a,o);break e}}else for(g=a.child,g!==null&&(g.return=a);g!==null;){var U=g.dependencies;if(U!==null){_=g.child;for(var Q=U.firstContext;Q!==null;){if(Q.context===d){if(g.tag===1){Q=Yn(-1,o&-o),Q.tag=2;var ue=g.updateQueue;if(ue!==null){ue=ue.shared;var Te=ue.pending;Te===null?Q.next=Q:(Q.next=Te.next,Te.next=Q),ue.pending=Q}}g.lanes|=o,Q=g.alternate,Q!==null&&(Q.lanes|=o),N0(g.return,o,a),U.lanes|=o;break}Q=Q.next}}else if(g.tag===10)_=g.type===a.type?null:g.child;else if(g.tag===18){if(_=g.return,_===null)throw Error(t(341));_.lanes|=o,U=_.alternate,U!==null&&(U.lanes|=o),N0(_,o,a),_=g.sibling}else _=g.child;if(_!==null)_.return=g;else for(_=g;_!==null;){if(_===a){_=null;break}if(g=_.sibling,g!==null){g.return=_.return,_=g;break}_=_.return}g=_}Ur(n,a,m.children,o),a=a.child}return a;case 9:return m=a.type,d=a.pendingProps.children,bs(a,o),m=fn(m),d=d(m),a.flags|=1,Ur(n,a,d,o),a.child;case 14:return d=a.type,m=bn(d,a.pendingProps),m=bn(d.type,m),Dd(n,a,d,m,o);case 15:return Od(n,a,a.type,a.pendingProps,o);case 17:return d=a.type,m=a.pendingProps,m=a.elementType===d?m:bn(d,m),Ul(n,a),a.tag=1,Yr(d)?(n=!0,El(a)):n=!1,bs(a,o),Sd(a,d,m),V0(a,d,m,o),K0(null,a,d,!0,n,o);case 19:return Ud(n,a,o);case 22:return jd(n,a,o)}throw Error(t(156,a.tag))};function uh(n,a){return ve(n,a)}function jg(n,a,o,d){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(n,a,o,d){return new jg(n,a,o,d)}function xc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ig(n){if(typeof n=="function")return xc(n)?1:0;if(n!=null){if(n=n.$$typeof,n===K)return 11;if(n===we)return 14}return 2}function Sa(n,a){var o=n.alternate;return o===null?(o=xn(n.tag,a,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=a,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&14680064,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,a=n.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o}function Jl(n,a,o,d,m,g){var _=2;if(d=n,typeof n=="function")xc(n)&&(_=1);else if(typeof n=="string")_=5;else e:switch(n){case M:return Xa(o.children,m,g,a);case V:_=8,m|=8;break;case G:return n=xn(12,o,a,m|2),n.elementType=G,n.lanes=g,n;case me:return n=xn(13,o,a,m),n.elementType=me,n.lanes=g,n;case he:return n=xn(19,o,a,m),n.elementType=he,n.lanes=g,n;case Ee:return ql(o,m,g,a);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case oe:_=10;break e;case B:_=9;break e;case K:_=11;break e;case we:_=14;break e;case Oe:_=16,d=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return a=xn(_,o,a,m),a.elementType=n,a.type=d,a.lanes=g,a}function Xa(n,a,o,d){return n=xn(7,n,d,a),n.lanes=o,n}function ql(n,a,o,d){return n=xn(22,n,d,a),n.elementType=Ee,n.lanes=o,n.stateNode={isHidden:!1},n}function pc(n,a,o){return n=xn(6,n,null,a),n.lanes=o,n}function mc(n,a,o){return a=xn(4,n.children!==null?n.children:[],n.key,a),a.lanes=o,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}function Rg(n,a,o,d,m){this.tag=a,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wo(0),this.expirationTimes=Wo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wo(0),this.identifierPrefix=d,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function gc(n,a,o,d,m,g,_,U,Q){return n=new Rg(n,a,o,U,Q),a===1?(a=1,g===!0&&(a|=8)):a=0,g=xn(3,null,null,a),n.current=g,g.stateNode=n,g.memoizedState={element:d,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},F0(g),n}function Pg(n,a,o){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:d==null?null:""+d,children:n,containerInfo:a,implementation:o}}function fh(n){if(!n)return xa;n=n._reactInternals;e:{if(j(n)!==n||n.tag!==1)throw Error(t(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Yr(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(n.tag===1){var o=n.type;if(Yr(o))return Bf(n,o,a)}return a}function dh(n,a,o,d,m,g,_,U,Q){return n=gc(o,d,!0,n,m,g,_,U,Q),n.context=fh(null),o=n.current,d=Hr(),m=ka(o),g=Yn(d,m),g.callback=a??null,ga(o,g,m),n.current.lanes=m,Xs(n,m,d),qr(n,d),n}function Zl(n,a,o,d){var m=a.current,g=Hr(),_=ka(m);return o=fh(o),a.context===null?a.context=o:a.pendingContext=o,a=Yn(g,_),a.payload={element:n},d=d===void 0?null:d,d!==null&&(a.callback=d),n=ga(m,a,_),n!==null&&(Cn(n,m,_,g),Fl(n,m,_)),_}function eo(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function hh(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<a?o:a}}function vc(n,a){hh(n,a),(n=n.alternate)&&hh(n,a)}function Lg(){return null}var xh=typeof reportError=="function"?reportError:function(n){console.error(n)};function wc(n){this._internalRoot=n}to.prototype.render=wc.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(t(409));Zl(n,a,null,null)},to.prototype.unmount=wc.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;Va(function(){Zl(null,n,null,null)}),a[Vn]=null}};function to(n){this._internalRoot=n}to.prototype.unstable_scheduleHydration=function(n){if(n){var a=Qu();n={blockedOn:null,target:n,priority:a};for(var o=0;o<ca.length&&a!==0&&a<ca[o].priority;o++);ca.splice(o,0,n),o===0&&Zu(n)}};function yc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ro(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ph(){}function Mg(n,a,o,d,m){if(m){if(typeof d=="function"){var g=d;d=function(){var ue=eo(_);g.call(ue)}}var _=dh(a,d,n,0,null,!1,!1,"",ph);return n._reactRootContainer=_,n[Vn]=_.current,li(n.nodeType===8?n.parentNode:n),Va(),_}for(;m=n.lastChild;)n.removeChild(m);if(typeof d=="function"){var U=d;d=function(){var ue=eo(Q);U.call(ue)}}var Q=gc(n,0,!1,null,null,!1,!1,"",ph);return n._reactRootContainer=Q,n[Vn]=Q.current,li(n.nodeType===8?n.parentNode:n),Va(function(){Zl(a,Q,o,d)}),Q}function no(n,a,o,d,m){var g=o._reactRootContainer;if(g){var _=g;if(typeof m=="function"){var U=m;m=function(){var Q=eo(_);U.call(Q)}}Zl(a,_,n,m)}else _=Mg(o,a,n,m,d);return eo(_)}Ku=function(n){switch(n.tag){case 3:var a=n.stateNode;if(a.current.memoizedState.isDehydrated){var o=Gs(a.pendingLanes);o!==0&&(Vo(a,o|1),qr(a,Ce()),(vt&6)===0&&(As=Ce()+500,pa()))}break;case 13:Va(function(){var d=Kn(n,1);if(d!==null){var m=Hr();Cn(d,n,1,m)}}),vc(n,1)}},$o=function(n){if(n.tag===13){var a=Kn(n,134217728);if(a!==null){var o=Hr();Cn(a,n,134217728,o)}vc(n,134217728)}},Yu=function(n){if(n.tag===13){var a=ka(n),o=Kn(n,a);if(o!==null){var d=Hr();Cn(o,n,a,d)}vc(n,a)}},Qu=function(){return At},Ju=function(n,a){var o=At;try{return At=n,a()}finally{At=o}},xt=function(n,a,o){switch(a){case"input":if(Pe(n,o),a=o.name,o.type==="radio"&&a!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<o.length;a++){var d=o[a];if(d!==n&&d.form===n.form){var m=yl(d);if(!m)throw Error(t(90));N(d),Pe(d,m)}}}break;case"textarea":qt(n,o);break;case"select":a=o.value,a!=null&&Xt(n,!!o.multiple,a,!1)}},nt=fc,Tt=Va;var Bg={usingClientEntryPoint:!1,Events:[ui,ms,yl,Ut,Rt,fc]},bi={findFiberByHostInstance:Pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ug={bundleType:bi.bundleType,version:bi.version,rendererPackageName:bi.rendererPackageName,rendererConfig:bi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=re(n),n===null?null:n.stateNode},findFiberByHostInstance:bi.findFiberByHostInstance||Lg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ao=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ao.isDisabled&&ao.supportsFiber)try{vr=ao.inject(Ug),Wt=ao}catch{}}return Zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bg,Zr.createPortal=function(n,a){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yc(a))throw Error(t(200));return Pg(n,a,null,o)},Zr.createRoot=function(n,a){if(!yc(n))throw Error(t(299));var o=!1,d="",m=xh;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onRecoverableError!==void 0&&(m=a.onRecoverableError)),a=gc(n,1,!1,null,null,o,!1,d,m),n[Vn]=a.current,li(n.nodeType===8?n.parentNode:n),new wc(a)},Zr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=re(a),n=n===null?null:n.stateNode,n},Zr.flushSync=function(n){return Va(n)},Zr.hydrate=function(n,a,o){if(!ro(a))throw Error(t(200));return no(null,n,a,!0,o)},Zr.hydrateRoot=function(n,a,o){if(!yc(n))throw Error(t(405));var d=o!=null&&o.hydratedSources||null,m=!1,g="",_=xh;if(o!=null&&(o.unstable_strictMode===!0&&(m=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),a=dh(a,null,n,1,o??null,m,!1,g,_),n[Vn]=a.current,li(n),d)for(n=0;n<d.length;n++)o=d[n],m=o._getVersion,m=m(o._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[o,m]:a.mutableSourceEagerHydrationData.push(o,m);return new to(a)},Zr.render=function(n,a,o){if(!ro(a))throw Error(t(200));return no(null,n,a,!1,o)},Zr.unmountComponentAtNode=function(n){if(!ro(n))throw Error(t(40));return n._reactRootContainer?(Va(function(){no(null,null,n,!1,function(){n._reactRootContainer=null,n[Vn]=null})}),!0):!1},Zr.unstable_batchedUpdates=fc,Zr.unstable_renderSubtreeIntoContainer=function(n,a,o,d){if(!ro(o))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return no(n,a,o,!1,d)},Zr.version="18.3.1-next-f1338f8080-20240426",Zr}var Sh;function Yx(){if(Sh)return Sc.exports;Sh=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),Sc.exports=Xg(),Sc.exports}var bh;function Kg(){if(bh)return so;bh=1;var e=Yx();return so.createRoot=e.createRoot,so.hydrateRoot=e.hydrateRoot,so}var Yg=Kg();const Qg=uu(Yg);let Jg={data:""},qg=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Jg,Zg=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ev=/\/\*[^]*?\*\/|  +/g,_h=/\n+/g,Ca=(e,r)=>{let t="",i="",s="";for(let l in e){let c=e[l];l[0]=="@"?l[1]=="i"?t=l+" "+c+";":i+=l[1]=="f"?Ca(c,l):l+"{"+Ca(c,l[1]=="k"?"":r)+"}":typeof c=="object"?i+=Ca(c,r?r.replace(/([^,])+/g,u=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,h=>/&/.test(h)?h.replace(/&/g,u):u?u+" "+h:h)):l):c!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Ca.p?Ca.p(l,c):l+":"+c+";")}return t+(r&&s?r+"{"+s+"}":s)+i},qn={},Qx=e=>{if(typeof e=="object"){let r="";for(let t in e)r+=t+Qx(e[t]);return r}return e},tv=(e,r,t,i,s)=>{let l=Qx(e),c=qn[l]||(qn[l]=(h=>{let x=0,p=11;for(;x<h.length;)p=101*p+h.charCodeAt(x++)>>>0;return"go"+p})(l));if(!qn[c]){let h=l!==e?e:(x=>{let p,v,y=[{}];for(;p=Zg.exec(x.replace(ev,""));)p[4]?y.shift():p[3]?(v=p[3].replace(_h," ").trim(),y.unshift(y[0][v]=y[0][v]||{})):y[0][p[1]]=p[2].replace(_h," ").trim();return y[0]})(e);qn[c]=Ca(s?{["@keyframes "+c]:h}:h,t?"":"."+c)}let u=t&&qn.g?qn.g:null;return t&&(qn.g=qn[c]),((h,x,p,v)=>{v?x.data=x.data.replace(v,h):x.data.indexOf(h)===-1&&(x.data=p?h+x.data:x.data+h)})(qn[c],r,i,u),c},rv=(e,r,t)=>e.reduce((i,s,l)=>{let c=r[l];if(c&&c.call){let u=c(t),h=u&&u.props&&u.props.className||/^go/.test(u)&&u;c=h?"."+h:u&&typeof u=="object"?u.props?"":Ca(u,""):u===!1?"":u}return i+s+(c??"")},"");function Oo(e){let r=this||{},t=e.call?e(r.p):e;return tv(t.unshift?t.raw?rv(t,[].slice.call(arguments,1),r.p):t.reduce((i,s)=>Object.assign(i,s&&s.call?s(r.p):s),{}):t,qg(r.target),r.g,r.o,r.k)}let Jx,$c,Gc;Oo.bind({g:1});let na=Oo.bind({k:1});function nv(e,r,t,i){Ca.p=r,Jx=e,$c=t,Gc=i}function Ia(e,r){let t=this||{};return function(){let i=arguments;function s(l,c){let u=Object.assign({},l),h=u.className||s.className;t.p=Object.assign({theme:$c&&$c()},u),t.o=/ *go\d+/.test(h),u.className=Oo.apply(t,i)+(h?" "+h:"");let x=e;return e[0]&&(x=u.as||e,delete u.as),Gc&&x[0]&&Gc(u),Jx(x,u)}return s}}var av=e=>typeof e=="function",Xc=(e,r)=>av(e)?e(r):e,sv=(()=>{let e=0;return()=>(++e).toString()})(),iv=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let r=matchMedia("(prefers-reduced-motion: reduce)");e=!r||r.matches}return e}})(),lv=20,qx="default",Zx=(e,r)=>{let{toastLimit:t}=e.settings;switch(r.type){case 0:return{...e,toasts:[r.toast,...e.toasts].slice(0,t)};case 1:return{...e,toasts:e.toasts.map(c=>c.id===r.toast.id?{...c,...r.toast}:c)};case 2:let{toast:i}=r;return Zx(e,{type:e.toasts.find(c=>c.id===i.id)?1:0,toast:i});case 3:let{toastId:s}=r;return{...e,toasts:e.toasts.map(c=>c.id===s||s===void 0?{...c,dismissed:!0,visible:!1}:c)};case 4:return r.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(c=>c.id!==r.toastId)};case 5:return{...e,pausedAt:r.time};case 6:let l=r.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(c=>({...c,pauseDuration:c.pauseDuration+l}))}}},ov=[],cv={toasts:[],pausedAt:void 0,settings:{toastLimit:lv}},Rs={},ep=(e,r=qx)=>{Rs[r]=Zx(Rs[r]||cv,e),ov.forEach(([t,i])=>{t===r&&i(Rs[r])})},tp=e=>Object.keys(Rs).forEach(r=>ep(e,r)),uv=e=>Object.keys(Rs).find(r=>Rs[r].toasts.some(t=>t.id===e)),du=(e=qx)=>r=>{ep(r,e)},fv=(e,r="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:r,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...t,id:t?.id||sv()}),Yi=e=>(r,t)=>{let i=fv(r,e,t);return du(i.toasterId||uv(i.id))({type:2,toast:i}),i.id},Xe=(e,r)=>Yi("blank")(e,r);Xe.error=Yi("error");Xe.success=Yi("success");Xe.loading=Yi("loading");Xe.custom=Yi("custom");Xe.dismiss=(e,r)=>{let t={type:3,toastId:e};r?du(r)(t):tp(t)};Xe.dismissAll=e=>Xe.dismiss(void 0,e);Xe.remove=(e,r)=>{let t={type:4,toastId:e};r?du(r)(t):tp(t)};Xe.removeAll=e=>Xe.remove(void 0,e);Xe.promise=(e,r,t)=>{let i=Xe.loading(r.loading,{...t,...t?.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let l=r.success?Xc(r.success,s):void 0;return l?Xe.success(l,{id:i,...t,...t?.success}):Xe.dismiss(i),s}).catch(s=>{let l=r.error?Xc(r.error,s):void 0;l?Xe.error(l,{id:i,...t,...t?.error}):Xe.dismiss(i)}),e};var dv=na`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,hv=na`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,xv=na`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,pv=Ia("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${hv} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${xv} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,mv=na`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,gv=Ia("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${mv} 1s linear infinite;
`,vv=na`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,wv=na`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,yv=Ia("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${vv} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${wv} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,kv=Ia("div")`
  position: absolute;
`,Ev=Ia("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Sv=na`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,bv=Ia("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Sv} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,_v=({toast:e})=>{let{icon:r,type:t,iconTheme:i}=e;return r!==void 0?typeof r=="string"?ee.createElement(bv,null,r):r:t==="blank"?null:ee.createElement(Ev,null,ee.createElement(gv,{...i}),t!=="loading"&&ee.createElement(kv,null,t==="error"?ee.createElement(pv,{...i}):ee.createElement(yv,{...i})))},Tv=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Cv=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,Nv="0%{opacity:0;} 100%{opacity:1;}",Av="0%{opacity:1;} 100%{opacity:0;}",Fv=Ia("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Dv=Ia("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Ov=(e,r)=>{let t=e.includes("top")?1:-1,[i,s]=iv()?[Nv,Av]:[Tv(t),Cv(t)];return{animation:r?`${na(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${na(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};ee.memo(({toast:e,position:r,style:t,children:i})=>{let s=e.height?Ov(e.position||r||"top-center",e.visible):{opacity:0},l=ee.createElement(_v,{toast:e}),c=ee.createElement(Dv,{...e.ariaProps},Xc(e.message,e));return ee.createElement(Fv,{className:e.className,style:{...s,...t,...e.style}},typeof i=="function"?i({icon:l,message:c}):ee.createElement(ee.Fragment,null,l,c))});nv(ee.createElement);Oo`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;var ut=(e=>(e.TEXT="نص",e.NUMBER="رقم",e.DATE="تاريخ",e.CHECKBOX="مربع اختيار",e.LIST="قائمة",e.MULTI_CHECKBOX="مجموعة مربعات",e))(ut||{});function Un(e){if(!e)return"#fff";let r=e.replace("#","");r.length===3&&(r=r.split("").map(u=>u+u).join(""));const t=parseInt(r,16),i=t>>16&255,s=t>>8&255,l=t&255;return .299*i+.587*s+.114*l>170?"#222":"#fff"}function Th(e){if(!e)return"rgba(46,133,64,0.08)";let r=e.replace("#","");r.length===3&&(r=r.split("").map(c=>c+c).join(""));const t=parseInt(r,16),i=t>>16&255,s=t>>8&255,l=t&255;return`rgba(${i},${s},${l},0.08)`}const rp=ee.createContext({dragDropManager:void 0});function pn(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Ch=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})(),Nh=function(){return Math.random().toString(36).substring(7).split("").join(".")},Ah={INIT:"@@redux/INIT"+Nh(),REPLACE:"@@redux/REPLACE"+Nh()};function jv(e){if(typeof e!="object"||e===null)return!1;for(var r=e;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}function np(e,r,t){var i;if(typeof r=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(pn(0));if(typeof r=="function"&&typeof t>"u"&&(t=r,r=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(pn(1));return t(np)(e,r)}if(typeof e!="function")throw new Error(pn(2));var s=e,l=r,c=[],u=c,h=!1;function x(){u===c&&(u=c.slice())}function p(){if(h)throw new Error(pn(3));return l}function v(w){if(typeof w!="function")throw new Error(pn(4));if(h)throw new Error(pn(5));var S=!0;return x(),u.push(w),function(){if(S){if(h)throw new Error(pn(6));S=!1,x();var R=u.indexOf(w);u.splice(R,1),c=null}}}function y(w){if(!jv(w))throw new Error(pn(7));if(typeof w.type>"u")throw new Error(pn(8));if(h)throw new Error(pn(9));try{h=!0,l=s(l,w)}finally{h=!1}for(var S=c=u,O=0;O<S.length;O++){var R=S[O];R()}return w}function E(w){if(typeof w!="function")throw new Error(pn(10));s=w,y({type:Ah.REPLACE})}function k(){var w,S=v;return w={subscribe:function(R){if(typeof R!="object"||R===null)throw new Error(pn(11));function C(){R.next&&R.next(p())}C();var L=S(C);return{unsubscribe:L}}},w[Ch]=function(){return this},w}return y({type:Ah.INIT}),i={dispatch:y,subscribe:v,getState:p,replaceReducer:E},i[Ch]=k,i}function ct(e,r,...t){if(Iv()&&r===void 0)throw new Error("invariant requires an error message argument");if(!e){let i;if(r===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let s=0;i=new Error(r.replace(/%s/g,function(){return t[s++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}}function Iv(){return typeof process<"u"&&!0}function Rv(e,r,t){return r.split(".").reduce((i,s)=>i&&i[s]?i[s]:t||null,e)}function Pv(e,r){return e.filter(t=>t!==r)}function ap(e){return typeof e=="object"}function Lv(e,r){const t=new Map,i=l=>{t.set(l,t.has(l)?t.get(l)+1:1)};e.forEach(i),r.forEach(i);const s=[];return t.forEach((l,c)=>{l===1&&s.push(c)}),s}function Mv(e,r){return e.filter(t=>r.indexOf(t)>-1)}const hu="dnd-core/INIT_COORDS",jo="dnd-core/BEGIN_DRAG",xu="dnd-core/PUBLISH_DRAG_SOURCE",Io="dnd-core/HOVER",Ro="dnd-core/DROP",Po="dnd-core/END_DRAG";function Fh(e,r){return{type:hu,payload:{sourceClientOffset:r||null,clientOffset:e||null}}}const Bv={type:hu,payload:{clientOffset:null,sourceClientOffset:null}};function Uv(e){return function(t=[],i={publishSource:!0}){const{publishSource:s=!0,clientOffset:l,getSourceClientOffset:c}=i,u=e.getMonitor(),h=e.getRegistry();e.dispatch(Fh(l)),Hv(t,u,h);const x=Vv(t,u);if(x==null){e.dispatch(Bv);return}let p=null;if(l){if(!c)throw new Error("getSourceClientOffset must be defined");zv(c),p=c(x)}e.dispatch(Fh(l,p));const y=h.getSource(x).beginDrag(u,x);if(y==null)return;Wv(y),h.pinSource(x);const E=h.getSourceType(x);return{type:jo,payload:{itemType:E,item:y,sourceId:x,clientOffset:l||null,sourceClientOffset:p||null,isSourcePublic:!!s}}}}function Hv(e,r,t){ct(!r.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(i){ct(t.getSource(i),"Expected sourceIds to be registered.")})}function zv(e){ct(typeof e=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function Wv(e){ct(ap(e),"Item must be an object.")}function Vv(e,r){let t=null;for(let i=e.length-1;i>=0;i--)if(r.canDragSource(e[i])){t=e[i];break}return t}function $v(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Gv(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),i.forEach(function(s){$v(e,s,t[s])})}return e}function Xv(e){return function(t={}){const i=e.getMonitor(),s=e.getRegistry();Kv(i),Jv(i).forEach((c,u)=>{const h=Yv(c,u,s,i),x={type:Ro,payload:{dropResult:Gv({},t,h)}};e.dispatch(x)})}}function Kv(e){ct(e.isDragging(),"Cannot call drop while not dragging."),ct(!e.didDrop(),"Cannot call drop twice during one drag operation.")}function Yv(e,r,t,i){const s=t.getTarget(e);let l=s?s.drop(i,e):void 0;return Qv(l),typeof l>"u"&&(l=r===0?{}:i.getDropResult()),l}function Qv(e){ct(typeof e>"u"||ap(e),"Drop result must either be an object or undefined.")}function Jv(e){const r=e.getTargetIds().filter(e.canDropOnTarget,e);return r.reverse(),r}function qv(e){return function(){const t=e.getMonitor(),i=e.getRegistry();Zv(t);const s=t.getSourceId();return s!=null&&(i.getSource(s,!0).endDrag(t,s),i.unpinSource()),{type:Po}}}function Zv(e){ct(e.isDragging(),"Cannot call endDrag while not dragging.")}function Kc(e,r){return r===null?e===null:Array.isArray(e)?e.some(t=>t===r):e===r}function e2(e){return function(t,{clientOffset:i}={}){t2(t);const s=t.slice(0),l=e.getMonitor(),c=e.getRegistry(),u=l.getItemType();return n2(s,c,u),r2(s,l,c),a2(s,l,c),{type:Io,payload:{targetIds:s,clientOffset:i||null}}}}function t2(e){ct(Array.isArray(e),"Expected targetIds to be an array.")}function r2(e,r,t){ct(r.isDragging(),"Cannot call hover while not dragging."),ct(!r.didDrop(),"Cannot call hover after drop.");for(let i=0;i<e.length;i++){const s=e[i];ct(e.lastIndexOf(s)===i,"Expected targetIds to be unique in the passed array.");const l=t.getTarget(s);ct(l,"Expected targetIds to be registered.")}}function n2(e,r,t){for(let i=e.length-1;i>=0;i--){const s=e[i],l=r.getTargetType(s);Kc(l,t)||e.splice(i,1)}}function a2(e,r,t){e.forEach(function(i){t.getTarget(i).hover(r,i)})}function s2(e){return function(){if(e.getMonitor().isDragging())return{type:xu}}}function i2(e){return{beginDrag:Uv(e),publishDragSource:s2(e),hover:e2(e),drop:Xv(e),endDrag:qv(e)}}class l2{receiveBackend(r){this.backend=r}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const r=this,{dispatch:t}=this.store;function i(l){return(...c)=>{const u=l.apply(r,c);typeof u<"u"&&t(u)}}const s=i2(this);return Object.keys(s).reduce((l,c)=>{const u=s[c];return l[c]=i(u),l},{})}dispatch(r){this.store.dispatch(r)}constructor(r,t){this.isSetUp=!1,this.handleRefCountChange=()=>{const i=this.store.getState().refCount>0;this.backend&&(i&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!i&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=r,this.monitor=t,r.subscribe(this.handleRefCountChange)}}function o2(e,r){return{x:e.x+r.x,y:e.y+r.y}}function sp(e,r){return{x:e.x-r.x,y:e.y-r.y}}function c2(e){const{clientOffset:r,initialClientOffset:t,initialSourceClientOffset:i}=e;return!r||!t||!i?null:sp(o2(r,i),t)}function u2(e){const{clientOffset:r,initialClientOffset:t}=e;return!r||!t?null:sp(r,t)}const Fi=[],pu=[];Fi.__IS_NONE__=!0;pu.__IS_ALL__=!0;function f2(e,r){return e===Fi?!1:e===pu||typeof r>"u"?!0:Mv(r,e).length>0}class d2{subscribeToStateChange(r,t={}){const{handlerIds:i}=t;ct(typeof r=="function","listener must be a function."),ct(typeof i>"u"||Array.isArray(i),"handlerIds, when specified, must be an array of strings.");let s=this.store.getState().stateId;const l=()=>{const c=this.store.getState(),u=c.stateId;try{u===s||u===s+1&&!f2(c.dirtyHandlerIds,i)||r()}finally{s=u}};return this.store.subscribe(l)}subscribeToOffsetChange(r){ct(typeof r=="function","listener must be a function.");let t=this.store.getState().dragOffset;const i=()=>{const s=this.store.getState().dragOffset;s!==t&&(t=s,r())};return this.store.subscribe(i)}canDragSource(r){if(!r)return!1;const t=this.registry.getSource(r);return ct(t,`Expected to find a valid source. sourceId=${r}`),this.isDragging()?!1:t.canDrag(this,r)}canDropOnTarget(r){if(!r)return!1;const t=this.registry.getTarget(r);if(ct(t,`Expected to find a valid target. targetId=${r}`),!this.isDragging()||this.didDrop())return!1;const i=this.registry.getTargetType(r),s=this.getItemType();return Kc(i,s)&&t.canDrop(this,r)}isDragging(){return!!this.getItemType()}isDraggingSource(r){if(!r)return!1;const t=this.registry.getSource(r,!0);if(ct(t,`Expected to find a valid source. sourceId=${r}`),!this.isDragging()||!this.isSourcePublic())return!1;const i=this.registry.getSourceType(r),s=this.getItemType();return i!==s?!1:t.isDragging(this,r)}isOverTarget(r,t={shallow:!1}){if(!r)return!1;const{shallow:i}=t;if(!this.isDragging())return!1;const s=this.registry.getTargetType(r),l=this.getItemType();if(l&&!Kc(s,l))return!1;const c=this.getTargetIds();if(!c.length)return!1;const u=c.indexOf(r);return i?u===c.length-1:u>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return c2(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return u2(this.store.getState().dragOffset)}constructor(r,t){this.store=r,this.registry=t}}const Dh=typeof global<"u"?global:self,ip=Dh.MutationObserver||Dh.WebKitMutationObserver;function lp(e){return function(){const t=setTimeout(s,0),i=setInterval(s,50);function s(){clearTimeout(t),clearInterval(i),e()}}}function h2(e){let r=1;const t=new ip(e),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){r=-r,i.data=r}}const x2=typeof ip=="function"?h2:lp;class p2{enqueueTask(r){const{queue:t,requestFlush:i}=this;t.length||(i(),this.flushing=!0),t[t.length]=r}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:r}=this;for(;this.index<r.length;){const t=this.index;if(this.index++,r[t].call(),this.index>this.capacity){for(let i=0,s=r.length-this.index;i<s;i++)r[i]=r[i+this.index];r.length-=this.index,this.index=0}}r.length=0,this.index=0,this.flushing=!1},this.registerPendingError=r=>{this.pendingErrors.push(r),this.requestErrorThrow()},this.requestFlush=x2(this.flush),this.requestErrorThrow=lp(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class m2{call(){try{this.task&&this.task()}catch(r){this.onError(r)}finally{this.task=null,this.release(this)}}constructor(r,t){this.onError=r,this.release=t,this.task=null}}class g2{create(r){const t=this.freeTasks,i=t.length?t.pop():new m2(this.onError,s=>t[t.length]=s);return i.task=r,i}constructor(r){this.onError=r,this.freeTasks=[]}}const op=new p2,v2=new g2(op.registerPendingError);function w2(e){op.enqueueTask(v2.create(e))}const mu="dnd-core/ADD_SOURCE",gu="dnd-core/ADD_TARGET",vu="dnd-core/REMOVE_SOURCE",Lo="dnd-core/REMOVE_TARGET";function y2(e){return{type:mu,payload:{sourceId:e}}}function k2(e){return{type:gu,payload:{targetId:e}}}function E2(e){return{type:vu,payload:{sourceId:e}}}function S2(e){return{type:Lo,payload:{targetId:e}}}function b2(e){ct(typeof e.canDrag=="function","Expected canDrag to be a function."),ct(typeof e.beginDrag=="function","Expected beginDrag to be a function."),ct(typeof e.endDrag=="function","Expected endDrag to be a function.")}function _2(e){ct(typeof e.canDrop=="function","Expected canDrop to be a function."),ct(typeof e.hover=="function","Expected hover to be a function."),ct(typeof e.drop=="function","Expected beginDrag to be a function.")}function Yc(e,r){if(r&&Array.isArray(e)){e.forEach(t=>Yc(t,!1));return}ct(typeof e=="string"||typeof e=="symbol",r?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var wn;(function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"})(wn||(wn={}));let T2=0;function C2(){return T2++}function N2(e){const r=C2().toString();switch(e){case wn.SOURCE:return`S${r}`;case wn.TARGET:return`T${r}`;default:throw new Error(`Unknown Handler Role: ${e}`)}}function Oh(e){switch(e[0]){case"S":return wn.SOURCE;case"T":return wn.TARGET;default:throw new Error(`Cannot parse handler ID: ${e}`)}}function jh(e,r){const t=e.entries();let i=!1;do{const{done:s,value:[,l]}=t.next();if(l===r)return!0;i=!!s}while(!i);return!1}class A2{addSource(r,t){Yc(r),b2(t);const i=this.addHandler(wn.SOURCE,r,t);return this.store.dispatch(y2(i)),i}addTarget(r,t){Yc(r,!0),_2(t);const i=this.addHandler(wn.TARGET,r,t);return this.store.dispatch(k2(i)),i}containsHandler(r){return jh(this.dragSources,r)||jh(this.dropTargets,r)}getSource(r,t=!1){return ct(this.isSourceId(r),"Expected a valid source ID."),t&&r===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(r)}getTarget(r){return ct(this.isTargetId(r),"Expected a valid target ID."),this.dropTargets.get(r)}getSourceType(r){return ct(this.isSourceId(r),"Expected a valid source ID."),this.types.get(r)}getTargetType(r){return ct(this.isTargetId(r),"Expected a valid target ID."),this.types.get(r)}isSourceId(r){return Oh(r)===wn.SOURCE}isTargetId(r){return Oh(r)===wn.TARGET}removeSource(r){ct(this.getSource(r),"Expected an existing source."),this.store.dispatch(E2(r)),w2(()=>{this.dragSources.delete(r),this.types.delete(r)})}removeTarget(r){ct(this.getTarget(r),"Expected an existing target."),this.store.dispatch(S2(r)),this.dropTargets.delete(r),this.types.delete(r)}pinSource(r){const t=this.getSource(r);ct(t,"Expected an existing source."),this.pinnedSourceId=r,this.pinnedSource=t}unpinSource(){ct(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(r,t,i){const s=N2(r);return this.types.set(s,t),r===wn.SOURCE?this.dragSources.set(s,i):r===wn.TARGET&&this.dropTargets.set(s,i),s}constructor(r){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=r}}const F2=(e,r)=>e===r;function D2(e,r){return!e&&!r?!0:!e||!r?!1:e.x===r.x&&e.y===r.y}function O2(e,r,t=F2){if(e.length!==r.length)return!1;for(let i=0;i<e.length;++i)if(!t(e[i],r[i]))return!1;return!0}function j2(e=Fi,r){switch(r.type){case Io:break;case mu:case gu:case Lo:case vu:return Fi;case jo:case xu:case Po:case Ro:default:return pu}const{targetIds:t=[],prevTargetIds:i=[]}=r.payload,s=Lv(t,i);if(!(s.length>0||!O2(t,i)))return Fi;const c=i[i.length-1],u=t[t.length-1];return c!==u&&(c&&s.push(c),u&&s.push(u)),s}function I2(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function R2(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),i.forEach(function(s){I2(e,s,t[s])})}return e}const Ih={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function P2(e=Ih,r){const{payload:t}=r;switch(r.type){case hu:case jo:return{initialSourceClientOffset:t.sourceClientOffset,initialClientOffset:t.clientOffset,clientOffset:t.clientOffset};case Io:return D2(e.clientOffset,t.clientOffset)?e:R2({},e,{clientOffset:t.clientOffset});case Po:case Ro:return Ih;default:return e}}function L2(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Ds(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),i.forEach(function(s){L2(e,s,t[s])})}return e}const M2={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function B2(e=M2,r){const{payload:t}=r;switch(r.type){case jo:return Ds({},e,{itemType:t.itemType,item:t.item,sourceId:t.sourceId,isSourcePublic:t.isSourcePublic,dropResult:null,didDrop:!1});case xu:return Ds({},e,{isSourcePublic:!0});case Io:return Ds({},e,{targetIds:t.targetIds});case Lo:return e.targetIds.indexOf(t.targetId)===-1?e:Ds({},e,{targetIds:Pv(e.targetIds,t.targetId)});case Ro:return Ds({},e,{dropResult:t.dropResult,didDrop:!0,targetIds:[]});case Po:return Ds({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}function U2(e=0,r){switch(r.type){case mu:case gu:return e+1;case vu:case Lo:return e-1;default:return e}}function H2(e=0){return e+1}function z2(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function W2(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),i.forEach(function(s){z2(e,s,t[s])})}return e}function V2(e={},r){return{dirtyHandlerIds:j2(e.dirtyHandlerIds,{type:r.type,payload:W2({},r.payload,{prevTargetIds:Rv(e,"dragOperation.targetIds",[])})}),dragOffset:P2(e.dragOffset,r),refCount:U2(e.refCount,r),dragOperation:B2(e.dragOperation,r),stateId:H2(e.stateId)}}function $2(e,r=void 0,t={},i=!1){const s=G2(i),l=new d2(s,new A2(s)),c=new l2(s,l),u=e(c,r,t);return c.receiveBackend(u),c}function G2(e){const r=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return np(V2,e&&r&&r({name:"dnd-core",instanceId:"dnd-core"}))}function X2(e,r){if(e==null)return{};var t=K2(e,r),i,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)i=l[s],!(r.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(t[i]=e[i])}return t}function K2(e,r){if(e==null)return{};var t={},i=Object.keys(e),s,l;for(l=0;l<i.length;l++)s=i[l],!(r.indexOf(s)>=0)&&(t[s]=e[s]);return t}let Rh=0;const go=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var Y2=ee.memo(function(r){var{children:t}=r,i=X2(r,["children"]);const[s,l]=Q2(i);return ee.useEffect(()=>{if(l){const c=cp();return++Rh,()=>{--Rh===0&&(c[go]=null)}}},[]),f.jsx(rp.Provider,{value:s,children:t})});function Q2(e){if("manager"in e)return[{dragDropManager:e.manager},!1];const r=J2(e.backend,e.context,e.options,e.debugMode),t=!e.context;return[r,t]}function J2(e,r=cp(),t,i){const s=r;return s[go]||(s[go]={dragDropManager:$2(e,r,t,i)}),s[go]}function cp(){return typeof global<"u"?global:window}var Tc,Ph;function q2(){return Ph||(Ph=1,Tc=function e(r,t){if(r===t)return!0;if(r&&t&&typeof r=="object"&&typeof t=="object"){if(r.constructor!==t.constructor)return!1;var i,s,l;if(Array.isArray(r)){if(i=r.length,i!=t.length)return!1;for(s=i;s--!==0;)if(!e(r[s],t[s]))return!1;return!0}if(r.constructor===RegExp)return r.source===t.source&&r.flags===t.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===t.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===t.toString();if(l=Object.keys(r),i=l.length,i!==Object.keys(t).length)return!1;for(s=i;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,l[s]))return!1;for(s=i;s--!==0;){var c=l[s];if(!e(r[c],t[c]))return!1}return!0}return r!==r&&t!==t}),Tc}var Z2=q2();const ew=uu(Z2),Za=typeof window<"u"?ee.useLayoutEffect:ee.useEffect;function tw(e,r,t){const[i,s]=ee.useState(()=>r(e)),l=ee.useCallback(()=>{const c=r(e);ew(i,c)||(s(c),t&&t())},[i,e,t]);return Za(l),[i,l]}function rw(e,r,t){const[i,s]=tw(e,r,t);return Za(function(){const c=e.getHandlerId();if(c!=null)return e.subscribeToStateChange(s,{handlerIds:[c]})},[e,s]),i}function up(e,r,t){return rw(r,e||(()=>({})),()=>t.reconnect())}function fp(e,r){const t=[];return typeof e!="function"&&t.push(e),ee.useMemo(()=>typeof e=="function"?e():e,t)}function nw(e){return ee.useMemo(()=>e.hooks.dragSource(),[e])}function aw(e){return ee.useMemo(()=>e.hooks.dragPreview(),[e])}let Cc=!1,Nc=!1;class sw{receiveHandlerId(r){this.sourceId=r}getHandlerId(){return this.sourceId}canDrag(){ct(!Cc,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Cc=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Cc=!1}}isDragging(){if(!this.sourceId)return!1;ct(!Nc,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Nc=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Nc=!1}}subscribeToStateChange(r,t){return this.internalMonitor.subscribeToStateChange(r,t)}isDraggingSource(r){return this.internalMonitor.isDraggingSource(r)}isOverTarget(r,t){return this.internalMonitor.isOverTarget(r,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(r){return this.internalMonitor.subscribeToOffsetChange(r)}canDragSource(r){return this.internalMonitor.canDragSource(r)}canDropOnTarget(r){return this.internalMonitor.canDropOnTarget(r)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(r){this.sourceId=null,this.internalMonitor=r.getMonitor()}}let Ac=!1;class iw{receiveHandlerId(r){this.targetId=r}getHandlerId(){return this.targetId}subscribeToStateChange(r,t){return this.internalMonitor.subscribeToStateChange(r,t)}canDrop(){if(!this.targetId)return!1;ct(!Ac,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return Ac=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{Ac=!1}}isOver(r){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,r):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(r){this.targetId=null,this.internalMonitor=r.getMonitor()}}function lw(e,r,t){const i=t.getRegistry(),s=i.addTarget(e,r);return[s,()=>i.removeTarget(s)]}function ow(e,r,t){const i=t.getRegistry(),s=i.addSource(e,r);return[s,()=>i.removeSource(s)]}function Qc(e,r,t,i){let s;if(s!==void 0)return!!s;if(e===r)return!0;if(typeof e!="object"||!e||typeof r!="object"||!r)return!1;const l=Object.keys(e),c=Object.keys(r);if(l.length!==c.length)return!1;const u=Object.prototype.hasOwnProperty.bind(r);for(let h=0;h<l.length;h++){const x=l[h];if(!u(x))return!1;const p=e[x],v=r[x];if(s=void 0,s===!1||s===void 0&&p!==v)return!1}return!0}function Jc(e){return e!==null&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function cw(e){if(typeof e.type=="string")return;const r=e.type.displayName||e.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${r} into a <div>, or turn it into a drag source or a drop target itself.`)}function uw(e){return(r=null,t=null)=>{if(!ee.isValidElement(r)){const l=r;return e(l,t),l}const i=r;return cw(i),fw(i,t?l=>e(l,t):e)}}function dp(e){const r={};return Object.keys(e).forEach(t=>{const i=e[t];if(t.endsWith("Ref"))r[t]=e[t];else{const s=uw(i);r[t]=()=>s}}),r}function Lh(e,r){typeof e=="function"?e(r):e.current=r}function fw(e,r){const t=e.ref;return ct(typeof t!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),t?ee.cloneElement(e,{ref:i=>{Lh(t,i),Lh(r,i)}}):ee.cloneElement(e,{ref:r})}class dw{receiveHandlerId(r){this.handlerId!==r&&(this.handlerId=r,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(r){this.dragSourceOptionsInternal=r}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(r){this.dragPreviewOptionsInternal=r}reconnect(){const r=this.reconnectDragSource();this.reconnectDragPreview(r)}reconnectDragSource(){const r=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?r?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=r,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,r,this.dragSourceOptions)),t):(this.lastConnectedDragSource=r,t):t}reconnectDragPreview(r=!1){const t=this.dragPreview,i=r||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(i&&this.disconnectDragPreview(),!!this.handlerId){if(!t){this.lastConnectedDragPreview=t;return}i&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!Qc(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!Qc(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(r){this.hooks=dp({dragSource:(t,i)=>{this.clearDragSource(),this.dragSourceOptions=i||null,Jc(t)?this.dragSourceRef=t:this.dragSourceNode=t,this.reconnectDragSource()},dragPreview:(t,i)=>{this.clearDragPreview(),this.dragPreviewOptions=i||null,Jc(t)?this.dragPreviewRef=t:this.dragPreviewNode=t,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=r}}class hw{get connectTarget(){return this.dropTarget}reconnect(){const r=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();r&&this.disconnectDropTarget();const t=this.dropTarget;if(this.handlerId){if(!t){this.lastConnectedDropTarget=t;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions))}}receiveHandlerId(r){r!==this.handlerId&&(this.handlerId=r,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(r){this.dropTargetOptionsInternal=r}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!Qc(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(r){this.hooks=dp({dropTarget:(t,i)=>{this.clearDropTarget(),this.dropTargetOptions=i,Jc(t)?this.dropTargetRef=t:this.dropTargetNode=t,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=r}}function Hs(){const{dragDropManager:e}=ee.useContext(rp);return ct(e!=null,"Expected drag drop context"),e}function xw(e,r){const t=Hs(),i=ee.useMemo(()=>new dw(t.getBackend()),[t]);return Za(()=>(i.dragSourceOptions=e||null,i.reconnect(),()=>i.disconnectDragSource()),[i,e]),Za(()=>(i.dragPreviewOptions=r||null,i.reconnect(),()=>i.disconnectDragPreview()),[i,r]),i}function pw(){const e=Hs();return ee.useMemo(()=>new sw(e),[e])}class mw{beginDrag(){const r=this.spec,t=this.monitor;let i=null;return typeof r.item=="object"?i=r.item:typeof r.item=="function"?i=r.item(t):i={},i??null}canDrag(){const r=this.spec,t=this.monitor;return typeof r.canDrag=="boolean"?r.canDrag:typeof r.canDrag=="function"?r.canDrag(t):!0}isDragging(r,t){const i=this.spec,s=this.monitor,{isDragging:l}=i;return l?l(s):t===r.getSourceId()}endDrag(){const r=this.spec,t=this.monitor,i=this.connector,{end:s}=r;s&&s(t.getItem(),t),i.reconnect()}constructor(r,t,i){this.spec=r,this.monitor=t,this.connector=i}}function gw(e,r,t){const i=ee.useMemo(()=>new mw(e,r,t),[r,t]);return ee.useEffect(()=>{i.spec=e},[e]),i}function vw(e){return ee.useMemo(()=>{const r=e.type;return ct(r!=null,"spec.type must be defined"),r},[e])}function ww(e,r,t){const i=Hs(),s=gw(e,r,t),l=vw(e);Za(function(){if(l!=null){const[u,h]=ow(l,s,i);return r.receiveHandlerId(u),t.receiveHandlerId(u),h}},[i,r,t,s,l])}function yw(e,r){const t=fp(e);ct(!t.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const i=pw(),s=xw(t.options,t.previewOptions);return ww(t,i,s),[up(t.collect,i,s),nw(s),aw(s)]}function kw(e){return ee.useMemo(()=>e.hooks.dropTarget(),[e])}function Ew(e){const r=Hs(),t=ee.useMemo(()=>new hw(r.getBackend()),[r]);return Za(()=>(t.dropTargetOptions=e||null,t.reconnect(),()=>t.disconnectDropTarget()),[e]),t}function Sw(){const e=Hs();return ee.useMemo(()=>new iw(e),[e])}function bw(e){const{accept:r}=e;return ee.useMemo(()=>(ct(e.accept!=null,"accept must be defined"),Array.isArray(r)?r:[r]),[r])}class _w{canDrop(){const r=this.spec,t=this.monitor;return r.canDrop?r.canDrop(t.getItem(),t):!0}hover(){const r=this.spec,t=this.monitor;r.hover&&r.hover(t.getItem(),t)}drop(){const r=this.spec,t=this.monitor;if(r.drop)return r.drop(t.getItem(),t)}constructor(r,t){this.spec=r,this.monitor=t}}function Tw(e,r){const t=ee.useMemo(()=>new _w(e,r),[r]);return ee.useEffect(()=>{t.spec=e},[e]),t}function Cw(e,r,t){const i=Hs(),s=Tw(e,r),l=bw(e);Za(function(){const[u,h]=lw(l,s,i);return r.receiveHandlerId(u),t.receiveHandlerId(u),h},[i,r,s,t,l.map(c=>c.toString()).join("|")])}function Nw(e,r){const t=fp(e),i=Sw(),s=Ew(t.options);return Cw(t,i,s),[up(t.collect,i,s),kw(s)]}function hp(e){let r=null;return()=>(r==null&&(r=e()),r)}function Aw(e,r){return e.filter(t=>t!==r)}function Fw(e,r){const t=new Set,i=l=>t.add(l);e.forEach(i),r.forEach(i);const s=[];return t.forEach(l=>s.push(l)),s}class Dw{enter(r){const t=this.entered.length,i=s=>this.isNodeInDocument(s)&&(!s.contains||s.contains(r));return this.entered=Fw(this.entered.filter(i),[r]),t===0&&this.entered.length>0}leave(r){const t=this.entered.length;return this.entered=Aw(this.entered.filter(this.isNodeInDocument),r),t>0&&this.entered.length===0}reset(){this.entered=[]}constructor(r){this.entered=[],this.isNodeInDocument=r}}class Ow{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(r=>{Object.defineProperty(this.item,r,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${r}" until the drop event.`),null}})})}loadDataTransfer(r){if(r){const t={};Object.keys(this.config.exposeProperties).forEach(i=>{const s=this.config.exposeProperties[i];s!=null&&(t[i]={value:s(r,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(r,t){return t===r.getSourceId()}endDrag(){}constructor(r){this.config=r,this.item={},this.initializeExposedProperties()}}const xp="__NATIVE_FILE__",pp="__NATIVE_URL__",mp="__NATIVE_TEXT__",gp="__NATIVE_HTML__",Mh=Object.freeze(Object.defineProperty({__proto__:null,FILE:xp,HTML:gp,TEXT:mp,URL:pp},Symbol.toStringTag,{value:"Module"}));function Fc(e,r,t){const i=r.reduce((s,l)=>s||e.getData(l),"");return i??t}const qc={[xp]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:["Files"]},[gp]:{exposeProperties:{html:(e,r)=>Fc(e,r,""),dataTransfer:e=>e},matchesTypes:["Html","text/html"]},[pp]:{exposeProperties:{urls:(e,r)=>Fc(e,r,"").split(`
`),dataTransfer:e=>e},matchesTypes:["Url","text/uri-list"]},[mp]:{exposeProperties:{text:(e,r)=>Fc(e,r,""),dataTransfer:e=>e},matchesTypes:["Text","text/plain"]}};function jw(e,r){const t=qc[e];if(!t)throw new Error(`native type ${e} has no configuration`);const i=new Ow(t);return i.loadDataTransfer(r),i}function Dc(e){if(!e)return null;const r=Array.prototype.slice.call(e.types||[]);return Object.keys(qc).filter(t=>{const i=qc[t];return i?.matchesTypes?i.matchesTypes.some(s=>r.indexOf(s)>-1):!1})[0]||null}const Iw=hp(()=>/firefox/i.test(navigator.userAgent)),vp=hp(()=>!!window.safari);class Bh{interpolate(r){const{xs:t,ys:i,c1s:s,c2s:l,c3s:c}=this;let u=t.length-1;if(r===t[u])return i[u];let h=0,x=c.length-1,p;for(;h<=x;){p=Math.floor(.5*(h+x));const E=t[p];if(E<r)h=p+1;else if(E>r)x=p-1;else return i[p]}u=Math.max(0,x);const v=r-t[u],y=v*v;return i[u]+s[u]*v+l[u]*y+c[u]*v*y}constructor(r,t){const{length:i}=r,s=[];for(let E=0;E<i;E++)s.push(E);s.sort((E,k)=>r[E]<r[k]?-1:1);const l=[],c=[];let u,h;for(let E=0;E<i-1;E++)u=r[E+1]-r[E],h=t[E+1]-t[E],l.push(u),c.push(h/u);const x=[c[0]];for(let E=0;E<l.length-1;E++){const k=c[E],w=c[E+1];if(k*w<=0)x.push(0);else{u=l[E];const S=l[E+1],O=u+S;x.push(3*O/((O+S)/k+(O+u)/w))}}x.push(c[c.length-1]);const p=[],v=[];let y;for(let E=0;E<x.length-1;E++){y=c[E];const k=x[E],w=1/l[E],S=k+x[E+1]-y-y;p.push((y-k-S)*w),v.push(S*w*w)}this.xs=r,this.ys=t,this.c1s=x,this.c2s=p,this.c3s=v}}const Rw=1;function wp(e){const r=e.nodeType===Rw?e:e.parentElement;if(!r)return null;const{top:t,left:i}=r.getBoundingClientRect();return{x:i,y:t}}function io(e){return{x:e.clientX,y:e.clientY}}function Pw(e){var r;return e.nodeName==="IMG"&&(Iw()||!(!((r=document.documentElement)===null||r===void 0)&&r.contains(e)))}function Lw(e,r,t,i){let s=e?r.width:t,l=e?r.height:i;return vp()&&e&&(l/=window.devicePixelRatio,s/=window.devicePixelRatio),{dragPreviewWidth:s,dragPreviewHeight:l}}function Mw(e,r,t,i,s){const l=Pw(r),u=wp(l?e:r),h={x:t.x-u.x,y:t.y-u.y},{offsetWidth:x,offsetHeight:p}=e,{anchorX:v,anchorY:y}=i,{dragPreviewWidth:E,dragPreviewHeight:k}=Lw(l,r,x,p),w=()=>{let W=new Bh([0,.5,1],[h.y,h.y/p*k,h.y+k-p]).interpolate(y);return vp()&&l&&(W+=(window.devicePixelRatio-1)*k),W},S=()=>new Bh([0,.5,1],[h.x,h.x/x*E,h.x+E-x]).interpolate(v),{offsetX:O,offsetY:R}=s,C=O===0||O,L=R===0||R;return{x:C?O:S(),y:L?R:w()}}class Bw{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var r;return!((r=this.globalContext)===null||r===void 0)&&r.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var r;return((r=this.optionsArgs)===null||r===void 0?void 0:r.rootElement)||this.window}constructor(r,t){this.ownerDocument=null,this.globalContext=r,this.optionsArgs=t}}function Uw(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Uh(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{},i=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),i.forEach(function(s){Uw(e,s,t[s])})}return e}class Hw{profile(){var r,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((r=this.dragStartSourceIds)===null||r===void 0?void 0:r.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((t=this.dragOverTargetIds)===null||t===void 0?void 0:t.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const r=this.rootElement;if(r!==void 0){if(r.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");r.__isReactDndBackendSetUp=!0,this.addEventListeners(r)}}teardown(){const r=this.rootElement;if(r!==void 0&&(r.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var t;(t=this.window)===null||t===void 0||t.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(r,t,i){return this.sourcePreviewNodeOptions.set(r,i),this.sourcePreviewNodes.set(r,t),()=>{this.sourcePreviewNodes.delete(r),this.sourcePreviewNodeOptions.delete(r)}}connectDragSource(r,t,i){this.sourceNodes.set(r,t),this.sourceNodeOptions.set(r,i);const s=c=>this.handleDragStart(c,r),l=c=>this.handleSelectStart(c);return t.setAttribute("draggable","true"),t.addEventListener("dragstart",s),t.addEventListener("selectstart",l),()=>{this.sourceNodes.delete(r),this.sourceNodeOptions.delete(r),t.removeEventListener("dragstart",s),t.removeEventListener("selectstart",l),t.setAttribute("draggable","false")}}connectDropTarget(r,t){const i=c=>this.handleDragEnter(c,r),s=c=>this.handleDragOver(c,r),l=c=>this.handleDrop(c,r);return t.addEventListener("dragenter",i),t.addEventListener("dragover",s),t.addEventListener("drop",l),()=>{t.removeEventListener("dragenter",i),t.removeEventListener("dragover",s),t.removeEventListener("drop",l)}}addEventListeners(r){r.addEventListener&&(r.addEventListener("dragstart",this.handleTopDragStart),r.addEventListener("dragstart",this.handleTopDragStartCapture,!0),r.addEventListener("dragend",this.handleTopDragEndCapture,!0),r.addEventListener("dragenter",this.handleTopDragEnter),r.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),r.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),r.addEventListener("dragover",this.handleTopDragOver),r.addEventListener("dragover",this.handleTopDragOverCapture,!0),r.addEventListener("drop",this.handleTopDrop),r.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(r){r.removeEventListener&&(r.removeEventListener("dragstart",this.handleTopDragStart),r.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),r.removeEventListener("dragend",this.handleTopDragEndCapture,!0),r.removeEventListener("dragenter",this.handleTopDragEnter),r.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),r.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),r.removeEventListener("dragover",this.handleTopDragOver),r.removeEventListener("dragover",this.handleTopDragOverCapture,!0),r.removeEventListener("drop",this.handleTopDrop),r.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const r=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(r);return Uh({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const r=this.monitor.getSourceId(),t=this.sourcePreviewNodeOptions.get(r);return Uh({anchorX:.5,anchorY:.5,captureDraggingState:!1},t||{})}isDraggingNativeItem(){const r=this.monitor.getItemType();return Object.keys(Mh).some(t=>Mh[t]===r)}beginDragNativeItem(r,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=jw(r,t),this.currentNativeHandle=this.registry.addSource(r,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(r){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=r;const t=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var i;return(i=this.rootElement)===null||i===void 0?void 0:i.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},t)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var r;(r=this.window)===null||r===void 0||r.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(r,t){r.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}handleDragEnter(r,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(r,t){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(r,t){this.dropTargetIds.unshift(t)}constructor(r,t,i){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=s=>{const l=this.sourceNodes.get(s);return l&&wp(l)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=s=>!!(s&&this.document&&this.document.body&&this.document.body.contains(s)),this.endDragIfSourceWasRemovedFromDOM=()=>{const s=this.currentDragSourceNode;s==null||this.isNodeInDocument(s)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=s=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(s||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=s=>{if(s.defaultPrevented)return;const{dragStartSourceIds:l}=this;this.dragStartSourceIds=null;const c=io(s);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(l||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:c});const{dataTransfer:u}=s,h=Dc(u);if(this.monitor.isDragging()){if(u&&typeof u.setDragImage=="function"){const p=this.monitor.getSourceId(),v=this.sourceNodes.get(p),y=this.sourcePreviewNodes.get(p)||v;if(y){const{anchorX:E,anchorY:k,offsetX:w,offsetY:S}=this.getCurrentSourcePreviewNodeOptions(),C=Mw(v,y,c,{anchorX:E,anchorY:k},{offsetX:w,offsetY:S});u.setDragImage(y,C.x,C.y)}}try{u?.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(s.target);const{captureDraggingState:x}=this.getCurrentSourcePreviewNodeOptions();x?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(h)this.beginDragNativeItem(h);else{if(u&&!u.types&&(s.target&&!s.target.hasAttribute||!s.target.hasAttribute("draggable")))return;s.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=s=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var l;(l=this.currentNativeSource)===null||l===void 0||l.loadDataTransfer(s.dataTransfer)}if(!this.enterLeaveCounter.enter(s.target)||this.monitor.isDragging())return;const{dataTransfer:u}=s,h=Dc(u);h&&this.beginDragNativeItem(h,u)},this.handleTopDragEnter=s=>{const{dragEnterTargetIds:l}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=s.altKey,l.length>0&&this.actions.hover(l,{clientOffset:io(s)}),l.some(u=>this.monitor.canDropOnTarget(u))&&(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=s=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var l;(l=this.currentNativeSource)===null||l===void 0||l.loadDataTransfer(s.dataTransfer)}},this.handleTopDragOver=s=>{const{dragOverTargetIds:l}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none");return}this.altKeyPressed=s.altKey,this.lastClientOffset=io(s),this.scheduleHover(l),(l||[]).some(u=>this.monitor.canDropOnTarget(u))?(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?s.preventDefault():(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=s=>{this.isDraggingNativeItem()&&s.preventDefault(),this.enterLeaveCounter.leave(s.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=s=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var l;s.preventDefault(),(l=this.currentNativeSource)===null||l===void 0||l.loadDataTransfer(s.dataTransfer)}else Dc(s.dataTransfer)&&s.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=s=>{const{dropTargetIds:l}=this;this.dropTargetIds=[],this.actions.hover(l,{clientOffset:io(s)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=s=>{const l=s.target;typeof l.dragDrop=="function"&&(l.tagName==="INPUT"||l.tagName==="SELECT"||l.tagName==="TEXTAREA"||l.isContentEditable||(s.preventDefault(),l.dragDrop()))},this.options=new Bw(t,i),this.actions=r.getActions(),this.monitor=r.getMonitor(),this.registry=r.getRegistry(),this.enterLeaveCounter=new Dw(this.isNodeInDocument)}}const zw=function(r,t,i){return new Hw(r,t,i)},Ww=({onClose:e,onSave:r,column:t})=>{const[i,s]=ee.useState(t.name),[l,c]=ee.useState(t.type),[u,h]=ee.useState(t.options?.join(", ")||""),[x,p]=ee.useState(t.multiSlots||8),[v,y]=ee.useState(!!t.multiShowCounter),[E,k]=ee.useState(t.multiCountMode||"both");ee.useEffect(()=>{(l===ut.MULTI_CHECKBOX&&t.type!==ut.MULTI_CHECKBOX||l!==ut.MULTI_CHECKBOX&&t.type===ut.MULTI_CHECKBOX)&&(p(8),y(!1),k("both"))},[l,t.type]),ee.useEffect(()=>{s(t.name),c(t.type),h(t.options?.join(", ")||""),p(t.multiSlots||8),y(!!t.multiShowCounter),k(t.multiCountMode||"both")},[t]);const w=S=>{if(S.preventDefault(),i.trim()){let O;l===ut.LIST&&u.trim()&&(O=u.split(",").map(R=>R.trim()).filter(Boolean)),l===ut.MULTI_CHECKBOX?r({name:i.trim(),type:l,options:O,multiSlots:Math.max(1,Math.min(64,Number(x)||1)),multiShowCounter:!!v,multiCountMode:E}):r({name:i.trim(),type:l,options:O})}};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300",children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-8 w-full max-w-md m-4",children:[f.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800 dark:text-slate-100",children:"تعديل العمود"}),f.jsxs("form",{onSubmit:w,children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"columnName",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"اسم العمود"}),f.jsx("input",{type:"text",id:"columnName",value:i,onChange:S=>s(S.target.value),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"columnType",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"نوع العمود"}),f.jsx("select",{id:"columnType",value:l,onChange:S=>c(S.target.value),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white",children:Object.values(ut).map(S=>f.jsx("option",{value:S,children:S},S))})]}),l===ut.LIST&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"columnOptions",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"خيارات القائمة (مفصولة بفاصلة)"}),f.jsx("input",{type:"text",id:"columnOptions",value:u,onChange:S=>h(S.target.value),placeholder:"مثال: ممتاز, جيد جداً, جيد",className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white"})]}),l===ut.MULTI_CHECKBOX&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"عدد الخانات"}),f.jsx("input",{type:"tel",inputMode:"numeric",pattern:"[0-9]*",min:1,max:64,value:x??"",onChange:S=>{const O=S.target.value.replace(/[^0-9]/g,"");p(O?Math.max(1,Math.min(64,parseInt(O,10))):1)},className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white",placeholder:"8"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{id:"showCounter",type:"checkbox",checked:v,onChange:S=>y(S.target.checked)}),f.jsx("label",{htmlFor:"showCounter",className:"text-sm text-slate-700 dark:text-slate-300",children:"عرض العداد داخل الخلية"})]}),v&&f.jsxs("div",{children:[f.jsx("div",{className:"block mb-1 text-sm font-medium text-slate-700 dark:text-slate-300",children:"طريقة العد داخل الخلية"}),f.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-700 dark:text-slate-300",children:[f.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"radio",name:"mc-mode-edit",checked:E==="check",onChange:()=>k("check")}),f.jsx("span",{children:"يحسب الصح فقط (✓)"})]}),f.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"radio",name:"mc-mode-edit",checked:E==="cross",onChange:()=>k("cross")}),f.jsx("span",{children:"يحسب الخطأ فقط (✗)"})]}),f.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"radio",name:"mc-mode-edit",checked:E==="both",onChange:()=>k("both")}),f.jsx("span",{children:"يحسب كليهما (✓ و ✗)"})]})]})]})]})]}),f.jsxs("div",{className:"flex justify-end gap-4 mt-8 pt-4 border-t border-slate-200 dark:border-slate-700",children:[f.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 focus:z-10 focus:ring-4 focus:ring-slate-200 dark:focus:ring-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-600 dark:hover:text-white dark:hover:bg-slate-700 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"submit",className:"py-2 px-4 text-sm font-medium text-white bg-[#2E8540] rounded-lg hover:bg-[#246b33] focus:ring-4 focus:ring-green-300 dark:focus:ring-green-800 transition-colors",children:"حفظ التغييرات"})]})]})]})})};function Vw(){if(typeof window>"u"||typeof navigator>"u")return!1;const e=navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2||window.matchMedia&&window.matchMedia("(pointer: coarse)").matches?!0:window.innerWidth<=1024}const Hh={COLUMN:"column"},$w=({column:e,onFillColumn:r})=>{const t=Math.max(1,Number(e.multiSlots)||8),[i,s]=xr.useState("".padEnd(t,"0"));xr.useEffect(()=>{s(u=>(u||"").slice(0,t).padEnd(t,"0"))},[t]);const l=u=>{const h=i.split(""),x=h[u];h[u]=x==="0"?"1":x==="1"?"2":"0";const p=h.join("");s(p);const v=h[u];r&&r(e.id,{__mcSlotUpdate:{index:u,value:v}})},c=()=>{const u="".padEnd(t,"0");s(u),r&&r(e.id,{__mcClear:!0})};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"flex flex-wrap gap-[2px] items-center justify-center",children:Array.from({length:t}).map((u,h)=>{const x=i[h]||"0",p=x==="1",v=x==="2",y="w-4 h-4 rounded border flex items-center justify-center text-[9px] select-none",E=p?`${y} bg-emerald-500 border-emerald-600 text-white`:v?`${y} bg-red-500 border-red-600 text-white`:`${y} bg-white border-slate-300 hover:bg-slate-100 text-slate-500`,k=p?"✓":v?"×":"";return f.jsx("button",{type:"button",onClick:()=>l(h),className:E,title:`الخانة ${h+1}`,"aria-label":`الخانة ${h+1}`,children:k},h)})}),f.jsx("button",{type:"button",className:"text-[10px] text-slate-400 hover:text-red-500 border px-1 rounded",title:"تفريغ الكل",onClick:c,children:"تفريغ"})]})},Gw=({column:e,index:r,moveColumn:t,themeColor:i,onEditColumn:s,onDeleteColumn:l,onFillColumn:c})=>{const u=ee.useRef(null),[{isDragging:h},x]=yw({type:Hh.COLUMN,item:{index:r},collect:v=>({isDragging:v.isDragging()})}),[,p]=Nw({accept:Hh.COLUMN,hover:(v,y)=>{if(!u.current)return;const E=v.index,k=r;if(E===k)return;const w=u.current.getBoundingClientRect(),S=(w.right-w.left)/2,R=y.getClientOffset().x-w.left;E<k&&R<S||E>k&&R>S||(t(E,k),v.index=k)}});return x(p(u)),f.jsx("th",{ref:u,className:`px-1 sm:px-2 py-2 min-w-[80px] md:min-w-[120px] max-w-[180px] text-center align-top border-slate-200 border-l last:border-l-0 group relative text-xs font-bold ${h?"opacity-80 shadow-xl !bg-green-50":""}`,style:{opacity:h?.5:1,fontFamily:"Noto Sans Arabic, Cairo, sans-serif",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:Un(i)},children:f.jsxs("div",{className:"flex flex-col items-center gap-0.5 w-full",children:[f.jsxs("div",{className:"flex items-center justify-center mb-1",children:[f.jsx("span",{className:"font-semibold text-xs break-words w-full",title:e.name,children:e.name}),f.jsx("span",{className:"cursor-grab ml-1 opacity-40 hover:opacity-100",title:"اسحب لتغيير موقع العمود",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-3 h-3",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})})]}),f.jsxs("div",{className:"flex gap-4 justify-center items-center mt-1",children:[f.jsx("button",{className:"inline-flex items-center justify-center ms-1 text-lg opacity-90 transition-all duration-150 p-2 rounded-full icon-hover",title:"تعديل اسم العمود","aria-label":"تعديل اسم العمود",onClick:()=>s(e.id),style:{verticalAlign:"middle",minWidth:36,minHeight:36,color:Un(i),background:"transparent"},children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})})}),f.jsx("button",{className:"inline-flex items-center justify-center ms-1 text-lg opacity-90 transition-all duration-150 p-2 rounded-full icon-hover",title:"حذف العمود","aria-label":"حذف العمود",onClick:()=>l(e.id,e.name),style:{verticalAlign:"middle",minWidth:36,minHeight:36,color:Un(i),background:"transparent"},children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]}),e.type==="قائمة"||e.type==="LIST"?f.jsxs("select",{className:"w-full mt-1 p-1 text-xs text-center rounded bg-white text-slate-700 border border-slate-300 focus:ring-emerald-500 focus:border-emerald-500",defaultValue:"",onChange:v=>{const y=v.target.value;y==="__empty__"?(c&&c(e.id,null),v.target.selectedIndex=0):y!==""&&(c&&c(e.id,y),v.target.selectedIndex=0)},style:{fontSize:10,minWidth:0,maxWidth:120},children:[f.jsx("option",{value:"",children:"تعميم لكل العمود..."}),f.jsx("option",{value:"__empty__",children:"بدون قيمة (تفريغ)"}),(e.options||[]).map(v=>f.jsx("option",{value:v,children:v},v))]}):e.type==="مربع اختيار"||e.type==="CHECKBOX"?f.jsxs("div",{className:"flex gap-1 mt-1 justify-center items-center",children:[f.jsx("input",{type:"checkbox",onChange:v=>c&&c(e.id,v.target.checked),title:"تعميم تفعيل/إلغاء الكل",className:"w-5 h-5 sm:w-6 sm:h-6 accent-emerald-600"}),f.jsx("button",{type:"button",className:"text-xs text-slate-400 hover:text-red-500 border px-1 rounded ml-1",title:"تفريغ الكل",onClick:()=>c&&c(e.id,null),children:"تفريغ"})]}):e.type==="مجموعة مربعات"||e.type==="MULTI_CHECKBOX"?f.jsx("div",{className:"flex items-center gap-2 mt-1",children:f.jsx($w,{column:e,onFillColumn:c})}):f.jsxs("div",{className:"flex items-center gap-1",children:[e.type==="تاريخ"||e.type==="DATE"?f.jsx(f.Fragment,{children:f.jsx(Kw,{column:e,onFillColumn:c})}):f.jsx("input",{type:e.type==="رقم"||e.type==="NUMBER"?"number":"text",className:"w-full mt-1 p-1 text-xs sm:text-sm text-center rounded bg-white text-slate-700 border border-slate-300 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"تعميم لكل العمود",onChange:v=>{let E=v.target.value;(e.type==="رقم"||e.type==="NUMBER")&&(E=E===""?null:parseFloat(E)),c&&c(e.id,E)},style:{fontSize:10,minWidth:0,maxWidth:120}}),f.jsx("button",{type:"button",className:"text-xs text-slate-400 hover:text-red-500 border px-1 rounded ml-1",title:"تفريغ الكل",onClick:()=>c&&c(e.id,null),children:"تفريغ"})]})]})})},Xw=e=>{try{localStorage.setItem("columnOrder",JSON.stringify(e))}catch(r){console.error("Error saving column order to localStorage:",r)}},Kw=({column:e,onFillColumn:r})=>{const[t,i]=ee.useState(!1),[s,l]=ee.useState(!1),[c,u]=ee.useState(""),h=ee.useRef(null),x=Vw(),p=()=>{i(!1),l(!0),setTimeout(()=>{h.current&&h.current.focus()},100),console.log("تم تأكيد تعديل التاريخ")},v=()=>{i(!1),l(!1),console.log("تم إلغاء تعديل التاريخ")},y=w=>x&&!s?(w.preventDefault(),i(!0),console.log("تم الضغط على حقل التاريخ في DraggableColumns.jsx - يظهر التأكيد"),!1):(console.log("تم الضغط على حقل التاريخ - جهاز عادي أو تم التمكين"),!0),E=w=>{const S=w.target.value;u(S),r&&r(e.id,S||null)},k=x?f.jsx("span",{className:"mobile-indicator",title:"يتطلب تأكيد على الأجهزة المحمولة",children:f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[f.jsx("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}),f.jsx("path",{d:"M12 18h.01"})]})}):null;return f.jsxs("div",{style:{position:"relative"},className:"date-input-container",children:[k,f.jsx("input",{ref:h,type:"date",className:"w-full mt-1 p-1 text-xs sm:text-sm text-center rounded bg-white text-slate-700 border border-slate-300 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"تعميم لكل العمود",style:{fontSize:10,minWidth:0,maxWidth:120,backgroundColor:x&&!s?"#f8f8f8":"#fff"},value:c,readOnly:x&&!s,onTouchStart:y,onMouseDown:y,onChange:E}),t&&f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",direction:"rtl"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:24,minWidth:280,boxShadow:"0 4px 20px rgba(0,0,0,0.25)",textAlign:"center"},children:[f.jsx("div",{style:{marginBottom:16,fontWeight:600,fontSize:18,color:"#059669"},children:"تأكيد تعديل التاريخ"}),f.jsx("div",{style:{marginBottom:20,fontSize:16,color:"#4b5563"},children:"هل تريد تعديل التاريخ لهذا العمود؟"}),f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"12px"},children:[f.jsx("button",{onClick:p,style:{background:"#059669",color:"#fff",border:"none",borderRadius:4,padding:"10px 20px",fontWeight:600,fontSize:16,cursor:"pointer"},children:"نعم"}),f.jsx("button",{onClick:v,style:{background:"#e5e7eb",color:"#222",border:"none",borderRadius:4,padding:"10px 20px",fontWeight:600,fontSize:16,cursor:"pointer"},children:"إلغاء"})]})]})})]})},Yw=({columns:e,themeColor:r,onEditColumn:t,onDeleteColumn:i,onFillColumn:s,onColumnsReorder:l})=>{const c=(u,h)=>{const x=[...e],p=x[u];x.splice(u,1),x.splice(h,0,p),l(x),Xw(x.map(v=>v.id))};return f.jsx(f.Fragment,{children:e.map((u,h)=>f.jsx(Gw,{column:u,index:h,moveColumn:c,themeColor:r,onEditColumn:t,onDeleteColumn:i,onFillColumn:s},u.id))})},yp="columnOrderv1";function Qw(e=[]){if(!(!e||!Array.isArray(e)))try{localStorage.setItem(yp,JSON.stringify(e))}catch(r){console.error("Error saving column order to localStorage:",r)}}function vo(){try{const e=localStorage.getItem(yp);return e?JSON.parse(e):[]}catch(e){return console.error("Error retrieving column order from localStorage:",e),[]}}function wo(e,r){if(!e||!e.length)return[];if(!r||!r.length)return[...e];const t=new Map(e.map(s=>[s.id,s])),i=[];return r.forEach(s=>{t.has(s)&&(i.push(t.get(s)),t.delete(s))}),t.forEach(s=>i.push(s)),i}var Jw=Yx();const qw=["#ffffff","#000000","#f87171","#fbbf24","#4ade80","#60a5fa"],Zw=["#222222","#000000","#ffffff","#f87171","#60a5fa"],ey=["12px","14px","16px","18px","20px"],ty=["right","center","left"],Oc=e=>e?`colorfulcell-${e}`:"",_a=({children:e,cellId:r,openCell:t,setOpenCell:i})=>{const s=t===r,l=()=>{if(!r)return null;try{const B=localStorage.getItem(Oc(r));return B?JSON.parse(B):null}catch{return null}},[c,u]=ee.useState(l()?.bgColor||"#ffffff"),[h,x]=ee.useState(l()?.textColor||"#222222"),[p,v]=ee.useState(l()?.fontSize||"14px"),[y,E]=ee.useState(l()?.textAlign||"center"),k=ee.useRef(null),w=ee.useRef(null),S=ee.useRef(!1),O=ee.useRef(null),[R,C]=ee.useState(!1);xr.useEffect(()=>{C(!0)},[]),xr.useEffect(()=>{if(!s)return;const B=K=>{K.key==="Escape"&&i&&i(null)};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[s,i]),xr.useEffect(()=>{if(!r)return;const B={bgColor:c,textColor:h,fontSize:p,textAlign:y};localStorage.setItem(Oc(r),JSON.stringify(B))},[c,h,p,y,r]);const L=B=>{const me=B.target?.tagName;if(me&&(me==="INPUT"||me==="SELECT"||me==="TEXTAREA"||me==="BUTTON")||!i||!r)return;const he=B.touches&&B.touches[0];he&&(w.current={x:he.clientX,y:he.clientY},S.current=!1),k.current=setTimeout(()=>{S.current||i(r)},800)},X=B=>{if(!w.current)return;const K=B.touches&&B.touches[0];if(!K)return;const me=Math.abs(K.clientX-w.current.x),he=Math.abs(K.clientY-w.current.y),we=10;(me>we||he>we)&&(S.current=!0,k.current&&(clearTimeout(k.current),k.current=null))},W=()=>{k.current&&(clearTimeout(k.current),k.current=null),w.current=null,S.current=!1},M=B=>{B.preventDefault(),i&&r&&i(r)},V=ee.isValidElement(e)&&(e.type==="input"||e.type==="select"||e.type==="textarea")?ee.cloneElement(e,{style:{...e.props.style||{},background:c,color:h,fontSize:p,textAlign:y}}):e,G=()=>{u("#ffffff"),x("#222222"),v("14px"),E("center"),r&&localStorage.removeItem(Oc(r)),i&&i(null)},oe=s&&R?Jw.createPortal(f.jsx("div",{style:{position:"fixed",inset:0,zIndex:9999,background:"rgba(0,0,0,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>i&&i(null),children:f.jsxs("div",{ref:O,onClick:B=>B.stopPropagation(),style:{background:"#fff",color:"#222",boxShadow:"0 2px 16px #0003",borderRadius:10,padding:12,width:"min(360px, 96vw)",minWidth:200,minHeight:120,maxHeight:"90vh",overflowY:"auto",border:"1px solid #e5e7eb",fontFamily:"inherit",fontSize:"14px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:6,marginBottom:10,alignItems:"center",justifyContent:"center",background:"#f3f4f6",borderRadius:6,padding:4,color:"#222"},children:[ty.map(B=>f.jsx("button",{onClick:()=>E(B),style:{fontWeight:y===B?"bold":"normal",border:y===B?"2px solid #60a5fa":"1px solid #ddd",borderRadius:4,padding:"2px 6px",background:"#fff",cursor:"pointer",color:"#222"},children:B==="right"?"يمين":B==="center"?"وسط":"يسار"},B)),f.jsx("select",{value:h,onChange:B=>x(B.target.value),style:{borderRadius:4,border:"1px solid #ddd",padding:"2px 4px",background:"#fff",color:"#222",fontWeight:"bold"},children:Zw.map(B=>f.jsx("option",{value:B,style:{background:B,color:B==="#fff"?"#222":"#fff"},children:B},B))}),f.jsx("select",{value:p,onChange:B=>v(B.target.value),style:{borderRadius:4,border:"1px solid #ddd",padding:"2px 4px",background:"#fff",color:"#222"},children:ey.map(B=>f.jsx("option",{value:B,children:B},B))})]}),f.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:12,justifyContent:"center",background:"#fff"},children:qw.map(B=>f.jsx("button",{onClick:()=>u(B),style:{width:28,height:28,borderRadius:"50%",background:B,border:c===B?"2px solid #222":"1px solid #ccc",cursor:"pointer",outline:"none"}},B))}),f.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"center",marginTop:10,background:"#fff"},children:[f.jsx("button",{onClick:()=>i&&i(null),style:{padding:"6px 18px",borderRadius:5,background:"#eee",border:"none",cursor:"pointer",fontWeight:500,color:"#222"},children:"إغلاق"}),f.jsx("button",{onClick:G,style:{padding:"6px 18px",borderRadius:5,background:"#f87171",color:"#fff",border:"none",cursor:"pointer",fontWeight:500},children:"إعادة الافتراضي"})]})]})}),document.body):null;return f.jsxs("td",{style:{background:c,color:h,cursor:"pointer",minWidth:120,position:"relative",fontSize:p,textAlign:y},onContextMenu:M,onTouchStart:L,onTouchMove:X,onTouchEnd:W,onTouchCancel:W,className:"text-center px-2 py-2 border",children:[V,oe]})},ry=e=>{const{columns:r,students:t,onEditColumn:i,onDeleteColumn:s,onFillColumn:l,onUpdateStudentData:c,onDeleteStudent:u,themeColor:h,nameSortOrder:x="asc",onNameSortChange:p,onColumnOrderChange:v}=e,[y,E]=ee.useState(null),[k,w]=ee.useState(()=>{const V=vo();return wo(r,V)});ee.useEffect(()=>{const V=vo();w(wo(r,V))},[r]);const S=V=>{w(V),Qw(V.map(G=>G.id)),Xe.success("تم حفظ ترتيب الأعمدة"),setTimeout(()=>{window.location.reload()},600),v&&v(V)},[O,R]=ee.useState(()=>{try{const V=localStorage.getItem("highlightedRows");return V?JSON.parse(V):[]}catch{return[]}});ee.useEffect(()=>{localStorage.setItem("highlightedRows",JSON.stringify(O))},[O]);const C=[...t].sort((V,G)=>x==="asc"?(V.name||"").localeCompare(G.name||"","ar"):(G.name||"").localeCompare(V.name||"","ar")),L=(V,G)=>{s&&s(V,G)},[X,W]=ee.useState(null),M=V=>{R(G=>G.includes(V)?G.filter(oe=>oe!==V):[...G,V])};return f.jsx(Y2,{backend:zw,children:f.jsxs("div",{className:"full-page-table w-full h-full glass rounded-2xl overflow-hidden shadow-2xl border border-white/30 backdrop-blur-xl flex flex-col",children:[f.jsx("div",{className:`flex justify-between items-center p-4 bg-gradient-to-r from-white/90 to-white/70 \r
                       border-b border-white/20 backdrop-blur-sm flex-shrink-0`}),f.jsx("div",{className:"full-page-table-container flex-1 overflow-auto custom-scroll",children:f.jsxs("table",{className:"w-full h-full border-collapse relative min-w-full",children:[f.jsx("thead",{className:"sticky top-0 z-40",style:{backgroundColor:h||"#2E8540",borderTopLeftRadius:12,borderTopRightRadius:12,fontFamily:"'Almarai','Cairo','Noto Sans Arabic','Amiri',sans-serif",boxShadow:"0 2px 8px -2px #0002",color:Un(h||"#2E8540")},children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-1 sm:px-2 py-2 sticky right-0 min-w-[60px] max-w-[60px] text-center z-30 text-xs font-bold border-r-4 border-slate-300 shadow-lg serial-header",style:{fontFamily:"'Almarai','Cairo','Noto Sans Arabic','Amiri',sans-serif",boxShadow:"2px 0 8px -2px #0002",color:Un("#22c55e"),background:"rgba(34,197,94,0.85)",letterSpacing:"1px",borderTopRightRadius:10},children:"م"}),f.jsx("th",{className:"px-1 sm:px-2 py-2 sticky right-0 min-w-[200px] max-w-[320px] text-center z-30 text-xs font-bold border-r-4 border-slate-300 shadow-lg name-header",style:{fontFamily:"'Almarai','Cairo','Noto Sans Arabic','Amiri',sans-serif",boxShadow:"2px 0 8px -2px #0002",color:Un("#0ea5e9"),background:"rgba(14,165,233,0.85)",letterSpacing:"1px"},children:f.jsxs("div",{className:"flex items-center justify-center gap-2",children:[f.jsx("span",{children:"الاسم"}),p&&f.jsx("button",{className:"bg-white bg-opacity-25 rounded px-1.5 py-0.5 text-[10px] hover:bg-opacity-40 transition-all",onClick:()=>p(x==="asc"?"desc":"asc"),title:x==="asc"?"ترتيب تنازلي":"ترتيب تصاعدي",children:x==="asc"?"أ→ي":"ي→أ"})]})}),(()=>{const V=Yw;return f.jsx(V,{columns:k,themeColor:h,onEditColumn:G=>{const oe=r.find(B=>B.id===G);oe&&E(oe)},onDeleteColumn:L,onFillColumn:l,onColumnsReorder:S})})(),f.jsx("th",{className:"px-2 py-2 text-center text-xs",title:"إجراءات",children:"إجراءات"})]})}),f.jsx("tbody",{children:C.length===0?f.jsx("tr",{children:f.jsx("td",{colSpan:k.length+3,className:"text-center py-6 text-slate-400",children:"لا يوجد طلاب"})}):C.map((V,G)=>{const oe=O.includes(V.id);return f.jsxs("tr",{className:"border-b last:border-b-0 transition-colors "+(oe?"bg-yellow-100":G%2===0?"bg-gray-50":"bg-white"),children:[f.jsx("td",{className:"px-1 sm:px-2 py-2 text-center font-semibold text-slate-700 whitespace-nowrap border-b-4 border-slate-300 z-20 cursor-pointer",style:{maxWidth:"60px",minWidth:"60px",boxShadow:"2px 0 8px -2px #0002",backgroundColor:Th(h)},onClick:B=>{B.stopPropagation(),M(V.id)},children:V.serial||G+1}),f.jsx("td",{className:"px-1 sm:px-2 py-2 sticky right-0 text-right font-semibold text-slate-700 whitespace-nowrap border-b-4 border-slate-300 z-20 text-sm md:text-xs",style:{maxWidth:"220px",minWidth:"140px",boxShadow:"2px 0 8px -2px #0002",backgroundColor:Th(h)},children:V.name}),k.map(B=>{const K=V.records?.[B.id];if(B.id==="serial"||B.id==="name")return null;const me=`${V.id}-${B.id}`;if(B.type==="مربع اختيار"||B.type==="CHECKBOX")try{let he="0";typeof K=="string"&&(K==="1"||K==="2"||K==="0")?he=K:K===!0?he="1":K===!1?he="2":(K==null||K===void 0||console.warn("Unexpected value type for checkbox:",typeof K,K),he="0");const we=he==="1",Oe=he==="2",Ee="w-6 h-6 rounded border flex items-center justify-center text-[16px] select-none shadow-sm transition-all duration-150 cursor-pointer mx-auto my-auto",Se=we?`${Ee} bg-[rgba(22,163,74,0.13)] border-emerald-600 text-emerald-700`:Oe?`${Ee} bg-[rgba(255,26,26,0.18)] border-red-600 text-red-700`:`${Ee} bg-white border-slate-300 hover:bg-slate-100 text-slate-500`,Y=we?f.jsx("span",{style:{fontSize:"16px",fontWeight:"bold",color:"#16a34a",display:"inline-block",lineHeight:"1",verticalAlign:"middle"},children:"✔"}):Oe?f.jsx("span",{style:{fontSize:"16px",fontWeight:"bold",color:"#ff1a1a",display:"inline-block",lineHeight:"1",verticalAlign:"middle"},children:"✗"}):f.jsx("span",{style:{fontSize:"16px",fontWeight:"bold",color:"#64748b",display:"inline-block",lineHeight:"1",verticalAlign:"middle"},children:"–"}),xe=z=>{try{z.stopPropagation();let T=he==="0"?"1":he==="1"?"2":"0";c&&c(V.id,B.id,T)}catch(T){console.error("Error in checkbox toggle:",T)}};return f.jsx(_a,{cellId:me,openCell:X,setOpenCell:W,children:f.jsx("div",{className:Se,onClick:xe,title:we?"صح":Oe?"خطأ":"فارغ",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Y})},B.id)}catch(he){return console.error("Error rendering checkbox cell:",he,{col:B,value:K,student:V}),f.jsx(_a,{cellId:me,openCell:X,setOpenCell:W,children:f.jsx("div",{className:"text-red-500 text-xs",children:"خطأ"})},B.id)}if(B.type==="مجموعة مربعات"||B.type==="MULTI_CHECKBOX")try{const he=Math.max(1,Number(B.multiSlots)||8),we=!!B.multiShowCounter,Oe=Array.isArray(B.multiLabels)?B.multiLabels:[];let Ee="";typeof K=="string"?Ee=K:(K==null||K===void 0||console.warn("Unexpected value type for multi-checkbox:",typeof K,K),Ee="".padEnd(he,"0"));const Se=H=>H==="1"||H==="2"?H:"0",xe=Ee.split("").map(H=>Se(H)).join("").padEnd(he,"0").slice(0,he),z=B.multiCountMode,T=z==="check"?[...xe].filter(H=>H==="1").length:z==="cross"?[...xe].filter(H=>H==="2").length:[...xe].filter(H=>H==="1"||H==="2").length,J=H=>{try{const I=xe.split(""),ne=I[H];I[H]=ne==="0"?"1":ne==="1"?"2":"0";const fe=I.join("");c&&c(V.id,B.id,fe)}catch(I){console.error("Error in toggleAt:",I)}};return f.jsx(_a,{cellId:me,openCell:X,setOpenCell:W,children:f.jsxs("div",{className:"relative pr-5 flex flex-wrap gap-[2px] items-center justify-center",children:[we&&f.jsxs("span",{className:"absolute right-0 top-1/2 -translate-y-1/2 text-[10px] text-slate-500 pointer-events-none select-none",children:[T,"/",he]}),Array.from({length:he}).map((H,I)=>{const ne=xe[I]||"0",fe=ne==="1",ye=ne==="2",le="w-6 h-6 rounded border flex items-center justify-center text-[18px] select-none shadow-sm transition-all duration-150",de=fe?`${le} bg-[rgba(22,163,74,0.13)] border-emerald-600 text-emerald-700`:ye?`${le} bg-[rgba(255,26,26,0.18)] border-red-600 text-red-700`:`${le} bg-white border-slate-300 hover:bg-slate-100 text-slate-500`,pe=fe?f.jsx("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#16a34a",display:"inline-block",lineHeight:"1",verticalAlign:"middle"},children:"✔"}):ye?f.jsx("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#ff1a1a",display:"inline-block",lineHeight:"1",verticalAlign:"middle"},children:"✗"}):f.jsx("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#64748b",display:"inline-block",lineHeight:"1",verticalAlign:"middle"},children:"–"}),N=Oe[I]?` - ${Oe[I]}`:"",_e=`الخانة ${I+1}${N} ${fe?"صح":ye?"إكس":"فارغة"}`;return f.jsx("button",{type:"button","aria-label":_e,title:_e,onClick:Ne=>{Ne.stopPropagation(),J(I)},className:de,children:pe},I)})]})},B.id)}catch(he){return console.error("Error rendering multi-checkbox cell:",he,{col:B,value:K,student:V}),f.jsx(_a,{cellId:me,openCell:X,setOpenCell:W,children:f.jsx("div",{className:"text-red-500 text-xs",children:"خطأ"})},B.id)}return B.type==="قائمة"||B.type==="LIST"?f.jsx(_a,{cellId:me,openCell:X,setOpenCell:W,children:f.jsxs("select",{value:K||"",onClick:he=>he.stopPropagation(),onChange:he=>c&&c(V.id,B.id,he.target.value),className:"w-full p-1 text-xs rounded border border-slate-300 bg-white text-slate-700",children:[f.jsx("option",{value:"",children:"—"}),(B.options||[]).map(he=>f.jsx("option",{value:he,children:he},he))]})},B.id):B.type==="رقم"||B.type==="NUMBER"?f.jsx(_a,{cellId:me,openCell:X,setOpenCell:W,children:f.jsx("input",{type:"number",value:K??"",onClick:he=>he.stopPropagation(),onChange:he=>c&&c(V.id,B.id,he.target.value===""?null:parseFloat(he.target.value)),className:"w-full p-1 text-xs rounded border border-slate-300 bg-white text-slate-700 text-center"})},B.id):B.type==="تاريخ"||B.type==="DATE"?f.jsx(_a,{cellId:me,openCell:X,setOpenCell:W,children:f.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[f.jsx("input",{type:"date",value:K||"",onClick:he=>he.stopPropagation(),onChange:he=>c&&c(V.id,B.id,he.target.value||null),onInput:he=>{he.target.value===""&&c&&c(V.id,B.id,null)},className:"w-full p-1 text-xs rounded border border-slate-300 bg-white text-slate-700 text-center"}),f.jsx("button",{type:"button",tabIndex:-1,"aria-label":"مسح التاريخ",onClick:he=>{he.preventDefault(),he.stopPropagation(),c&&c(V.id,B.id,null)},style:{position:"absolute",right:2,top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",color:"#888",fontSize:"1.1em",cursor:"pointer",padding:0,display:"none"},className:"date-clear-btn",children:"×"})]})},B.id):f.jsx(_a,{cellId:me,openCell:X,setOpenCell:W,children:f.jsx("input",{type:"text",value:K??"",onClick:he=>he.stopPropagation(),onChange:he=>c&&c(V.id,B.id,he.target.value),className:"w-full p-1 text-xs rounded border border-slate-300 bg-white text-slate-700 text-center"})},B.id)}),f.jsx("td",{className:"px-2 py-3 text-center text-base bg-slate-50 border-b border-slate-200",children:f.jsx("button",{className:"text-red-500 hover:underline text-xs",title:`حذف الطالب: ${V.name}`,"aria-label":`حذف الطالب: ${V.name}`,onClick:B=>{B.stopPropagation(),u&&u(V.id,V.name)},children:"حذف"})})]},V.id)})})]})}),y&&f.jsx(Ww,{column:y,onClose:()=>E(null),onSave:V=>{i(y.id,V),E(null)}}),f.jsx("style",{children:`
        .custom-scroll::-webkit-scrollbar {
          height: 8px;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
          background: #cbd5e1;
          border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-track {
          background: #f1f5f9;
        }
      `})]})})},ny=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),f.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),f.jsx("polyline",{points:"7 3 7 8 15 8"})]}),ay=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),f.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),f.jsx("line",{x1:"9",y1:"21",x2:"9",y2:"9"})]}),zh=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:f.jsx("path",{d:"M3 21v-4.5M3 12.5V3M10 21v-7.5M10 9.5V3M17 21V15.5M17 11.5V3M1 16.5h4M8 9.5h4M15 11.5h4"})}),sy=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),f.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),iy=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("polyline",{points:"3 6 5 6 21 6"}),f.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),ly=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),f.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),yo=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),f.jsx("polyline",{points:"7 10 12 15 17 10"}),f.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),Wh=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),f.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),f.jsx("line",{x1:"20",y1:"8",x2:"20",y2:"14"}),f.jsx("line",{x1:"17",y1:"11",x2:"23",y2:"11"})]}),oy=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),f.jsx("polyline",{points:"16 17 21 12 16 7"}),f.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),cy=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:f.jsx("polyline",{points:"15 18 9 12 15 6"})}),uy=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:f.jsx("polyline",{points:"9 18 15 12 9 6"})}),fy=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1"}),f.jsx("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),f.jsx("path",{d:"M12 11h4"}),f.jsx("path",{d:"M12 16h4"}),f.jsx("path",{d:"M8 11h.01"}),f.jsx("path",{d:"M8 16h.01"})]}),dy=e=>f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:f.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),hy=e=>f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[f.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),f.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),Vh=({onAddStudent:e,onImportStudents:r,onExportExcel:t,onExportPdf:i,onOpenSettings:s,onOpenCustomize:l,onSaveTemplate:c,onUseTemplate:u,onDeleteAllStudents:h,classType:x,onAdminExport:p})=>f.jsx("nav",{className:"glass sticky top-0 z-40 backdrop-blur-xl border-b border-white/20 shadow-lg",children:f.jsx("div",{className:"container mx-auto py-4",children:f.jsxs("div",{className:"flex flex-wrap gap-3 items-center justify-center",children:[f.jsxs("button",{onClick:l,className:`btn-modern btn-primary flex items-center gap-2 px-4 py-2.5 text-sm font-semibold \r
                     shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200`,children:[f.jsx(zh,{className:"w-4 h-4"}),"إدارة الصفوف والجداول"]}),f.jsxs("button",{onClick:s,className:`btn-modern bg-gradient-to-r from-gray-600 to-gray-700 text-white \r
                     flex items-center gap-2 px-4 py-2.5 text-sm font-semibold \r
                     shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 group`,children:[f.jsx(zh,{className:"w-4 h-4 group-hover:rotate-90 transition-transform duration-300"}),"الإعدادات"]}),f.jsxs("button",{onClick:e,className:`btn-modern bg-gradient-to-r from-emerald-500 to-emerald-600 text-white \r
                     flex items-center gap-2 px-4 py-2.5 text-sm font-semibold shadow-lg \r
                     hover:shadow-xl transform hover:scale-105 transition-all duration-200`,children:[f.jsx(Wh,{className:"w-4 h-4"}),x==="إداري"?"إضافة اسم":"إضافة طالب"]}),f.jsxs("button",{onClick:r,className:`btn-modern bg-gradient-to-r from-yellow-500 to-yellow-600 text-white \r
                     flex items-center gap-2 px-4 py-2.5 text-sm font-semibold shadow-lg \r
                     hover:shadow-xl transform hover:scale-105 transition-all duration-200`,children:[f.jsx(Wh,{className:"w-4 h-4"}),x==="إداري"?"استيراد أسماء":"استيراد طلاب"]}),x!=="إداري"&&f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:t,className:`btn-modern bg-gradient-to-r from-green-600 to-green-700 text-white \r
                         flex items-center gap-2 px-4 py-2.5 text-sm font-semibold shadow-lg \r
                         hover:shadow-xl transform hover:scale-105 transition-all duration-200`,children:[f.jsx(yo,{className:"w-4 h-4"})," تصدير Excel"]}),f.jsxs("button",{onClick:i,className:`btn-modern bg-gradient-to-r from-red-600 to-red-700 text-white \r
                         flex items-center gap-2 px-4 py-2.5 text-sm font-semibold shadow-lg \r
                         hover:shadow-xl transform hover:scale-105 transition-all duration-200`,children:[f.jsx(yo,{className:"w-4 h-4"})," تصدير PDF"]})]}),x==="إداري"&&f.jsxs("button",{onClick:p,className:`btn-modern bg-gradient-to-r from-blue-600 to-blue-700 text-white \r
                       flex items-center gap-2 px-4 py-2.5 text-sm font-semibold shadow-lg \r
                       hover:shadow-xl transform hover:scale-105 transition-all duration-200`,children:[f.jsx(ly,{className:"w-4 h-4"})," خيارات التصدير"]}),c&&f.jsxs("button",{onClick:c,className:`btn-modern bg-gradient-to-r from-blue-500 to-blue-600 text-white \r
                       flex items-center gap-2 px-4 py-2.5 text-sm font-semibold shadow-lg \r
                       hover:shadow-xl transform hover:scale-105 transition-all duration-200`,children:[f.jsx(ny,{className:"w-4 h-4"})," حفظ القالب"]}),u&&f.jsxs("button",{onClick:u,className:`btn-modern bg-gradient-to-r from-purple-500 to-purple-600 text-white \r
                       flex items-center gap-2 px-4 py-2.5 text-sm font-semibold shadow-lg \r
                       hover:shadow-xl transform hover:scale-105 transition-all duration-200`,children:[f.jsx(ay,{className:"w-4 h-4"})," استخدام قالب"]}),h&&f.jsxs("button",{onClick:h,className:`btn-modern bg-gradient-to-r from-red-600 to-red-700 text-white \r
                       flex items-center gap-2 px-4 py-2.5 text-sm font-semibold shadow-lg \r
                       hover:shadow-xl transform hover:scale-105 transition-all duration-200 \r
                       hover:from-red-700 hover:to-red-800`,children:[f.jsx("span",{className:"w-4 h-4 text-sm",children:"🗑️"}),"حذف كل الأسماء"]})]})})}),xy=({classes:e,activeClassId:r,activeSubjectId:t,onClassChange:i,onSubjectChange:s})=>{const l=e.find(c=>c.id===r);return f.jsxs("div",{className:"flex gap-2 items-center mb-2",children:[f.jsx("label",{className:"text-sm font-semibold",children:"الفصل:"}),f.jsx("select",{className:"p-1 border rounded bg-slate-50 dark:bg-slate-700 dark:border-slate-600 focus:ring-1 focus:ring-emerald-500",value:r,onChange:c=>i(c.target.value),children:e.map(c=>f.jsx("option",{value:c.id,children:c.name},c.id))}),f.jsx("label",{className:"text-sm font-semibold",children:"المادة:"}),f.jsx("select",{className:"p-1 border rounded bg-slate-50 dark:bg-slate-700 dark:border-slate-600 focus:ring-1 focus:ring-emerald-500",value:t,onChange:c=>s(c.target.value),disabled:!l,children:l?.subjects.map(c=>f.jsx("option",{value:c.id,children:c.name},c.id))})]})},kp=({onClose:e,onAddColumn:r})=>{const[t,i]=ee.useState(1),[s,l]=ee.useState(ut.NUMBER),[c,u]=ee.useState(""),[h,x]=ee.useState(8),[p,v]=ee.useState(!0),[y,E]=ee.useState(""),[k,w]=ee.useState("both"),[S,O]=ee.useState(""),R=L=>{let X=Math.max(1,parseInt(L.target.value)||1);i(X)},C=L=>{L.preventDefault();let X;if(s===ut.LIST&&c.trim()&&(X=c.split(",").map(W=>W.trim()).filter(Boolean)),!!S.trim())for(let W=0;W<t;W++){const M=s===ut.MULTI_CHECKBOX?{multiSlots:Math.max(1,Number(h)||8),multiShowCounter:p,multiLabels:y.trim()?y.split(",").map(V=>V.trim()).filter(Boolean):void 0,multiCountMode:k}:void 0;r(S.trim(),s,X,M)}};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300",children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-8 w-full max-w-md m-4",children:[f.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800 dark:text-slate-100",children:"إضافة عمود جديد"}),f.jsxs("form",{onSubmit:C,children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"mainLabel",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:S||"عنوان الحقل الرئيسي"}),f.jsx("input",{type:"text",id:"mainLabel",value:S,onChange:L=>O(L.target.value),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"columnCount",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"عدد الحقول"}),f.jsx("input",{type:"number",id:"columnCount",min:1,value:t,onChange:R,className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"columnType",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"نوع الحقول"}),f.jsx("select",{id:"columnType",value:s,onChange:L=>l(L.target.value),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white",children:Object.values(ut).map(L=>f.jsx("option",{value:L,children:L},L))})]}),s===ut.MULTI_CHECKBOX&&f.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-slate-700 dark:text-slate-300",children:"عدد الخانات داخل الخلية"}),f.jsx("input",{type:"number",min:1,value:h,onChange:L=>x(parseInt(L.target.value)||8),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{id:"mcounter",type:"checkbox",checked:p,onChange:L=>v(L.target.checked)}),f.jsx("label",{htmlFor:"mcounter",className:"text-sm text-slate-700 dark:text-slate-300",children:"عرض العداد (مثلاً 4/8)"})]}),p&&f.jsxs("div",{children:[f.jsx("div",{className:"block mb-1 text-sm font-medium text-slate-700 dark:text-slate-300",children:"طريقة العد داخل الخلية"}),f.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-slate-700 dark:text-slate-300",children:[f.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"radio",name:"mc-mode",checked:k==="check",onChange:()=>w("check")}),f.jsx("span",{children:"يحسب الصح فقط (✓)"})]}),f.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"radio",name:"mc-mode",checked:k==="cross",onChange:()=>w("cross")}),f.jsx("span",{children:"يحسب الخطأ فقط (✗)"})]}),f.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"radio",name:"mc-mode",checked:k==="both",onChange:()=>w("both")}),f.jsx("span",{children:"يحسب كليهما (✓ و ✗)"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-slate-700 dark:text-slate-300",children:"تسميات اختيارية (مفصولة بفواصل)"}),f.jsx("input",{type:"text",value:y,onChange:L=>E(L.target.value),placeholder:"أسبوع 1, أسبوع 2, ...",className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]})]}),s===ut.LIST&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"columnOptions",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"خيارات القائمة (مفصولة بفاصلة)"}),f.jsx("input",{type:"text",id:"columnOptions",value:c,onChange:L=>u(L.target.value),placeholder:"مثال: ممتاز, جيد جداً, جيد",className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white"})]}),f.jsx("div",{className:"flex flex-col gap-0 mt-4",children:Array.from({length:t}).map((L,X)=>f.jsx("input",{type:s===ut.NUMBER?"number":s===ut.DATE?"date":"text",className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-none focus:ring-emerald-500 focus:border-emerald-500 w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white",style:{marginBottom:0,borderRadius:0,borderTop:X===0?"":"none"},disabled:!0},X))})]}),f.jsxs("div",{className:"flex justify-end gap-4 mt-8 pt-4 border-t border-slate-200 dark:border-slate-700",children:[f.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 focus:z-10 focus:ring-4 focus:ring-slate-200 dark:focus:ring-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-600 dark:hover:text-white dark:hover:bg-slate-700 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"submit",className:"py-2 px-4 text-sm font-medium text-white bg-[#2E8540] rounded-lg hover:bg-[#246b33] focus:ring-4 focus:ring-green-300 dark:focus:ring-green-800 transition-colors",children:"إضافة عمود"})]})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ep=1252,py=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],wu={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yu=function(e){py.indexOf(e)!=-1&&(Ep=wu[0]=e)};function my(){yu(1252)}var Dn=function(e){yu(e)};function Sp(){Dn(1200),my()}function $h(e){for(var r=[],t=0,i=e.length;t<i;++t)r[t]=e.charCodeAt(t);return r}function gy(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function bp(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Ti=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?gy(e.slice(2)):r==254&&t==255?bp(e.slice(2)):r==65279?e.slice(1):e},lo=function(r){return String.fromCharCode(r)},Gh=function(r){return String.fromCharCode(r)},Ui,Aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xh(e){for(var r="",t=0,i=0,s=0,l=0,c=0,u=0,h=0,x=0;x<e.length;)t=e.charCodeAt(x++),l=t>>2,i=e.charCodeAt(x++),c=(t&3)<<4|i>>4,s=e.charCodeAt(x++),u=(i&15)<<2|s>>6,h=s&63,isNaN(i)?u=h=64:isNaN(s)&&(h=64),r+=Aa.charAt(l)+Aa.charAt(c)+Aa.charAt(u)+Aa.charAt(h);return r}function on(e){var r="",t=0,i=0,s=0,l=0,c=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=Aa.indexOf(e.charAt(x++)),c=Aa.indexOf(e.charAt(x++)),t=l<<2|c>>4,r+=String.fromCharCode(t),u=Aa.indexOf(e.charAt(x++)),i=(c&15)<<4|u>>2,u!==64&&(r+=String.fromCharCode(i)),h=Aa.indexOf(e.charAt(x++)),s=(u&3)<<6|h,h!==64&&(r+=String.fromCharCode(s));return r}var pt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ns=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Oa(e){return pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Kh(e){return pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Fn=function(r){return pt?ns(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function as(e){if(Array.isArray(e))return e.map(function(i){return String.fromCharCode(i)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function ku(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ku(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var Na=pt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:ns(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var i=new Uint8Array(t),s=0;for(r=0,t=0;r<e.length;t+=s,++r)if(s=e[r].length,e[r]instanceof Uint8Array)i.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";i.set(new Uint8Array(e[r]),t)}return i}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function vy(e){for(var r=[],t=0,i=e.length+250,s=Oa(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)s[t++]=c;else if(c<2048)s[t++]=192|c>>6&31,s[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++l)&1023;s[t++]=240|c>>8&7,s[t++]=128|c>>2&63,s[t++]=128|u>>6&15|(c&3)<<4,s[t++]=128|u&63}else s[t++]=224|c>>12&15,s[t++]=128|c>>6&63,s[t++]=128|c&63;t>i&&(r.push(s.slice(0,t)),t=0,s=Oa(65535),i=65530)}return r.push(s.slice(0,t)),Na(r)}var $r=/\u0000/g,Ci=/[\u0001-\u0006]/g;function Ps(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function On(e,r){var t=""+e;return t.length>=r?t:$t("0",r-t.length)+t}function Eu(e,r){var t=""+e;return t.length>=r?t:$t(" ",r-t.length)+t}function ko(e,r){var t=""+e;return t.length>=r?t:t+$t(" ",r-t.length)}function wy(e,r){var t=""+Math.round(e);return t.length>=r?t:$t("0",r-t.length)+t}function yy(e,r){var t=""+e;return t.length>=r?t:$t("0",r-t.length)+t}var Yh=Math.pow(2,32);function Os(e,r){if(e>Yh||e<-Yh)return wy(e,r);var t=Math.round(e);return yy(t,r)}function Eo(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Qh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function ky(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Jh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ey={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function So(e,r,t){for(var i=e<0?-1:1,s=e*i,l=0,c=1,u=0,h=1,x=0,p=0,v=Math.floor(s);x<r&&(v=Math.floor(s),u=v*c+l,p=v*x+h,!(s-v<5e-8));)s=1/(s-v),l=c,c=u,h=x,x=p;if(p>r&&(x>r?(p=h,u=l):(p=x,u=c)),!t)return[0,i*u,p];var y=Math.floor(i*u/p);return[y,i*u-y*p,p]}function Qa(e,r,t){if(e>2958465||e<0)return null;var i=e|0,s=Math.floor(86400*(e-i)),l=0,c=[],u={D:i,T:s,u:86400*(e-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),r&&r.date1904&&(i+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++i,++u.D)),i===60)c=t?[1317,10,29]:[1900,2,29],l=3;else if(i===0)c=t?[1317,8,29]:[1900,1,0],l=6;else{i>60&&--i;var h=new Date(1900,0,1);h.setDate(h.getDate()+i-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),i<60&&(l=(l+6)%7),t&&(l=Ny(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var _p=new Date(1899,11,31,0,0,0),Sy=_p.getTime(),by=new Date(1900,2,1,0,0,0);function Tp(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=by&&(t+=1440*60*1e3),(t-(Sy+(e.getTimezoneOffset()-_p.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Su(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _y(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Ty(e){var r=e<0?12:11,t=Su(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function Cy(e){var r=Su(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Hi(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Ty(e):r===10?t=e.toFixed(10).substr(0,12):t=Cy(e),Su(_y(t.toUpperCase()))}function es(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Hi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return yn(14,Tp(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Ny(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Ay(e,r,t,i){var s="",l=0,c=0,u=t.y,h,x=0;switch(e){case 98:u=t.y+543;case 121:switch(r.length){case 1:case 2:h=u%100,x=2;break;default:h=u%1e4,x=4;break}break;case 109:switch(r.length){case 1:case 2:h=t.m,x=r.length;break;case 3:return jc[t.m-1][1];case 5:return jc[t.m-1][0];default:return jc[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:h=t.d,x=r.length;break;case 3:return Qh[t.q][0];default:return Qh[t.q][1]}break;case 104:switch(r.length){case 1:case 2:h=1+(t.H+11)%12,x=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:h=t.H,x=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:h=t.M,x=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?On(t.S,r.length):(i>=2?c=i===3?1e3:100:c=i===1?10:1,l=Math.round(c*(t.S+t.u)),l>=60*c&&(l=0),r==="s"?l===0?"0":""+l/c:(s=On(l,2+i),r==="ss"?s.substr(0,2):"."+s.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":h=t.D*24+t.H;break;case"[m]":case"[mm]":h=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":h=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}x=r.length===3?1:2;break;case 101:h=u,x=1;break}var p=x>0?On(h,x):"";return p}function Fa(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,i=e.substr(0,t);t!=e.length;t+=r)i+=(i.length>0?",":"")+e.substr(t,r);return i}var Cp=/%/g;function Fy(e,r,t){var i=r.replace(Cp,""),s=r.length-i.length;return ea(e,i,t*Math.pow(10,2*s))+$t("%",s)}function Dy(e,r,t){for(var i=r.length-1;r.charCodeAt(i-1)===44;)--i;return ea(e,r.substr(0,i),t/Math.pow(10,3*(r.length-i)))}function Np(e,r){var t,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Np(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%s;if(l<0&&(l+=s),t=(r/Math.pow(10,l)).toPrecision(i+1+(s+l)%s),t.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,x,p){return h+x+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else t=r.toExponential(i);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Ap=/# (\?+)( ?)\/( ?)(\d+)/;function Oy(e,r,t){var i=parseInt(e[4],10),s=Math.round(r*i),l=Math.floor(s/i),c=s-l*i,u=i;return t+(l===0?"":""+l)+" "+(c===0?$t(" ",e[1].length+1+e[4].length):Eu(c,e[1].length)+e[2]+"/"+e[3]+On(u,e[4].length))}function jy(e,r,t){return t+(r===0?"":""+r)+$t(" ",e[1].length+2+e[4].length)}var Fp=/^#*0*\.([0#]+)/,Dp=/\).*[0#]/,Op=/\(###\) ###\\?-####/;function zr(e){for(var r="",t,i=0;i!=e.length;++i)switch(t=e.charCodeAt(i)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function qh(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Zh(e,r){var t=e-Math.floor(e),i=Math.pow(10,r);return r<(""+Math.round(t*i)).length?0:Math.round(t*i)}function Iy(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Ry(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Dp)){var i=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?gn("n",i,t):"("+gn("n",i,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Dy(e,r,t);if(r.indexOf("%")!==-1)return Fy(e,r,t);if(r.indexOf("E")!==-1)return Np(r,t);if(r.charCodeAt(0)===36)return"$"+gn(e,r.substr(r.charAt(1)==" "?2:1),t);var s,l,c,u,h=Math.abs(t),x=t<0?"-":"";if(r.match(/^00+$/))return x+Os(h,r.length);if(r.match(/^[#?]+$/))return s=Os(t,0),s==="0"&&(s=""),s.length>r.length?s:zr(r.substr(0,r.length-s.length))+s;if(l=r.match(Ap))return Oy(l,h,x);if(r.match(/^#+0+$/))return x+Os(h,r.length-r.indexOf("0"));if(l=r.match(Fp))return s=qh(t,l[1].length).replace(/^([^\.]+)$/,"$1."+zr(l[1])).replace(/\.$/,"."+zr(l[1])).replace(/\.(\d*)$/,function(k,w){return"."+w+$t("0",zr(l[1]).length-w.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return x+qh(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return x+Fa(Os(h,0));if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+gn(e,r,-t):Fa(""+(Math.floor(t)+Iy(t,l[1].length)))+"."+On(Zh(t,l[1].length),l[1].length);if(l=r.match(/^#,#*,#0/))return gn(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ps(gn(e,r.replace(/[\\-]/g,""),t)),c=0,Ps(Ps(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return c<s.length?s.charAt(c++):k==="0"?"0":""}));if(r.match(Op))return s=gn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=So(h,Math.pow(10,c)-1,!1),s=""+x,p=ea("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ko(u[2],c),p.length<l[4].length&&(p=zr(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=So(h,Math.pow(10,c)-1,!0),x+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Eu(u[1],c)+l[2]+"/"+l[3]+ko(u[2],c):$t(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return s=Os(t,0),r.length<=s.length?s:zr(r.substr(0,r.length-s.length))+s;if(l=r.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var v=r.indexOf(".")-c,y=r.length-s.length-v;return zr(r.substr(0,v)+s+r.substr(r.length-y))}if(l=r.match(/^00,000\.([#0]*0)$/))return c=Zh(t,l[1].length),t<0?"-"+gn(e,r,-t):Fa(Ry(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?On(0,3-k.length):"")+k})+"."+On(c,l[1].length);switch(r){case"###,##0.00":return gn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var E=Fa(Os(h,0));return E!=="0"?x+E:"";case"###,###.00":return gn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return gn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Py(e,r,t){for(var i=r.length-1;r.charCodeAt(i-1)===44;)--i;return ea(e,r.substr(0,i),t/Math.pow(10,3*(r.length-i)))}function Ly(e,r,t){var i=r.replace(Cp,""),s=r.length-i.length;return ea(e,i,t*Math.pow(10,2*s))+$t("%",s)}function jp(e,r){var t,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+jp(e,-r);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%s;if(l<0&&(l+=s),t=(r/Math.pow(10,l)).toPrecision(i+1+(s+l)%s),!t.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,x,p){return h+x+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else t=r.toExponential(i);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Bn(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Dp)){var i=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Bn("n",i,t):"("+Bn("n",i,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Py(e,r,t);if(r.indexOf("%")!==-1)return Ly(e,r,t);if(r.indexOf("E")!==-1)return jp(r,t);if(r.charCodeAt(0)===36)return"$"+Bn(e,r.substr(r.charAt(1)==" "?2:1),t);var s,l,c,u,h=Math.abs(t),x=t<0?"-":"";if(r.match(/^00+$/))return x+On(h,r.length);if(r.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>r.length?s:zr(r.substr(0,r.length-s.length))+s;if(l=r.match(Ap))return jy(l,h,x);if(r.match(/^#+0+$/))return x+On(h,r.length-r.indexOf("0"));if(l=r.match(Fp))return s=(""+t).replace(/^([^\.]+)$/,"$1."+zr(l[1])).replace(/\.$/,"."+zr(l[1])),s=s.replace(/\.(\d*)$/,function(k,w){return"."+w+$t("0",zr(l[1]).length-w.length)}),r.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return x+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return x+Fa(""+h);if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Bn(e,r,-t):Fa(""+t)+"."+$t("0",l[1].length);if(l=r.match(/^#,#*,#0/))return Bn(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ps(Bn(e,r.replace(/[\\-]/g,""),t)),c=0,Ps(Ps(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return c<s.length?s.charAt(c++):k==="0"?"0":""}));if(r.match(Op))return s=Bn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=So(h,Math.pow(10,c)-1,!1),s=""+x,p=ea("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ko(u[2],c),p.length<l[4].length&&(p=zr(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=So(h,Math.pow(10,c)-1,!0),x+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Eu(u[1],c)+l[2]+"/"+l[3]+ko(u[2],c):$t(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return s=""+t,r.length<=s.length?s:zr(r.substr(0,r.length-s.length))+s;if(l=r.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var v=r.indexOf(".")-c,y=r.length-s.length-v;return zr(r.substr(0,v)+s+r.substr(r.length-y))}if(l=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Bn(e,r,-t):Fa(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?On(0,3-k.length):"")+k})+"."+On(0,l[1].length);switch(r){case"###,###":case"##,###":case"#,###":var E=Fa(""+h);return E!=="0"?x+E:"";default:if(r.match(/\.[0#?]*$/))return Bn(e,r.slice(0,r.lastIndexOf(".")),t)+zr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ea(e,r,t){return(t|0)===t?Bn(e,r,t):gn(e,r,t)}function My(e){for(var r=[],t=!1,i=0,s=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:r[r.length]=e.substr(s,i-s),s=i+1}if(r[r.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Ip=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zs(e){for(var r=0,t="",i="";r<e.length;)switch(t=e.charAt(r)){case"G":Eo(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(i=t;e.charAt(r++)!=="]"&&r<e.length;)i+=e.charAt(r);if(i.match(Ip))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function By(e,r,t,i){for(var s=[],l="",c=0,u="",h="t",x,p,v,y="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Eo(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(v=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(v);s[s.length]={t:"t",v:l},++c;break;case"\\":var E=e.charAt(++c),k=E==="("||E===")"?E:"t";s[s.length]={t:k,v:E},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(x==null&&(x=Qa(r,t,e.charAt(c+1)==="2"),x==null))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||x==null&&(x=Qa(r,t),x==null))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"上":var w={t:u,v:u};if(x==null&&(x=Qa(r,t)),e.substr(c,3).toUpperCase()==="A/P"?(x!=null&&(w.v=x.H>=12?"P":"A"),w.t="T",y="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(x!=null&&(w.v=x.H>=12?"PM":"AM"),w.t="T",c+=5,y="h"):e.substr(c,5).toUpperCase()==="上午/下午"?(x!=null&&(w.v=x.H>=12?"下午":"上午"),w.t="T",c+=5,y="h"):(w.t="t",++c),x==null&&w.t==="T")return"";s[s.length]=w,h=u;break;case"[":for(l=u;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Ip)){if(x==null&&(x=Qa(r,t),x==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",zs(e)||(s[s.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=u;++c<e.length&&(u=e.charAt(c))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:i===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c;break}var S=0,O=0,R;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=y,h="h",S<1&&(S=1);break;case"s":(R=s[c].v.match(/\.0+$/))&&(O=Math.max(O,R[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":h==="s"&&(s[c].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&s[c].v.match(/[Hh]/)&&(S=1),S<2&&s[c].v.match(/[Mm]/)&&(S=2),S<3&&s[c].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var C="",L;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=Ay(s[c].t.charCodeAt(0),s[c].v,x,O),s[c].t="t";break;case"n":case"?":for(L=c+1;s[L]!=null&&((u=s[L].t)==="?"||u==="D"||(u===" "||u==="t")&&s[L+1]!=null&&(s[L+1].t==="?"||s[L+1].t==="t"&&s[L+1].v==="/")||s[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[L].v==="/"||s[L].v===" "&&s[L+1]!=null&&s[L+1].t=="?"));)s[c].v+=s[L].v,s[L]={v:"",t:";"},++L;C+=s[c].v,c=L-1;break;case"G":s[c].t="t",s[c].v=es(r,t);break}var X="",W,M;if(C.length>0){C.charCodeAt(0)==40?(W=r<0&&C.charCodeAt(0)===45?-r:r,M=ea("n",C,W)):(W=r<0&&i>1?-r:r,M=ea("n",C,W),W<0&&s[0]&&s[0].t=="t"&&(M=M.substr(1),s[0].v="-"+s[0].v)),L=M.length-1;var V=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){V=c;break}var G=s.length;if(V===s.length&&M.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(L>=s[c].v.length-1?(L-=s[c].v.length,s[c].v=M.substr(L+1,s[c].v.length)):L<0?s[c].v="":(s[c].v=M.substr(0,L+1),L=-1),s[c].t="t",G=c);L>=0&&G<s.length&&(s[G].v=M.substr(0,L+1)+s[G].v)}else if(V!==s.length&&M.indexOf("E")===-1){for(L=M.indexOf(".")-1,c=V;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(p=s[c].v.indexOf(".")>-1&&c===V?s[c].v.indexOf(".")-1:s[c].v.length-1,X=s[c].v.substr(p+1);p>=0;--p)L>=0&&(s[c].v.charAt(p)==="0"||s[c].v.charAt(p)==="#")&&(X=M.charAt(L--)+X);s[c].v=X,s[c].t="t",G=c}for(L>=0&&G<s.length&&(s[G].v=M.substr(0,L+1)+s[G].v),L=M.indexOf(".")+1,c=V;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==V)){for(p=s[c].v.indexOf(".")>-1&&c===V?s[c].v.indexOf(".")+1:0,X=s[c].v.substr(0,p);p<s[c].v.length;++p)L<M.length&&(X+=M.charAt(L++));s[c].v=X,s[c].t="t",G=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(W=i>1&&r<0&&c>0&&s[c-1].v==="-"?-r:r,s[c].v=ea(s[c].t,s[c].v,W),s[c].t="t");var oe="";for(c=0;c!==s.length;++c)s[c]!=null&&(oe+=s[c].v);return oe}var ex=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tx(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function Uy(e,r){var t=My(e),i=t.length,s=t[i-1].indexOf("@");if(i<4&&s>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(ex),u=t[1].match(ex);return tx(r,c)?[i,t[0]]:tx(r,u)?[i,t[1]]:[i,t[c!=null&&u!=null?2:1]]}return[i,l]}function yn(e,r,t){t==null&&(t={});var i="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?i=t.dateNF:i=e;break;case"number":e==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:ot)[e],i==null&&(i=t.table&&t.table[Jh[e]]||ot[Jh[e]]),i==null&&(i=Ey[e]||"General");break}if(Eo(i,0))return es(r,t);r instanceof Date&&(r=Tp(r,t.date1904));var s=Uy(i,r);if(Eo(s[1]))return es(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return By(s[1],r,t,s[0])}function Ja(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(ot[t]==null){r<0&&(r=t);continue}if(ot[t]==e){r=t;break}}r<0&&(r=391)}return ot[r]=e,r}function Rp(){ot=ky()}var Hy={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Pp=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function zy(e){var r=typeof e=="number"?ot[e]:e;return r=r.replace(Pp,"(\\d+)"),new RegExp("^"+r+"$")}function Wy(e,r,t){var i=-1,s=-1,l=-1,c=-1,u=-1,h=-1;(r.match(Pp)||[]).forEach(function(v,y){var E=parseInt(t[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":i=E;break;case"d":l=E;break;case"h":c=E;break;case"s":h=E;break;case"m":c>=0?u=E:s=E;break}}),h>=0&&u==-1&&s>=0&&(u=s,s=-1);var x=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?x:i==-1&&s==-1&&l==-1?p:x+"T"+p}var Vy=(function(){var e={};e.version="1.2.0";function r(){for(var M=0,V=new Array(256),G=0;G!=256;++G)M=G,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,V[G]=M;return typeof Int32Array<"u"?new Int32Array(V):V}var t=r();function i(M){var V=0,G=0,oe=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(oe=0;oe!=256;++oe)B[oe]=M[oe];for(oe=0;oe!=256;++oe)for(G=M[oe],V=256+oe;V<4096;V+=256)G=B[V]=G>>>8^M[G&255];var K=[];for(oe=1;oe!=16;++oe)K[oe-1]=typeof Int32Array<"u"?B.subarray(oe*256,oe*256+256):B.slice(oe*256,oe*256+256);return K}var s=i(t),l=s[0],c=s[1],u=s[2],h=s[3],x=s[4],p=s[5],v=s[6],y=s[7],E=s[8],k=s[9],w=s[10],S=s[11],O=s[12],R=s[13],C=s[14];function L(M,V){for(var G=V^-1,oe=0,B=M.length;oe<B;)G=G>>>8^t[(G^M.charCodeAt(oe++))&255];return~G}function X(M,V){for(var G=V^-1,oe=M.length-15,B=0;B<oe;)G=C[M[B++]^G&255]^R[M[B++]^G>>8&255]^O[M[B++]^G>>16&255]^S[M[B++]^G>>>24]^w[M[B++]]^k[M[B++]]^E[M[B++]]^y[M[B++]]^v[M[B++]]^p[M[B++]]^x[M[B++]]^h[M[B++]]^u[M[B++]]^c[M[B++]]^l[M[B++]]^t[M[B++]];for(oe+=15;B<oe;)G=G>>>8^t[(G^M[B++])&255];return~G}function W(M,V){for(var G=V^-1,oe=0,B=M.length,K=0,me=0;oe<B;)K=M.charCodeAt(oe++),K<128?G=G>>>8^t[(G^K)&255]:K<2048?(G=G>>>8^t[(G^(192|K>>6&31))&255],G=G>>>8^t[(G^(128|K&63))&255]):K>=55296&&K<57344?(K=(K&1023)+64,me=M.charCodeAt(oe++)&1023,G=G>>>8^t[(G^(240|K>>8&7))&255],G=G>>>8^t[(G^(128|K>>2&63))&255],G=G>>>8^t[(G^(128|me>>6&15|(K&3)<<4))&255],G=G>>>8^t[(G^(128|me&63))&255]):(G=G>>>8^t[(G^(224|K>>12&15))&255],G=G>>>8^t[(G^(128|K>>6&63))&255],G=G>>>8^t[(G^(128|K&63))&255]);return~G}return e.table=t,e.bstr=L,e.buf=X,e.str=W,e})(),mt=(function(){var r={};r.version="1.2.1";function t(b,P){for(var A=b.split("/"),D=P.split("/"),F=0,j=0,q=Math.min(A.length,D.length);F<q;++F){if(j=A[F].length-D[F].length)return j;if(A[F]!=D[F])return A[F]<D[F]?-1:1}return A.length-D.length}function i(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:i(b.slice(0,-1));var P=b.lastIndexOf("/");return P===-1?b:b.slice(0,P+1)}function s(b){if(b.charAt(b.length-1)=="/")return s(b.slice(0,-1));var P=b.lastIndexOf("/");return P===-1?b:b.slice(P+1)}function l(b,P){typeof P=="string"&&(P=new Date(P));var A=P.getHours();A=A<<6|P.getMinutes(),A=A<<5|P.getSeconds()>>>1,b.write_shift(2,A);var D=P.getFullYear()-1980;D=D<<4|P.getMonth()+1,D=D<<5|P.getDate(),b.write_shift(2,D)}function c(b){var P=b.read_shift(2)&65535,A=b.read_shift(2)&65535,D=new Date,F=A&31;A>>>=5;var j=A&15;A>>>=4,D.setMilliseconds(0),D.setFullYear(A+1980),D.setMonth(j-1),D.setDate(F);var q=P&31;P>>>=5;var ce=P&63;return P>>>=6,D.setHours(P),D.setMinutes(ce),D.setSeconds(q<<1),D}function u(b){kr(b,0);for(var P={},A=0;b.l<=b.length-4;){var D=b.read_shift(2),F=b.read_shift(2),j=b.l+F,q={};switch(D){case 21589:A=b.read_shift(1),A&1&&(q.mtime=b.read_shift(4)),F>5&&(A&2&&(q.atime=b.read_shift(4)),A&4&&(q.ctime=b.read_shift(4))),q.mtime&&(q.mt=new Date(q.mtime*1e3));break}b.l=j,P[D]=q}return P}var h;function x(){return h||(h={})}function p(b,P){if(b[0]==80&&b[1]==75)return xt(b,P);if((b[0]|32)==109&&(b[1]|32)==105)return Et(b,P);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var A=3,D=512,F=0,j=0,q=0,ce=0,te=0,re=[],ae=b.slice(0,512);kr(ae,0);var ve=v(ae);switch(A=ve[0],A){case 3:D=512;break;case 4:D=4096;break;case 0:if(ve[1]==0)return xt(b,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}D!==512&&(ae=b.slice(0,D),kr(ae,28));var Ae=b.slice(0,D);y(ae,A);var Me=ae.read_shift(4,"i");if(A===3&&Me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Me);ae.l+=4,q=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),ce=ae.read_shift(4,"i"),F=ae.read_shift(4,"i"),te=ae.read_shift(4,"i"),j=ae.read_shift(4,"i");for(var Fe=-1,Ce=0;Ce<109&&(Fe=ae.read_shift(4,"i"),!(Fe<0));++Ce)re[Ce]=Fe;var Ye=E(b,D);S(te,j,Ye,D,re);var Nt=R(Ye,q,re,D);Nt[q].name="!Directory",F>0&&ce!==me&&(Nt[ce].name="!MiniFAT"),Nt[re[0]].name="!FAT",Nt.fat_addrs=re,Nt.ssz=D;var lt={},yt=[],Mr=[],Br=[];C(q,Nt,Ye,yt,F,lt,Mr,ce),k(Mr,Br,yt),yt.shift();var vr={FileIndex:Mr,FullPaths:Br};return P&&P.raw&&(vr.raw={header:Ae,sectors:Ye}),vr}function v(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(he,"Header Signature: "),b.l+=16;var P=b.read_shift(2,"u");return[b.read_shift(2,"u"),P]}function y(b,P){var A=9;switch(b.l+=2,A=b.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function E(b,P){for(var A=Math.ceil(b.length/P)-1,D=[],F=1;F<A;++F)D[F-1]=b.slice(F*P,(F+1)*P);return D[A-1]=b.slice(A*P),D}function k(b,P,A){for(var D=0,F=0,j=0,q=0,ce=0,te=A.length,re=[],ae=[];D<te;++D)re[D]=ae[D]=D,P[D]=A[D];for(;ce<ae.length;++ce)D=ae[ce],F=b[D].L,j=b[D].R,q=b[D].C,re[D]===D&&(F!==-1&&re[F]!==F&&(re[D]=re[F]),j!==-1&&re[j]!==j&&(re[D]=re[j])),q!==-1&&(re[q]=D),F!==-1&&D!=re[D]&&(re[F]=re[D],ae.lastIndexOf(F)<ce&&ae.push(F)),j!==-1&&D!=re[D]&&(re[j]=re[D],ae.lastIndexOf(j)<ce&&ae.push(j));for(D=1;D<te;++D)re[D]===D&&(j!==-1&&re[j]!==j?re[D]=re[j]:F!==-1&&re[F]!==F&&(re[D]=re[F]));for(D=1;D<te;++D)if(b[D].type!==0){if(ce=D,ce!=re[ce])do ce=re[ce],P[D]=P[ce]+"/"+P[D];while(ce!==0&&re[ce]!==-1&&ce!=re[ce]);re[D]=-1}for(P[0]+="/",D=1;D<te;++D)b[D].type!==2&&(P[D]+="/")}function w(b,P,A){for(var D=b.start,F=b.size,j=[],q=D;A&&F>0&&q>=0;)j.push(P.slice(q*K,q*K+K)),F-=K,q=Ya(A,q*4);return j.length===0?lr(0):Na(j).slice(0,b.size)}function S(b,P,A,D,F){var j=me;if(b===me){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var q=A[b],ce=(D>>>2)-1;if(!q)return;for(var te=0;te<ce&&(j=Ya(q,te*4))!==me;++te)F.push(j);S(Ya(q,D-4),P-1,A,D,F)}}function O(b,P,A,D,F){var j=[],q=[];F||(F=[]);var ce=D-1,te=0,re=0;for(te=P;te>=0;){F[te]=!0,j[j.length]=te,q.push(b[te]);var ae=A[Math.floor(te*4/D)];if(re=te*4&ce,D<4+re)throw new Error("FAT boundary crossed: "+te+" 4 "+D);if(!b[ae])break;te=Ya(b[ae],re)}return{nodes:j,data:fx([q])}}function R(b,P,A,D){var F=b.length,j=[],q=[],ce=[],te=[],re=D-1,ae=0,ve=0,Ae=0,Me=0;for(ae=0;ae<F;++ae)if(ce=[],Ae=ae+P,Ae>=F&&(Ae-=F),!q[Ae]){te=[];var Fe=[];for(ve=Ae;ve>=0;){Fe[ve]=!0,q[ve]=!0,ce[ce.length]=ve,te.push(b[ve]);var Ce=A[Math.floor(ve*4/D)];if(Me=ve*4&re,D<4+Me)throw new Error("FAT boundary crossed: "+ve+" 4 "+D);if(!b[Ce]||(ve=Ya(b[Ce],Me),Fe[ve]))break}j[Ae]={nodes:ce,data:fx([te])}}return j}function C(b,P,A,D,F,j,q,ce){for(var te=0,re=D.length?2:0,ae=P[b].data,ve=0,Ae=0,Me;ve<ae.length;ve+=128){var Fe=ae.slice(ve,ve+128);kr(Fe,64),Ae=Fe.read_shift(2),Me=Nu(Fe,0,Ae-re),D.push(Me);var Ce={name:Me,type:Fe.read_shift(1),color:Fe.read_shift(1),L:Fe.read_shift(4,"i"),R:Fe.read_shift(4,"i"),C:Fe.read_shift(4,"i"),clsid:Fe.read_shift(16),state:Fe.read_shift(4,"i"),start:0,size:0},Ye=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Ye!==0&&(Ce.ct=L(Fe,Fe.l-8));var Nt=Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2)+Fe.read_shift(2);Nt!==0&&(Ce.mt=L(Fe,Fe.l-8)),Ce.start=Fe.read_shift(4,"i"),Ce.size=Fe.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=me,Ce.name=""),Ce.type===5?(te=Ce.start,F>0&&te!==me&&(P[te].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",P[Ce.start]===void 0&&(P[Ce.start]=O(A,Ce.start,P.fat_addrs,P.ssz)),P[Ce.start].name=Ce.name,Ce.content=P[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:te!==me&&Ce.start!==me&&P[te]&&(Ce.content=w(Ce,P[te].data,(P[ce]||{}).data))),Ce.content&&kr(Ce.content,0),j[Me]=Ce,q.push(Ce)}}function L(b,P){return new Date((sn(b,P+4)/1e7*Math.pow(2,32)+sn(b,P)/1e7-11644473600)*1e3)}function X(b,P){return x(),p(h.readFileSync(b),P)}function W(b,P){var A=P&&P.type;switch(A||pt&&Buffer.isBuffer(b)&&(A="buffer"),A||"base64"){case"file":return X(b,P);case"base64":return p(Fn(on(b)),P);case"binary":return p(Fn(b),P)}return p(b,P)}function M(b,P){var A=P||{},D=A.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=D+"/",b.FileIndex[0]={name:D,type:5}),A.CLSID&&(b.FileIndex[0].clsid=A.CLSID),V(b)}function V(b){var P="Sh33tJ5";if(!mt.find(b,"/"+P)){var A=lr(4);A[0]=55,A[1]=A[3]=50,A[2]=54,b.FileIndex.push({name:P,type:2,content:A,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+P),G(b)}}function G(b,P){M(b);for(var A=!1,D=!1,F=b.FullPaths.length-1;F>=0;--F){var j=b.FileIndex[F];switch(j.type){case 0:D?A=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(j.R*j.L*j.C)&&(A=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!P)){var q=new Date(1987,1,19),ce=0,te=Object.create?Object.create(null):{},re=[];for(F=0;F<b.FullPaths.length;++F)te[b.FullPaths[F]]=!0,b.FileIndex[F].type!==0&&re.push([b.FullPaths[F],b.FileIndex[F]]);for(F=0;F<re.length;++F){var ae=i(re[F][0]);D=te[ae],D||(re.push([ae,{name:s(ae).replace("/",""),type:1,clsid:Oe,ct:q,mt:q,content:null}]),te[ae]=!0)}for(re.sort(function(Me,Fe){return t(Me[0],Fe[0])}),b.FullPaths=[],b.FileIndex=[],F=0;F<re.length;++F)b.FullPaths[F]=re[F][0],b.FileIndex[F]=re[F][1];for(F=0;F<re.length;++F){var ve=b.FileIndex[F],Ae=b.FullPaths[F];if(ve.name=s(Ae).replace("/",""),ve.L=ve.R=ve.C=-(ve.color=1),ve.size=ve.content?ve.content.length:0,ve.start=0,ve.clsid=ve.clsid||Oe,F===0)ve.C=re.length>1?1:-1,ve.size=0,ve.type=5;else if(Ae.slice(-1)=="/"){for(ce=F+1;ce<re.length&&i(b.FullPaths[ce])!=Ae;++ce);for(ve.C=ce>=re.length?-1:ce,ce=F+1;ce<re.length&&i(b.FullPaths[ce])!=i(Ae);++ce);ve.R=ce>=re.length?-1:ce,ve.type=1}else i(b.FullPaths[F+1]||"")==i(Ae)&&(ve.R=F+1),ve.type=2}}}function oe(b,P){var A=P||{};if(A.fileType=="mad")return Kt(b,A);switch(G(b),A.fileType){case"zip":return st(b,A)}var D=(function(Me){for(var Fe=0,Ce=0,Ye=0;Ye<Me.FileIndex.length;++Ye){var Nt=Me.FileIndex[Ye];if(Nt.content){var lt=Nt.content.length;lt>0&&(lt<4096?Fe+=lt+63>>6:Ce+=lt+511>>9)}}for(var yt=Me.FullPaths.length+3>>2,Mr=Fe+7>>3,Br=Fe+127>>7,vr=Mr+Ce+yt+Br,Wt=vr+127>>7,$s=Wt<=109?0:Math.ceil((Wt-109)/127);vr+Wt+$s+127>>7>Wt;)$s=++Wt<=109?0:Math.ceil((Wt-109)/127);var Yt=[1,$s,Wt,Br,yt,Ce,Fe,0];return Me.FileIndex[0].size=Fe<<6,Yt[7]=(Me.FileIndex[0].start=Yt[0]+Yt[1]+Yt[2]+Yt[3]+Yt[4]+Yt[5])+(Yt[6]+7>>3),Yt})(b),F=lr(D[7]<<9),j=0,q=0;{for(j=0;j<8;++j)F.write_shift(1,we[j]);for(j=0;j<8;++j)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),j=0;j<3;++j)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,D[2]),F.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:me),F.write_shift(4,D[3]),F.write_shift(-4,D[1]?D[0]-1:me),F.write_shift(4,D[1]),j=0;j<109;++j)F.write_shift(-4,j<D[2]?D[1]+j:-1)}if(D[1])for(q=0;q<D[1];++q){for(;j<236+q*127;++j)F.write_shift(-4,j<D[2]?D[1]+j:-1);F.write_shift(-4,q===D[1]-1?me:q+1)}var ce=function(Me){for(q+=Me;j<q-1;++j)F.write_shift(-4,j+1);Me&&(++j,F.write_shift(-4,me))};for(q=j=0,q+=D[1];j<q;++j)F.write_shift(-4,Ee.DIFSECT);for(q+=D[2];j<q;++j)F.write_shift(-4,Ee.FATSECT);ce(D[3]),ce(D[4]);for(var te=0,re=0,ae=b.FileIndex[0];te<b.FileIndex.length;++te)ae=b.FileIndex[te],ae.content&&(re=ae.content.length,!(re<4096)&&(ae.start=q,ce(re+511>>9)));for(ce(D[6]+7>>3);F.l&511;)F.write_shift(-4,Ee.ENDOFCHAIN);for(q=j=0,te=0;te<b.FileIndex.length;++te)ae=b.FileIndex[te],ae.content&&(re=ae.content.length,!(!re||re>=4096)&&(ae.start=q,ce(re+63>>6)));for(;F.l&511;)F.write_shift(-4,Ee.ENDOFCHAIN);for(j=0;j<D[4]<<2;++j){var ve=b.FullPaths[j];if(!ve||ve.length===0){for(te=0;te<17;++te)F.write_shift(4,0);for(te=0;te<3;++te)F.write_shift(4,-1);for(te=0;te<12;++te)F.write_shift(4,0);continue}ae=b.FileIndex[j],j===0&&(ae.start=ae.size?ae.start-1:me);var Ae=j===0&&A.root||ae.name;if(re=2*(Ae.length+1),F.write_shift(64,Ae,"utf16le"),F.write_shift(2,re),F.write_shift(1,ae.type),F.write_shift(1,ae.color),F.write_shift(-4,ae.L),F.write_shift(-4,ae.R),F.write_shift(-4,ae.C),ae.clsid)F.write_shift(16,ae.clsid,"hex");else for(te=0;te<4;++te)F.write_shift(4,0);F.write_shift(4,ae.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,ae.start),F.write_shift(4,ae.size),F.write_shift(4,0)}for(j=1;j<b.FileIndex.length;++j)if(ae=b.FileIndex[j],ae.size>=4096)if(F.l=ae.start+1<<9,pt&&Buffer.isBuffer(ae.content))ae.content.copy(F,F.l,0,ae.size),F.l+=ae.size+511&-512;else{for(te=0;te<ae.size;++te)F.write_shift(1,ae.content[te]);for(;te&511;++te)F.write_shift(1,0)}for(j=1;j<b.FileIndex.length;++j)if(ae=b.FileIndex[j],ae.size>0&&ae.size<4096)if(pt&&Buffer.isBuffer(ae.content))ae.content.copy(F,F.l,0,ae.size),F.l+=ae.size+63&-64;else{for(te=0;te<ae.size;++te)F.write_shift(1,ae.content[te]);for(;te&63;++te)F.write_shift(1,0)}if(pt)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function B(b,P){var A=b.FullPaths.map(function(te){return te.toUpperCase()}),D=A.map(function(te){var re=te.split("/");return re[re.length-(te.slice(-1)=="/"?2:1)]}),F=!1;P.charCodeAt(0)===47?(F=!0,P=A[0].slice(0,-1)+P):F=P.indexOf("/")!==-1;var j=P.toUpperCase(),q=F===!0?A.indexOf(j):D.indexOf(j);if(q!==-1)return b.FileIndex[q];var ce=!j.match(Ci);for(j=j.replace($r,""),ce&&(j=j.replace(Ci,"!")),q=0;q<A.length;++q)if((ce?A[q].replace(Ci,"!"):A[q]).replace($r,"")==j||(ce?D[q].replace(Ci,"!"):D[q]).replace($r,"")==j)return b.FileIndex[q];return null}var K=64,me=-2,he="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],Oe="00000000000000000000000000000000",Ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:he,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Se(b,P,A){x();var D=oe(b,A);h.writeFileSync(P,D)}function Y(b){for(var P=new Array(b.length),A=0;A<b.length;++A)P[A]=String.fromCharCode(b[A]);return P.join("")}function xe(b,P){var A=oe(b,P);switch(P&&P.type||"buffer"){case"file":return x(),h.writeFileSync(P.filename,A),A;case"binary":return typeof A=="string"?A:Y(A);case"base64":return Xh(typeof A=="string"?A:Y(A));case"buffer":if(pt)return Buffer.isBuffer(A)?A:ns(A);case"array":return typeof A=="string"?Fn(A):A}return A}var z;function T(b){try{var P=b.InflateRaw,A=new P;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)z=b;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function J(b,P){if(!z)return et(b,P);var A=z.InflateRaw,D=new A,F=D._processChunk(b.slice(b.l),D._finishFlushFlag);return b.l+=D.bytesRead,F}function H(b){return z?z.deflateRawSync(b):Ze(b)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(b){var P=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(P>>16|P>>8|P)&255}for(var le=typeof Uint8Array<"u",de=le?new Uint8Array(256):[],pe=0;pe<256;++pe)de[pe]=ye(pe);function N(b,P){var A=de[b&255];return P<=8?A>>>8-P:(A=A<<8|de[b>>8&255],P<=16?A>>>16-P:(A=A<<8|de[b>>16&255],A>>>24-P))}function _e(b,P){var A=P&7,D=P>>>3;return(b[D]|(A<=6?0:b[D+1]<<8))>>>A&3}function Ne(b,P){var A=P&7,D=P>>>3;return(b[D]|(A<=5?0:b[D+1]<<8))>>>A&7}function Qe(b,P){var A=P&7,D=P>>>3;return(b[D]|(A<=4?0:b[D+1]<<8))>>>A&15}function Ge(b,P){var A=P&7,D=P>>>3;return(b[D]|(A<=3?0:b[D+1]<<8))>>>A&31}function Pe(b,P){var A=P&7,D=P>>>3;return(b[D]|(A<=1?0:b[D+1]<<8))>>>A&127}function St(b,P,A){var D=P&7,F=P>>>3,j=(1<<A)-1,q=b[F]>>>D;return A<8-D||(q|=b[F+1]<<8-D,A<16-D)||(q|=b[F+2]<<16-D,A<24-D)||(q|=b[F+3]<<24-D),q&j}function Ft(b,P,A){var D=P&7,F=P>>>3;return D<=5?b[F]|=(A&7)<<D:(b[F]|=A<<D&255,b[F+1]=(A&7)>>8-D),P+3}function Dt(b,P,A){var D=P&7,F=P>>>3;return A=(A&1)<<D,b[F]|=A,P+1}function Xt(b,P,A){var D=P&7,F=P>>>3;return A<<=D,b[F]|=A&255,A>>>=8,b[F+1]=A,P+8}function Rr(b,P,A){var D=P&7,F=P>>>3;return A<<=D,b[F]|=A&255,A>>>=8,b[F+1]=A&255,b[F+2]=A>>>8,P+16}function gr(b,P){var A=b.length,D=2*A>P?2*A:P+5,F=0;if(A>=P)return b;if(pt){var j=Kh(D);if(b.copy)b.copy(j);else for(;F<b.length;++F)j[F]=b[F];return j}else if(le){var q=new Uint8Array(D);if(q.set)q.set(b);else for(;F<A;++F)q[F]=b[F];return q}return b.length=D,b}function qt(b){for(var P=new Array(b),A=0;A<b;++A)P[A]=0;return P}function nr(b,P,A){var D=1,F=0,j=0,q=0,ce=0,te=b.length,re=le?new Uint16Array(32):qt(32);for(j=0;j<32;++j)re[j]=0;for(j=te;j<A;++j)b[j]=0;te=b.length;var ae=le?new Uint16Array(te):qt(te);for(j=0;j<te;++j)re[F=b[j]]++,D<F&&(D=F),ae[j]=0;for(re[0]=0,j=1;j<=D;++j)re[j+16]=ce=ce+re[j-1]<<1;for(j=0;j<te;++j)ce=b[j],ce!=0&&(ae[j]=re[ce+16]++);var ve=0;for(j=0;j<te;++j)if(ve=b[j],ve!=0)for(ce=N(ae[j],D)>>D-ve,q=(1<<D+4-ve)-1;q>=0;--q)P[ce|q<<ve]=ve&15|j<<4;return D}var Pr=le?new Uint16Array(512):qt(512),Lr=le?new Uint16Array(32):qt(32);if(!le){for(var It=0;It<512;++It)Pr[It]=0;for(It=0;It<32;++It)Lr[It]=0}(function(){for(var b=[],P=0;P<32;P++)b.push(5);nr(b,Lr,32);var A=[];for(P=0;P<=143;P++)A.push(8);for(;P<=255;P++)A.push(9);for(;P<=279;P++)A.push(7);for(;P<=287;P++)A.push(8);nr(A,Pr,288)})();var ur=(function(){for(var P=le?new Uint8Array(32768):[],A=0,D=0;A<fe.length-1;++A)for(;D<fe[A+1];++D)P[D]=A;for(;D<32768;++D)P[D]=29;var F=le?new Uint8Array(259):[];for(A=0,D=0;A<ne.length-1;++A)for(;D<ne[A+1];++D)F[D]=A;function j(ce,te){for(var re=0;re<ce.length;){var ae=Math.min(65535,ce.length-re),ve=re+ae==ce.length;for(te.write_shift(1,+ve),te.write_shift(2,ae),te.write_shift(2,~ae&65535);ae-- >0;)te[te.l++]=ce[re++]}return te.l}function q(ce,te){for(var re=0,ae=0,ve=le?new Uint16Array(32768):[];ae<ce.length;){var Ae=Math.min(65535,ce.length-ae);if(Ae<10){for(re=Ft(te,re,+(ae+Ae==ce.length)),re&7&&(re+=8-(re&7)),te.l=re/8|0,te.write_shift(2,Ae),te.write_shift(2,~Ae&65535);Ae-- >0;)te[te.l++]=ce[ae++];re=te.l*8;continue}re=Ft(te,re,+(ae+Ae==ce.length)+2);for(var Me=0;Ae-- >0;){var Fe=ce[ae];Me=(Me<<5^Fe)&32767;var Ce=-1,Ye=0;if((Ce=ve[Me])&&(Ce|=ae&-32768,Ce>ae&&(Ce-=32768),Ce<ae))for(;ce[Ce+Ye]==ce[ae+Ye]&&Ye<250;)++Ye;if(Ye>2){Fe=F[Ye],Fe<=22?re=Xt(te,re,de[Fe+1]>>1)-1:(Xt(te,re,3),re+=5,Xt(te,re,de[Fe-23]>>5),re+=3);var Nt=Fe<8?0:Fe-4>>2;Nt>0&&(Rr(te,re,Ye-ne[Fe]),re+=Nt),Fe=P[ae-Ce],re=Xt(te,re,de[Fe]>>3),re-=3;var lt=Fe<4?0:Fe-2>>1;lt>0&&(Rr(te,re,ae-Ce-fe[Fe]),re+=lt);for(var yt=0;yt<Ye;++yt)ve[Me]=ae&32767,Me=(Me<<5^ce[ae])&32767,++ae;Ae-=Ye-1}else Fe<=143?Fe=Fe+48:re=Dt(te,re,1),re=Xt(te,re,de[Fe]),ve[Me]=ae&32767,++ae}re=Xt(te,re,0)-1}return te.l=(re+7)/8|0,te.l}return function(te,re){return te.length<8?j(te,re):q(te,re)}})();function Ze(b){var P=lr(50+Math.floor(b.length*1.1)),A=ur(b,P);return P.slice(0,A)}var ht=le?new Uint16Array(32768):qt(32768),ar=le?new Uint16Array(32768):qt(32768),_t=le?new Uint16Array(128):qt(128),ge=1,Be=1;function Ie(b,P){var A=Ge(b,P)+257;P+=5;var D=Ge(b,P)+1;P+=5;var F=Qe(b,P)+4;P+=4;for(var j=0,q=le?new Uint8Array(19):qt(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,re=le?new Uint8Array(8):qt(8),ae=le?new Uint8Array(8):qt(8),ve=q.length,Ae=0;Ae<F;++Ae)q[I[Ae]]=j=Ne(b,P),te<j&&(te=j),re[j]++,P+=3;var Me=0;for(re[0]=0,Ae=1;Ae<=te;++Ae)ae[Ae]=Me=Me+re[Ae-1]<<1;for(Ae=0;Ae<ve;++Ae)(Me=q[Ae])!=0&&(ce[Ae]=ae[Me]++);var Fe=0;for(Ae=0;Ae<ve;++Ae)if(Fe=q[Ae],Fe!=0){Me=de[ce[Ae]]>>8-Fe;for(var Ce=(1<<7-Fe)-1;Ce>=0;--Ce)_t[Me|Ce<<Fe]=Fe&7|Ae<<3}var Ye=[];for(te=1;Ye.length<A+D;)switch(Me=_t[Pe(b,P)],P+=Me&7,Me>>>=3){case 16:for(j=3+_e(b,P),P+=2,Me=Ye[Ye.length-1];j-- >0;)Ye.push(Me);break;case 17:for(j=3+Ne(b,P),P+=3;j-- >0;)Ye.push(0);break;case 18:for(j=11+Pe(b,P),P+=7;j-- >0;)Ye.push(0);break;default:Ye.push(Me),te<Me&&(te=Me);break}var Nt=Ye.slice(0,A),lt=Ye.slice(A);for(Ae=A;Ae<286;++Ae)Nt[Ae]=0;for(Ae=D;Ae<30;++Ae)lt[Ae]=0;return ge=nr(Nt,ht,286),Be=nr(lt,ar,30),P}function Le(b,P){if(b[0]==3&&!(b[1]&3))return[Oa(P),2];for(var A=0,D=0,F=Kh(P||1<<18),j=0,q=F.length>>>0,ce=0,te=0;(D&1)==0;){if(D=Ne(b,A),A+=3,D>>>1)D>>1==1?(ce=9,te=5):(A=Ie(b,A),ce=ge,te=Be);else{A&7&&(A+=8-(A&7));var re=b[A>>>3]|b[(A>>>3)+1]<<8;if(A+=32,re>0)for(!P&&q<j+re&&(F=gr(F,j+re),q=F.length);re-- >0;)F[j++]=b[A>>>3],A+=8;continue}for(;;){!P&&q<j+32767&&(F=gr(F,j+32767),q=F.length);var ae=St(b,A,ce),ve=D>>>1==1?Pr[ae]:ht[ae];if(A+=ve&15,ve>>>=4,(ve>>>8&255)===0)F[j++]=ve;else{if(ve==256)break;ve-=257;var Ae=ve<8?0:ve-4>>2;Ae>5&&(Ae=0);var Me=j+ne[ve];Ae>0&&(Me+=St(b,A,Ae),A+=Ae),ae=St(b,A,te),ve=D>>>1==1?Lr[ae]:ar[ae],A+=ve&15,ve>>>=4;var Fe=ve<4?0:ve-2>>1,Ce=fe[ve];for(Fe>0&&(Ce+=St(b,A,Fe),A+=Fe),!P&&q<Me&&(F=gr(F,Me+100),q=F.length);j<Me;)F[j]=F[j-Ce],++j}}}return P?[F,A+7>>>3]:[F.slice(0,j),A+7>>>3]}function et(b,P){var A=b.slice(b.l||0),D=Le(A,P);return b.l+=D[1],D[0]}function Ke(b,P){if(b)typeof console<"u"&&console.error(P);else throw new Error(P)}function xt(b,P){var A=b;kr(A,0);var D=[],F=[],j={FileIndex:D,FullPaths:F};M(j,{root:P.root});for(var q=A.length-4;(A[q]!=80||A[q+1]!=75||A[q+2]!=5||A[q+3]!=6)&&q>=0;)--q;A.l=q+4,A.l+=4;var ce=A.read_shift(2);A.l+=6;var te=A.read_shift(4);for(A.l=te,q=0;q<ce;++q){A.l+=20;var re=A.read_shift(4),ae=A.read_shift(4),ve=A.read_shift(2),Ae=A.read_shift(2),Me=A.read_shift(2);A.l+=8;var Fe=A.read_shift(4),Ce=u(A.slice(A.l+ve,A.l+ve+Ae));A.l+=ve+Ae+Me;var Ye=A.l;A.l=Fe+4,dt(A,re,ae,j,Ce),A.l=Ye}return j}function dt(b,P,A,D,F){b.l+=2;var j=b.read_shift(2),q=b.read_shift(2),ce=c(b);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var te=b.read_shift(4),re=b.read_shift(4),ae=b.read_shift(4),ve=b.read_shift(2),Ae=b.read_shift(2),Me="",Fe=0;Fe<ve;++Fe)Me+=String.fromCharCode(b[b.l++]);if(Ae){var Ce=u(b.slice(b.l,b.l+Ae));(Ce[21589]||{}).mt&&(ce=Ce[21589].mt),((F||{})[21589]||{}).mt&&(ce=F[21589].mt)}b.l+=Ae;var Ye=b.slice(b.l,b.l+re);switch(q){case 8:Ye=J(b,ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var Nt=!1;j&8&&(te=b.read_shift(4),te==134695760&&(te=b.read_shift(4),Nt=!0),re=b.read_shift(4),ae=b.read_shift(4)),re!=P&&Ke(Nt,"Bad compressed size: "+P+" != "+re),ae!=A&&Ke(Nt,"Bad uncompressed size: "+A+" != "+ae),ke(D,Me,Ye,{unsafe:!0,mt:ce})}function st(b,P){var A=P||{},D=[],F=[],j=lr(1),q=A.compression?8:0,ce=0,te=0,re=0,ae=0,ve=0,Ae=b.FullPaths[0],Me=Ae,Fe=b.FileIndex[0],Ce=[],Ye=0;for(te=1;te<b.FullPaths.length;++te)if(Me=b.FullPaths[te].slice(Ae.length),Fe=b.FileIndex[te],!(!Fe.size||!Fe.content||Me=="Sh33tJ5")){var Nt=ae,lt=lr(Me.length);for(re=0;re<Me.length;++re)lt.write_shift(1,Me.charCodeAt(re)&127);lt=lt.slice(0,lt.l),Ce[ve]=Vy.buf(Fe.content,0);var yt=Fe.content;q==8&&(yt=H(yt)),j=lr(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,ce),j.write_shift(2,q),Fe.mt?l(j,Fe.mt):j.write_shift(4,0),j.write_shift(-4,Ce[ve]),j.write_shift(4,yt.length),j.write_shift(4,Fe.content.length),j.write_shift(2,lt.length),j.write_shift(2,0),ae+=j.length,D.push(j),ae+=lt.length,D.push(lt),ae+=yt.length,D.push(yt),j=lr(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,ce),j.write_shift(2,q),j.write_shift(4,0),j.write_shift(-4,Ce[ve]),j.write_shift(4,yt.length),j.write_shift(4,Fe.content.length),j.write_shift(2,lt.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,Nt),Ye+=j.l,F.push(j),Ye+=lt.length,F.push(lt),++ve}return j=lr(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,ve),j.write_shift(2,ve),j.write_shift(4,Ye),j.write_shift(4,ae),j.write_shift(2,0),Na([Na(D),Na(F),j])}var bt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ut(b,P){if(b.ctype)return b.ctype;var A=b.name||"",D=A.match(/\.([^\.]+)$/);return D&&bt[D[1]]||P&&(D=(A=P).match(/[\.\\]([^\.\\])+$/),D&&bt[D[1]])?bt[D[1]]:"application/octet-stream"}function Rt(b){for(var P=Xh(b),A=[],D=0;D<P.length;D+=76)A.push(P.slice(D,D+76));return A.join(`\r
`)+`\r
`}function nt(b){var P=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ae=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],D=P.split(`\r
`),F=0;F<D.length;++F){var j=D[F];if(j.length==0){A.push("");continue}for(var q=0;q<j.length;){var ce=76,te=j.slice(q,q+ce);te.charAt(ce-1)=="="?ce--:te.charAt(ce-2)=="="?ce-=2:te.charAt(ce-3)=="="&&(ce-=3),te=j.slice(q,q+ce),q+=ce,q<j.length&&(te+="="),A.push(te)}}return A.join(`\r
`)}function Tt(b){for(var P=[],A=0;A<b.length;++A){for(var D=b[A];A<=b.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+b[++A];P.push(D)}for(var F=0;F<P.length;++F)P[F]=P[F].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return Fn(P.join(`\r
`))}function Ct(b,P,A){for(var D="",F="",j="",q,ce=0;ce<10;++ce){var te=P[ce];if(!te||te.match(/^\s*$/))break;var re=te.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":D=re[2].trim();break;case"content-type":j=re[2].trim();break;case"content-transfer-encoding":F=re[2].trim();break}}switch(++ce,F.toLowerCase()){case"base64":q=Fn(on(P.slice(ce).join("")));break;case"quoted-printable":q=Tt(P.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var ae=ke(b,D.slice(A.length),q,{unsafe:!0});j&&(ae.ctype=j)}function Et(b,P){if(Y(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=P&&P.root||"",D=(pt&&Buffer.isBuffer(b)?b.toString("binary"):Y(b)).split(`\r
`),F=0,j="";for(F=0;F<D.length;++F)if(j=D[F],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),A||(A=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),j.slice(0,A.length)!=A););var q=(D[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var ce="--"+(q[1]||""),te=[],re=[],ae={FileIndex:te,FullPaths:re};M(ae);var ve,Ae=0;for(F=0;F<D.length;++F){var Me=D[F];Me!==ce&&Me!==ce+"--"||(Ae++&&Ct(ae,D.slice(ve,F),A),ve=F)}return ae}function Kt(b,P){var A=P||{},D=A.boundary||"SheetJS";D="------="+D;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],j=b.FullPaths[0],q=j,ce=b.FileIndex[0],te=1;te<b.FullPaths.length;++te)if(q=b.FullPaths[te].slice(j.length),ce=b.FileIndex[te],!(!ce.size||!ce.content||q=="Sh33tJ5")){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var re=ce.content,ae=pt&&Buffer.isBuffer(re)?re.toString("binary"):Y(re),ve=0,Ae=Math.min(1024,ae.length),Me=0,Fe=0;Fe<=Ae;++Fe)(Me=ae.charCodeAt(Fe))>=32&&Me<128&&++ve;var Ce=ve>=Ae*4/5;F.push(D),F.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+q),F.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),F.push("Content-Type: "+Ut(ce,q)),F.push(""),F.push(Ce?nt(ae):Rt(ae))}return F.push(D+`--\r
`),F.join(`\r
`)}function Xr(b){var P={};return M(P,b),P}function ke(b,P,A,D){var F=D&&D.unsafe;F||M(b);var j=!F&&mt.find(b,P);if(!j){var q=b.FullPaths[0];P.slice(0,q.length)==q?q=P:(q.slice(-1)!="/"&&(q+="/"),q=(q+P).replace("//","/")),j={name:s(P),type:2},b.FileIndex.push(j),b.FullPaths.push(q),F||mt.utils.cfb_gc(b)}return j.content=A,j.size=A?A.length:0,D&&(D.CLSID&&(j.clsid=D.CLSID),D.mt&&(j.mt=D.mt),D.ct&&(j.ct=D.ct)),j}function je(b,P){M(b);var A=mt.find(b,P);if(A){for(var D=0;D<b.FileIndex.length;++D)if(b.FileIndex[D]==A)return b.FileIndex.splice(D,1),b.FullPaths.splice(D,1),!0}return!1}function Ue(b,P,A){M(b);var D=mt.find(b,P);if(D){for(var F=0;F<b.FileIndex.length;++F)if(b.FileIndex[F]==D)return b.FileIndex[F].name=s(A),b.FullPaths[F]=A,!0}return!1}function at(b){G(b,!0)}return r.find=B,r.read=W,r.parse=p,r.write=xe,r.writeFile=Se,r.utils={cfb_new:Xr,cfb_add:ke,cfb_del:je,cfb_mov:Ue,cfb_gc:at,ReadShift:Di,CheckField:a1,prep_blob:kr,bconcat:Na,use_zlib:T,_deflateRaw:Ze,_inflateRaw:et,consts:Ee},r})();function $y(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+e)}function Hn(e){for(var r=Object.keys(e),t=[],i=0;i<r.length;++i)Object.prototype.hasOwnProperty.call(e,r[i])&&t.push(r[i]);return t}function bu(e){for(var r=[],t=Hn(e),i=0;i!==t.length;++i)r[e[t[i]]]=t[i];return r}var bo=new Date(1899,11,30,0,0,0);function Gr(e,r){var t=e.getTime(),i=bo.getTime()+(e.getTimezoneOffset()-bo.getTimezoneOffset())*6e4;return(t-i)/(1440*60*1e3)}var Lp=new Date,Gy=bo.getTime()+(Lp.getTimezoneOffset()-bo.getTimezoneOffset())*6e4,rx=Lp.getTimezoneOffset();function Mo(e){var r=new Date;return r.setTime(e*24*60*60*1e3+Gy),r.getTimezoneOffset()!==rx&&r.setTime(r.getTime()+(r.getTimezoneOffset()-rx)*6e4),r}function Xy(e){var r=0,t=0,i=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(t=1,l>3&&(i=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":t*=24;case"H":t*=60;case"M":if(i)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(s[l],10)}return r}var nx=new Date("2017-02-19T19:06:09.000Z"),Mp=isNaN(nx.getFullYear())?new Date("2/19/17"):nx,Ky=Mp.getFullYear()==2017;function mr(e,r){var t=new Date(e);if(Ky)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Mp.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return e.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function ts(e,r){if(pt&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Ai(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ai(bp(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Ai(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ai(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(l){return t[l]||l})}catch{}for(var i=[],s=0;s!=e.length;++s)i.push(String.fromCharCode(e[s]));return i.join("")}function Er(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Er(e[t]));return r}function $t(e,r){for(var t="";t.length<r;)t+=e;return t}function jn(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,l){return t=-t,l}),!isNaN(r=Number(i)))?r/t:r}var Yy=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bs(e){var r=new Date(e),t=new Date(NaN),i=r.getYear(),s=r.getMonth(),l=r.getDate();if(isNaN(l))return t;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&Yy.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return i<0||i>8099?t:(s>0||l>1)&&i!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Qy=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,i,s){if(e||typeof i=="string")return t.split(i);for(var l=t.split(i),c=[l[0]],u=1;u<l.length;++u)c.push(s),c.push(l[u]);return c}})();function Bp(e){return e?e.content&&e.type?ts(e.content,!0):e.data?Ti(e.data):e.asNodeBuffer&&pt?Ti(e.asNodeBuffer().toString("binary")):e.asBinary?Ti(e.asBinary()):e._data&&e._data.getContent?Ti(ts(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Up(e){if(!e)return null;if(e.data)return $h(e.data);if(e.asNodeBuffer&&pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?$h(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Jy(e){return e&&e.name.slice(-4)===".bin"?Up(e):Bp(e)}function vn(e,r){for(var t=e.FullPaths||Hn(e.files),i=r.toLowerCase().replace(/[\/]/g,"\\"),s=i.replace(/\\/g,"/"),l=0;l<t.length;++l){var c=t[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==c||s==c)return e.files?e.files[t[l]]:e.FileIndex[l]}return null}function _u(e,r){var t=vn(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function tr(e,r,t){if(!t)return Jy(_u(e,r));if(!r)return null;try{return tr(e,r)}catch{return null}}function ln(e,r,t){if(!t)return Bp(_u(e,r));if(!r)return null;try{return ln(e,r)}catch{return null}}function qy(e,r,t){return Up(_u(e,r))}function ax(e){for(var r=e.FullPaths||Hn(e.files),t=[],i=0;i<r.length;++i)r[i].slice(-1)!="/"&&t.push(r[i].replace(/^Root Entry[\/]/,""));return t.sort()}function Zy(e,r,t){if(e.FullPaths){if(typeof t=="string"){var i;return pt?i=ns(t):i=vy(t),mt.utils.cfb_add(e,r,i)}mt.utils.cfb_add(e,r,t)}else e.file(r,t)}function Hp(e,r){switch(r.type){case"base64":return mt.read(e,{type:"base64"});case"binary":return mt.read(e,{type:"binary"});case"buffer":case"array":return mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Ni(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var i=e.split("/");i.length!==0;){var s=i.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var zp=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ek=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,sx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tk=/<[^>]*>/g,Ir=zp.match(sx)?sx:tk,rk=/<\w*:/,nk=/<(\/?)\w+:/;function tt(e,r,t){for(var i={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(r||(i[0]=e.slice(0,s)),s===e.length)return i;var c=e.match(ek),u=0,h="",x=0,p="",v="",y=1;if(c)for(x=0;x!=c.length;++x){for(v=c[x],l=0;l!=v.length&&v.charCodeAt(l)!==61;++l);for(p=v.slice(0,l).trim();v.charCodeAt(l+1)==32;)++l;for(y=(s=v.charCodeAt(l+1))==34||s==39?1:0,h=v.slice(l+1+y,v.length-y),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),i[p]=h,i[p.toLowerCase()]=h;else{var E=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(i[E]&&p.slice(u-3,u)=="ext")continue;i[E]=h,i[E.toLowerCase()]=h}}return i}function zn(e){return e.replace(nk,"<$1")}var Wp={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ak=bu(Wp),wt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(i){var s=i+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,h){return Wp[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(r,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=s.indexOf("]]>");return t(s.slice(0,l))+s.slice(l+9,c)+t(s.slice(c+3))}})(),sk=/[&<>'"]/g,ik=/[\u0000-\u001f]/g;function Tu(e){var r=e+"";return r.replace(sk,function(t){return ak[t]}).replace(/\n/g,"<br/>").replace(ik,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var ix=(function(){var e=/&#(\d+);/g;function r(t,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(e,r)}})();function Bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ic(e){for(var r="",t=0,i=0,s=0,l=0,c=0,u=0;t<e.length;){if(i=e.charCodeAt(t++),i<128){r+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),i>191&&i<224){c=(i&31)<<6,c|=s&63,r+=String.fromCharCode(c);continue}if(l=e.charCodeAt(t++),i<240){r+=String.fromCharCode((i&15)<<12|(s&63)<<6|l&63);continue}c=e.charCodeAt(t++),u=((i&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(u>>>10&1023)),r+=String.fromCharCode(56320+(u&1023))}return r}function lx(e){var r=Oa(2*e.length),t,i,s=1,l=0,c=0,u;for(i=0;i<e.length;i+=s)s=1,(u=e.charCodeAt(i))<128?t=u:u<224?(t=(u&31)*64+(e.charCodeAt(i+1)&63),s=2):u<240?(t=(u&15)*4096+(e.charCodeAt(i+1)&63)*64+(e.charCodeAt(i+2)&63),s=3):(s=4,t=(u&7)*262144+(e.charCodeAt(i+1)&63)*4096+(e.charCodeAt(i+2)&63)*64+(e.charCodeAt(i+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(r[l++]=c&255,r[l++]=c>>>8,c=0),r[l++]=t%256,r[l++]=t>>>8;return r.slice(0,l).toString("ucs2")}function ox(e){return ns(e,"binary").toString("utf8")}var oo="foo bar bazâð£",jt=pt&&(ox(oo)==Ic(oo)&&ox||lx(oo)==Ic(oo)&&lx)||Ic,Ai=pt?function(e){return ns(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,i=0,s=0;t<e.length;)switch(i=e.charCodeAt(t++),!0){case i<128:r.push(String.fromCharCode(i));break;case i<2048:r.push(String.fromCharCode(192+(i>>6))),r.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=e.charCodeAt(t++)-56320+(i<<10),r.push(String.fromCharCode(240+(s>>18&7))),r.push(String.fromCharCode(144+(s>>12&63))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)));break;default:r.push(String.fromCharCode(224+(i>>12))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)))}return r.join("")},zi=(function(){var e={};return function(t,i){var s=t+"|"+(i||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",i||"")}})(),Vp=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)i=i.replace(e[s][0],e[s][1]);return i}})(),lk=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),ok=/<\/?(?:vt:)?variant>/g,ck=/<(?:vt:)([^>]*)>([\s\S]*)</;function cx(e,r){var t=tt(e),i=e.match(lk(t.baseType))||[],s=[];if(i.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+i.length+" != "+t.size);return s}return i.forEach(function(l){var c=l.replace(ok,"").match(ck);c&&s.push({v:jt(c[2]),t:c[1]})}),s}var uk=/(^\s|\s$|\n)/;function fk(e){return Hn(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function dk(e,r,t){return"<"+e+(t!=null?fk(t):"")+(r!=null?(r.match(uk)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Cu(e){if(pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return jt(as(ku(e)));throw new Error("Bad input format: expected Buffer or string")}var Wi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,hk={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},xk=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function pk(e,r){for(var t=1-2*(e[r+7]>>>7),i=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),s=e[r+6]&15,l=5;l>=0;--l)s=s*256+e[r+l];return i==2047?s==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),t*Math.pow(2,i-52)*s)}function mk(e,r,t){var i=(r<0||1/r==-1/0?1:0)<<7,s=0,l=0,c=i?-r:r;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(r)?26985:0);for(var u=0;u<=5;++u,l/=256)e[t+u]=l&255;e[t+6]=(s&15)<<4|l&15,e[t+7]=s>>4|i}var ux=function(e){for(var r=[],t=10240,i=0;i<e[0].length;++i)if(e[0][i])for(var s=0,l=e[0][i].length;s<l;s+=t)r.push.apply(r,e[0][i].slice(s,s+t));return r},fx=pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:ns(r)})):ux(e)}:ux,dx=function(e,r,t){for(var i=[],s=r;s<t;s+=2)i.push(String.fromCharCode(Zn(e,s)));return i.join("").replace($r,"")},Nu=pt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace($r,""):dx(e,r,t)}:dx,hx=function(e,r,t){for(var i=[],s=r;s<r+t;++s)i.push(("0"+e[s].toString(16)).slice(-2));return i.join("")},$p=pt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):hx(e,r,t)}:hx,xx=function(e,r,t){for(var i=[],s=r;s<t;s++)i.push(String.fromCharCode(js(e,s)));return i.join("")},Qi=pt?function(r,t,i){return Buffer.isBuffer(r)?r.toString("utf8",t,i):xx(r,t,i)}:xx,Gp=function(e,r){var t=sn(e,r);return t>0?Qi(e,r+4,r+4+t-1):""},Xp=Gp,Kp=function(e,r){var t=sn(e,r);return t>0?Qi(e,r+4,r+4+t-1):""},Yp=Kp,Qp=function(e,r){var t=2*sn(e,r);return t>0?Qi(e,r+4,r+4+t-1):""},Jp=Qp,qp=function(r,t){var i=sn(r,t);return i>0?Nu(r,t+4,t+4+i):""},Zp=qp,e1=function(e,r){var t=sn(e,r);return t>0?Qi(e,r+4,r+4+t):""},t1=e1,r1=function(e,r){return pk(e,r)},_o=r1,n1=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};pt&&(Xp=function(r,t){if(!Buffer.isBuffer(r))return Gp(r,t);var i=r.readUInt32LE(t);return i>0?r.toString("utf8",t+4,t+4+i-1):""},Yp=function(r,t){if(!Buffer.isBuffer(r))return Kp(r,t);var i=r.readUInt32LE(t);return i>0?r.toString("utf8",t+4,t+4+i-1):""},Jp=function(r,t){if(!Buffer.isBuffer(r))return Qp(r,t);var i=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+i-1)},Zp=function(r,t){if(!Buffer.isBuffer(r))return qp(r,t);var i=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+i)},t1=function(r,t){if(!Buffer.isBuffer(r))return e1(r,t);var i=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+i)},_o=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):r1(r,t)},n1=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var js=function(e,r){return e[r]},Zn=function(e,r){return e[r+1]*256+e[r]},gk=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},sn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ya=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},vk=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Di(e,r){var t="",i,s,l=[],c,u,h,x;switch(r){case"dbcs":if(x=this.l,pt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)t+=String.fromCharCode(Zn(this,x)),x+=2;e*=2;break;case"utf8":t=Qi(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Nu(this,this.l,this.l+e);break;case"wstr":return Di.call(this,e,"dbcs");case"lpstr-ansi":t=Xp(this,this.l),e=4+sn(this,this.l);break;case"lpstr-cp":t=Yp(this,this.l),e=4+sn(this,this.l);break;case"lpwstr":t=Jp(this,this.l),e=4+2*sn(this,this.l);break;case"lpp4":e=4+sn(this,this.l),t=Zp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+sn(this,this.l),t=t1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(c=js(this,this.l+e++))!==0;)l.push(lo(c));t=l.join("");break;case"_wstr":for(e=0,t="";(c=Zn(this,this.l+e))!==0;)l.push(lo(c)),e+=2;e+=2,t=l.join("");break;case"dbcs-cont":for(t="",x=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(x)!==-1)return c=js(this,x),this.l=x+1,u=Di.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(lo(Zn(this,x))),x+=2}t=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",x=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(x)!==-1)return c=js(this,x),this.l=x+1,u=Di.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(lo(js(this,x))),x+=1}t=l.join("");break;default:switch(e){case 1:return i=js(this,this.l),this.l++,i;case 2:return i=(r==="i"?gk:Zn)(this,this.l),this.l+=2,i;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(i=(e>0?Ya:vk)(this,this.l),this.l+=4,i):(s=sn(this,this.l),this.l+=4,s);case 8:case-8:if(r==="f")return e==8?s=_o(this,this.l):s=_o([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=$p(this,this.l,e);break}}return this.l+=e,t}var wk=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},yk=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},kk=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function Ek(e,r,t){var i=0,s=0;if(t==="dbcs"){for(s=0;s!=r.length;++s)kk(this,r.charCodeAt(s),this.l+2*s);i=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=r.length;++s)this[this.l+s]=r.charCodeAt(s)&255;i=r.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(r.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(r.length,e);++s){var c=r.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:i=1,this[this.l]=r&255;break;case 2:i=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:i=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:i=4,wk(this,r,this.l);break;case 8:if(i=8,t==="f"){mk(this,r,this.l);break}case 16:break;case-4:i=4,yk(this,r,this.l);break}return this.l+=i,this}function a1(e,r){var t=$p(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function kr(e,r){e.l=r,e.read_shift=Di,e.chk=a1,e.write_shift=Ek}function jr(e,r){e.l+=r}function lr(e){var r=Oa(e);return kr(r,0),r}function sa(e,r,t){if(e){var i,s,l;kr(e,e.l||0);for(var c=e.length,u=0,h=0;e.l<c;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var x=Do[u]||Do[65535];for(i=e.read_shift(1),l=i&127,s=1;s<4&&i&128;++s)l+=((i=e.read_shift(1))&127)<<7*s;h=e.l+l;var p=x.f&&x.f(e,l,t);if(e.l=h,r(p,x,u))return}}}function Zc(){var e=[],r=pt?256:2048,t=function(x){var p=lr(x);return kr(p,0),p},i=t(r),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&e.push(i),i=null)},l=function(x){return i&&x<i.length-i.l?i:(s(),i=t(Math.max(x+1,r)))},c=function(){return s(),Na(e)},u=function(x){s(),i=x,i.l==null&&(i.l=i.length),l(r)};return{next:l,push:u,end:c,_bufs:e}}function Oi(e,r,t){var i=Er(e);if(r.s?(i.cRel&&(i.c+=r.s.c),i.rRel&&(i.r+=r.s.r)):(i.cRel&&(i.c+=r.c),i.rRel&&(i.r+=r.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function px(e,r,t){var i=Er(e);return i.s=Oi(i.s,r.s,t),i.e=Oi(i.e,r.s,t),i}function ji(e,r){if(e.cRel&&e.c<0)for(e=Er(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Er(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=it(e);return!e.cRel&&e.cRel!=null&&(t=_k(t)),!e.rRel&&e.rRel!=null&&(t=Sk(t)),t}function Rc(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+or(e.s.c)+":"+(e.e.cRel?"":"$")+or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sr(e.s.r)+":"+(e.e.rRel?"":"$")+Sr(e.e.r):ji(e.s,r.biff)+":"+ji(e.e,r.biff)}function Au(e){return parseInt(bk(e),10)-1}function Sr(e){return""+(e+1)}function Sk(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function bk(e){return e.replace(/\$(\d+)$/,"$1")}function Fu(e){for(var r=Tk(e),t=0,i=0;i!==r.length;++i)t=26*t+r.charCodeAt(i)-64;return t-1}function or(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function _k(e){return e.replace(/^([A-Z])/,"$$$1")}function Tk(e){return e.replace(/^\$([A-Z])/,"$1")}function Ck(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Vr(e){for(var r=0,t=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);s>=48&&s<=57?r=10*r+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:r-1}}function it(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Ws(e){var r=e.indexOf(":");return r==-1?{s:Vr(e),e:Vr(e)}:{s:Vr(e.slice(0,r)),e:Vr(e.slice(r+1))}}function gt(e,r){return typeof r>"u"||typeof r=="number"?gt(e.s,e.e):(typeof e!="string"&&(e=it(e)),typeof r!="string"&&(r=it(r)),e==r?e:e+":"+r)}function Gt(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,s=0,l=e.length;for(t=0;i<l&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(r.s.c=--t,t=0;i<l&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;if(r.s.r=--t,i===l||s!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++i,t=0;i!=l&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(r.e.c=--t,t=0;i!=l&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;return r.e.r=--t,r}function mx(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=yn(e.z,t?Gr(r):r)}catch{}try{return e.w=yn((e.XF||{}).numFmtId||(t?14:0),t?Gr(r):r)}catch{return""+r}}function aa(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?ls[e.v]||e.v:r==null?mx(e,e.v):mx(e,r))}function Ra(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",i={};return i[t]=e,{SheetNames:[t],Sheets:i}}function s1(e,r,t){var i=t||{},s=e?Array.isArray(e):i.dense,l=e||(s?[]:{}),c=0,u=0;if(l&&i.origin!=null){if(typeof i.origin=="number")c=i.origin;else{var h=typeof i.origin=="string"?Vr(i.origin):i.origin;c=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=Gt(l["!ref"]);x.s.c=p.s.c,x.s.r=p.s.r,x.e.c=Math.max(x.e.c,p.e.c),x.e.r=Math.max(x.e.r,p.e.r),c==-1&&(x.e.r=c=p.e.r+1)}for(var v=0;v!=r.length;++v)if(r[v]){if(!Array.isArray(r[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=r[v].length;++y)if(!(typeof r[v][y]>"u")){var E={v:r[v][y]},k=c+v,w=u+y;if(x.s.r>k&&(x.s.r=k),x.s.c>w&&(x.s.c=w),x.e.r<k&&(x.e.r=k),x.e.c<w&&(x.e.c=w),r[v][y]&&typeof r[v][y]=="object"&&!Array.isArray(r[v][y])&&!(r[v][y]instanceof Date))E=r[v][y];else if(Array.isArray(E.v)&&(E.f=r[v][y][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(i.nullError)E.t="e",E.v=0;else if(i.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=i.dateNF||ot[14],i.cellDates?(E.t="d",E.w=yn(E.z,Gr(E.v))):(E.t="n",E.v=Gr(E.v),E.w=yn(E.z,E.v))):E.t="s";if(s)l[k]||(l[k]=[]),l[k][w]&&l[k][w].z&&(E.z=l[k][w].z),l[k][w]=E;else{var S=it({c:w,r:k});l[S]&&l[S].z&&(E.z=l[S].z),l[S]=E}}}return x.s.c<1e7&&(l["!ref"]=gt(x)),l}function Vs(e,r){return s1(null,e,r)}function Nk(e){return e.read_shift(4,"i")}function Or(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Ak(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Du(e,r){var t=e.l,i=e.read_shift(1),s=Or(e),l=[],c={t:s,h:s};if((i&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(Ak(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=t+r,c}var Fk=Du;function kn(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function ss(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var Dk=Or;function Ou(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var Ok=Or,eu=Ou;function ju(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,i=r[0]&2;e.l+=4;var s=i===0?_o([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ya(r,0)>>2;return t?s/100:s}function i1(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var is=i1;function Fr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function jk(e){var r={},t=e.read_shift(1),i=t>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,i){case 0:r.auto=1;break;case 1:r.index=s;var x=qa[s];x&&(r.rgb=$i(x));break;case 2:r.rgb=$i([c,u,h]);break;case 3:r.theme=s;break}return l!=0&&(r.tint=l>0?l/32767:l/32768),r}function Ik(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function l1(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=e.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Rk(e){return l1(e,1)}function Pk(e){return l1(e,2)}var Iu=2,en=3,co=11,gx=12,To=19,uo=64,Lk=65,Mk=71,Bk=4108,Uk=4126,pr=80,o1=81,Hk=[pr,o1],zk={1:{n:"CodePage",t:Iu},2:{n:"Category",t:pr},3:{n:"PresentationFormat",t:pr},4:{n:"ByteCount",t:en},5:{n:"LineCount",t:en},6:{n:"ParagraphCount",t:en},7:{n:"SlideCount",t:en},8:{n:"NoteCount",t:en},9:{n:"HiddenCount",t:en},10:{n:"MultimediaClipCount",t:en},11:{n:"ScaleCrop",t:co},12:{n:"HeadingPairs",t:Bk},13:{n:"TitlesOfParts",t:Uk},14:{n:"Manager",t:pr},15:{n:"Company",t:pr},16:{n:"LinksUpToDate",t:co},17:{n:"CharacterCount",t:en},19:{n:"SharedDoc",t:co},22:{n:"HyperlinksChanged",t:co},23:{n:"AppVersion",t:en,p:"version"},24:{n:"DigSig",t:Lk},26:{n:"ContentType",t:pr},27:{n:"ContentStatus",t:pr},28:{n:"Language",t:pr},29:{n:"Version",t:pr},255:{},2147483648:{n:"Locale",t:To},2147483651:{n:"Behavior",t:To},1919054434:{}},Wk={1:{n:"CodePage",t:Iu},2:{n:"Title",t:pr},3:{n:"Subject",t:pr},4:{n:"Author",t:pr},5:{n:"Keywords",t:pr},6:{n:"Comments",t:pr},7:{n:"Template",t:pr},8:{n:"LastAuthor",t:pr},9:{n:"RevNumber",t:pr},10:{n:"EditTime",t:uo},11:{n:"LastPrinted",t:uo},12:{n:"CreatedDate",t:uo},13:{n:"ModifiedDate",t:uo},14:{n:"PageCount",t:en},15:{n:"WordCount",t:en},16:{n:"CharCount",t:en},17:{n:"Thumbnail",t:Mk},18:{n:"Application",t:pr},19:{n:"DocSecurity",t:en},255:{},2147483648:{n:"Locale",t:To},2147483651:{n:"Behavior",t:To},1919054434:{}},vx={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Vk=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $k(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Gk=$k([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qa=Er(Gk),ls={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},c1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},wx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Xk(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Kk(e){var r=Xk();if(!e||!e.match)return r;var t={};if((e.match(Ir)||[]).forEach(function(i){var s=tt(i);switch(s[0].replace(rk,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":r[wx[s.ContentType]]!==void 0&&r[wx[s.ContentType]].push(s.PartName);break}}),r.xmlns!==hk.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var Is={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tu(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Ii(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var i={};return(e.match(Ir)||[]).forEach(function(s){var l=tt(s);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Ni(l.Target,r);t[u]=c,i[l.Id]=c}}),t["!id"]=i,t}var Yk="application/vnd.oasis.opendocument.spreadsheet";function Qk(e,r){for(var t=Cu(e),i,s;i=Wi.exec(t);)switch(i[3]){case"manifest":break;case"file-entry":if(s=tt(i[0],!1),s.path=="/"&&s.type!==Yk)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw i}}var Ri=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Jk=(function(){for(var e=new Array(Ri.length),r=0;r<Ri.length;++r){var t=Ri[r],i="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return e})();function u1(e){var r={};e=jt(e);for(var t=0;t<Ri.length;++t){var i=Ri[t],s=e.match(Jk[t]);s!=null&&s.length>0&&(r[i[1]]=wt(s[1])),i[2]==="date"&&r[i[1]]&&(r[i[1]]=mr(r[i[1]]))}return r}var qk=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function f1(e,r,t,i){var s=[];if(typeof e=="string")s=cx(e,i);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(p){return{v:p}}));var c=typeof r=="string"?cx(r,i).map(function(p){return p.v}):r,u=0,h=0;if(c.length>0)for(var x=0;x!==s.length;x+=2){switch(h=+s[x+1].v,s[x].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=h,t.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=h,t.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":t.Chartsheets=h,t.ChartNames=c.slice(u,u+h);break}u+=h}}function Zk(e,r,t){var i={};return r||(r={}),e=jt(e),qk.forEach(function(s){var l=(e.match(zi(s[0]))||[])[1];switch(s[2]){case"string":l&&(r[s[1]]=wt(l));break;case"bool":r[s[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));c&&c.length>0&&(i[s[1]]=c[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&f1(i.HeadingPairs,i.TitlesOfParts,r,t),r}var e4=/<[^>]+>[^<]*/g;function t4(e,r){var t={},i="",s=e.match(e4);if(s)for(var l=0;l!=s.length;++l){var c=s[l],u=tt(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":i=wt(u.name);break;case"</property>":i=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),x=h[0].slice(4),p=h[1];switch(x){case"lpstr":case"bstr":case"lpwstr":t[i]=wt(p);break;case"bool":t[i]=Bt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[i]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[i]=parseFloat(p);break;case"filetime":case"date":t[i]=mr(p);break;case"cy":case"error":t[i]=wt(p);break;default:if(x.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",c,x,h)}}else if(c.slice(0,2)!=="</"){if(r.WTF)throw new Error(c)}}}return t}var r4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Pc;function n4(e,r,t){Pc||(Pc=bu(r4)),r=Pc[r]||r,e[r]=t}function Ru(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function d1(e,r,t){var i=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-i&3;)++e.l;return s}function h1(e,r,t){var i=e.read_shift(0,"lpwstr");return i}function x1(e,r,t){return r===31?h1(e):d1(e,r,t)}function ru(e,r,t){return x1(e,r,t===!1?0:4)}function a4(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return x1(e,r,0)}function s4(e){for(var r=e.read_shift(4),t=[],i=0;i!=r;++i){var s=e.l;t[i]=e.read_shift(0,"lpwstr").replace($r,""),e.l-s&2&&(e.l+=2)}return t}function i4(e){for(var r=e.read_shift(4),t=[],i=0;i!=r;++i)t[i]=e.read_shift(0,"lpstr-cp").replace($r,"");return t}function l4(e){var r=e.l,t=Co(e,o1);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var i=Co(e,en);return[t,i]}function o4(e){for(var r=e.read_shift(4),t=[],i=0;i<r/2;++i)t.push(l4(e));return t}function yx(e,r){for(var t=e.read_shift(4),i={},s=0;s!=t;++s){var l=e.read_shift(4),c=e.read_shift(4);i[l]=e.read_shift(c,r===1200?"utf16le":"utf8").replace($r,"").replace(Ci,"!"),r===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),i}function p1(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function c4(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Co(e,r,t){var i=e.read_shift(2),s,l=t||{};if(e.l+=2,r!==gx&&i!==r&&Hk.indexOf(r)===-1&&!((r&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+r+" saw "+i);switch(r===gx?i:r){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return d1(e,i,4).replace($r,"");case 31:return h1(e);case 64:return Ru(e);case 65:return p1(e);case 71:return c4(e);case 80:return ru(e,i,!l.raw).replace($r,"");case 81:return a4(e,i).replace($r,"");case 4108:return o4(e);case 4126:case 4127:return i==4127?s4(e):i4(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+i)}}function kx(e,r){var t=e.l,i=e.read_shift(4),s=e.read_shift(4),l=[],c=0,u=0,h=-1,x={};for(c=0;c!=s;++c){var p=e.read_shift(4),v=e.read_shift(4);l[c]=[p,v+t]}l.sort(function(R,C){return R[1]-C[1]});var y={};for(c=0;c!=s;++c){if(e.l!==l[c][1]){var E=!0;if(c>0&&r)switch(r[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,E=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break}if((!r||c==0)&&e.l<=l[c][1]&&(E=!1,e.l=l[c][1]),E)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(r){var k=r[l[c][0]];if(y[k.n]=Co(e,k.t,{raw:!0}),k.p==="version"&&(y[k.n]=String(y[k.n]>>16)+"."+("0000"+String(y[k.n]&65535)).slice(-4)),k.n=="CodePage")switch(y[k.n]){case 0:y[k.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Dn(u=y[k.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[k.n])}}else if(l[c][0]===1){if(u=y.CodePage=Co(e,Iu),Dn(u),h!==-1){var w=e.l;e.l=l[h][1],x=yx(e,u),e.l=w}}else if(l[c][0]===0){if(u===0){h=c,e.l=l[c+1][1];continue}x=yx(e,u)}else{var S=x[l[c][0]],O;switch(e[e.l]){case 65:e.l+=4,O=p1(e);break;case 30:e.l+=4,O=ru(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,O=ru(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,O=e.read_shift(4,"i");break;case 19:e.l+=4,O=e.read_shift(4);break;case 5:e.l+=4,O=e.read_shift(8,"f");break;case 11:e.l+=4,O=Jt(e,4);break;case 64:e.l+=4,O=mr(Ru(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[S]=O}}return e.l=t+i,y}function Ex(e,r,t){var i=e.content;if(!i)return{};kr(i,0);var s,l,c,u,h=0;i.chk("feff","Byte Order: "),i.read_shift(2);var x=i.read_shift(4),p=i.read_shift(16);if(p!==mt.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(s=i.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=i.read_shift(16),u=i.read_shift(4),s===1&&u!==i.l)throw new Error("Length mismatch: "+u+" !== "+i.l);s===2&&(c=i.read_shift(16),h=i.read_shift(4));var v=kx(i,r),y={SystemIdentifier:x};for(var E in v)y[E]=v[E];if(y.FMTID=l,s===1)return y;if(h-i.l==2&&(i.l+=2),i.l!==h)throw new Error("Length mismatch 2: "+i.l+" !== "+h);var k;try{k=kx(i,null)}catch{}for(E in k)y[E]=k[E];return y.FMTID=[l,c],y}function Ta(e,r){return e.read_shift(r),null}function u4(e,r,t){for(var i=[],s=e.l+r;e.l<s;)i.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return i}function Jt(e,r){return e.read_shift(r)===1}function rr(e){return e.read_shift(2,"u")}function m1(e,r){return u4(e,r,rr)}function f4(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Ji(e,r,t){var i=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var c=i?e.read_shift(i,s):"";return c}function d4(e){var r=e.read_shift(2),t=e.read_shift(1),i=t&4,s=t&8,l=1+(t&1),c=0,u,h={};s&&(c=e.read_shift(2)),i&&(u=e.read_shift(4));var x=l==2?"dbcs-cont":"sbcs-cont",p=r===0?"":e.read_shift(r,x);return s&&(e.l+=4*c),i&&(e.l+=u),h.t=p,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function rs(e,r,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var s=e.read_shift(1);return s===0?i=e.read_shift(r,"sbcs-cont"):i=e.read_shift(r,"dbcs-cont"),i}function qi(e,r,t){var i=e.read_shift(t&&t.biff==2?1:2);return i===0?(e.l++,""):rs(e,i,t)}function os(e,r,t){if(t.biff>5)return qi(e,r,t);var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function h4(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function x4(e){var r=e.read_shift(4),t=e.l,i=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),e.l=t);var s=e.read_shift((i?r-24:r)>>1,"utf16le").replace($r,"");return i&&(e.l+=24),s}function p4(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var i=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+i.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace($r,"");return t+c}function m4(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return x4(e);case"0303000000000000c000000000000046":return p4(e);default:throw new Error("Unsupported Moniker "+t)}}function fo(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace($r,""):"";return t}function g4(e,r){var t=e.l+r,i=e.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var s=e.read_shift(2);e.l+=2;var l,c,u,h,x="",p,v;s&16&&(l=fo(e,t-e.l)),s&128&&(c=fo(e,t-e.l)),(s&257)===257&&(u=fo(e,t-e.l)),(s&257)===1&&(h=m4(e,t-e.l)),s&8&&(x=fo(e,t-e.l)),s&32&&(p=e.read_shift(16)),s&64&&(v=Ru(e)),e.l=t;var y=c||u||h||"";y&&x&&(y+="#"+x),y||(y="#"+x),s&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var E={Target:y};return p&&(E.guid=p),v&&(E.time=v),l&&(E.Tooltip=l),E}function g1(e){var r=e.read_shift(1),t=e.read_shift(1),i=e.read_shift(1),s=e.read_shift(1);return[r,t,i,s]}function v1(e,r){var t=g1(e);return t[3]=0,t}function Wn(e){var r=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2);return{r,c:t,ixfe:i}}function v4(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function w4(e,r,t){return r===0?"":os(e,r,t)}function y4(e,r,t){var i=t.biff>8?4:2,s=e.read_shift(i),l=e.read_shift(i,"i"),c=e.read_shift(i,"i");return[s,l,c]}function w1(e){var r=e.read_shift(2),t=ju(e);return[r,t]}function k4(e,r,t){e.l+=4,r-=4;var i=e.l+r,s=Ji(e,r,t),l=e.read_shift(2);if(i-=e.l,l!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+l);return e.l+=l,s}function Bo(e){var r=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);return{s:{c:i,r},e:{c:s,r:t}}}function y1(e){var r=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1);return{s:{c:i,r},e:{c:s,r:t}}}var E4=y1;function k1(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2);return e.l+=12,[t,r,i]}function S4(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function b4(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Nr(e){e.l+=2,e.l+=e.read_shift(2)}var _4={0:Nr,4:Nr,5:Nr,6:Nr,7:b4,8:Nr,9:Nr,10:Nr,11:Nr,12:Nr,13:S4,14:Nr,15:Nr,16:Nr,17:Nr,18:Nr,19:Nr,20:Nr,21:k1};function T4(e,r){for(var t=e.l+r,i=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{i.push(_4[s](e,t-e.l))}catch{return e.l=t,i}}return e.l!=t&&(e.l=t),i}function ho(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function C4(e,r){return r===0||e.read_shift(2),1200}function N4(e,r,t){if(t.enc)return e.l+=r,"";var i=e.l,s=os(e,0,t);return e.read_shift(r+i-e.l),s}function A4(e,r,t){var i=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function F4(e,r,t){var i=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=Ji(e,0,t);return c.length===0&&(c="Sheet1"),{pos:i,hs:s,dt:l,name:c}}function D4(e,r){for(var t=e.l+r,i=e.read_shift(4),s=e.read_shift(4),l=[],c=0;c!=s&&e.l<t;++c)l.push(d4(e));return l.Count=i,l.Unique=s,l}function O4(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function j4(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var i=e.read_shift(1);return e.l+=3,i&7&&(r.level=i&7),i&32&&(r.hidden=!0),i&64&&(r.hpt=t/20),r}function I4(e){var r=v4(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function R4(e){return e.read_shift(2),e.read_shift(4)}function Sx(e,r,t){var i=0;t&&t.biff==2||(i=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(i=1-(s>>15),s&=32767);var l={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[l,s]}function P4(e){var r=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),x=e.read_shift(2);return{Pos:[r,t],Dim:[i,s],Flags:l,CurTab:c,FirstTab:u,Selected:h,TabRatio:x}}function L4(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var i=e.read_shift(2);return{RTL:i&64}}function M4(){}function B4(e,r,t){var i={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return i.name=Ji(e,0,t),i}function U4(e){var r=Wn(e);return r.isst=e.read_shift(4),r}function H4(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=e.l+r,s=Wn(e);t.biff==2&&e.l++;var l=qi(e,i-e.l,t);return s.val=l,s}function z4(e,r,t){var i=e.read_shift(2),s=os(e,0,t);return[i,s]}var W4=os;function bx(e,r,t){var i=e.l+r,s=t.biff==8||!t.biff?4:2,l=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(2),h=e.read_shift(2);return e.l=i,{s:{r:l,c:u},e:{r:c,c:h}}}function V4(e){var r=e.read_shift(2),t=e.read_shift(2),i=w1(e);return{r,c:t,ixfe:i[0],rknum:i[1]}}function $4(e,r){for(var t=e.l+r-2,i=e.read_shift(2),s=e.read_shift(2),l=[];e.l<t;)l.push(w1(e));if(e.l!==t)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulRK length mismatch");return{r:i,c:s,C:c,rkrec:l}}function G4(e,r){for(var t=e.l+r-2,i=e.read_shift(2),s=e.read_shift(2),l=[];e.l<t;)l.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-s+1)throw new Error("MulBlank length mismatch");return{r:i,c:s,C:c,ixfe:l}}function X4(e,r,t,i){var s={},l=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return s.patternType=Vk[u>>26],i.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=c&15,s.dgRight=c>>4&15,s.dgTop=c>>8&15,s.dgBottom=c>>12&15,s.icvLeft=c>>16&127,s.icvRight=c>>23&127,s.grbitDiag=c>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function K4(e,r,t){var i={};return i.ifnt=e.read_shift(2),i.numFmtId=e.read_shift(2),i.flags=e.read_shift(2),i.fStyle=i.flags>>2&1,r-=6,i.data=X4(e,r,i.fStyle,t),i}function Y4(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function _x(e,r,t){var i=Wn(e);(t.biff==2||r==9)&&++e.l;var s=f4(e);return i.val=s,i.t=s===!0||s===!1?"b":"e",i}function Q4(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=Wn(e),s=Fr(e);return i.val=s,i}var Tx=w4;function J4(e,r,t){var i=e.l+r,s=e.read_shift(2),l=e.read_shift(2);if(t.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=rs(e,l),u=[];i>e.l;)u.push(qi(e));return[l,s,c,u]}function Cx(e,r,t){var i=e.read_shift(2),s,l={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return t.sbcch===14849&&(s=k4(e,r-2,t)),l.body=s||e.read_shift(r-2),typeof s=="string"&&(l.Name=s),l}var q4=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Nx(e,r,t){var i=e.l+r,s=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(t&&t.biff==2?1:2),h=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),h=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var x=rs(e,c,t);s&32&&(x=q4[x.charCodeAt(0)]);var p=i-e.l;t&&t.biff==2&&--p;var v=i==e.l||u===0||!(p>0)?[]:j3(e,p,t,u);return{chKey:l,Name:x,itab:h,rgce:v}}function E1(e,r,t){if(t.biff<8)return Z4(e,r,t);for(var i=[],s=e.l+r,l=e.read_shift(t.biff>8?4:2);l--!==0;)i.push(y4(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return i}function Z4(e,r,t){e[e.l+1]==3&&e[e.l]++;var i=Ji(e,r,t);return i.charCodeAt(0)==3?i.slice(1):i}function eE(e,r,t){if(t.biff<8){e.l+=r;return}var i=e.read_shift(2),s=e.read_shift(2),l=rs(e,i,t),c=rs(e,s,t);return[l,c]}function tE(e,r,t){var i=y1(e);e.l++;var s=e.read_shift(1);return r-=8,[I3(e,r,t),s,i]}function Ax(e,r,t){var i=E4(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[i,D3(e,r,t)]}function rE(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,i=e.read_shift(4);return[r,t,i]}function nE(e,r,t){if(!(t.biff<8)){var i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=os(e,0,t);return t.biff<8&&e.read_shift(1),[{r:i,c:s},u,c,l]}}function aE(e,r,t){return nE(e,r,t)}function sE(e,r){for(var t=[],i=e.read_shift(2);i--;)t.push(Bo(e));return t}function iE(e,r,t){if(t&&t.biff<8)return oE(e,r,t);var i=k1(e),s=T4(e,r-22,i[1]);return{cmo:i,ft:s}}var lE={8:function(e,r){var t=e.l+r;e.l+=10;var i=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:i}}};function oE(e,r,t){e.l+=4;var i=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var c=[];return c.push((lE[i]||jr)(e,r,t)),{cmo:[s,i,l],ft:c}}function cE(e,r,t){var i=e.l,s="";try{e.l+=4;var l=(t.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=h4(e,6,t);var u=e.read_shift(2);e.read_shift(2),rr(e,2);var h=e.read_shift(2);e.l+=h;for(var x=1;x<e.lens.length-1;++x){if(e.l-i!=e.lens[x])throw new Error("TxO: bad continue record");var p=e[e.l],v=rs(e,e.lens[x+1]-e.lens[x]-1);if(s+=v,s.length>=(p?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=i+r,{t:s}}catch{return e.l=i+r,{t:s}}}function uE(e,r){var t=Bo(e);e.l+=16;var i=g4(e,r-24);return[t,i]}function fE(e,r){e.read_shift(2);var t=Bo(e),i=e.read_shift((r-10)/2,"dbcs-cont");return i=i.replace($r,""),[t,i]}function dE(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=vx[t]||t,t=e.read_shift(2),r[1]=vx[t]||t,r}function hE(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(v1(e));return t}function xE(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(v1(e));return t}function pE(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function S1(e,r,t){if(!t.cellStyles)return jr(e,r);var i=t&&t.biff>=12?4:2,s=e.read_shift(i),l=e.read_shift(i),c=e.read_shift(i),u=e.read_shift(i),h=e.read_shift(2);i==2&&(e.l+=2);var x={s,e:l,w:c,ixfe:u,flags:h};return(t.biff>=5||!t.biff)&&(x.level=h>>8&7),x}function mE(e,r){var t={};return r<32||(e.l+=16,t.header=Fr(e),t.footer=Fr(e),e.l+=2),t}function gE(e,r,t){var i={area:!1};if(t.biff!=5)return e.l+=r,i;var s=e.read_shift(1);return e.l+=3,s&16&&(i.area=!0),i}var vE=Wn,wE=m1,yE=qi;function kE(e){var r=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(4),s={fmt:r,env:t,len:i,data:e.slice(e.l,e.l+i)};return e.l+=i,s}function EE(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var i=Wn(e);++e.l;var s=os(e,r-7,t);return i.t="str",i.val=s,i}function SE(e){var r=Wn(e);++e.l;var t=Fr(e);return r.t="n",r.val=t,r}function bE(e){var r=Wn(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function _E(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function TE(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function CE(e,r,t){var i=e.l+r,s=Wn(e),l=e.read_shift(2),c=rs(e,l,t);return e.l=i,s.t="str",s.val=c,s}var NE=[2,3,48,49,131,139,140,245],Fx=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=bu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,h){var x=[],p=Oa(1);switch(h.type){case"base64":p=Fn(on(u));break;case"binary":p=Fn(u);break;case"buffer":case"array":p=u;break}kr(p,0);var v=p.read_shift(1),y=!!(v&136),E=!1,k=!1;switch(v){case 2:break;case 3:break;case 48:E=!0,y=!0;break;case 49:E=!0,y=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,S=521;v==2&&(w=p.read_shift(2)),p.l+=3,v!=2&&(w=p.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(S=p.read_shift(2));var O=p.read_shift(2),R=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(R=e[p[p.l]]),p.l+=1,p.l+=2),k&&(p.l+=36);for(var C=[],L={},X=Math.min(p.length,v==2?521:S-10-(E?264:0)),W=k?32:11;p.l<X&&p[p.l]!=13;)switch(L={},L.name=Ui.utils.decode(R,p.slice(p.l,p.l+W)).replace(/[\u0000\r\n].*$/g,""),p.l+=W,L.type=String.fromCharCode(p.read_shift(1)),v!=2&&!k&&(L.offset=p.read_shift(4)),L.len=p.read_shift(1),v==2&&(L.offset=p.read_shift(2)),L.dec=p.read_shift(1),L.name.length&&C.push(L),v!=2&&(p.l+=k?13:14),L.type){case"B":(!E||L.len!=8)&&h.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(p[p.l]!==13&&(p.l=S-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=S;var M=0,V=0;for(x[0]=[],V=0;V!=C.length;++V)x[0][V]=C[V].name;for(;w-- >0;){if(p[p.l]===42){p.l+=O;continue}for(++p.l,x[++M]=[],V=0,V=0;V!=C.length;++V){var G=p.slice(p.l,p.l+C[V].len);p.l+=C[V].len,kr(G,0);var oe=Ui.utils.decode(R,G);switch(C[V].type){case"C":oe.trim().length&&(x[M][V]=oe.replace(/\s+$/,""));break;case"D":oe.length===8?x[M][V]=new Date(+oe.slice(0,4),+oe.slice(4,6)-1,+oe.slice(6,8)):x[M][V]=oe;break;case"F":x[M][V]=parseFloat(oe.trim());break;case"+":case"I":x[M][V]=k?G.read_shift(-4,"i")^2147483648:G.read_shift(4,"i");break;case"L":switch(oe.trim().toUpperCase()){case"Y":case"T":x[M][V]=!0;break;case"N":case"F":x[M][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+oe+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));x[M][V]="##MEMO##"+(k?parseInt(oe.trim(),10):G.read_shift(4));break;case"N":oe=oe.replace(/\u0000/g,"").trim(),oe&&oe!="."&&(x[M][V]=+oe||0);break;case"@":x[M][V]=new Date(G.read_shift(-8,"f")-621356832e5);break;case"T":x[M][V]=new Date((G.read_shift(4)-2440588)*864e5+G.read_shift(4));break;case"Y":x[M][V]=G.read_shift(4,"i")/1e4+G.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[M][V]=-G.read_shift(-8,"f");break;case"B":if(E&&C[V].len==8){x[M][V]=G.read_shift(8,"f");break}case"G":case"P":G.l+=C[V].len;break;case"0":if(C[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[V].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),h.DBF=C,x}function i(u,h){var x=h||{};x.dateNF||(x.dateNF="yyyymmdd");var p=Vs(t(u,x),x);return p["!cols"]=x.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete x.DBF,p}function s(u,h){try{return Ra(i(u,h),h)}catch(x){if(h&&h.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var x=h||{};if(+x.codepage>=0&&Dn(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var p=Zc(),v=cu(u,{header:1,raw:!0,cellDates:!0}),y=v[0],E=v.slice(1),k=u["!cols"]||[],w=0,S=0,O=0,R=1;for(w=0;w<y.length;++w){if(((k[w]||{}).DBF||{}).name){y[w]=k[w].DBF.name,++O;continue}if(y[w]!=null){if(++O,typeof y[w]=="number"&&(y[w]=y[w].toString(10)),typeof y[w]!="string")throw new Error("DBF Invalid column name "+y[w]+" |"+typeof y[w]+"|");if(y.indexOf(y[w])!==w){for(S=0;S<1024;++S)if(y.indexOf(y[w]+"_"+S)==-1){y[w]+="_"+S;break}}}}var C=Gt(u["!ref"]),L=[],X=[],W=[];for(w=0;w<=C.e.c-C.s.c;++w){var M="",V="",G=0,oe=[];for(S=0;S<E.length;++S)E[S][w]!=null&&oe.push(E[S][w]);if(oe.length==0||y[w]==null){L[w]="?";continue}for(S=0;S<oe.length;++S){switch(typeof oe[S]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=oe[S]instanceof Date?"D":"C";break;default:V="C"}G=Math.max(G,String(oe[S]).length),M=M&&M!=V?"C":V}G>250&&(G=250),V=((k[w]||{}).DBF||{}).type,V=="C"&&k[w].DBF.len>G&&(G=k[w].DBF.len),M=="B"&&V=="N"&&(M="N",W[w]=k[w].DBF.dec,G=k[w].DBF.len),X[w]=M=="C"||V=="N"?G:l[M]||0,R+=X[w],L[w]=M}var B=p.next(32);for(B.write_shift(4,318902576),B.write_shift(4,E.length),B.write_shift(2,296+32*O),B.write_shift(2,R),w=0;w<4;++w)B.write_shift(4,0);for(B.write_shift(4,0|(+r[Ep]||3)<<8),w=0,S=0;w<y.length;++w)if(y[w]!=null){var K=p.next(32),me=(y[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);K.write_shift(1,me,"sbcs"),K.write_shift(1,L[w]=="?"?"C":L[w],"sbcs"),K.write_shift(4,S),K.write_shift(1,X[w]||l[L[w]]||0),K.write_shift(1,W[w]||0),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(1,0),K.write_shift(4,0),K.write_shift(4,0),S+=X[w]||l[L[w]]||0}var he=p.next(264);for(he.write_shift(4,13),w=0;w<65;++w)he.write_shift(4,0);for(w=0;w<E.length;++w){var we=p.next(R);for(we.write_shift(1,0),S=0;S<y.length;++S)if(y[S]!=null)switch(L[S]){case"L":we.write_shift(1,E[w][S]==null?63:E[w][S]?84:70);break;case"B":we.write_shift(8,E[w][S]||0,"f");break;case"N":var Oe="0";for(typeof E[w][S]=="number"&&(Oe=E[w][S].toFixed(W[S]||0)),O=0;O<X[S]-Oe.length;++O)we.write_shift(1,32);we.write_shift(1,Oe,"sbcs");break;case"D":E[w][S]?(we.write_shift(4,("0000"+E[w][S].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(E[w][S].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+E[w][S].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var Ee=String(E[w][S]!=null?E[w][S]:"").slice(0,X[S]);for(we.write_shift(1,Ee,"sbcs"),O=0;O<X[S]-Ee.length;++O)we.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:i,from_sheet:c}})(),AE=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Hn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,E){var k=e[E];return typeof k=="number"?Gh(k):k},i=function(y,E,k){var w=E.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return w==59?y:Gh(w)};e["|"]=254;function s(y,E){switch(E.type){case"base64":return l(on(y),E);case"binary":return l(y,E);case"buffer":return l(pt&&Buffer.isBuffer(y)?y.toString("binary"):as(y),E);case"array":return l(ts(y),E)}throw new Error("Unrecognized type "+E.type)}function l(y,E){var k=y.split(/[\n\r]+/),w=-1,S=-1,O=0,R=0,C=[],L=[],X=null,W={},M=[],V=[],G=[],oe=0,B;for(+E.codepage>=0&&Dn(+E.codepage);O!==k.length;++O){oe=0;var K=k[O].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(r,t),me=K.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),he=me[0],we;if(K.length>0)switch(he){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&L.push(K.slice(3).replace(/;;/g,";"));break;case"C":var Oe=!1,Ee=!1,Se=!1,Y=!1,xe=-1,z=-1;for(R=1;R<me.length;++R)switch(me[R].charAt(0)){case"A":break;case"X":S=parseInt(me[R].slice(1))-1,Ee=!0;break;case"Y":for(w=parseInt(me[R].slice(1))-1,Ee||(S=0),B=C.length;B<=w;++B)C[B]=[];break;case"K":we=me[R].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(jn(we))?isNaN(Bs(we).getDate())||(we=mr(we)):(we=jn(we),X!==null&&zs(X)&&(we=Mo(we))),Oe=!0;break;case"E":Y=!0;var T=Ls(me[R].slice(1),{r:w,c:S});C[w][S]=[C[w][S],T];break;case"S":Se=!0,C[w][S]=[C[w][S],"S5S"];break;case"G":break;case"R":xe=parseInt(me[R].slice(1))-1;break;case"C":z=parseInt(me[R].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+K)}if(Oe&&(C[w][S]&&C[w][S].length==2?C[w][S][0]=we:C[w][S]=we,X=null),Se){if(Y)throw new Error("SYLK shared formula cannot have own formula");var J=xe>-1&&C[xe][z];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");C[w][S][1]=j1(J[1],{r:w-xe,c:S-z})}break;case"F":var H=0;for(R=1;R<me.length;++R)switch(me[R].charAt(0)){case"X":S=parseInt(me[R].slice(1))-1,++H;break;case"Y":for(w=parseInt(me[R].slice(1))-1,B=C.length;B<=w;++B)C[B]=[];break;case"M":oe=parseInt(me[R].slice(1))/20;break;case"F":break;case"G":break;case"P":X=L[parseInt(me[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(G=me[R].slice(1).split(" "),B=parseInt(G[0],10);B<=parseInt(G[1],10);++B)oe=parseInt(G[2],10),V[B-1]=oe===0?{hidden:!0}:{wch:oe},Us(V[B-1]);break;case"C":S=parseInt(me[R].slice(1))-1,V[S]||(V[S]={});break;case"R":w=parseInt(me[R].slice(1))-1,M[w]||(M[w]={}),oe>0?(M[w].hpt=oe,M[w].hpx=Gi(oe)):oe===0&&(M[w].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+K)}H<1&&(X=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+K)}}return M.length>0&&(W["!rows"]=M),V.length>0&&(W["!cols"]=V),E&&E.sheetRows&&(C=C.slice(0,E.sheetRows)),[C,W]}function c(y,E){var k=s(y,E),w=k[0],S=k[1],O=Vs(w,E);return Hn(S).forEach(function(R){O[R]=S[R]}),O}function u(y,E){return Ra(c(y,E),E)}function h(y,E,k,w){var S="C;Y"+(k+1)+";X"+(w+1)+";K";switch(y.t){case"n":S+=y.v||0,y.f&&!y.F&&(S+=";E"+pb(y.f,{r:k,c:w}));break;case"b":S+=y.v?"TRUE":"FALSE";break;case"e":S+=y.w||y.v;break;case"d":S+='"'+(y.w||y.v)+'"';break;case"s":S+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function x(y,E){E.forEach(function(k,w){var S="F;W"+(w+1)+" "+(w+1)+" ";k.hidden?S+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Ao(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Fo(k.wpx)),typeof k.wch=="number"&&(S+=Math.round(k.wch))),S.charAt(S.length-1)!=" "&&y.push(S)})}function p(y,E){E.forEach(function(k,w){var S="F;";k.hidden?S+="M0;":k.hpt?S+="M"+20*k.hpt+";":k.hpx&&(S+="M"+20*F1(k.hpx)+";"),S.length>2&&y.push(S+"R"+(w+1))})}function v(y,E){var k=["ID;PWXL;N;E"],w=[],S=Gt(y["!ref"]),O,R=Array.isArray(y),C=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),y["!cols"]&&x(k,y["!cols"]),y["!rows"]&&p(k,y["!rows"]),k.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var L=S.s.r;L<=S.e.r;++L)for(var X=S.s.c;X<=S.e.c;++X){var W=it({r:L,c:X});O=R?(y[L]||[])[X]:y[W],!(!O||O.v==null&&(!O.f||O.F))&&w.push(h(O,y,L,X))}return k.join(C)+C+w.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:c,from_sheet:v}})(),FE=(function(){function e(l,c){switch(c.type){case"base64":return r(on(l),c);case"binary":return r(l,c);case"buffer":return r(pt&&Buffer.isBuffer(l)?l.toString("binary"):as(l),c);case"array":return r(ts(l),c)}throw new Error("Unrecognized type "+c.type)}function r(l,c){for(var u=l.split(`
`),h=-1,x=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++h]=[],x=0;continue}if(!(h<0)){var y=u[p].trim().split(","),E=y[0],k=y[1];++p;for(var w=u[p]||"";(w.match(/["]/g)||[]).length&1&&p<u.length-1;)w+=`
`+u[++p];switch(w=w.trim(),+E){case-1:if(w==="BOT"){v[++h]=[],x=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[h][x]=!0:w==="FALSE"?v[h][x]=!1:isNaN(jn(k))?isNaN(Bs(k).getDate())?v[h][x]=k:v[h][x]=mr(k):v[h][x]=jn(k),++x;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[h][x++]=w!==""?w:null;break}if(w==="EOD")break}}return c&&c.sheetRows&&(v=v.slice(0,c.sheetRows)),v}function t(l,c){return Vs(e(l,c),c)}function i(l,c){return Ra(t(l,c),c)}var s=(function(){var l=function(h,x,p,v,y){h.push(x),h.push(p+","+v),h.push('"'+y.replace(/"/g,'""')+'"')},c=function(h,x,p,v){h.push(x+","+p),h.push(x==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var x=[],p=Gt(h["!ref"]),v,y=Array.isArray(h);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,p.e.r-p.s.r+1,""),l(x,"TUPLES",0,p.e.c-p.s.c+1,""),l(x,"DATA",0,0,"");for(var E=p.s.r;E<=p.e.r;++E){c(x,-1,0,"BOT");for(var k=p.s.c;k<=p.e.c;++k){var w=it({r:E,c:k});if(v=y?(h[E]||[])[k]:h[w],!v){c(x,1,0,"");continue}switch(v.t){case"n":var S=v.w;!S&&v.v!=null&&(S=v.v),S==null?v.f&&!v.F?c(x,1,0,"="+v.f):c(x,1,0,""):c(x,0,S,"V");break;case"b":c(x,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":c(x,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=yn(v.z||ot[14],Gr(mr(v.v)))),c(x,0,v.w,"V");break;default:c(x,1,0,"")}}}c(x,-1,0,"EOD");var O=`\r
`,R=x.join(O);return R}})();return{to_workbook:i,to_sheet:t,from_sheet:s}})(),DE=(function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,y){for(var E=v.split(`
`),k=-1,w=-1,S=0,O=[];S!==E.length;++S){var R=E[S].trim().split(":");if(R[0]==="cell"){var C=Vr(R[1]);if(O.length<=C.r)for(k=O.length;k<=C.r;++k)O[k]||(O[k]=[]);switch(k=C.r,w=C.c,R[2]){case"t":O[k][w]=e(R[3]);break;case"v":O[k][w]=+R[3];break;case"vtf":var L=R[R.length-1];case"vtc":switch(R[3]){case"nl":O[k][w]=!!+R[4];break;default:O[k][w]=+R[4];break}R[2]=="vtf"&&(O[k][w]=[O[k][w],L])}}}return y&&y.sheetRows&&(O=O.slice(0,y.sheetRows)),O}function i(v,y){return Vs(t(v,y),y)}function s(v,y){return Ra(i(v,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function x(v){if(!v||!v["!ref"])return"";for(var y=[],E=[],k,w="",S=Ws(v["!ref"]),O=Array.isArray(v),R=S.s.r;R<=S.e.r;++R)for(var C=S.s.c;C<=S.e.c;++C)if(w=it({r:R,c:C}),k=O?(v[R]||[])[C]:v[w],!(!k||k.v==null||k.t==="z")){switch(E=["cell",w,"t"],k.t){case"s":case"str":E.push(r(k.v));break;case"n":k.f?(E[2]="vtf",E[3]="n",E[4]=k.v,E[5]=r(k.f)):(E[2]="v",E[3]=k.v);break;case"b":E[2]="vt"+(k.f?"f":"c"),E[3]="nl",E[4]=k.v?"1":"0",E[5]=r(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var L=Gr(mr(k.v));E[2]="vtc",E[3]="nd",E[4]=""+L,E[5]=k.w||yn(k.z||ot[14],L);break;case"e":continue}y.push(E.join(":"))}return y.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(v){return[l,c,u,c,x(v),h].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:p}})(),Vi=(function(){function e(p,v,y,E,k){k.raw?v[y][E]=p:p===""||(p==="TRUE"?v[y][E]=!0:p==="FALSE"?v[y][E]=!1:isNaN(jn(p))?isNaN(Bs(p).getDate())?v[y][E]=p:v[y][E]=mr(p):v[y][E]=jn(p))}function r(p,v){var y=v||{},E=[];if(!p||p.length===0)return E;for(var k=p.split(/[\r\n]/),w=k.length-1;w>=0&&k[w].length===0;)--w;for(var S=10,O=0,R=0;R<=w;++R)O=k[R].indexOf(" "),O==-1?O=k[R].length:O++,S=Math.max(S,O);for(R=0;R<=w;++R){E[R]=[];var C=0;for(e(k[R].slice(0,S).trim(),E,R,C,y),C=1;C<=(k[R].length-S)/10+1;++C)e(k[R].slice(S+(C-1)*10,S+C*10).trim(),E,R,C,y)}return y.sheetRows&&(E=E.slice(0,y.sheetRows)),E}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(p){for(var v={},y=!1,E=0,k=0;E<p.length;++E)(k=p.charCodeAt(E))==34?y=!y:!y&&k in t&&(v[k]=(v[k]||0)+1);k=[];for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&k.push([v[E],E]);if(!k.length){v=i;for(E in v)Object.prototype.hasOwnProperty.call(v,E)&&k.push([v[E],E])}return k.sort(function(w,S){return w[0]-S[0]||i[w[1]]-i[S[1]]}),t[k.pop()[1]]||44}function l(p,v){var y=v||{},E="",k=y.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(E=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(E=p.charAt(4),p=p.slice(6)):E=s(p.slice(0,1024)):y&&y.FS?E=y.FS:E=s(p.slice(0,1024));var S=0,O=0,R=0,C=0,L=0,X=E.charCodeAt(0),W=!1,M=0,V=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var G=y.dateNF!=null?zy(y.dateNF):null;function oe(){var B=p.slice(C,L),K={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)K.t="z";else if(y.raw)K.t="s",K.v=B;else if(B.trim().length===0)K.t="s",K.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(K.t="s",K.v=B.slice(2,-1).replace(/""/g,'"')):gb(B)?(K.t="n",K.f=B.slice(1)):(K.t="s",K.v=B);else if(B=="TRUE")K.t="b",K.v=!0;else if(B=="FALSE")K.t="b",K.v=!1;else if(!isNaN(R=jn(B)))K.t="n",y.cellText!==!1&&(K.w=B),K.v=R;else if(!isNaN(Bs(B).getDate())||G&&B.match(G)){K.z=y.dateNF||ot[14];var me=0;G&&B.match(G)&&(B=Wy(B,y.dateNF,B.match(G)||[]),me=1),y.cellDates?(K.t="d",K.v=mr(B,me)):(K.t="n",K.v=Gr(mr(B,me))),y.cellText!==!1&&(K.w=yn(K.z,K.v instanceof Date?Gr(K.v):K.v)),y.cellNF||delete K.z}else K.t="s",K.v=B;if(K.t=="z"||(y.dense?(k[S]||(k[S]=[]),k[S][O]=K):k[it({c:O,r:S})]=K),C=L+1,V=p.charCodeAt(C),w.e.c<O&&(w.e.c=O),w.e.r<S&&(w.e.r=S),M==X)++O;else if(O=0,++S,y.sheetRows&&y.sheetRows<=S)return!0}e:for(;L<p.length;++L)switch(M=p.charCodeAt(L)){case 34:V===34&&(W=!W);break;case X:case 10:case 13:if(!W&&oe())break e;break}return L-C>0&&oe(),k["!ref"]=gt(w),k}function c(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,v):Vs(r(p,v),v)}function u(p,v){var y="",E=v.type=="string"?[0,0,0,0]:Wu(p,v);switch(v.type){case"base64":y=on(p);break;case"binary":y=p;break;case"buffer":v.codepage==65001?y=p.toString("utf8"):v.codepage&&typeof Ui<"u"||(y=pt&&Buffer.isBuffer(p)?p.toString("binary"):as(p));break;case"array":y=ts(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+v.type)}return E[0]==239&&E[1]==187&&E[2]==191?y=jt(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=jt(y):v.type=="binary"&&typeof Ui<"u",y.slice(0,19)=="socialcalc:version:"?DE.to_sheet(v.type=="string"?y:jt(y),v):c(y,v)}function h(p,v){return Ra(u(p,v),v)}function x(p){for(var v=[],y=Gt(p["!ref"]),E,k=Array.isArray(p),w=y.s.r;w<=y.e.r;++w){for(var S=[],O=y.s.c;O<=y.e.c;++O){var R=it({r:w,c:O});if(E=k?(p[w]||[])[O]:p[R],!E||E.v==null){S.push("          ");continue}for(var C=(E.w||(aa(E),E.w)||"").slice(0,10);C.length<10;)C+=" ";S.push(C+(O===0?" ":""))}v.push(S.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:x}})();function OE(e,r){var t=r||{},i=!!t.WTF;t.WTF=!0;try{var s=AE.to_workbook(e,t);return t.WTF=i,s}catch(l){if(t.WTF=i,!l.message.match(/SYLK bad record ID/)&&i)throw l;return Vi.to_workbook(e,r)}}var Pi=(function(){function e(T,J,H){if(T){kr(T,T.l||0);for(var I=H.Enum||xe;T.l<T.length;){var ne=T.read_shift(2),fe=I[ne]||I[65535],ye=T.read_shift(2),le=T.l+ye,de=fe.f&&fe.f(T,ye,H);if(T.l=le,J(de,fe,ne))return}}}function r(T,J){switch(J.type){case"base64":return t(Fn(on(T)),J);case"binary":return t(Fn(T),J);case"buffer":case"array":return t(T,J)}throw"Unsupported type "+J.type}function t(T,J){if(!T)return T;var H=J||{},I=H.dense?[]:{},ne="Sheet1",fe="",ye=0,le={},de=[],pe=[],N={s:{r:0,c:0},e:{r:0,c:0}},_e=H.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)H.Enum=xe,e(T,function(Pe,St,Ft){switch(Ft){case 0:H.vers=Pe,Pe>=4096&&(H.qpro=!0);break;case 6:N=Pe;break;case 204:Pe&&(fe=Pe);break;case 222:fe=Pe;break;case 15:case 51:H.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:Ft==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=H.dateNF||ot[14],H.cellDates&&(Pe[1].t="d",Pe[1].v=Mo(Pe[1].v))),H.qpro&&Pe[3]>ye&&(I["!ref"]=gt(N),le[ne]=I,de.push(ne),I=H.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},ye=Pe[3],ne=fe||"Sheet"+(ye+1),fe="");var Dt=H.dense?(I[Pe[0].r]||[])[Pe[0].c]:I[it(Pe[0])];if(Dt){Dt.t=Pe[1].t,Dt.v=Pe[1].v,Pe[1].z!=null&&(Dt.z=Pe[1].z),Pe[1].f!=null&&(Dt.f=Pe[1].f);break}H.dense?(I[Pe[0].r]||(I[Pe[0].r]=[]),I[Pe[0].r][Pe[0].c]=Pe[1]):I[it(Pe[0])]=Pe[1];break}},H);else if(T[2]==26||T[2]==14)H.Enum=z,T[2]==14&&(H.qpro=!0,T.l=0),e(T,function(Pe,St,Ft){switch(Ft){case 204:ne=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>ye&&(I["!ref"]=gt(N),le[ne]=I,de.push(ne),I=H.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},ye=Pe[3],ne="Sheet"+(ye+1)),_e>0&&Pe[0].r>=_e)break;H.dense?(I[Pe[0].r]||(I[Pe[0].r]=[]),I[Pe[0].r][Pe[0].c]=Pe[1]):I[it(Pe[0])]=Pe[1],N.e.c<Pe[0].c&&(N.e.c=Pe[0].c),N.e.r<Pe[0].r&&(N.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(pe[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:pe[Pe[0]]=Pe[1],Pe[0]==ye&&(ne=Pe[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(I["!ref"]=gt(N),le[fe||ne]=I,de.push(fe||ne),!pe.length)return{SheetNames:de,Sheets:le};for(var Ne={},Qe=[],Ge=0;Ge<pe.length;++Ge)le[de[Ge]]?(Qe.push(pe[Ge]||de[Ge]),Ne[pe[Ge]]=le[pe[Ge]]||le[de[Ge]]):(Qe.push(pe[Ge]),Ne[pe[Ge]]={"!ref":"A1"});return{SheetNames:Qe,Sheets:Ne}}function i(T,J){var H=J||{};if(+H.codepage>=0&&Dn(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Zc(),ne=Gt(T["!ref"]),fe=Array.isArray(T),ye=[];An(I,0,l(1030)),An(I,6,h(ne));for(var le=Math.min(ne.e.r,8191),de=ne.s.r;de<=le;++de)for(var pe=Sr(de),N=ne.s.c;N<=ne.e.c;++N){de===ne.s.r&&(ye[N]=or(N));var _e=ye[N]+pe,Ne=fe?(T[de]||[])[N]:T[_e];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?An(I,13,E(de,N,Ne.v)):An(I,14,w(de,N,Ne.v));else{var Qe=aa(Ne);An(I,15,v(de,N,Qe.slice(0,239)))}}return An(I,1),I.end()}function s(T,J){var H=J||{};if(+H.codepage>=0&&Dn(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Zc();An(I,0,c(T));for(var ne=0,fe=0;ne<T.SheetNames.length;++ne)(T.Sheets[T.SheetNames[ne]]||{})["!ref"]&&An(I,27,Y(T.SheetNames[ne],fe++));var ye=0;for(ne=0;ne<T.SheetNames.length;++ne){var le=T.Sheets[T.SheetNames[ne]];if(!(!le||!le["!ref"])){for(var de=Gt(le["!ref"]),pe=Array.isArray(le),N=[],_e=Math.min(de.e.r,8191),Ne=de.s.r;Ne<=_e;++Ne)for(var Qe=Sr(Ne),Ge=de.s.c;Ge<=de.e.c;++Ge){Ne===de.s.r&&(N[Ge]=or(Ge));var Pe=N[Ge]+Qe,St=pe?(le[Ne]||[])[Ge]:le[Pe];if(!(!St||St.t=="z"))if(St.t=="n")An(I,23,oe(Ne,Ge,ye,St.v));else{var Ft=aa(St);An(I,22,M(Ne,Ge,ye,Ft.slice(0,239)))}}++ye}}return An(I,1),I.end()}function l(T){var J=lr(2);return J.write_shift(2,T),J}function c(T){var J=lr(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var H=0,I=0,ne=0,fe=0;fe<T.SheetNames.length;++fe){var ye=T.SheetNames[fe],le=T.Sheets[ye];if(!(!le||!le["!ref"])){++ne;var de=Ws(le["!ref"]);H<de.e.r&&(H=de.e.r),I<de.e.c&&(I=de.e.c)}}return H>8191&&(H=8191),J.write_shift(2,H),J.write_shift(1,ne),J.write_shift(1,I),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function u(T,J,H){var I={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&H.qpro?(I.s.c=T.read_shift(1),T.l++,I.s.r=T.read_shift(2),I.e.c=T.read_shift(1),T.l++,I.e.r=T.read_shift(2),I):(I.s.c=T.read_shift(2),I.s.r=T.read_shift(2),J==12&&H.qpro&&(T.l+=2),I.e.c=T.read_shift(2),I.e.r=T.read_shift(2),J==12&&H.qpro&&(T.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function h(T){var J=lr(8);return J.write_shift(2,T.s.c),J.write_shift(2,T.s.r),J.write_shift(2,T.e.c),J.write_shift(2,T.e.r),J}function x(T,J,H){var I=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(I[0].c=T.read_shift(1),I[3]=T.read_shift(1),I[0].r=T.read_shift(2),T.l+=2):(I[2]=T.read_shift(1),I[0].c=T.read_shift(2),I[0].r=T.read_shift(2)),I}function p(T,J,H){var I=T.l+J,ne=x(T,J,H);if(ne[1].t="s",H.vers==20768){T.l++;var fe=T.read_shift(1);return ne[1].v=T.read_shift(fe,"utf8"),ne}return H.qpro&&T.l++,ne[1].v=T.read_shift(I-T.l,"cstr"),ne}function v(T,J,H){var I=lr(7+H.length);I.write_shift(1,255),I.write_shift(2,J),I.write_shift(2,T),I.write_shift(1,39);for(var ne=0;ne<I.length;++ne){var fe=H.charCodeAt(ne);I.write_shift(1,fe>=128?95:fe)}return I.write_shift(1,0),I}function y(T,J,H){var I=x(T,J,H);return I[1].v=T.read_shift(2,"i"),I}function E(T,J,H){var I=lr(7);return I.write_shift(1,255),I.write_shift(2,J),I.write_shift(2,T),I.write_shift(2,H,"i"),I}function k(T,J,H){var I=x(T,J,H);return I[1].v=T.read_shift(8,"f"),I}function w(T,J,H){var I=lr(13);return I.write_shift(1,255),I.write_shift(2,J),I.write_shift(2,T),I.write_shift(8,H,"f"),I}function S(T,J,H){var I=T.l+J,ne=x(T,J,H);if(ne[1].v=T.read_shift(8,"f"),H.qpro)T.l=I;else{var fe=T.read_shift(2);L(T.slice(T.l,T.l+fe),ne),T.l+=fe}return ne}function O(T,J,H){var I=J&32768;return J&=-32769,J=(I?T:0)+(J>=8192?J-16384:J),(I?"":"$")+(H?or(J):Sr(J))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(T,J){kr(T,0);for(var H=[],I=0,ne="",fe="",ye="",le="";T.l<T.length;){var de=T[T.l++];switch(de){case 0:H.push(T.read_shift(8,"f"));break;case 1:fe=O(J[0].c,T.read_shift(2),!0),ne=O(J[0].r,T.read_shift(2),!1),H.push(fe+ne);break;case 2:{var pe=O(J[0].c,T.read_shift(2),!0),N=O(J[0].r,T.read_shift(2),!1);fe=O(J[0].c,T.read_shift(2),!0),ne=O(J[0].r,T.read_shift(2),!1),H.push(pe+N+":"+fe+ne)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(T.read_shift(2));break;case 6:{for(var _e="";de=T[T.l++];)_e+=String.fromCharCode(de);H.push('"'+_e.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:le=H.pop(),ye=H.pop(),H.push(["AND","OR"][de-20]+"("+ye+","+le+")");break;default:if(de<32&&C[de])le=H.pop(),ye=H.pop(),H.push(ye+C[de]+le);else if(R[de]){if(I=R[de][1],I==69&&(I=T[T.l++]),I>H.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+H.join("|")+"|");return}var Ne=H.slice(-I);H.length-=I,H.push(R[de][0]+"("+Ne.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}H.length==1?J[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function X(T){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=T.read_shift(2),J[3]=T[T.l++],J[0].c=T[T.l++],J}function W(T,J){var H=X(T);return H[1].t="s",H[1].v=T.read_shift(J-4,"cstr"),H}function M(T,J,H,I){var ne=lr(6+I.length);ne.write_shift(2,T),ne.write_shift(1,H),ne.write_shift(1,J),ne.write_shift(1,39);for(var fe=0;fe<I.length;++fe){var ye=I.charCodeAt(fe);ne.write_shift(1,ye>=128?95:ye)}return ne.write_shift(1,0),ne}function V(T,J){var H=X(T);H[1].v=T.read_shift(2);var I=H[1].v>>1;if(H[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return H[1].v=I,H}function G(T,J){var H=X(T),I=T.read_shift(4),ne=T.read_shift(4),fe=T.read_shift(2);if(fe==65535)return I===0&&ne===3221225472?(H[1].t="e",H[1].v=15):I===0&&ne===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var ye=fe&32768;return fe=(fe&32767)-16446,H[1].v=(1-ye*2)*(ne*Math.pow(2,fe+32)+I*Math.pow(2,fe)),H}function oe(T,J,H,I){var ne=lr(14);if(ne.write_shift(2,T),ne.write_shift(1,H),ne.write_shift(1,J),I==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var fe=0,ye=0,le=0,de=0;return I<0&&(fe=1,I=-I),ye=Math.log2(I)|0,I/=Math.pow(2,ye-31),de=I>>>0,(de&2147483648)==0&&(I/=2,++ye,de=I>>>0),I-=de,de|=2147483648,de>>>=0,I*=Math.pow(2,32),le=I>>>0,ne.write_shift(4,le),ne.write_shift(4,de),ye+=16383+(fe?32768:0),ne.write_shift(2,ye),ne}function B(T,J){var H=G(T);return T.l+=J-14,H}function K(T,J){var H=X(T),I=T.read_shift(4);return H[1].v=I>>6,H}function me(T,J){var H=X(T),I=T.read_shift(8,"f");return H[1].v=I,H}function he(T,J){var H=me(T);return T.l+=J-10,H}function we(T,J){return T[T.l+J-1]==0?T.read_shift(J,"cstr"):""}function Oe(T,J){var H=T[T.l++];H>J-1&&(H=J-1);for(var I="";I.length<H;)I+=String.fromCharCode(T[T.l++]);return I}function Ee(T,J,H){if(!(!H.qpro||J<21)){var I=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var ne=T.read_shift(J-21,"cstr");return[I,ne]}}function Se(T,J){for(var H={},I=T.l+J;T.l<I;){var ne=T.read_shift(2);if(ne==14e3){for(H[ne]=[0,""],H[ne][0]=T.read_shift(2);T[T.l];)H[ne][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return H}function Y(T,J){var H=lr(5+T.length);H.write_shift(2,14e3),H.write_shift(2,J);for(var I=0;I<T.length;++I){var ne=T.charCodeAt(I);H[H.l++]=ne>127?95:ne}return H[H.l++]=0,H}var xe={0:{n:"BOF",f:rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:Oe},65535:{n:""}},z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:G},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:K},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:he},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:r}})();function jE(e){var r={},t=e.match(Ir),i=0,s=!1;if(t)for(;i!=t.length;++i){var l=tt(t[i]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;r.cp=wu[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=l.val;break;case"<sz":r.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":l.rgb&&(r.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return r}var IE=(function(){var e=zi("t"),r=zi("rPr");function t(l){var c=l.match(e);if(!c)return{t:"s",v:""};var u={t:"s",v:wt(c[1])},h=l.match(r);return h&&(u.s=jE(h[1])),u}var i=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(c){return c.replace(i,"").split(s).map(t).filter(function(u){return u.v})}})(),RE=(function(){var r=/(\r\n|\n)/g;function t(s,l,c){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),c.push("</b>")),s.i&&(l.push("<i>"),c.push("</i>")),s.strike&&(l.push("<s>"),c.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),s}function i(s){var l=[[],s.v,[]];return s.v?(s.s&&t(s.s,l[0],l[2]),l[0].join("")+l[1].replace(r,"<br/>")+l[2].join("")):""}return function(l){return l.map(i).join("")}})(),PE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,LE=/<(?:\w+:)?r>/,ME=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Pu(e,r){var t=r?r.cellHTML:!0,i={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=wt(jt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=jt(e),t&&(i.h=Tu(i.t))):e.match(LE)&&(i.r=jt(e),i.t=wt(jt((e.replace(ME,"").match(PE)||[]).join("").replace(Ir,""))),t&&(i.h=RE(IE(i.r)))),i):{t:""}}var BE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,UE=/<(?:\w+:)?(?:si|sstItem)>/g,HE=/<\/(?:\w+:)?(?:si|sstItem)>/;function zE(e,r){var t=[],i="";if(!e)return t;var s=e.match(BE);if(s){i=s[2].replace(UE,"").split(HE);for(var l=0;l!=i.length;++l){var c=Pu(i[l].trim(),r);c!=null&&(t[t.length]=c)}s=tt(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}function WE(e){return[e.read_shift(4),e.read_shift(4)]}function VE(e,r){var t=[],i=!1;return sa(e,function(l,c,u){switch(u){case 159:t.Count=l[0],t.Unique=l[1];break;case 19:t.push(l);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(c.T,!i||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),t}function b1(e){for(var r=[],t=e.split(""),i=0;i<t.length;++i)r[i]=t[i].charCodeAt(0);return r}function ta(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function $E(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=ta(e,4),r.U=ta(e,4),r.W=ta(e,4),r}function GE(e){for(var r=e.read_shift(4),t=e.l+r-4,i={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(i.name=e.read_shift(0,"lpp4"),i.comps=l,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return i}function XE(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(GE(e));return r}function KE(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function YE(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=ta(e,4),r.U=ta(e,4),r.W=ta(e,4),r}function QE(e){var r=YE(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function _1(e,r){var t=e.l+r,i={};i.Flags=e.read_shift(4)&63,e.l+=4,i.AlgID=e.read_shift(4);var s=!1;switch(i.AlgID){case 26126:case 26127:case 26128:s=i.Flags==36;break;case 26625:s=i.Flags==4;break;case 0:s=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=e.read_shift(4),i.KeySize=e.read_shift(4),i.ProviderType=e.read_shift(4),e.l+=8,i.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,i}function T1(e,r){var t={},i=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,i),e.l=i,t}function JE(e){var r=ta(e);switch(r.Minor){case 2:return[r.Minor,qE(e)];case 3:return[r.Minor,ZE()];case 4:return[r.Minor,eS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function qE(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),i=_1(e,t),s=T1(e,e.length-e.l);return{t:"Std",h:i,v:s}}function ZE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function eS(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),i={};return t.replace(Ir,function(l){var c=tt(l);switch(zn(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(u){i[u]=c[u]});break;case"<dataIntegrity":i.encryptedHmacKey=c.encryptedHmacKey,i.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(c);break;default:throw c[0]}}),i}function tS(e,r){var t={},i=t.EncryptionVersionInfo=ta(e,4);if(r-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);t.Flags=e.read_shift(4),r-=4;var s=e.read_shift(4);return r-=4,t.EncryptionHeader=_1(e,s),r-=s,t.EncryptionVerifier=T1(e,r),t}function rS(e){var r={},t=r.EncryptionVersionInfo=ta(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function nS(e){var r=0,t,i=b1(e),s=i.length+1,l,c,u,h,x;for(t=Oa(s),t[0]=i.length,l=1;l!=s;++l)t[l]=i[l-1];for(l=s-1;l>=0;--l)c=t[l],u=(r&16384)===0?0:1,h=r<<1&32767,x=u|h,r=x^c;return r^52811}var C1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(c){return(c/2|c*128)&255},s=function(c,u){return i(c^u)},l=function(c){for(var u=r[c.length-1],h=104,x=c.length-1;x>=0;--x)for(var p=c[x],v=0;v!=7;++v)p&64&&(u^=t[h]),p*=2,--h;return u};return function(c){for(var u=b1(c),h=l(u),x=u.length,p=Oa(16),v=0;v!=16;++v)p[v]=0;var y,E,k;for((x&1)===1&&(y=h>>8,p[x]=s(e[0],y),--x,y=h&255,E=u[u.length-1],p[x]=s(E,y));x>0;)--x,y=h>>8,p[x]=s(u[x],y),--x,y=h&255,p[x]=s(u[x],y);for(x=15,k=15-u.length;k>0;)y=h>>8,p[x]=s(e[k],y),--x,--k,y=h&255,p[x]=s(u[x],y),--x,--k;return p}})(),aS=function(e,r,t,i,s){s||(s=r),i||(i=C1(e));var l,c;for(l=0;l!=r.length;++l)c=r[l],c^=i[t],c=(c>>5|c<<3)&255,s[l]=c,++t;return[s,t,i]},sS=function(e){var r=0,t=C1(e);return function(i){var s=aS("",i,r,t);return r=s[1],s[0]}};function iS(e,r,t,i){var s={key:rr(e),verificationBytes:rr(e)};return t.password&&(s.verifier=nS(t.password)),i.valid=s.verificationBytes===s.verifier,i.valid&&(i.insitu=sS(t.password)),s}function lS(e,r,t){var i=t||{};return i.Info=e.read_shift(2),e.l-=2,i.Info===1?i.Data=rS(e):i.Data=tS(e,r),i}function oS(e,r,t){var i={Type:t.biff>=8?e.read_shift(2):0};return i.Type?lS(e,r-2,i):iS(e,t.biff>=8?r:r-2,t,i),i}var cS=(function(){function e(s,l){switch(l.type){case"base64":return r(on(s),l);case"binary":return r(s,l);case"buffer":return r(pt&&Buffer.isBuffer(s)?s.toString("binary"):as(s),l);case"array":return r(ts(s),l)}throw new Error("Unrecognized type "+l.type)}function r(s,l){var c=l||{},u=c.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var y=/\\\w+\b/g,E=0,k,w=-1;k=y.exec(p);){switch(k[0]){case"\\cell":var S=p.slice(E,y.lastIndex-k[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var O={v:S,t:"s"};Array.isArray(u)?u[v][w]=O:u[it({r:v,c:w})]=O}break}E=y.lastIndex}w>x.e.c&&(x.e.c=w)}),u["!ref"]=gt(x),u}function t(s,l){return Ra(e(s,l),l)}function i(s){for(var l=["{\\rtf1\\ansi"],c=Gt(s["!ref"]),u,h=Array.isArray(s),x=c.s.r;x<=c.e.r;++x){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var v=it({r:x,c:p});u=h?(s[x]||[])[p]:s[v],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(aa(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:i}})();function uS(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function $i(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function fS(e){var r=e[0]/255,t=e[1]/255,i=e[2]/255,s=Math.max(r,t,i),l=Math.min(r,t,i),c=s-l;if(c===0)return[0,0,r];var u=0,h=0,x=s+l;switch(h=c/(x>1?2-x:x),s){case r:u=((t-i)/c+6)%6;break;case t:u=(i-r)/c+2;break;case i:u=(r-t)/c+4;break}return[u/6,h,x/2]}function dS(e){var r=e[0],t=e[1],i=e[2],s=t*2*(i<.5?i:1-i),l=i-s/2,c=[l,l,l],u=6*r,h;if(t!==0)switch(u|0){case 0:case 6:h=s*u,c[0]+=s,c[1]+=h;break;case 1:h=s*(2-u),c[0]+=h,c[1]+=s;break;case 2:h=s*(u-2),c[1]+=s,c[2]+=h;break;case 3:h=s*(4-u),c[1]+=h,c[2]+=s;break;case 4:h=s*(u-4),c[2]+=s,c[0]+=h;break;case 5:h=s*(6-u),c[2]+=h,c[0]+=s;break}for(var x=0;x!=3;++x)c[x]=Math.round(c[x]*255);return c}function No(e,r){if(r===0)return e;var t=fS(uS(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),$i(dS(t))}var N1=6,hS=15,xS=1,Wr=N1;function Ao(e){return Math.floor((e+Math.round(128/Wr)/256)*Wr)}function Fo(e){return Math.floor((e-5)/Wr*100+.5)/100}function nu(e){return Math.round((e*Wr+5)/Wr*256)/256}function Lc(e){return nu(Fo(Ao(e)))}function Lu(e){var r=Math.abs(e-Lc(e)),t=Wr;if(r>.005)for(Wr=xS;Wr<hS;++Wr)Math.abs(e-Lc(e))<=r&&(r=Math.abs(e-Lc(e)),t=Wr);Wr=t}function Us(e){e.width?(e.wpx=Ao(e.width),e.wch=Fo(e.wpx),e.MDW=Wr):e.wpx?(e.wch=Fo(e.wpx),e.width=nu(e.wch),e.MDW=Wr):typeof e.wch=="number"&&(e.width=nu(e.wch),e.wpx=Ao(e.width),e.MDW=Wr),e.customWidth&&delete e.customWidth}var pS=96,A1=pS;function F1(e){return e*96/A1}function Gi(e){return e*A1/96}var mS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function gS(e,r,t,i){r.Borders=[];var s={},l=!1;(e[0].match(Ir)||[]).forEach(function(c){var u=tt(c);switch(zn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=Bt(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=Bt(u.diagonalDown)),r.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(i&&i.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function vS(e,r,t,i){r.Fills=[];var s={},l=!1;(e[0].match(Ir)||[]).forEach(function(c){var u=tt(c);switch(zn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},r.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(i&&i.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function wS(e,r,t,i){r.Fonts=[];var s={},l=!1;(e[0].match(Ir)||[]).forEach(function(c){var u=tt(c);switch(zn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=jt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?Bt(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?Bt(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?Bt(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?Bt(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?Bt(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?Bt(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?Bt(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=wu[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=Bt(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var h=qa[s.color.index];s.color.index==81&&(h=qa[1]),h||(h=qa[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=No(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(i&&i.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function yS(e,r,t){r.NumberFmt=[];for(var i=Hn(ot),s=0;s<i.length;++s)r.NumberFmt[i[s]]=ot[i[s]];var l=e[0].match(Ir);if(l)for(s=0;s<l.length;++s){var c=tt(l[s]);switch(zn(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=wt(jt(c.formatCode)),h=parseInt(c.numFmtId,10);if(r.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&r.NumberFmt[h]!=null;--h);r.NumberFmt[h]=u}Ja(u,h)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var xo=["numFmtId","fillId","fontId","borderId","xfId"],po=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function kS(e,r,t){r.CellXf=[];var i,s=!1;(e[0].match(Ir)||[]).forEach(function(l){var c=tt(l),u=0;switch(zn(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=c,delete i[0],u=0;u<xo.length;++u)i[xo[u]]&&(i[xo[u]]=parseInt(i[xo[u]],10));for(u=0;u<po.length;++u)i[po[u]]&&(i[po[u]]=Bt(i[po[u]]));if(r.NumberFmt&&i.numFmtId>392){for(u=392;u>60;--u)if(r.NumberFmt[i.numFmtId]==r.NumberFmt[u]){i.numFmtId=u;break}}r.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=Bt(c.wrapText)),i.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var ES=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,x){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(r))&&yS(v,p,x),(v=u.match(s))&&wS(v,p,h,x),(v=u.match(i))&&vS(v,p,h,x),(v=u.match(l))&&gS(v,p,h,x),(v=u.match(t))&&kS(v,p,x),p}})();function SS(e,r){var t=e.read_shift(2),i=Or(e);return[t,i]}function bS(e,r,t){var i={};i.sz=e.read_shift(2)/20;var s=Ik(e);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var l=e.read_shift(2);switch(l===700&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(i.underline=c);var u=e.read_shift(1);u>0&&(i.family=u);var h=e.read_shift(1);switch(h>0&&(i.charset=h),e.l++,i.color=jk(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Or(e),i}var _S=jr;function TS(e,r){var t=e.l+r,i=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:i,numFmtId:s}}var CS=jr;function NS(e,r,t){var i={};i.NumberFmt=[];for(var s in ot)i.NumberFmt[s]=ot[s];i.CellXf=[],i.Fonts=[];var l=[],c=!1;return sa(e,function(h,x,p){switch(p){case 44:i.NumberFmt[h[0]]=h[1],Ja(h[1],h[0]);break;case 43:i.Fonts.push(h),h.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(h.color.rgb=No(r.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&i.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(p),c=!0;break;case 38:l.pop(),c=!1;break;default:if(x.T>0)l.push(p);else if(x.T<0)l.pop();else if(!c||t.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),i}var AS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function FS(e,r,t){r.themeElements.clrScheme=[];var i={};(e[0].match(Ir)||[]).forEach(function(s){var l=tt(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=l.val;break;case"<a:sysClr":i.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(r.themeElements.clrScheme[AS.indexOf(l[0])]=i,i={}):i.name=l[0].slice(3,l[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function DS(){}function OS(){}var jS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,IS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,RS=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function PS(e,r,t){r.themeElements={};var i;[["clrScheme",jS,FS],["fontScheme",IS,DS],["fmtScheme",RS,OS]].forEach(function(s){if(!(i=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](i,r,t)})}var LS=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function D1(e,r){(!e||e.length===0)&&(e=MS());var t,i={};if(!(t=e.match(LS)))throw new Error("themeElements not found in theme");return PS(t[0],i,r),i.raw=e,i}function MS(e,r){var t=[zp];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function BS(e,r,t){var i=e.l+r,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=i;return}var l=e.slice(e.l);e.l=i;var c;try{c=Hp(l,{type:"array"})}catch{return}var u=ln(c,"theme/theme/theme1.xml",!0);if(u)return D1(u,t)}}function US(e){return e.read_shift(4)}function HS(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=zS(e,4);break;case 2:r.xclrValue=g1(e);break;case 3:r.xclrValue=US(e);break;case 4:e.l+=4;break}return e.l+=8,r}function zS(e,r){return jr(e,r)}function WS(e,r){return jr(e,r)}function VS(e){var r=e.read_shift(2),t=e.read_shift(2)-4,i=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=HS(e);break;case 6:i[1]=WS(e,t);break;case 14:case 15:i[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return i}function $S(e,r){var t=e.l+r;e.l+=2;var i=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(VS(e,t-e.l));return{ixfe:i,ext:l}}function GS(e,r){r.forEach(function(t){t[0]})}function XS(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Or(e)}}function KS(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function YS(e){return e.l+=4,e.read_shift(4)!=0}function QS(e,r,t){var i={Types:[],Cell:[],Value:[]},s=t||{},l=[],c=!1,u=2;return sa(e,function(h,x,p){switch(p){case 335:i.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?i.Cell.push({type:i.Types[v[0]-1].name,index:v[1]}):u==0&&i.Value.push({type:i.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(p),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!x.T){if(!c||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),i}function JS(e,r,t){var i={Types:[],Cell:[],Value:[]};if(!e)return i;var s=!1,l=2,c;return e.replace(Ir,function(u){var h=tt(u);switch(zn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<i.Types.length;++x)i.Types[x].name==h.name&&(c=i.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?i.Cell.push({type:i.Types[h.t-1].name,index:+h.v}):l==0&&i.Value.push({type:i.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),i}function qS(e){var r=[];if(!e)return r;var t=1;return(e.match(Ir)||[]).forEach(function(i){var s=tt(i);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,r.push(s);break}}),r}function ZS(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=it(t);var i=e.read_shift(1);return i&2&&(r.l="1"),i&8&&(r.a="1"),r}function eb(e,r,t){var i=[];return sa(e,function(l,c,u){switch(u){case 63:i.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),i}function tb(e,r,t,i){if(!e)return e;var s=i||{},l=!1;sa(e,function(u,h,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},s)}function rb(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function Dx(e,r,t,i){var s=Array.isArray(e),l;r.forEach(function(c){var u=Vr(c.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[c.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[c.ref]=l;var h=Gt(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var x=gt(h);x!==e["!ref"]&&(e["!ref"]=x)}l.c||(l.c=[]);var p={a:c.author,t:c.t,r:c.r,T:t};c.h&&(p.h=c.h);for(var v=l.c.length-1;v>=0;--v){if(!t&&l.c[v].T)return;t&&!l.c[v].T&&l.c.splice(v,1)}if(t&&i){for(v=0;v<i.length;++v)if(p.a==i[v].id){p.a=i[v].name||p.a;break}}l.c.push(p)})}function nb(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],i=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&t.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=tt(u[0]),x={author:h.authorId&&t[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=Vr(h.ref);if(!(r.sheetRows&&r.sheetRows<=p.r)){var v=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!v&&!!v[1]&&Pu(v[1])||{r:"",t:"",h:""};x.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),x.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(x.h=y.h),i.push(x)}}}}),i}function ab(e,r){var t=[],i=!1,s={},l=0;return e.replace(Ir,function(u,h){var x=tt(u);switch(zn(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":s.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&r.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return u}),t}function sb(e,r){var t=[],i=!1;return e.replace(Ir,function(l){var c=tt(l);switch(zn(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),t}function ib(e){var r={};r.iauthor=e.read_shift(4);var t=is(e);return r.rfx=t.s,r.ref=it(t.s),e.l+=16,r}var lb=Or;function ob(e,r){var t=[],i=[],s={},l=!1;return sa(e,function(u,h,x){switch(x){case 632:i.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=i[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||r.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),t}var cb="application/vnd.ms-office.vbaProject";function ub(e){var r=mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,i){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");mt.utils.cfb_add(r,s,e.FileIndex[i].content)}}),mt.write(r)}function fb(){return{"!type":"dialog"}}function db(){return{"!type":"dialog"}}function hb(){return{"!type":"macro"}}function xb(){return{"!type":"macro"}}var Ls=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(i,s,l,c){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return u?p+=r.c:--p,h?x+=r.r:--x,s+(u?"":"$")+or(p)+(h?"":"$")+Sr(x)}return function(s,l){return r=l,s.replace(e,t)}})(),O1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,pb=(function(){return function(r,t){return r.replace(O1,function(i,s,l,c,u,h){var x=Fu(c)-(l?0:t.c),p=Au(h)-(u?0:t.r),v=p==0?"":u?p+1:"["+p+"]",y=x==0?"":l?x+1:"["+x+"]";return s+"R"+v+"C"+y})}})();function j1(e,r){return e.replace(O1,function(t,i,s,l,c,u){return i+(s=="$"?s+l:or(Fu(l)+r.c))+(c=="$"?c+u:Sr(Au(u)+r.r))})}function mb(e,r,t){var i=Ws(r),s=i.s,l=Vr(t),c={r:l.r-s.r,c:l.c-s.c};return j1(e,c)}function gb(e){return e.length!=1}function Ox(e){return e.replace(/_xlfn\./g,"")}function er(e){e.l+=1}function ja(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function I1(e,r,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return R1(e);t.biff==12&&(i=4)}var s=e.read_shift(i),l=e.read_shift(i),c=ja(e),u=ja(e);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function R1(e){var r=ja(e),t=ja(e),i=e.read_shift(1),s=e.read_shift(1);return{s:{r:r[0],c:i,cRel:r[1],rRel:r[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function vb(e,r,t){if(t.biff<8)return R1(e);var i=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),l=ja(e),c=ja(e);return{s:{r:i,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function P1(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return wb(e);var i=e.read_shift(t&&t.biff==12?4:2),s=ja(e);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function wb(e){var r=ja(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function yb(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function kb(e,r,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return Eb(e);var s=e.read_shift(i>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:u}}function Eb(e){var r=e.read_shift(2),t=e.read_shift(1),i=(r&32768)>>15,s=(r&16384)>>14;return r&=16383,i==1&&r>=8192&&(r=r-16384),s==1&&t>=128&&(t=t-256),{r,c:t,cRel:s,rRel:i}}function Sb(e,r,t){var i=(e[e.l++]&96)>>5,s=I1(e,t.biff>=2&&t.biff<=5?6:8,t);return[i,s]}function bb(e,r,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=I1(e,l,t);return[i,s,c]}function _b(e,r,t){var i=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function Tb(e,r,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[i,s]}function Cb(e,r,t){var i=(e[e.l++]&96)>>5,s=vb(e,r-1,t);return[i,s]}function Nb(e,r,t){var i=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[i]}function jx(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Ab(e,r,t){e.l+=2;for(var i=e.read_shift(t&&t.biff==2?1:2),s=[],l=0;l<=i;++l)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function Fb(e,r,t){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(t&&t.biff==2?1:2)]}function Db(e,r,t){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(t&&t.biff==2?1:2)]}function Ob(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function jb(e,r,t){var i=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[i]}function L1(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Ib(e){return e.read_shift(2),L1(e)}function Rb(e){return e.read_shift(2),L1(e)}function Pb(e,r,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=P1(e,0,t);return[i,s]}function Lb(e,r,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=kb(e,0,t);return[i,s]}function Mb(e,r,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var l=P1(e,0,t);return[i,s,l]}function Bb(e,r,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[U3[s],U1[s],i]}function Ub(e,r,t){var i=e[e.l++],s=e.read_shift(1),l=t&&t.biff<=3?[i==88?-1:0,e.read_shift(1)]:Hb(e);return[s,(l[0]===0?U1:B3)[l[1]]]}function Hb(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function zb(e,r,t){e.l+=t&&t.biff==2?3:4}function Wb(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var i=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function Vb(e){return e.l++,ls[e.read_shift(1)]}function $b(e){return e.l++,e.read_shift(2)}function Gb(e){return e.l++,e.read_shift(1)!==0}function Xb(e){return e.l++,Fr(e)}function Kb(e,r,t){return e.l++,Ji(e,r-1,t)}function Yb(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Jt(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=ls[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Fr(e);break;case 2:t[1]=os(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Qb(e,r,t){for(var i=e.read_shift(t.biff==12?4:2),s=[],l=0;l!=i;++l)s.push((t.biff==12?is:Bo)(e));return s}function Jb(e,r,t){var i=0,s=0;t.biff==12?(i=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),i=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--s==0&&(s=256));for(var l=0,c=[];l!=i&&(c[l]=[]);++l)for(var u=0;u!=s;++u)c[l][u]=Yb(e,t.biff);return c}function qb(e,r,t){var i=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,l=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[i,0,l]}function Zb(e,r,t){if(t.biff==5)return e3(e);var i=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[i,s,l]}function e3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[r,t,i]}function t3(e,r,t){var i=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function r3(e,r,t){var i=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function n3(e,r,t){var i=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[i]}function a3(e,r,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[i,s]}var s3=jr,i3=jr,l3=jr;function Zi(e,r,t){return e.l+=2,[yb(e)]}function Mu(e){return e.l+=6,[]}var o3=Zi,c3=Mu,u3=Mu,f3=Zi;function M1(e){return e.l+=2,[rr(e),e.read_shift(2)&1]}var d3=Zi,h3=M1,x3=Mu,p3=Zi,m3=Zi,g3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function v3(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),c=g3[t>>2&31];return{ixti:r,coltype:t&3,rt:c,idx:i,c:s,C:l}}function w3(e){return e.l+=2,[e.read_shift(4)]}function y3(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function k3(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function E3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function S3(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function b3(e){return e.l+=4,[0,0]}var Ix={1:{n:"PtgExp",f:Wb},2:{n:"PtgTbl",f:l3},3:{n:"PtgAdd",f:er},4:{n:"PtgSub",f:er},5:{n:"PtgMul",f:er},6:{n:"PtgDiv",f:er},7:{n:"PtgPower",f:er},8:{n:"PtgConcat",f:er},9:{n:"PtgLt",f:er},10:{n:"PtgLe",f:er},11:{n:"PtgEq",f:er},12:{n:"PtgGe",f:er},13:{n:"PtgGt",f:er},14:{n:"PtgNe",f:er},15:{n:"PtgIsect",f:er},16:{n:"PtgUnion",f:er},17:{n:"PtgRange",f:er},18:{n:"PtgUplus",f:er},19:{n:"PtgUminus",f:er},20:{n:"PtgPercent",f:er},21:{n:"PtgParen",f:er},22:{n:"PtgMissArg",f:er},23:{n:"PtgStr",f:Kb},26:{n:"PtgSheet",f:y3},27:{n:"PtgEndSheet",f:k3},28:{n:"PtgErr",f:Vb},29:{n:"PtgBool",f:Gb},30:{n:"PtgInt",f:$b},31:{n:"PtgNum",f:Xb},32:{n:"PtgArray",f:Nb},33:{n:"PtgFunc",f:Bb},34:{n:"PtgFuncVar",f:Ub},35:{n:"PtgName",f:qb},36:{n:"PtgRef",f:Pb},37:{n:"PtgArea",f:Sb},38:{n:"PtgMemArea",f:t3},39:{n:"PtgMemErr",f:s3},40:{n:"PtgMemNoMem",f:i3},41:{n:"PtgMemFunc",f:r3},42:{n:"PtgRefErr",f:n3},43:{n:"PtgAreaErr",f:_b},44:{n:"PtgRefN",f:Lb},45:{n:"PtgAreaN",f:Cb},46:{n:"PtgMemAreaN",f:E3},47:{n:"PtgMemNoMemN",f:S3},57:{n:"PtgNameX",f:Zb},58:{n:"PtgRef3d",f:Mb},59:{n:"PtgArea3d",f:bb},60:{n:"PtgRefErr3d",f:a3},61:{n:"PtgAreaErr3d",f:Tb},255:{}},_3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},T3={1:{n:"PtgElfLel",f:M1},2:{n:"PtgElfRw",f:p3},3:{n:"PtgElfCol",f:o3},6:{n:"PtgElfRwV",f:m3},7:{n:"PtgElfColV",f:f3},10:{n:"PtgElfRadical",f:d3},11:{n:"PtgElfRadicalS",f:x3},13:{n:"PtgElfColS",f:c3},15:{n:"PtgElfColSV",f:u3},16:{n:"PtgElfRadicalLel",f:h3},25:{n:"PtgList",f:v3},29:{n:"PtgSxName",f:w3},255:{}},C3={0:{n:"PtgAttrNoop",f:b3},1:{n:"PtgAttrSemi",f:jb},2:{n:"PtgAttrIf",f:Db},4:{n:"PtgAttrChoose",f:Ab},8:{n:"PtgAttrGoto",f:Fb},16:{n:"PtgAttrSum",f:zb},32:{n:"PtgAttrBaxcel",f:jx},33:{n:"PtgAttrBaxcel",f:jx},64:{n:"PtgAttrSpace",f:Ib},65:{n:"PtgAttrSpaceSemi",f:Rb},128:{n:"PtgAttrIfError",f:Ob},255:{}};function el(e,r,t,i){if(i.biff<8)return jr(e,r);for(var s=e.l+r,l=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=Jb(e,0,i),l.push(t[c][1]);break;case"PtgMemArea":t[c][2]=Qb(e,t[c][1],i),l.push(t[c][2]);break;case"PtgExp":i&&i.biff==12&&(t[c][1][1]=e.read_shift(4),l.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return r=s-e.l,r!==0&&l.push(jr(e,r)),l}function tl(e,r,t){for(var i=e.l+r,s,l,c=[];i!=e.l;)r=i-e.l,l=e[e.l],s=Ix[l]||Ix[_3[l]],(l===24||l===25)&&(s=(l===24?T3:C3)[e[e.l+1]]),!s||!s.f?jr(e,r):c.push([s.n,s.f(e,r,t)]);return c}function N3(e){for(var r=[],t=0;t<e.length;++t){for(var i=e[t],s=[],l=0;l<i.length;++l){var c=i[l];if(c)switch(c[0]){case 2:s.push('"'+c[1].replace(/"/g,'""')+'"');break;default:s.push(c[1])}else s.push("")}r.push(s.join(","))}return r.join(";")}var A3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function F3(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function B1(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!i)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[i[0]][0]){case 357:return s=i[1]==-1?"#REF":e.SheetNames[i[1]],i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[i[0]][0];case 355:default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[i[0]][0][3]?(s=i[1]==-1?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Rx(e,r,t){var i=B1(e,r,t);return i=="#REF"?i:F3(i,t)}function Ar(e,r,t,i,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},u=[],h,x,p,v=0,y=0,E,k="";if(!e[0]||!e[0][0])return"";for(var w=-1,S="",O=0,R=e[0].length;O<R;++O){var C=e[0][O];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),x=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:S=$t(" ",e[0][w][1][1]);break;case 1:S=$t("\r",e[0][w][1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}x=x+S,w=-1}u.push(x+A3[C[0]]+h);break;case"PtgIsect":h=u.pop(),x=u.pop(),u.push(x+" "+h);break;case"PtgUnion":h=u.pop(),x=u.pop(),u.push(x+","+h);break;case"PtgRange":h=u.pop(),x=u.pop(),u.push(x+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Oi(C[1][1],c,s),u.push(ji(p,l));break;case"PtgRefN":p=t?Oi(C[1][1],t,s):C[1][1],u.push(ji(p,l));break;case"PtgRef3d":v=C[1][1],p=Oi(C[1][2],c,s),k=Rx(i,v,s),u.push(k+"!"+ji(p,l));break;case"PtgFunc":case"PtgFuncVar":var L=C[1][0],X=C[1][1];L||(L=0),L&=127;var W=L==0?[]:u.slice(-L);u.length-=L,X==="User"&&(X=W.shift()),u.push(X+"("+W.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":E=px(C[1][1],t?{s:t}:c,s),u.push(Rc(E,s));break;case"PtgArea":E=px(C[1][1],c,s),u.push(Rc(E,s));break;case"PtgArea3d":v=C[1][1],E=C[1][2],k=Rx(i,v,s),u.push(k+"!"+Rc(E,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var M=(i.names||[])[y-1]||(i[0]||[])[y],V=M?M.Name:"SH33TJSNAME"+String(y);V&&V.slice(0,6)=="_xlfn."&&!s.xlfn&&(V=V.slice(6)),u.push(V);break;case"PtgNameX":var G=C[1][1];y=C[1][2];var oe;if(s.biff<=5)G<0&&(G=-G),i[G]&&(oe=i[G][y]);else{var B="";if(((i[G]||[])[0]||[])[0]==14849||(((i[G]||[])[0]||[])[0]==1025?i[G][y]&&i[G][y].itab>0&&(B=i.SheetNames[i[G][y].itab-1]+"!"):B=i.SheetNames[y-1]+"!"),i[G]&&i[G][y])B+=i[G][y].Name;else if(i[0]&&i[0][y])B+=i[0][y].Name;else{var K=(B1(i,G,s)||"").split(";;");K[y-1]?B=K[y-1]:B+="SH33TJSERRX"}u.push(B);break}oe||(oe={Name:"SH33TJSERRY"}),u.push(oe.Name);break;case"PtgParen":var me="(",he=")";if(w>=0){switch(S="",e[0][w][1][0]){case 2:me=$t(" ",e[0][w][1][1])+me;break;case 3:me=$t("\r",e[0][w][1][1])+me;break;case 4:he=$t(" ",e[0][w][1][1])+he;break;case 5:he=$t("\r",e[0][w][1][1])+he;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(me+u.pop()+he);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var we={c:t.c,r:t.r};if(i.sharedf[it(p)]){var Oe=i.sharedf[it(p)];u.push(Ar(Oe,c,we,i,s))}else{var Ee=!1;for(h=0;h!=i.arrayf.length;++h)if(x=i.arrayf[h],!(p.c<x[0].s.c||p.c>x[0].e.c)&&!(p.r<x[0].s.r||p.r>x[0].e.r)){u.push(Ar(x[1],c,we,i,s)),Ee=!0;break}Ee||u.push(C[1])}break;case"PtgArray":u.push("{"+N3(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=O;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&w>=0&&Se.indexOf(e[0][O][0])==-1){C=e[0][w];var Y=!0;switch(C[1][0]){case 4:Y=!1;case 0:S=$t(" ",C[1][1]);break;case 5:Y=!1;case 1:S=$t("\r",C[1][1]);break;default:if(S="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((Y?S:"")+u.pop()+(Y?"":S)),w=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function D3(e,r,t){var i=e.l+r,s=t.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],jr(e,r-2)];var u=tl(e,c,t);return r!==c+s&&(l=el(e,r-c-s,u,t)),e.l=i,[u,l]}function O3(e,r,t){var i=e.l+r,s=t.biff==2?1:2,l,c=e.read_shift(s);if(c==65535)return[[],jr(e,r-2)];var u=tl(e,c,t);return r!==c+s&&(l=el(e,r-c-s,u,t)),e.l=i,[u,l]}function j3(e,r,t,i){var s=e.l+r,l=tl(e,i,t),c;return s!==e.l&&(c=el(e,s-e.l,l,t)),[l,c]}function I3(e,r,t){var i=e.l+r,s,l=e.read_shift(2),c=tl(e,l,t);return l==65535?[[],jr(e,r-2)]:(r!==l+2&&(s=el(e,i-l-2,c,t)),[c,s])}function R3(e){var r;if(Zn(e,e.l+6)!==65535)return[Fr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Mc(e,r,t){var i=e.l+r,s=Wn(e);t.biff==2&&++e.l;var l=R3(e),c=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var u=O3(e,i-e.l,t);return{cell:s,val:l[0],formula:u,shared:c>>3&1,tt:l[1]}}function Uo(e,r,t){var i=e.read_shift(4),s=tl(e,i,t),l=e.read_shift(4),c=l>0?el(e,l,s,t):null;return[s,c]}var P3=Uo,Ho=Uo,L3=Uo,M3=Uo,B3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},U1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},U3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Px(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Bc(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Li={},Ms={};function Mi(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function H1(e,r,t,i,s,l){try{i.cellNF&&(e.z=ot[r])}catch(u){if(i.WTF)throw u}if(!(e.t==="z"&&!i.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=mr(e.v)),(!i||i.cellText!==!1)&&e.t!=="z")try{if(ot[r]==null&&Ja(Hy[r]||"General",r),e.t==="e")e.w=e.w||ls[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hi(e.v);else if(e.t==="d"){var c=Gr(e.v);(c|0)===c?e.w=c.toString(10):e.w=Hi(c)}else{if(e.v===void 0)return"";e.w=es(e.v,Ms)}else e.t==="d"?e.w=yn(r,Gr(e.v),Ms):e.w=yn(r,e.v,Ms)}catch(u){if(i.WTF)throw u}if(i.cellStyles&&t!=null)try{e.s=l.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=No(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),i.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=No(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),i.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(i.WTF&&l.Fills)throw u}}}function H3(e,r){var t=Gt(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=gt(t))}var z3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,W3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,V3=/<(?:\w:)?hyperlink [^>]*>/mg,$3=/"(\w*:\w*)"/,G3=/<(?:\w:)?col\b[^>]*[\/]?>/g,X3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,K3=/<(?:\w:)?pageMargins[^>]*\/>/g,z1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Y3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Q3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function J3(e,r,t,i,s,l,c){if(!e)return e;i||(i={"!id":{}});var u=r.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",p="",v=e.match(W3);v?(x=e.slice(0,v.index),p=e.slice(v.index+v[0].length)):x=p=e;var y=x.match(z1);y?Bu(y[0],u,s,t):(y=x.match(Y3))&&q3(y[0],y[1]||"",u,s,t);var E=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var k=x.slice(E,E+50).match($3);k&&H3(u,k[1])}var w=x.match(Q3);w&&w[1]&&a_(w[1],s);var S=[];if(r.cellStyles){var O=x.match(G3);O&&t_(S,O)}v&&s_(v[1],u,r,h,l,c);var R=p.match(X3);R&&(u["!autofilter"]=r_(R[0]));var C=[],L=p.match(z3);if(L)for(E=0;E!=L.length;++E)C[E]=Gt(L[E].slice(L[E].indexOf('"')+1));var X=p.match(V3);X&&Z3(u,X,i);var W=p.match(K3);if(W&&(u["!margins"]=e_(tt(W[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=gt(h)),r.sheetRows>0&&u["!ref"]){var M=Gt(u["!ref"]);r.sheetRows<=+M.e.r&&(M.e.r=r.sheetRows-1,M.e.r>h.e.r&&(M.e.r=h.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>h.e.c&&(M.e.c=h.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),u["!fullref"]=u["!ref"],u["!ref"]=gt(M))}return S.length>0&&(u["!cols"]=S),C.length>0&&(u["!merges"]=C),u}function Bu(e,r,t,i){var s=tt(e);t.Sheets[i]||(t.Sheets[i]={}),s.codeName&&(t.Sheets[i].CodeName=wt(jt(s.codeName)))}function q3(e,r,t,i,s){Bu(e.slice(0,e.indexOf(">")),t,i,s)}function Z3(e,r,t){for(var i=Array.isArray(e),s=0;s!=r.length;++s){var l=tt(jt(r[s]),!0);if(!l.ref)return;var c=((t||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+wt(l.location))):(l.Target="#"+wt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Gt(l.ref),h=u.s.r;h<=u.e.r;++h)for(var x=u.s.c;x<=u.e.c;++x){var p=it({c:x,r:h});i?(e[h]||(e[h]=[]),e[h][x]||(e[h][x]={t:"z",v:void 0}),e[h][x].l=l):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=l)}}}function e_(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function t_(e,r){for(var t=!1,i=0;i!=r.length;++i){var s=tt(r[i],!0);s.hidden&&(s.hidden=Bt(s.hidden));var l=parseInt(s.min,10)-1,c=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,Lu(s.width)),Us(s);l<=c;)e[l++]=Er(s)}}function r_(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var n_=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function a_(e,r){r.Views||(r.Views=[{}]),(e.match(n_)||[]).forEach(function(t,i){var s=tt(t);r.Views[i]||(r.Views[i]={}),+s.zoomScale&&(r.Views[i].zoom=+s.zoomScale),Bt(s.rightToLeft)&&(r.Views[i].RTL=!0)})}var s_=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=zi("v"),c=zi("f");return function(h,x,p,v,y,E){for(var k=0,w="",S=[],O=[],R=0,C=0,L=0,X="",W,M,V=0,G=0,oe,B,K=0,me=0,he=Array.isArray(E.CellXf),we,Oe=[],Ee=[],Se=Array.isArray(x),Y=[],xe={},z=!1,T=!!p.sheetStubs,J=h.split(r),H=0,I=J.length;H!=I;++H){w=J[H].trim();var ne=w.length;if(ne!==0){var fe=0;e:for(k=0;k<ne;++k)switch(w[k]){case">":if(w[k-1]!="/"){++k;break e}if(p&&p.cellStyles){if(M=tt(w.slice(fe,k),!0),V=M.r!=null?parseInt(M.r,10):V+1,G=-1,p.sheetRows&&p.sheetRows<V)continue;xe={},z=!1,M.ht&&(z=!0,xe.hpt=parseFloat(M.ht),xe.hpx=Gi(xe.hpt)),M.hidden=="1"&&(z=!0,xe.hidden=!0),M.outlineLevel!=null&&(z=!0,xe.level=+M.outlineLevel),z&&(Y[V-1]=xe)}break;case"<":fe=k;break}if(fe>=k)break;if(M=tt(w.slice(fe,k),!0),V=M.r!=null?parseInt(M.r,10):V+1,G=-1,!(p.sheetRows&&p.sheetRows<V)){v.s.r>V-1&&(v.s.r=V-1),v.e.r<V-1&&(v.e.r=V-1),p&&p.cellStyles&&(xe={},z=!1,M.ht&&(z=!0,xe.hpt=parseFloat(M.ht),xe.hpx=Gi(xe.hpt)),M.hidden=="1"&&(z=!0,xe.hidden=!0),M.outlineLevel!=null&&(z=!0,xe.level=+M.outlineLevel),z&&(Y[V-1]=xe)),S=w.slice(k).split(e);for(var ye=0;ye!=S.length&&S[ye].trim().charAt(0)=="<";++ye);for(S=S.slice(ye),k=0;k!=S.length;++k)if(w=S[k].trim(),w.length!==0){if(O=w.match(t),R=k,C=0,L=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,O!=null&&O.length===2){for(R=0,X=O[1],C=0;C!=X.length&&!((L=X.charCodeAt(C)-64)<1||L>26);++C)R=26*R+L;--R,G=R}else++G;for(C=0;C!=w.length&&w.charCodeAt(C)!==62;++C);if(++C,M=tt(w.slice(0,C),!0),M.r||(M.r=it({r:V-1,c:G})),X=w.slice(C),W={t:""},(O=X.match(l))!=null&&O[1]!==""&&(W.v=wt(O[1])),p.cellFormula){if((O=X.match(c))!=null&&O[1]!==""){if(W.f=wt(jt(O[1])).replace(/\r\n/g,`
`),p.xlfn||(W.f=Ox(W.f)),O[0].indexOf('t="array"')>-1)W.F=(X.match(s)||[])[1],W.F.indexOf(":")>-1&&Oe.push([Gt(W.F),W.F]);else if(O[0].indexOf('t="shared"')>-1){B=tt(O[0]);var le=wt(jt(O[1]));p.xlfn||(le=Ox(le)),Ee[parseInt(B.si,10)]=[B,le,M.r]}}else(O=X.match(/<f[^>]*\/>/))&&(B=tt(O[0]),Ee[B.si]&&(W.f=mb(Ee[B.si][1],Ee[B.si][2],M.r)));var de=Vr(M.r);for(C=0;C<Oe.length;++C)de.r>=Oe[C][0].s.r&&de.r<=Oe[C][0].e.r&&de.c>=Oe[C][0].s.c&&de.c<=Oe[C][0].e.c&&(W.F=Oe[C][1])}if(M.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(T)W.t="z";else continue;else W.t=M.t||"n";switch(v.s.c>G&&(v.s.c=G),v.e.c<G&&(v.e.c=G),W.t){case"n":if(W.v==""||W.v==null){if(!T)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!T)continue;W.t="z"}else oe=Li[parseInt(W.v,10)],W.v=oe.t,W.r=oe.r,p.cellHTML&&(W.h=oe.h);break;case"str":W.t="s",W.v=W.v!=null?jt(W.v):"",p.cellHTML&&(W.h=Tu(W.v));break;case"inlineStr":O=X.match(i),W.t="s",O!=null&&(oe=Pu(O[1]))?(W.v=oe.t,p.cellHTML&&(W.h=oe.h)):W.v="";break;case"b":W.v=Bt(W.v);break;case"d":p.cellDates?W.v=mr(W.v,1):(W.v=Gr(mr(W.v,1)),W.t="n");break;case"e":(!p||p.cellText!==!1)&&(W.w=W.v),W.v=c1[W.v];break}if(K=me=0,we=null,he&&M.s!==void 0&&(we=E.CellXf[M.s],we!=null&&(we.numFmtId!=null&&(K=we.numFmtId),p.cellStyles&&we.fillId!=null&&(me=we.fillId))),H1(W,K,me,p,y,E),p.cellDates&&he&&W.t=="n"&&zs(ot[K])&&(W.t="d",W.v=Mo(W.v)),M.cm&&p.xlmeta){var pe=(p.xlmeta.Cell||[])[+M.cm-1];pe&&pe.type=="XLDAPR"&&(W.D=!0)}if(Se){var N=Vr(M.r);x[N.r]||(x[N.r]=[]),x[N.r][N.c]=W}else x[M.r]=W}}}}Y.length>0&&(x["!rows"]=Y)}})();function i_(e,r){var t={},i=e.l+r;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=i,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=s/20),t}var l_=is;function o_(){}function c_(e,r){var t={},i=e[e.l];return++e.l,t.above=!(i&64),t.left=!(i&128),e.l+=18,t.name=Dk(e),t}function u_(e){var r=kn(e);return[r]}function f_(e){var r=ss(e);return[r]}function d_(e){var r=kn(e),t=e.read_shift(1);return[r,t,"b"]}function h_(e){var r=ss(e),t=e.read_shift(1);return[r,t,"b"]}function x_(e){var r=kn(e),t=e.read_shift(1);return[r,t,"e"]}function p_(e){var r=ss(e),t=e.read_shift(1);return[r,t,"e"]}function m_(e){var r=kn(e),t=e.read_shift(4);return[r,t,"s"]}function g_(e){var r=ss(e),t=e.read_shift(4);return[r,t,"s"]}function v_(e){var r=kn(e),t=Fr(e);return[r,t,"n"]}function W1(e){var r=ss(e),t=Fr(e);return[r,t,"n"]}function w_(e){var r=kn(e),t=ju(e);return[r,t,"n"]}function y_(e){var r=ss(e),t=ju(e);return[r,t,"n"]}function k_(e){var r=kn(e),t=Du(e);return[r,t,"is"]}function E_(e){var r=kn(e),t=Or(e);return[r,t,"str"]}function S_(e){var r=ss(e),t=Or(e);return[r,t,"str"]}function b_(e,r,t){var i=e.l+r,s=kn(e);s.r=t["!row"];var l=e.read_shift(1),c=[s,l,"b"];if(t.cellFormula){e.l+=2;var u=Ho(e,i-e.l,t);c[3]=Ar(u,null,s,t.supbooks,t)}else e.l=i;return c}function __(e,r,t){var i=e.l+r,s=kn(e);s.r=t["!row"];var l=e.read_shift(1),c=[s,l,"e"];if(t.cellFormula){e.l+=2;var u=Ho(e,i-e.l,t);c[3]=Ar(u,null,s,t.supbooks,t)}else e.l=i;return c}function T_(e,r,t){var i=e.l+r,s=kn(e);s.r=t["!row"];var l=Fr(e),c=[s,l,"n"];if(t.cellFormula){e.l+=2;var u=Ho(e,i-e.l,t);c[3]=Ar(u,null,s,t.supbooks,t)}else e.l=i;return c}function C_(e,r,t){var i=e.l+r,s=kn(e);s.r=t["!row"];var l=Or(e),c=[s,l,"str"];if(t.cellFormula){e.l+=2;var u=Ho(e,i-e.l,t);c[3]=Ar(u,null,s,t.supbooks,t)}else e.l=i;return c}var N_=is;function A_(e,r){var t=e.l+r,i=is(e),s=Ou(e),l=Or(e),c=Or(e),u=Or(e);e.l=t;var h={rfx:i,relId:s,loc:l,display:u};return c&&(h.Tooltip=c),h}function F_(){}function D_(e,r,t){var i=e.l+r,s=i1(e),l=e.read_shift(1),c=[s];if(c[2]=l,t.cellFormula){var u=P3(e,i-e.l,t);c[1]=u}else e.l=i;return c}function O_(e,r,t){var i=e.l+r,s=is(e),l=[s];if(t.cellFormula){var c=M3(e,i-e.l,t);l[1]=c,e.l=i}else e.l=i;return l}var j_=["left","right","top","bottom","header","footer"];function I_(e){var r={};return j_.forEach(function(t){r[t]=Fr(e)}),r}function R_(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function P_(){}function L_(){}function M_(e,r,t,i,s,l,c){if(!e)return e;var u=r||{};i||(i={"!id":{}});var h=u.dense?[]:{},x,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,y=!1,E,k,w,S,O,R,C,L,X,W=[];u.biff=12,u["!row"]=0;var M=0,V=!1,G=[],oe={},B=u.supbooks||s.supbooks||[[]];if(B.sharedf=oe,B.arrayf=G,B.SheetNames=s.SheetNames||s.Sheets.map(function(Se){return Se.name}),!u.supbooks&&(u.supbooks=B,s.Names))for(var K=0;K<s.Names.length;++K)B[0][K+1]=s.Names[K];var me=[],he=[],we=!1;Do[16]={n:"BrtShortReal",f:W1};var Oe;if(sa(e,function(Y,xe,z){if(!y)switch(z){case 148:x=Y;break;case 0:E=Y,u.sheetRows&&u.sheetRows<=E.r&&(y=!0),L=Sr(S=E.r),u["!row"]=E.r,(Y.hidden||Y.hpt||Y.level!=null)&&(Y.hpt&&(Y.hpx=Gi(Y.hpt)),he[Y.r]=Y);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(k={t:Y[2]},Y[2]){case"n":k.v=Y[1];break;case"s":C=Li[Y[1]],k.v=C.t,k.r=C.r;break;case"b":k.v=!!Y[1];break;case"e":k.v=Y[1],u.cellText!==!1&&(k.w=ls[k.v]);break;case"str":k.t="s",k.v=Y[1];break;case"is":k.t="s",k.v=Y[1].t;break}if((w=c.CellXf[Y[0].iStyleRef])&&H1(k,w.numFmtId,null,u,l,c),O=Y[0].c==-1?O+1:Y[0].c,u.dense?(h[S]||(h[S]=[]),h[S][O]=k):h[or(O)+L]=k,u.cellFormula){for(V=!1,M=0;M<G.length;++M){var T=G[M];E.r>=T[0].s.r&&E.r<=T[0].e.r&&O>=T[0].s.c&&O<=T[0].e.c&&(k.F=gt(T[0]),V=!0)}!V&&Y.length>3&&(k.f=Y[3])}if(p.s.r>E.r&&(p.s.r=E.r),p.s.c>O&&(p.s.c=O),p.e.r<E.r&&(p.e.r=E.r),p.e.c<O&&(p.e.c=O),u.cellDates&&w&&k.t=="n"&&zs(ot[w.numFmtId])){var J=Qa(k.v);J&&(k.t="d",k.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}Oe&&(Oe.type=="XLDAPR"&&(k.D=!0),Oe=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;k={t:"z",v:void 0},O=Y[0].c==-1?O+1:Y[0].c,u.dense?(h[S]||(h[S]=[]),h[S][O]=k):h[or(O)+L]=k,p.s.r>E.r&&(p.s.r=E.r),p.s.c>O&&(p.s.c=O),p.e.r<E.r&&(p.e.r=E.r),p.e.c<O&&(p.e.c=O),Oe&&(Oe.type=="XLDAPR"&&(k.D=!0),Oe=void 0);break;case 176:W.push(Y);break;case 49:Oe=((u.xlmeta||{}).Cell||[])[Y-1];break;case 494:var H=i["!id"][Y.relId];for(H?(Y.Target=H.Target,Y.loc&&(Y.Target+="#"+Y.loc),Y.Rel=H):Y.relId==""&&(Y.Target="#"+Y.loc),S=Y.rfx.s.r;S<=Y.rfx.e.r;++S)for(O=Y.rfx.s.c;O<=Y.rfx.e.c;++O)u.dense?(h[S]||(h[S]=[]),h[S][O]||(h[S][O]={t:"z",v:void 0}),h[S][O].l=Y):(R=it({c:O,r:S}),h[R]||(h[R]={t:"z",v:void 0}),h[R].l=Y);break;case 426:if(!u.cellFormula)break;G.push(Y),X=u.dense?h[S][O]:h[or(O)+L],X.f=Ar(Y[1],p,{r:E.r,c:O},B,u),X.F=gt(Y[0]);break;case 427:if(!u.cellFormula)break;oe[it(Y[0].s)]=Y[1],X=u.dense?h[S][O]:h[or(O)+L],X.f=Ar(Y[1],p,{r:E.r,c:O},B,u);break;case 60:if(!u.cellStyles)break;for(;Y.e>=Y.s;)me[Y.e--]={width:Y.w/256,hidden:!!(Y.flags&1),level:Y.level},we||(we=!0,Lu(Y.w/256)),Us(me[Y.e+1]);break;case 161:h["!autofilter"]={ref:gt(Y)};break;case 476:h["!margins"]=Y;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),Y.name&&(s.Sheets[t].CodeName=Y.name),(Y.above||Y.left)&&(h["!outline"]={above:Y.above,left:Y.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),Y.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!xe.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+z.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(h["!ref"]=gt(x||p)),u.sheetRows&&h["!ref"]){var Ee=Gt(h["!ref"]);u.sheetRows<=+Ee.e.r&&(Ee.e.r=u.sheetRows-1,Ee.e.r>p.e.r&&(Ee.e.r=p.e.r),Ee.e.r<Ee.s.r&&(Ee.s.r=Ee.e.r),Ee.e.c>p.e.c&&(Ee.e.c=p.e.c),Ee.e.c<Ee.s.c&&(Ee.s.c=Ee.e.c),h["!fullref"]=h["!ref"],h["!ref"]=gt(Ee))}return W.length>0&&(h["!merges"]=W),me.length>0&&(h["!cols"]=me),he.length>0&&(h["!rows"]=he),h}function B_(e){var r=[],t=e.match(/^<c:numCache>/),i;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(r[+c[1]]=t?+c[2]:c[2])});var s=wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){i=l.replace(/<.*?>/g,"")}),[r,s,i]}function U_(e,r,t,i,s,l){var c=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,x="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var y=B_(v);p.s.r=p.s.c=0,p.e.c=u,x=or(u),y[0].forEach(function(E,k){c[x+Sr(k)]={t:"n",v:E,z:y[1]},h=k}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(c["!ref"]=gt(p)),c}function H_(e,r,t,i,s){if(!e)return e;i||(i={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,u=e.match(z1);return u&&Bu(u[0],l,s,t),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),i["!id"][l["!rel"]]&&(l["!drawel"]=i["!id"][l["!rel"]]),l}function z_(e,r){e.l+=10;var t=Or(e);return{name:t}}function W_(e,r,t,i,s){if(!e)return e;i||(i={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return sa(e,function(h,x,p){switch(p){case 550:l["!rel"]=h;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),h.name&&(s.Sheets[t].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!c||r.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},r),i["!id"][l["!rel"]]&&(l["!drawel"]=i["!id"][l["!rel"]]),l}var V1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],V_=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$_=[],G_=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Lx(e,r){for(var t=0;t!=e.length;++t)for(var i=e[t],s=0;s!=r.length;++s){var l=r[s];if(i[l[0]]==null)i[l[0]]=l[1];else switch(l[2]){case"bool":typeof i[l[0]]=="string"&&(i[l[0]]=Bt(i[l[0]]));break;case"int":typeof i[l[0]]=="string"&&(i[l[0]]=parseInt(i[l[0]],10));break}}}function Mx(e,r){for(var t=0;t!=r.length;++t){var i=r[t];if(e[i[0]]==null)e[i[0]]=i[1];else switch(i[2]){case"bool":typeof e[i[0]]=="string"&&(e[i[0]]=Bt(e[i[0]]));break;case"int":typeof e[i[0]]=="string"&&(e[i[0]]=parseInt(e[i[0]],10));break}}}function $1(e){Mx(e.WBProps,V1),Mx(e.CalcPr,G_),Lx(e.WBView,V_),Lx(e.Sheets,$_),Ms.date1904=Bt(e.WBProps.date1904)}var X_="][*?/\\".split("");function K_(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return X_.forEach(function(i){if(e.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var Y_=/<\w+:workbook/;function Q_(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,s="xmlns",l={},c=0;if(e.replace(Ir,function(h,x){var p=tt(h);switch(zn(p[0])){case"<?xml":break;case"<workbook":h.match(Y_)&&(s="xmlns"+h.match(/<(\w+):/)[1]),t.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":V1.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":t.WBProps[v[0]]=Bt(p[v[0]]);break;case"int":t.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:t.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(t.WBProps.CodeName=jt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=wt(jt(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":l={},l.Name=jt(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),Bt(p.hidden||"0")&&(l.Hidden=!0),c=x+h.length;break;case"</definedName>":l.Ref=wt(jt(e.slice(c,x))),t.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&r.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),xk.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return $1(t),t}function J_(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=eu(e),t.name=Or(e),t}function q_(e,r){var t={},i=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=r>8?Or(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function Z_(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function eT(e,r,t){var i=e.l+r;e.l+=4,e.l+=1;var s=e.read_shift(4),l=Ok(e),c=L3(e,0,t),u=Ou(e);e.l=i;var h={Name:l,Ptg:c};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function tT(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],s=!1;r||(r={}),r.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],Do[16]={n:"BrtFRTArchID$",f:Z_},sa(e,function(h,x,p){switch(p){case 156:c.SheetNames.push(h.name),t.Sheets.push(h);break;case 153:t.WBProps=h;break;case 39:h.Sheet!=null&&(r.SID=h.Sheet),h.Ref=Ar(h.Ptg,null,null,c,r),delete r.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([p,h]):c[0]=[p,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(p),s=!0;break;case 36:i.pop(),s=!1;break;case 37:i.push(p),s=!0;break;case 38:i.pop(),s=!1;break;case 16:break;default:if(!x.T){if(!s||r.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},r),$1(t),t.Names=l,t.supbooks=c,t}function rT(e,r,t){return r.slice(-4)===".bin"?tT(e,t):Q_(e,t)}function nT(e,r,t,i,s,l,c,u){return r.slice(-4)===".bin"?M_(e,i,t,s,l,c,u):J3(e,i,t,s,l,c,u)}function aT(e,r,t,i,s,l,c,u){return r.slice(-4)===".bin"?W_(e,i,t,s,l):H_(e,i,t,s,l)}function sT(e,r,t,i,s,l,c,u){return r.slice(-4)===".bin"?hb():xb()}function iT(e,r,t,i,s,l,c,u){return r.slice(-4)===".bin"?fb():db()}function lT(e,r,t,i){return r.slice(-4)===".bin"?NS(e,t,i):ES(e,t,i)}function oT(e,r,t){return D1(e,t)}function cT(e,r,t){return r.slice(-4)===".bin"?VE(e,t):zE(e,t)}function uT(e,r,t){return r.slice(-4)===".bin"?ob(e,t):nb(e,t)}function fT(e,r,t){return r.slice(-4)===".bin"?eb(e):qS(e)}function dT(e,r,t,i){return t.slice(-4)===".bin"?tb(e,r,t,i):void 0}function hT(e,r,t){return r.slice(-4)===".bin"?QS(e,r,t):JS(e,r,t)}var G1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,X1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Nn(e,r){var t=e.split(/\s+/),i=[];if(i[0]=t[0],t.length===1)return i;var s=e.match(G1),l,c,u,h;if(s)for(h=0;h!=s.length;++h)l=s[h].match(X1),(c=l[1].indexOf(":"))===-1?i[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(c+1),i[u]=l[2].slice(1,l[2].length-1));return i}function xT(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var i=e.match(G1),s,l,c,u;if(i)for(u=0;u!=i.length;++u)s=i[u].match(X1),(l=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),t[c]=s[2].slice(1,s[2].length-1));return t}var Bi;function pT(e,r){var t=Bi[e]||wt(e);return t==="General"?es(r):yn(t,r)}function mT(e,r,t,i){var s=i;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Bt(i);break;case"i2":case"int":s=parseInt(i,10);break;case"r4":case"float":s=parseFloat(i);break;case"date":case"dateTime.tz":s=mr(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[wt(r)]=s}function gT(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ls[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hi(e.v):e.w=es(e.v):e.w=pT(r||"General",e.v)}catch(l){if(t.WTF)throw l}try{var i=Bi[r]||r||"General";if(t.cellNF&&(e.z=i),t.cellDates&&e.t=="n"&&zs(i)){var s=Qa(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(t.WTF)throw l}}}function vT(e,r,t){if(t.cellStyles&&r.Interior){var i=r.Interior;i.Pattern&&(i.patternType=mS[i.Pattern]||i.Pattern)}e[r.ID]=r}function wT(e,r,t,i,s,l,c,u,h,x){var p="General",v=i.StyleID,y={};x=x||{};var E=[],k=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&c&&(v=c.StyleID);l[v]!==void 0&&(l[v].nf&&(p=l[v].nf),l[v].Interior&&E.push(l[v].Interior),!!l[v].Parent);)v=l[v].Parent;switch(t.Type){case"Boolean":i.t="b",i.v=Bt(e);break;case"String":i.t="s",i.r=ix(wt(e)),i.v=e.indexOf("<")>-1?wt(r||e).replace(/<.*?>/g,""):i.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),i.v=(mr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),i.v!==i.v?i.v=wt(e):i.v<60&&(i.v=i.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+e),i.t||(i.t="n");break;case"Error":i.t="e",i.v=c1[e],x.cellText!==!1&&(i.w=e);break;default:e==""&&r==""?i.t="z":(i.t="s",i.v=ix(r||e));break}if(gT(i,p,x),x.cellFormula!==!1)if(i.Formula){var w=wt(i.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),i.f=Ls(w,s),delete i.Formula,i.ArrayRange=="RC"?i.F=Ls("RC:RC",s):i.ArrayRange&&(i.F=Ls(i.ArrayRange,s),h.push([Gt(i.F),i.F]))}else for(k=0;k<h.length;++k)s.r>=h[k][0].s.r&&s.r<=h[k][0].e.r&&s.c>=h[k][0].s.c&&s.c<=h[k][0].e.c&&(i.F=h[k][1]);x.cellStyles&&(E.forEach(function(S){!y.patternType&&S.patternType&&(y.patternType=S.patternType)}),i.s=y),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function yT(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Uc(e,r){var t=r||{};Rp();var i=Ti(Cu(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(i=jt(i));var s=i.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var c=Er(t);return c.type="string",Vi.to_workbook(i,c)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(St){s.indexOf("<"+St)>=0&&(l=!0)}),l)return AT(i,t);Bi={"General Number":"General","General Date":ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ot[15],"Short Date":ot[14],"Long Time":ot[19],"Medium Time":ot[18],"Short Time":ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ot[2],Standard:ot[4],Percent:ot[10],Scientific:ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],x,p={},v=[],y=t.dense?[]:{},E="",k={},w={},S=Nn('<Data ss:Type="String">'),O=0,R=0,C=0,L={s:{r:2e6,c:2e6},e:{r:0,c:0}},X={},W={},M="",V=0,G=[],oe={},B={},K=0,me=[],he=[],we={},Oe=[],Ee,Se=!1,Y=[],xe=[],z={},T=0,J=0,H={Sheets:[],WBProps:{date1904:!1}},I={};Wi.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";u=Wi.exec(i);)switch(u[3]=(ne=u[3]).toLowerCase()){case"data":if(ne=="data"){if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?wT(i.slice(O,u.index),M,S,h[h.length-1][0]=="comment"?we:k,{c:R,r:C},X,Oe[R],w,Y,t):(M="",S=Nn(u[0]),O=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(he.length>0&&(k.c=he),(!t.sheetRows||t.sheetRows>C)&&k.v!==void 0&&(t.dense?(y[C]||(y[C]=[]),y[C][R]=k):y[or(R)+Sr(C)]=k),k.HRef&&(k.l={Target:wt(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(T=R+(parseInt(k.MergeAcross,10)|0),J=C+(parseInt(k.MergeDown,10)|0),G.push({s:{c:R,r:C},e:{c:T,r:J}})),!t.sheetStubs)k.MergeAcross?R=T+1:++R;else if(k.MergeAcross||k.MergeDown){for(var fe=R;fe<=T;++fe)for(var ye=C;ye<=J;++ye)(fe>R||ye>C)&&(t.dense?(y[ye]||(y[ye]=[]),y[ye][fe]={t:"z"}):y[or(fe)+Sr(ye)]={t:"z"});R=T+1}else++R;else k=xT(u[0]),k.Index&&(R=+k.Index-1),R<L.s.c&&(L.s.c=R),R>L.e.c&&(L.e.c=R),u[0].slice(-2)==="/>"&&++R,he=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<L.s.r&&(L.s.r=C),C>L.e.r&&(L.e.r=C),u[0].slice(-2)==="/>"&&(w=Nn(u[0]),w.Index&&(C=+w.Index-1)),R=0,++C):(w=Nn(u[0]),w.Index&&(C=+w.Index-1),z={},(w.AutoFitHeight=="0"||w.Height)&&(z.hpx=parseInt(w.Height,10),z.hpt=F1(z.hpx),xe[C]=z),w.Hidden=="1"&&(z.hidden=!0,xe[C]=z));break;case"worksheet":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"));v.push(E),L.s.r<=L.e.r&&L.s.c<=L.e.c&&(y["!ref"]=gt(L),t.sheetRows&&t.sheetRows<=L.e.r&&(y["!fullref"]=y["!ref"],L.e.r=t.sheetRows-1,y["!ref"]=gt(L))),G.length&&(y["!merges"]=G),Oe.length>0&&(y["!cols"]=Oe),xe.length>0&&(y["!rows"]=xe),p[E]=y}else L={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=R=0,h.push([u[3],!1]),x=Nn(u[0]),E=wt(x.Name),y=t.dense?[]:{},G=[],Y=[],xe=[],I={name:E,Hidden:0},H.Sheets.push(I);break;case"table":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),Oe=[],Se=!1}break;case"style":u[1]==="/"?vT(X,W,t):W=Nn(u[0]);break;case"numberformat":W.nf=wt(Nn(u[0]).Format||"General"),Bi[W.nf]&&(W.nf=Bi[W.nf]);for(var le=0;le!=392&&ot[le]!=W.nf;++le);if(le==392){for(le=57;le!=392;++le)if(ot[le]==null){Ja(W.nf,le);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(Ee=Nn(u[0]),Ee.Hidden&&(Ee.hidden=!0,delete Ee.Hidden),Ee.Width&&(Ee.wpx=parseInt(Ee.Width,10)),!Se&&Ee.wpx>10){Se=!0,Wr=N1;for(var de=0;de<Oe.length;++de)Oe[de]&&Us(Oe[de])}Se&&Us(Ee),Oe[Ee.Index-1||Oe.length]=Ee;for(var pe=0;pe<+Ee.Span;++pe)Oe[Oe.length]=Er(Ee);break;case"namedrange":if(u[1]==="/")break;H.Names||(H.Names=[]);var N=tt(u[0]),_e={Name:N.Name,Ref:Ls(N.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(_e.Sheet=H.Sheets.length-1),H.Names.push(_e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?M+=i.slice(V,u.index):V=u.index+u[0].length;break;case"interior":if(!t.cellStyles)break;W.Interior=Nn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?n4(oe,ne,i.slice(K,u.index)):K=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"));yT(we),he.push(we)}else h.push([u[3],!1]),x=Nn(u[0]),we={a:x.Author};break;case"autofilter":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ne=Nn(u[0]);y["!autofilter"]={ref:Ls(Ne.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return Vx(i,t);var Qe=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Qe=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Qe=!1}break;case"excelworkbook":switch(u[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Qe=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Qe=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(i.slice(K,u.index)){case"SheetHidden":I.Hidden=1;break;case"SheetVeryHidden":I.Hidden=2;break}else K=u.index+u[0].length;break;case"header":y["!margins"]||Mi(y["!margins"]={},"xlml"),isNaN(+tt(u[0]).Margin)||(y["!margins"].header=+tt(u[0]).Margin);break;case"footer":y["!margins"]||Mi(y["!margins"]={},"xlml"),isNaN(+tt(u[0]).Margin)||(y["!margins"].footer=+tt(u[0]).Margin);break;case"pagemargins":var Ge=tt(u[0]);y["!margins"]||Mi(y["!margins"]={},"xlml"),isNaN(+Ge.Top)||(y["!margins"].top=+Ge.Top),isNaN(+Ge.Left)||(y["!margins"].left=+Ge.Left),isNaN(+Ge.Right)||(y["!margins"].right=+Ge.Right),isNaN(+Ge.Bottom)||(y["!margins"].bottom=+Ge.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Qe=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Qe=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Qe=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Qe=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Qe=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Qe=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Qe=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Qe=!1}break;case"smarttags":break;default:Qe=!1;break}if(Qe||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?mT(B,ne,me,i.slice(K,u.index)):(me=u,K=u.index+u[0].length);break}if(t.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Pe={};return!t.bookSheets&&!t.bookProps&&(Pe.Sheets=p),Pe.SheetNames=v,Pe.Workbook=H,Pe.SSF=Er(ot),Pe.Props=oe,Pe.Custprops=B,Pe}function au(e,r){switch(zu(r=r||{}),r.type||"base64"){case"base64":return Uc(on(e),r);case"binary":case"buffer":case"file":return Uc(e,r);case"array":return Uc(as(e),r)}}function kT(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Rk(t),t.length-t.l<=4)return r;var i=t.read_shift(4);if(i==0||i>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(i=t.read_shift(4),i!==1907505652)||(r.UnicodeClipboardFormat=Pk(t),i=t.read_shift(4),i==0||i>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var ET=[60,1084,2066,2165,2175];function ST(e,r,t,i,s){var l=i,c=[],u=t.slice(t.l,t.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}c.push(u),t.l+=l;for(var h=Zn(t,t.l),x=su[h],p=0;x!=null&&ET.indexOf(h)>-1;)l=Zn(t,t.l+2),p=t.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=t.slice(p,t.l+4+l),c.push(u),t.l+=4+l,x=su[h=Zn(t,t.l)];var v=Na(c);kr(v,0);var y=0;v.lens=[];for(var E=0;E<c.length;++E)v.lens.push(y),y+=c[E].length;if(v.length<i)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+i;return r.f(v,v.length,s)}function Mn(e,r,t){if(e.t!=="z"&&e.XF){var i=0;try{i=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=ot[i])}catch(l){if(r.WTF)throw l}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ls[e.v]:i===0||i=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hi(e.v):e.w=es(e.v):e.w=yn(i,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(l){if(r.WTF)throw l}if(r.cellDates&&i&&e.t=="n"&&zs(ot[i]||String(i))){var s=Qa(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function mo(e,r,t){return{v:e,ixfe:r,t}}function bT(e,r){var t={opts:{}},i={},s=r.dense?[]:{},l={},c={},u=null,h=[],x="",p={},v,y="",E,k,w,S,O={},R=[],C,L,X=[],W=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},G=function(Ze){return Ze<8?qa[Ze]:Ze<64&&W[Ze-8]||qa[Ze]},oe=function(Ze,ht,ar){var _t=ht.XF.data;if(!(!_t||!_t.patternType||!ar||!ar.cellStyles)){ht.s={},ht.s.patternType=_t.patternType;var ge;(ge=$i(G(_t.icvFore)))&&(ht.s.fgColor={rgb:ge}),(ge=$i(G(_t.icvBack)))&&(ht.s.bgColor={rgb:ge})}},B=function(Ze,ht,ar){if(!(z>1)&&!(ar.sheetRows&&Ze.r>=ar.sheetRows)){if(ar.cellStyles&&ht.XF&&ht.XF.data&&oe(Ze,ht,ar),delete ht.ixfe,delete ht.XF,v=Ze,y=it(Ze),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<c.s.r&&(c.s.r=Ze.r),Ze.c<c.s.c&&(c.s.c=Ze.c),Ze.r+1>c.e.r&&(c.e.r=Ze.r+1),Ze.c+1>c.e.c&&(c.e.c=Ze.c+1),ar.cellFormula&&ht.f){for(var _t=0;_t<R.length;++_t)if(!(R[_t][0].s.c>Ze.c||R[_t][0].s.r>Ze.r)&&!(R[_t][0].e.c<Ze.c||R[_t][0].e.r<Ze.r)){ht.F=gt(R[_t][0]),(R[_t][0].s.c!=Ze.c||R[_t][0].s.r!=Ze.r)&&delete ht.f,ht.f&&(ht.f=""+Ar(R[_t][1],c,Ze,Y,K));break}}ar.dense?(s[Ze.r]||(s[Ze.r]=[]),s[Ze.r][Ze.c]=ht):s[y]=ht}},K={enc:!1,sbcch:0,snames:[],sharedf:O,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(K.password=r.password);var me,he=[],we=[],Oe=[],Ee=[],Se=!1,Y=[];Y.SheetNames=K.snames,Y.sharedf=K.sharedf,Y.arrayf=K.arrayf,Y.names=[],Y.XTI=[];var xe=0,z=0,T=0,J=[],H=[],I;K.codepage=1200,Dn(1200);for(var ne=!1;e.l<e.length-1;){var fe=e.l,ye=e.read_shift(2);if(ye===0&&xe===10)break;var le=e.l===e.length?0:e.read_shift(2),de=su[ye];if(de&&de.f){if(r.bookSheets&&xe===133&&ye!==133)break;if(xe=ye,de.r===2||de.r==12){var pe=e.read_shift(2);if(le-=2,!K.enc&&pe!==ye&&((pe&255)<<8|pe>>8)!==ye)throw new Error("rt mismatch: "+pe+"!="+ye);de.r==12&&(e.l+=10,le-=10)}var N={};if(ye===10?N=de.f(e,le,K):N=ST(ye,de,e,le,K),z==0&&[9,521,1033,2057].indexOf(xe)===-1)continue;switch(ye){case 34:t.opts.Date1904=M.WBProps.date1904=N;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(K.enc||(e.l=0),K.enc=N,!r.password)throw new Error("File is password-protected");if(N.valid==null)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:K.lastuser=N;break;case 66:var _e=Number(N);switch(_e){case 21010:_e=1200;break;case 32768:_e=1e4;break;case 32769:_e=1252;break}Dn(K.codepage=_e),ne=!0;break;case 317:K.rrtabid=N;break;case 25:K.winlocked=N;break;case 439:t.opts.RefreshAll=N;break;case 12:t.opts.CalcCount=N;break;case 16:t.opts.CalcDelta=N;break;case 17:t.opts.CalcIter=N;break;case 13:t.opts.CalcMode=N;break;case 14:t.opts.CalcPrecision=N;break;case 95:t.opts.CalcSaveRecalc=N;break;case 15:K.CalcRefMode=N;break;case 2211:t.opts.FullCalc=N;break;case 129:N.fDialog&&(s["!type"]="dialog"),N.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),N.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:X.push(N);break;case 430:Y.push([N]),Y[Y.length-1].XTI=[];break;case 35:case 547:Y[Y.length-1].push(N);break;case 24:case 536:I={Name:N.Name,Ref:Ar(N.rgce,c,null,Y,K)},N.itab>0&&(I.Sheet=N.itab-1),Y.names.push(I),Y[0]||(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].push(N),N.Name=="_xlnm._FilterDatabase"&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&N.rgce[0][0][0]=="PtgArea3d"&&(H[N.itab-1]={ref:gt(N.rgce[0][0][1][2])});break;case 22:K.ExternCount=N;break;case 23:Y.length==0&&(Y[0]=[],Y[0].XTI=[]),Y[Y.length-1].XTI=Y[Y.length-1].XTI.concat(N),Y.XTI=Y.XTI.concat(N);break;case 2196:if(K.biff<8)break;I!=null&&(I.Comment=N[1]);break;case 18:s["!protect"]=N;break;case 19:N!==0&&K.WTF&&console.error("Password verifier: "+N);break;case 133:l[N.pos]=N,K.snames.push(N.name);break;case 10:{if(--z)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,s["!ref"]=gt(c),r.sheetRows&&r.sheetRows<=c.e.r){var Ne=c.e.r;c.e.r=r.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=gt(c),c.e.r=Ne}c.e.r++,c.e.c++}he.length>0&&(s["!merges"]=he),we.length>0&&(s["!objects"]=we),Oe.length>0&&(s["!cols"]=Oe),Ee.length>0&&(s["!rows"]=Ee),M.Sheets.push(V)}x===""?p=s:i[x]=s,s=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(K.biff===8&&(K.biff={9:2,521:3,1033:4}[ye]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),K.biffguess=N.BIFFVer==0,N.BIFFVer==0&&N.dt==4096&&(K.biff=5,ne=!0,Dn(K.codepage=28591)),K.biff==8&&N.BIFFVer==0&&N.dt==16&&(K.biff=2),z++)break;if(s=r.dense?[]:{},K.biff<8&&!ne&&(ne=!0,Dn(K.codepage=r.codepage||1252)),K.biff<5||N.BIFFVer==0&&N.dt==4096){x===""&&(x="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var Qe={pos:e.l-le,name:x};l[Qe.pos]=Qe,K.snames.push(x)}else x=(l[fe]||{name:""}).name;N.dt==32&&(s["!type"]="chart"),N.dt==64&&(s["!type"]="macro"),he=[],we=[],K.arrayf=R=[],Oe=[],Ee=[],Se=!1,V={Hidden:(l[fe]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(r.dense?(s[N.r]||[])[N.c]:s[it({c:N.c,r:N.r})])&&++N.c,C={ixfe:N.ixfe,XF:X[N.ixfe]||{},v:N.val,t:"n"},T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B({c:N.c,r:N.r},C,r);break;case 5:case 517:C={ixfe:N.ixfe,XF:X[N.ixfe],v:N.val,t:N.t},T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B({c:N.c,r:N.r},C,r);break;case 638:C={ixfe:N.ixfe,XF:X[N.ixfe],v:N.rknum,t:"n"},T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B({c:N.c,r:N.r},C,r);break;case 189:for(var Ge=N.c;Ge<=N.C;++Ge){var Pe=N.rkrec[Ge-N.c][0];C={ixfe:Pe,XF:X[Pe],v:N.rkrec[Ge-N.c][1],t:"n"},T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B({c:Ge,r:N.r},C,r)}break;case 6:case 518:case 1030:{if(N.val=="String"){u=N;break}if(C=mo(N.val,N.cell.ixfe,N.tt),C.XF=X[C.ixfe],r.cellFormula){var St=N.formula;if(St&&St[0]&&St[0][0]&&St[0][0][0]=="PtgExp"){var Ft=St[0][0][1][0],Dt=St[0][0][1][1],Xt=it({r:Ft,c:Dt});O[Xt]?C.f=""+Ar(N.formula,c,N.cell,Y,K):C.F=((r.dense?(s[Ft]||[])[Dt]:s[Xt])||{}).F}else C.f=""+Ar(N.formula,c,N.cell,Y,K)}T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B(N.cell,C,r),u=N}break;case 7:case 519:if(u)u.val=N,C=mo(N,u.cell.ixfe,"s"),C.XF=X[C.ixfe],r.cellFormula&&(C.f=""+Ar(u.formula,c,u.cell,Y,K)),T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B(u.cell,C,r),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(N);var Rr=it(N[0].s);if(E=r.dense?(s[N[0].s.r]||[])[N[0].s.c]:s[Rr],r.cellFormula&&E){if(!u||!Rr||!E)break;E.f=""+Ar(N[1],c,N[0],Y,K),E.F=gt(N[0])}}break;case 1212:{if(!r.cellFormula)break;if(y){if(!u)break;O[it(u.cell)]=N[0],E=r.dense?(s[u.cell.r]||[])[u.cell.c]:s[it(u.cell)],(E||{}).f=""+Ar(N[0],c,v,Y,K)}}break;case 253:C=mo(h[N.isst].t,N.ixfe,"s"),h[N.isst].h&&(C.h=h[N.isst].h),C.XF=X[C.ixfe],T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B({c:N.c,r:N.r},C,r);break;case 513:r.sheetStubs&&(C={ixfe:N.ixfe,XF:X[N.ixfe],t:"z"},T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B({c:N.c,r:N.r},C,r));break;case 190:if(r.sheetStubs)for(var gr=N.c;gr<=N.C;++gr){var qt=N.ixfe[gr-N.c];C={ixfe:qt,XF:X[qt],t:"z"},T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B({c:gr,r:N.r},C,r)}break;case 214:case 516:case 4:C=mo(N.val,N.ixfe,"s"),C.XF=X[C.ixfe],T>0&&(C.z=J[C.ixfe>>8&63]),Mn(C,r,t.opts.Date1904),B({c:N.c,r:N.r},C,r);break;case 0:case 512:z===1&&(c=N);break;case 252:h=N;break;case 1054:if(K.biff==4){J[T++]=N[1];for(var nr=0;nr<T+163&&ot[nr]!=N[1];++nr);nr>=163&&Ja(N[1],T+163)}else Ja(N[1],N[0]);break;case 30:{J[T++]=N;for(var Pr=0;Pr<T+163&&ot[Pr]!=N;++Pr);Pr>=163&&Ja(N,T+163)}break;case 229:he=he.concat(N);break;case 93:we[N.cmo[0]]=K.lastobj=N;break;case 438:K.lastobj.TxO=N;break;case 127:K.lastobj.ImData=N;break;case 440:for(S=N[0].s.r;S<=N[0].e.r;++S)for(w=N[0].s.c;w<=N[0].e.c;++w)E=r.dense?(s[S]||[])[w]:s[it({c:w,r:S})],E&&(E.l=N[1]);break;case 2048:for(S=N[0].s.r;S<=N[0].e.r;++S)for(w=N[0].s.c;w<=N[0].e.c;++w)E=r.dense?(s[S]||[])[w]:s[it({c:w,r:S})],E&&E.l&&(E.l.Tooltip=N[1]);break;case 28:{if(K.biff<=5&&K.biff>=2)break;E=r.dense?(s[N[0].r]||[])[N[0].c]:s[it(N[0])];var Lr=we[N[2]];E||(r.dense?(s[N[0].r]||(s[N[0].r]=[]),E=s[N[0].r][N[0].c]={t:"z"}):E=s[it(N[0])]={t:"z"},c.e.r=Math.max(c.e.r,N[0].r),c.s.r=Math.min(c.s.r,N[0].r),c.e.c=Math.max(c.e.c,N[0].c),c.s.c=Math.min(c.s.c,N[0].c)),E.c||(E.c=[]),k={a:N[1],t:Lr.TxO.t},E.c.push(k)}break;case 2173:GS(X[N.ixfe],N.ext);break;case 125:{if(!K.cellStyles)break;for(;N.e>=N.s;)Oe[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(N.flags&1)},Se||(Se=!0,Lu(N.w/256)),Us(Oe[N.e+1])}break;case 520:{var It={};N.level!=null&&(Ee[N.r]=It,It.level=N.level),N.hidden&&(Ee[N.r]=It,It.hidden=!0),N.hpt&&(Ee[N.r]=It,It.hpt=N.hpt,It.hpx=Gi(N.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Mi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ye]]=N;break;case 161:s["!margins"]||Mi(s["!margins"]={}),s["!margins"].header=N.header,s["!margins"].footer=N.footer;break;case 574:N.RTL&&(M.Views[0].RTL=!0);break;case 146:W=N;break;case 2198:me=N;break;case 140:L=N;break;case 442:x?V.CodeName=N||V.name:M.WBProps.CodeName=N||"ThisWorkbook";break}}else de||console.error("Missing Info for XLS Record 0x"+ye.toString(16)),e.l+=le}return t.SheetNames=Hn(l).sort(function(ur,Ze){return Number(ur)-Number(Ze)}).map(function(ur){return l[ur].name}),r.bookSheets||(t.Sheets=i),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&H.forEach(function(ur,Ze){t.Sheets[t.SheetNames[Ze]]["!autofilter"]=ur}),t.Strings=h,t.SSF=Er(ot),K.enc&&(t.Encryption=K.enc),me&&(t.Themes=me),t.Metadata={},L!==void 0&&(t.Metadata.Country=L),Y.names.length>0&&(M.Names=Y.names),t.Workbook=M,t}var Bx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _T(e,r,t){var i=mt.find(e,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var s=Ex(i,zk,Bx.DSI);for(var l in s)r[l]=s[l]}catch(x){if(t.WTF)throw x}var c=mt.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var u=Ex(c,Wk,Bx.SI);for(var h in u)r[h]==null&&(r[h]=u[h])}catch(x){if(t.WTF)throw x}r.HeadingPairs&&r.TitlesOfParts&&(f1(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function K1(e,r){r||(r={}),zu(r),Sp(),r.codepage&&yu(r.codepage);var t,i;if(e.FullPaths){if(mt.find(e,"/encryption"))throw new Error("File is password-protected");t=mt.find(e,"!CompObj"),i=mt.find(e,"/Workbook")||mt.find(e,"/Book")}else{switch(r.type){case"base64":e=Fn(on(e));break;case"binary":e=Fn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}kr(e,0),i={content:e}}var s,l;if(t&&kT(t),r.bookProps&&!r.bookSheets)s={};else{var c=pt?"buffer":"array";if(i&&i.content)s=bT(i.content,r);else if((l=mt.find(e,"PerfectOffice_MAIN"))&&l.content)s=Pi.to_workbook(l.content,(r.type=c,r));else if((l=mt.find(e,"NativeContent_MAIN"))&&l.content)s=Pi.to_workbook(l.content,(r.type=c,r));else throw(l=mt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=ub(e))}var u={};return e.FullPaths&&_T(e,u,r),s.Props=s.Custprops=u,r.bookFiles&&(s.cfb=e),s}var Do={0:{f:i_},1:{f:u_},2:{f:w_},3:{f:x_},4:{f:d_},5:{f:v_},6:{f:E_},7:{f:m_},8:{f:C_},9:{f:T_},10:{f:b_},11:{f:__},12:{f:f_},13:{f:y_},14:{f:p_},15:{f:h_},16:{f:W1},17:{f:S_},18:{f:g_},19:{f:Du},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:eT},40:{},42:{},43:{f:bS},44:{f:SS},45:{f:_S},46:{f:CS},47:{f:TS},48:{},49:{f:Nk},50:{},51:{f:KS},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:S1},62:{f:k_},63:{f:ZS},64:{f:P_},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:R_},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:c_},148:{f:l_,p:16},151:{f:F_},152:{},153:{f:q_},154:{},155:{},156:{f:J_},157:{},158:{},159:{T:1,f:WE},160:{T:-1},161:{T:1,f:is},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:N_},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:XS},336:{T:-1},337:{f:YS,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:eu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:E1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:D_},427:{f:O_},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:I_},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:o_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:A_},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:eu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lb},633:{T:1},634:{T:-1},635:{T:1,f:ib},636:{T:-1},637:{f:Fk},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:z_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:L_},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},su={6:{f:Mc},10:{f:Ta},12:{f:rr},13:{f:rr},14:{f:Jt},15:{f:Jt},16:{f:Fr},17:{f:Jt},18:{f:Jt},19:{f:rr},20:{f:Tx},21:{f:Tx},23:{f:E1},24:{f:Nx},25:{f:Jt},26:{},27:{},28:{f:aE},29:{},34:{f:Jt},35:{f:Cx},38:{f:Fr},39:{f:Fr},40:{f:Fr},41:{f:Fr},42:{f:Jt},43:{f:Jt},47:{f:oS},49:{f:B4},51:{f:rr},60:{},61:{f:P4},64:{f:Jt},65:{f:M4},66:{f:rr},77:{},80:{},81:{},82:{},85:{f:rr},89:{},90:{},91:{},92:{f:N4},93:{f:iE},94:{},95:{f:Jt},96:{},97:{},99:{f:Jt},125:{f:S1},128:{f:Y4},129:{f:A4},130:{f:rr},131:{f:Jt},132:{f:Jt},133:{f:F4},134:{},140:{f:dE},141:{f:rr},144:{},146:{f:xE},151:{},152:{},153:{},154:{},155:{},156:{f:rr},157:{},158:{},160:{f:wE},161:{f:mE},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$4},190:{f:G4},193:{f:Ta},197:{},198:{},199:{},200:{},201:{},202:{f:Jt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rr},220:{},221:{f:Jt},222:{},224:{f:K4},225:{f:C4},226:{f:Ta},227:{},229:{f:sE},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:D4},253:{f:U4},255:{f:O4},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:m1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Jt},353:{f:Ta},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:J4},431:{f:Jt},432:{},433:{},434:{},437:{},438:{f:cE},439:{f:Jt},440:{f:uE},441:{},442:{f:qi},443:{},444:{f:rr},445:{},446:{},448:{f:Ta},449:{f:R4,r:2},450:{f:Ta},512:{f:bx},513:{f:vE},515:{f:Q4},516:{f:H4},517:{f:_x},519:{f:yE},520:{f:j4},523:{},545:{f:Ax},549:{f:Sx},566:{},574:{f:L4},638:{f:V4},659:{},1048:{},1054:{f:z4},1084:{},1212:{f:tE},2048:{f:fE},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ho},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ta},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:pE,r:12},2173:{f:$S,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Jt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:eE,r:12},2197:{},2198:{f:BS,r:12},2199:{},2200:{},2201:{},2202:{f:rE,r:12},2203:{f:Ta},2204:{},2205:{},2206:{},2207:{},2211:{f:I4},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:gE},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:hE},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:bx},1:{},2:{f:bE},3:{f:SE},4:{f:EE},5:{f:_x},7:{f:_E},8:{},9:{f:ho},11:{},22:{f:rr},30:{f:W4},31:{},32:{},33:{f:Ax},36:{},37:{f:Sx},50:{f:TE},62:{},52:{},67:{},68:{f:rr},69:{},86:{},126:{},127:{f:kE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:CE},223:{},234:{},354:{},421:{},518:{f:Mc},521:{f:ho},536:{f:Nx},547:{f:Cx},561:{},579:{},1030:{f:Mc},1033:{f:ho},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function An(e,r,t,i){var s=r;if(!isNaN(s)){var l=(t||[]).length||0,c=e.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&n1(t)&&e.push(t)}}function Ux(e,r){var t=r||{},i=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=s.index,u=l&&l.index||e.length,h=Qy(e.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,p=0,v=0,y=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},k=[];for(c=0;c<h.length;++c){var w=h[c].trim(),S=w.slice(0,3).toLowerCase();if(S=="<tr"){if(++x,t.sheetRows&&t.sheetRows<=x){--x;break}p=0;continue}if(!(S!="<td"&&S!="<th")){var O=w.split(/<\/t[dh]>/i);for(u=0;u<O.length;++u){var R=O[u].trim();if(R.match(/<t[dh]/i)){for(var C=R,L=0;C.charAt(0)=="<"&&(L=C.indexOf(">"))>-1;)C=C.slice(L+1);for(var X=0;X<k.length;++X){var W=k[X];W.s.c==p&&W.s.r<x&&x<=W.e.r&&(p=W.e.c+1,X=-1)}var M=tt(R.slice(0,R.indexOf(">")));y=M.colspan?+M.colspan:1,((v=+M.rowspan)>1||y>1)&&k.push({s:{r:x,c:p},e:{r:x+(v||1)-1,c:p+y-1}});var V=M.t||M["data-t"]||"";if(!C.length){p+=y;continue}if(C=Vp(C),E.s.r>x&&(E.s.r=x),E.e.r<x&&(E.e.r=x),E.s.c>p&&(E.s.c=p),E.e.c<p&&(E.e.c=p),!C.length){p+=y;continue}var G={t:"s",v:C};t.raw||!C.trim().length||V=="s"||(C==="TRUE"?G={t:"b",v:!0}:C==="FALSE"?G={t:"b",v:!1}:isNaN(jn(C))?isNaN(Bs(C).getDate())||(G={t:"d",v:mr(C)},t.cellDates||(G={t:"n",v:Gr(G.v)}),G.z=t.dateNF||ot[14]):G={t:"n",v:jn(C)}),t.dense?(i[x]||(i[x]=[]),i[x][p]=G):i[it({r:x,c:p})]=G,p+=y}}}}return i["!ref"]=gt(E),k.length&&(i["!merges"]=k),i}function TT(e,r,t,i){for(var s=e["!merges"]||[],l=[],c=r.s.c;c<=r.e.c;++c){for(var u=0,h=0,x=0;x<s.length;++x)if(!(s[x].s.r>t||s[x].s.c>c)&&!(s[x].e.r<t||s[x].e.c<c)){if(s[x].s.r<t||s[x].s.c<c){u=-1;break}u=s[x].e.r-s[x].s.r+1,h=s[x].e.c-s[x].s.c+1;break}if(!(u<0)){var p=it({r:t,c}),v=i.dense?(e[t]||[])[c]:e[p],y=v&&v.v!=null&&(v.h||Tu(v.w||(aa(v),v.w)||""))||"",E={};u>1&&(E.rowspan=u),h>1&&(E.colspan=h),i.editable?y='<span contenteditable="true">'+y+"</span>":v&&(E["data-t"]=v&&v.t||"z",v.v!=null&&(E["data-v"]=v.v),v.z!=null&&(E["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),E.id=(i.id||"sjs")+"-"+p,l.push(dk("td",y,E))}}var k="<tr>";return k+l.join("")+"</tr>"}var CT='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',NT="</body></html>";function AT(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ra(Ux(t[0],r),r);var i=Vu();return t.forEach(function(s,l){$u(i,Ux(s,r),"Sheet"+(l+1))}),i}function FT(e,r,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function DT(e,r){var t=r||{},i=t.header!=null?t.header:CT,s=t.footer!=null?t.footer:NT,l=[i],c=Ws(e["!ref"]);t.dense=Array.isArray(e),l.push(FT(e,c,t));for(var u=c.s.r;u<=c.e.r;++u)l.push(TT(e,c,u,t));return l.push("</table>"+s),l.join("")}function Y1(e,r,t){var i=t||{},s=0,l=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var c=typeof i.origin=="string"?Vr(i.origin):i.origin;s=c.r,l=c.c}var u=r.getElementsByTagName("tr"),h=Math.min(i.sheetRows||1e7,u.length),x={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var p=Ws(e["!ref"]);x.s.r=Math.min(x.s.r,p.s.r),x.s.c=Math.min(x.s.c,p.s.c),x.e.r=Math.max(x.e.r,p.e.r),x.e.c=Math.max(x.e.c,p.e.c),s==-1&&(x.e.r=s=p.e.r+1)}var v=[],y=0,E=e["!rows"]||(e["!rows"]=[]),k=0,w=0,S=0,O=0,R=0,C=0;for(e["!cols"]||(e["!cols"]=[]);k<u.length&&w<h;++k){var L=u[k];if(Hx(L)){if(i.display)continue;E[w]={hidden:!0}}var X=L.children;for(S=O=0;S<X.length;++S){var W=X[S];if(!(i.display&&Hx(W))){var M=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):Vp(W.innerHTML),V=W.getAttribute("data-z")||W.getAttribute("z");for(y=0;y<v.length;++y){var G=v[y];G.s.c==O+l&&G.s.r<w+s&&w+s<=G.e.r&&(O=G.e.c+1-l,y=-1)}C=+W.getAttribute("colspan")||1,((R=+W.getAttribute("rowspan")||1)>1||C>1)&&v.push({s:{r:w+s,c:O+l},e:{r:w+s+(R||1)-1,c:O+l+(C||1)-1}});var oe={t:"s",v:M},B=W.getAttribute("data-t")||W.getAttribute("t")||"";M!=null&&(M.length==0?oe.t=B||"z":i.raw||M.trim().length==0||B=="s"||(M==="TRUE"?oe={t:"b",v:!0}:M==="FALSE"?oe={t:"b",v:!1}:isNaN(jn(M))?isNaN(Bs(M).getDate())||(oe={t:"d",v:mr(M)},i.cellDates||(oe={t:"n",v:Gr(oe.v)}),oe.z=i.dateNF||ot[14]):oe={t:"n",v:jn(M)})),oe.z===void 0&&V!=null&&(oe.z=V);var K="",me=W.getElementsByTagName("A");if(me&&me.length)for(var he=0;he<me.length&&!(me[he].hasAttribute("href")&&(K=me[he].getAttribute("href"),K.charAt(0)!="#"));++he);K&&K.charAt(0)!="#"&&(oe.l={Target:K}),i.dense?(e[w+s]||(e[w+s]=[]),e[w+s][O+l]=oe):e[it({c:O+l,r:w+s})]=oe,x.e.c<O+l&&(x.e.c=O+l),O+=C}}++w}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),x.e.r=Math.max(x.e.r,w-1+s),e["!ref"]=gt(x),w>=h&&(e["!fullref"]=gt((x.e.r=u.length-k+w-1+s,x))),e}function Q1(e,r){var t=r||{},i=t.dense?[]:{};return Y1(i,e,r)}function OT(e,r){return Ra(Q1(e,r),r)}function Hx(e){var r="",t=jT(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function jT(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function IT(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=wt(r.replace(/<[^>]*>/g,""));return[t]}var zx={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function J1(e,r){var t=r||{},i=Cu(e),s=[],l,c,u={name:""},h="",x=0,p,v,y={},E=[],k=t.dense?[]:{},w,S,O={value:""},R="",C=0,L=[],X=-1,W=-1,M={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,G={},oe=[],B={},K=0,me=0,he=[],we=1,Oe=1,Ee=[],Se={Names:[]},Y={},xe=["",""],z=[],T={},J="",H=0,I=!1,ne=!1,fe=0;for(Wi.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=Wi.exec(i);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"工作表":w[1]==="/"?(M.e.c>=M.s.c&&M.e.r>=M.s.r?k["!ref"]=gt(M):k["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=M.e.r&&(k["!fullref"]=k["!ref"],M.e.r=t.sheetRows-1,k["!ref"]=gt(M)),oe.length&&(k["!merges"]=oe),he.length&&(k["!rows"]=he),p.name=p.名称||p.name,typeof JSON<"u"&&JSON.stringify(p),E.push(p.name),y[p.name]=k,ne=!1):w[0].charAt(w[0].length-2)!=="/"&&(p=tt(w[0],!1),X=W=-1,M.s.r=M.s.c=1e7,M.e.r=M.e.c=0,k=t.dense?[]:{},oe=[],he=[],ne=!0);break;case"table-row-group":w[1]==="/"?--V:++V;break;case"table-row":case"行":if(w[1]==="/"){X+=we,we=1;break}if(v=tt(w[0],!1),v.行号?X=v.行号-1:X==-1&&(X=0),we=+v["number-rows-repeated"]||1,we<10)for(fe=0;fe<we;++fe)V>0&&(he[X+fe]={level:V});W=-1;break;case"covered-table-cell":w[1]!=="/"&&++W,t.sheetStubs&&(t.dense?(k[X]||(k[X]=[]),k[X][W]={t:"z"}):k[it({r:X,c:W})]={t:"z"}),R="",L=[];break;case"table-cell":case"数据":if(w[0].charAt(w[0].length-2)==="/")++W,O=tt(w[0],!1),Oe=parseInt(O["number-columns-repeated"]||"1",10),S={t:"z",v:null},O.formula&&t.cellFormula!=!1&&(S.f=Px(wt(O.formula))),(O.数据类型||O["value-type"])=="string"&&(S.t="s",S.v=wt(O["string-value"]||""),t.dense?(k[X]||(k[X]=[]),k[X][W]=S):k[it({r:X,c:W})]=S),W+=Oe-1;else if(w[1]!=="/"){++W,R="",C=0,L=[],Oe=1;var ye=we?X+we-1:X;if(W>M.e.c&&(M.e.c=W),W<M.s.c&&(M.s.c=W),X<M.s.r&&(M.s.r=X),ye>M.e.r&&(M.e.r=ye),O=tt(w[0],!1),z=[],T={},S={t:O.数据类型||O["value-type"],v:null},t.cellFormula)if(O.formula&&(O.formula=wt(O.formula)),O["number-matrix-columns-spanned"]&&O["number-matrix-rows-spanned"]&&(K=parseInt(O["number-matrix-rows-spanned"],10)||0,me=parseInt(O["number-matrix-columns-spanned"],10)||0,B={s:{r:X,c:W},e:{r:X+K-1,c:W+me-1}},S.F=gt(B),Ee.push([B,S.F])),O.formula)S.f=Px(O.formula);else for(fe=0;fe<Ee.length;++fe)X>=Ee[fe][0].s.r&&X<=Ee[fe][0].e.r&&W>=Ee[fe][0].s.c&&W<=Ee[fe][0].e.c&&(S.F=Ee[fe][1]);switch((O["number-columns-spanned"]||O["number-rows-spanned"])&&(K=parseInt(O["number-rows-spanned"],10)||0,me=parseInt(O["number-columns-spanned"],10)||0,B={s:{r:X,c:W},e:{r:X+K-1,c:W+me-1}},oe.push(B)),O["number-columns-repeated"]&&(Oe=parseInt(O["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=Bt(O["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(O.value);break;case"percentage":S.t="n",S.v=parseFloat(O.value);break;case"currency":S.t="n",S.v=parseFloat(O.value);break;case"date":S.t="d",S.v=mr(O["date-value"]),t.cellDates||(S.t="n",S.v=Gr(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=Xy(O["time-value"])/86400,t.cellDates&&(S.t="d",S.v=Mo(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(O.数据数值);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",O["string-value"]!=null&&(R=wt(O["string-value"]),L=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(I=!1,S.t==="s"&&(S.v=R||"",L.length&&(S.R=L),I=C==0),Y.Target&&(S.l=Y),z.length>0&&(S.c=z,z=[]),R&&t.cellText!==!1&&(S.w=R),I&&(S.t="z",delete S.v),(!I||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=X))for(var le=0;le<we;++le){if(Oe=parseInt(O["number-columns-repeated"]||"1",10),t.dense)for(k[X+le]||(k[X+le]=[]),k[X+le][W]=le==0?S:Er(S);--Oe>0;)k[X+le][W+Oe]=Er(S);else for(k[it({r:X+le,c:W})]=S;--Oe>0;)k[it({r:X+le,c:W+Oe})]=Er(S);M.e.c<=W&&(M.e.c=W)}Oe=parseInt(O["number-columns-repeated"]||"1",10),W+=Oe-1,Oe=0,S={},R="",L=[]}Y={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l;T.t=R,L.length&&(T.R=L),T.a=J,z.push(T)}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);J="",H=0,R="",C=0,L=[];break;case"creator":w[1]==="/"?J=i.slice(H,w.index):H=w.index+w[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);R="",C=0,L=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(G[u.name]=h,(l=s.pop())[0]!==w[3])throw"Bad state: "+l}else w[0].charAt(w[0].length-2)!=="/"&&(h="",u=tt(w[0],!1),s.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":c=tt(w[0],!1),h+=zx[w[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":c=tt(w[0],!1),h+=zx[w[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=i.slice(x,w.index);break}else x=w.index+w[0].length;break;case"named-range":c=tt(w[0],!1),xe=Bc(c["cell-range-address"]);var de={Name:c.name,Ref:xe[0]+"!"+xe[1]};ne&&(de.Sheet=E.length),Se.Names.push(de);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(w[1]==="/"&&(!O||!O["string-value"])){var pe=IT(i.slice(C,w.index));R=(R.length>0?R+`
`:"")+pe[0]}else tt(w[0],!1),C=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{xe=Bc(tt(w[0])["target-range-address"]),y[xe[0]]["!autofilter"]={ref:xe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(Y=tt(w[0],!1),!Y.href)break;Y.Target=wt(Y.href),delete Y.href,Y.Target.charAt(0)=="#"&&Y.Target.indexOf(".")>-1?(xe=Bc(Y.Target.slice(1)),Y.Target="#"+xe[0]+"!"+xe[1]):Y.Target.match(/^\.\.[\\\/]/)&&(Y.Target=Y.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(w)}}var N={Sheets:y,SheetNames:E,Workbook:Se};return t.bookSheets&&delete N.Sheets,N}function Wx(e,r){r=r||{},vn(e,"META-INF/manifest.xml")&&Qk(tr(e,"META-INF/manifest.xml"),r);var t=ln(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var i=J1(jt(t),r);return vn(e,"meta.xml")&&(i.Props=u1(tr(e,"meta.xml"))),i}function Vx(e,r){return J1(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Uu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function iu(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):jt(as(e))}function lu(e){var r=e.reduce(function(s,l){return s+l.length},0),t=new Uint8Array(r),i=0;return e.forEach(function(s){t.set(s,i),i+=s.length}),t}function $x(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function RT(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,i=e[r+14]&1,s=r+13;s>=r;--s)i=i*256+e[s];return(e[r+15]&128?-i:i)*Math.pow(10,t-6176)}function Xi(e,r){var t=r?r[0]:0,i=e[t]&127;e:if(e[t++]>=128&&(i|=(e[t]&127)<<7,e[t++]<128||(i|=(e[t]&127)<<14,e[t++]<128)||(i|=(e[t]&127)<<21,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),i}function cr(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Dr(e){for(var r=[],t=[0];t[0]<e.length;){var i=t[0],s=Xi(e,t),l=s&7;s=Math.floor(s/8);var c=0,u;if(s==0)break;switch(l){case 0:{for(var h=t[0];e[t[0]++]>=128;);u=e.slice(h,t[0])}break;case 5:c=4,u=e.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,u=e.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=Xi(e,t),u=e.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(i))}var x={data:u,type:l};r[s]==null?r[s]=[x]:r[s].push(x)}return r}function Hu(e,r){return e?.map(function(t){return r(t.data)})||[]}function PT(e){for(var r,t=[],i=[0];i[0]<e.length;){var s=Xi(e,i),l=Dr(e.slice(i[0],i[0]+s));i[0]+=s;var c={id:cr(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Dr(u.data),x=cr(h[3][0].data);c.messages.push({meta:h,data:e.slice(i[0],i[0]+x)}),i[0]+=x}),(r=l[3])!=null&&r[0]&&(c.merge=cr(l[3][0].data)>>>0>0),t.push(c)}return t}function LT(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],i=Xi(r,t),s=[];t[0]<r.length;){var l=r[t[0]]&3;if(l==0){var c=r[t[0]++]>>2;if(c<60)++c;else{var u=c-59;c=r[t[0]],u>1&&(c|=r[t[0]+1]<<8),u>2&&(c|=r[t[0]+2]<<16),u>3&&(c|=r[t[0]+3]<<24),c>>>=0,c++,t[0]+=u}s.push(r.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var h=0,x=0;if(l==1?(x=(r[t[0]]>>2&7)+4,h=(r[t[0]++]&224)<<3,h|=r[t[0]++]):(x=(r[t[0]++]>>2)+1,l==2?(h=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(h=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),s=[lu(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(x>=h)for(s.push(s[0].slice(-h)),x-=h;x>=s[s.length-1].length;)s.push(s[s.length-1]),x-=s[s.length-1].length;s.push(s[0].slice(-h,-h+x))}}var p=lu(s);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function MT(e){for(var r=[],t=0;t<e.length;){var i=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(LT(i,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return lu(r)}function BT(e,r,t,i){var s=Uu(e),l=s.getUint32(4,!0),c=(i>1?12:8)+$x(l&(i>1?3470:398))*4,u=-1,h=-1,x=NaN,p=new Date(2001,0,1);l&512&&(u=s.getUint32(c,!0),c+=4),c+=$x(l&(i>1?12288:4096))*4,l&16&&(h=s.getUint32(c,!0),c+=4),l&32&&(x=s.getFloat64(c,!0),c+=8),l&64&&(p.setTime(p.getTime()+s.getFloat64(c,!0)*1e3),c+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:x};break;case 3:v={t:"s",v:r[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:x>0};break;case 7:v={t:"n",v:x/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:t[u]};else if(h>-1)v={t:"s",v:r[h]};else if(!isNaN(x))v={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function UT(e,r,t){var i=Uu(e),s=i.getUint32(8,!0),l=12,c=-1,u=-1,h=NaN,x=NaN,p=new Date(2001,0,1);s&1&&(h=RT(e,l),l+=16),s&2&&(x=i.getFloat64(l,!0),l+=8),s&4&&(p.setTime(p.getTime()+i.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=i.getUint32(l,!0),l+=4),s&16&&(c=i.getUint32(l,!0),l+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:r[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:x>0};break;case 7:v={t:"n",v:x/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:t[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return v}function HT(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return BT(e,r,t,e[0]);case 5:return UT(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Da(e){var r=Dr(e);return Xi(r[1][0].data)}function Gx(e,r){var t=Dr(r.data),i=cr(t[1][0].data),s=t[3],l=[];return(s||[]).forEach(function(c){var u=Dr(c.data),h=cr(u[1][0].data)>>>0;switch(i){case 1:l[h]=iu(u[3][0].data);break;case 8:{var x=e[Da(u[9][0].data)][0],p=Dr(x.data),v=e[Da(p[1][0].data)][0],y=cr(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var E=Dr(v.data);l[h]=E[3].map(function(k){return iu(k.data)}).join("")}break}}),l}function zT(e,r){var t,i,s,l,c,u,h,x,p,v,y,E,k,w,S=Dr(e),O=cr(S[1][0].data)>>>0,R=cr(S[2][0].data)>>>0,C=((i=(t=S[8])==null?void 0:t[0])==null?void 0:i.data)&&cr(S[8][0].data)>0||!1,L,X;if((l=(s=S[7])==null?void 0:s[0])!=null&&l.data&&r!=0)L=(u=(c=S[7])==null?void 0:c[0])==null?void 0:u.data,X=(x=(h=S[6])==null?void 0:h[0])==null?void 0:x.data;else if((v=(p=S[4])==null?void 0:p[0])!=null&&v.data&&r!=1)L=(E=(y=S[4])==null?void 0:y[0])==null?void 0:E.data,X=(w=(k=S[3])==null?void 0:k[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var W=C?4:1,M=Uu(L),V=[],G=0;G<L.length/2;++G){var oe=M.getUint16(G*2,!0);oe<65535&&V.push([G,oe])}if(V.length!=R)throw"Expected ".concat(R," cells, found ").concat(V.length);var B=[];for(G=0;G<V.length-1;++G)B[V[G][0]]=X.subarray(V[G][1]*W,V[G+1][1]*W);return V.length>=1&&(B[V[V.length-1][0]]=X.subarray(V[V.length-1][1]*W)),{R:O,cells:B}}function WT(e,r){var t,i=Dr(r.data),s=(t=i?.[7])!=null&&t[0]?cr(i[7][0].data)>>>0>0?1:0:-1,l=Hu(i[5],function(c){return zT(c,s)});return{nrows:cr(i[4][0].data)>>>0,data:l.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,x){if(c[u.R][x])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(x));c[u.R][x]=h}),c},[])}}function VT(e,r,t){var i,s=Dr(r.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(cr(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(cr(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=gt(l);var c=Dr(s[4][0].data),u=Gx(e,e[Da(c[4][0].data)][0]),h=(i=c[17])!=null&&i[0]?Gx(e,e[Da(c[17][0].data)][0]):[],x=Dr(c[3][0].data),p=0;x[1].forEach(function(v){var y=Dr(v.data),E=e[Da(y[2][0].data)][0],k=cr(E.meta[1][0].data);if(k!=6002)throw new Error("6001 unexpected reference to ".concat(k));var w=WT(e,E);w.data.forEach(function(S,O){S.forEach(function(R,C){var L=it({r:p+O,c:C}),X=HT(R,u,h);X&&(t[L]=X)})}),p+=w.nrows})}function $T(e,r){var t=Dr(r.data),i={"!ref":"A1"},s=e[Da(t[2][0].data)],l=cr(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return VT(e,s[0],i),i}function GT(e,r){var t,i=Dr(r.data),s={name:(t=i[1])!=null&&t[0]?iu(i[1][0].data):"",sheets:[]},l=Hu(i[2],Da);return l.forEach(function(c){e[c].forEach(function(u){var h=cr(u.meta[1][0].data);h==6e3&&s.sheets.push($T(e,u))})}),s}function XT(e,r){var t=Vu(),i=Dr(r.data),s=Hu(i[1],Da);if(s.forEach(function(l){e[l].forEach(function(c){var u=cr(c.meta[1][0].data);if(u==2){var h=GT(e,c);h.sheets.forEach(function(x,p){$u(t,x,p==0?h.name:h.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Hc(e){var r,t,i,s,l={},c=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var x;try{x=MT(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=PT(x)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){l[v.id]=v.messages,c.push(v.id)})}}),!c.length)throw new Error("File has no messages");var u=((s=(i=(t=(r=l?.[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:i[1])==null?void 0:s[0].data)&&cr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||c.forEach(function(h){l[h].forEach(function(x){var p=cr(x.meta[1][0].data)>>>0;if(p==1)if(!u)u=x;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return XT(l,u)}function KT(e){return function(t){for(var i=0;i!=e.length;++i){var s=e[i];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function zu(e){KT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function YT(e){return Is.WS.indexOf(e)>-1?"sheet":e==Is.CS?"chart":e==Is.DS?"dialog":e==Is.MS?"macro":e&&e.length?e:"sheet"}function QT(e,r){if(!e)return 0;try{e=r.map(function(i){return i.id||(i.id=i.strRelID),[i.name,e["!id"][i.id].Target,YT(e["!id"][i.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function JT(e,r,t,i,s,l,c,u,h,x,p,v){try{l[i]=Ii(ln(e,t,!0),r);var y=tr(e,r),E;switch(u){case"sheet":E=nT(y,r,s,h,l[i],x,p,v);break;case"chart":if(E=aT(y,r,s,h,l[i],x,p,v),!E||!E["!drawel"])break;var k=Ni(E["!drawel"].Target,r),w=tu(k),S=rb(ln(e,k,!0),Ii(ln(e,w,!0),k)),O=Ni(S,k),R=tu(O);E=U_(ln(e,O,!0),O,h,Ii(ln(e,R,!0),O),x,E);break;case"macro":E=sT(y,r,s,h,l[i],x,p,v);break;case"dialog":E=iT(y,r,s,h,l[i],x,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}c[i]=E;var C=[];l&&l[i]&&Hn(l[i]).forEach(function(L){var X="";if(l[i][L].Type==Is.CMNT){X=Ni(l[i][L].Target,r);var W=uT(tr(e,X,!0),X,h);if(!W||!W.length)return;Dx(E,W,!1)}l[i][L].Type==Is.TCMNT&&(X=Ni(l[i][L].Target,r),C=C.concat(ab(tr(e,X,!0),h)))}),C&&C.length&&Dx(E,C,!0,h.people||[])}catch(L){if(h.WTF)throw L}}function mn(e){return e.charAt(0)=="/"?e.slice(1):e}function qT(e,r){if(Rp(),r=r||{},zu(r),vn(e,"META-INF/manifest.xml")||vn(e,"objectdata.xml"))return Wx(e,r);if(vn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Hc<"u"){if(e.FileIndex)return Hc(e);var t=mt.utils.cfb_new();return ax(e).forEach(function(he){Zy(t,he,qy(e,he))}),Hc(t)}throw new Error("Unsupported NUMBERS file")}if(!vn(e,"[Content_Types].xml"))throw vn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=ax(e),s=Kk(ln(e,"[Content_Types].xml")),l=!1,c,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",tr(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!tr(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},x={};if(!r.bookSheets&&!r.bookProps){if(Li=[],s.sst)try{Li=cT(tr(e,mn(s.sst)),s.sst,r)}catch(he){if(r.WTF)throw he}r.cellStyles&&s.themes.length&&(h=oT(ln(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],r)),s.style&&(x=lT(tr(e,mn(s.style)),s.style,h,r))}s.links.map(function(he){try{var we=Ii(ln(e,tu(mn(he))),he);return dT(tr(e,mn(he)),we,he,r)}catch{}});var p=rT(tr(e,mn(s.workbooks[0])),s.workbooks[0],r),v={},y="";s.coreprops.length&&(y=tr(e,mn(s.coreprops[0]),!0),y&&(v=u1(y)),s.extprops.length!==0&&(y=tr(e,mn(s.extprops[0]),!0),y&&Zk(y,v,r)));var E={};(!r.bookSheets||r.bookProps)&&s.custprops.length!==0&&(y=ln(e,mn(s.custprops[0]),!0),y&&(E=t4(y,r)));var k={};if((r.bookSheets||r.bookProps)&&(p.Sheets?c=p.Sheets.map(function(we){return we.name}):v.Worksheets&&v.SheetNames.length>0&&(c=v.SheetNames),r.bookProps&&(k.Props=v,k.Custprops=E),r.bookSheets&&typeof c<"u"&&(k.SheetNames=c),r.bookSheets?k.SheetNames:r.bookProps))return k;c={};var w={};r.bookDeps&&s.calcchain&&(w=fT(tr(e,mn(s.calcchain)),s.calcchain));var S=0,O={},R,C;{var L=p.Sheets;v.Worksheets=L.length,v.SheetNames=[];for(var X=0;X!=L.length;++X)v.SheetNames[X]=L[X].name}var W=l?"bin":"xml",M=s.workbooks[0].lastIndexOf("/"),V=(s.workbooks[0].slice(0,M+1)+"_rels/"+s.workbooks[0].slice(M+1)+".rels").replace(/^\//,"");vn(e,V)||(V="xl/_rels/workbook."+W+".rels");var G=Ii(ln(e,V,!0),V.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=hT(tr(e,mn(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=sb(tr(e,mn(s.people[0])),r)),G&&(G=QT(G,p.Sheets));var oe=tr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=v.Worksheets;++S){var B="sheet";if(G&&G[S]?(R="xl/"+G[S][1].replace(/[\/]?xl\//,""),vn(e,R)||(R=G[S][1]),vn(e,R)||(R=V.replace(/_rels\/.*$/,"")+G[S][1]),B=G[S][2]):(R="xl/worksheets/sheet"+(S+1-oe)+"."+W,R=R.replace(/sheet0\./,"sheet.")),C=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(S!=r.sheets)continue e;break;case"string":if(v.SheetNames[S].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var K=!1,me=0;me!=r.sheets.length;++me)typeof r.sheets[me]=="number"&&r.sheets[me]==S&&(K=1),typeof r.sheets[me]=="string"&&r.sheets[me].toLowerCase()==v.SheetNames[S].toLowerCase()&&(K=1);if(!K)continue e}}JT(e,R,C,v.SheetNames[S],S,O,c,B,r,p,h,x)}return k={Directory:s,Workbook:p,Props:v,Custprops:E,Deps:w,Sheets:c,SheetNames:v.SheetNames,Strings:Li,Styles:x,Themes:h,SSF:Er(ot)},r&&r.bookFiles&&(e.files?(k.keys=i,k.files=e.files):(k.keys=[],k.files={},e.FullPaths.forEach(function(he,we){he=he.replace(/^Root Entry[\/]/,""),k.keys.push(he),k.files[he]=e.FileIndex[we]}))),r&&r.bookVBA&&(s.vba.length>0?k.vbaraw=tr(e,mn(s.vba[0]),!0):s.defaults&&s.defaults.bin===cb&&(k.vbaraw=tr(e,"xl/vbaProject.bin",!0))),k}function ZT(e,r){var t=r||{},i="Workbook",s=mt.find(e,i);try{if(i="/!DataSpaces/Version",s=mt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if($E(s.content),i="/!DataSpaces/DataSpaceMap",s=mt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var l=XE(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=mt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var c=KE(s.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=mt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);QE(s.content)}catch{}if(i="/EncryptionInfo",s=mt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var u=JE(s.content);if(i="/EncryptedPackage",s=mt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,t.password||"",t);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function Wu(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=on(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function eC(e,r){return mt.find(e,"EncryptedPackage")?ZT(e,r):K1(e,r)}function tC(e,r){var t,i=e,s=r||{};return s.type||(s.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),t=Hp(i,s),qT(t,s)}function q1(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return au(e.slice(t),r);default:break e}return Vi.to_workbook(e,r)}function rC(e,r){var t="",i=Wu(e,r);switch(r.type){case"base64":t=on(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=ts(e);break;default:throw new Error("Unrecognized type "+r.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(t=jt(t)),r.type="binary",q1(t,r)}function nC(e,r){var t=e;return r.type=="base64"&&(t=on(t)),t=Ui.utils.decode(1200,t.slice(2),"str"),r.type="binary",q1(t,r)}function aC(e){return e.match(/[^\x00-\x7F]/)?Ai(e):e}function zc(e,r,t,i){return i?(t.type="string",Vi.to_workbook(e,t)):Vi.to_workbook(r,t)}function ou(e,r){Sp();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ou(new Uint8Array(e),(t=Er(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var i=e,s=[0,0,0,0],l=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ms={},t.dateNF&&(Ms.dateNF=t.dateNF),t.type||(t.type=pt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=pt?"buffer":"binary",i=$y(e),typeof Uint8Array<"u"&&!pt&&(t.type="array")),t.type=="string"&&(l=!0,t.type="binary",t.codepage=65001,i=aC(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return t=Er(t),t.type="array",ou(ku(i),t)}switch((s=Wu(i,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return eC(mt.read(i,t),t);break;case 9:if(s[1]<=8)return K1(i,t);break;case 60:return au(i,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return OE(i,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return FE.to_workbook(i,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?tC(i,t):zc(e,i,t,l);case 239:return s[3]===60?au(i,t):zc(e,i,t,l);case 255:if(s[1]===254)return nC(i,t);if(s[1]===0&&s[2]===2&&s[3]===0)return Pi.to_workbook(i,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Pi.to_workbook(i,t);break;case 3:case 131:case 139:case 140:return Fx.to_workbook(i,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return cS.to_workbook(i,t);break;case 10:case 13:case 32:return rC(i,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return NE.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Fx.to_workbook(i,t):zc(e,i,t,l)}function sC(e,r,t,i,s,l,c,u){var h=Sr(t),x=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!c||e[t])for(var E=r.s.c;E<=r.e.c;++E){var k=c?e[t][E]:e[i[E]+h];if(k===void 0||k.t===void 0){if(x===void 0)continue;l[E]!=null&&(y[l[E]]=x);continue}var w=k.v;switch(k.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(l[E]!=null){if(w==null)if(k.t=="e"&&w===null)y[l[E]]=null;else if(x!==void 0)y[l[E]]=x;else if(p&&w===null)y[l[E]]=null;else continue;else y[l[E]]=p&&(k.t!=="n"||k.t==="n"&&u.rawNumbers!==!1)?w:aa(k,w,u);w!=null&&(v=!1)}}return{row:y,isempty:v}}function cu(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},i=0,s=1,l=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},x=r||{},p=x.range!=null?x.range:e["!ref"];switch(x.header===1?i=1:x.header==="A"?i=2:Array.isArray(x.header)?i=3:x.header==null&&(i=0),typeof p){case"string":h=Gt(p);break;case"number":h=Gt(e["!ref"]),h.s.r=p;break;default:h=p}i>0&&(s=0);var v=Sr(h.s.r),y=[],E=[],k=0,w=0,S=Array.isArray(e),O=h.s.r,R=0,C={};S&&!e[O]&&(e[O]=[]);var L=x.skipHidden&&e["!cols"]||[],X=x.skipHidden&&e["!rows"]||[];for(R=h.s.c;R<=h.e.c;++R)if(!(L[R]||{}).hidden)switch(y[R]=or(R),t=S?e[O][R]:e[y[R]+v],i){case 1:l[R]=R-h.s.c;break;case 2:l[R]=y[R];break;case 3:l[R]=x.header[R-h.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=c=aa(t,null,x),w=C[c]||0,!w)C[c]=1;else{do u=c+"_"+w++;while(C[u]);C[c]=w,C[u]=1}l[R]=u}for(O=h.s.r+s;O<=h.e.r;++O)if(!(X[O]||{}).hidden){var W=sC(e,h,O,y,i,l,S,x);(W.isempty===!1||(i===1?x.blankrows!==!1:x.blankrows))&&(E[k++]=W.row)}return E.length=k,E}var Xx=/"/g;function iC(e,r,t,i,s,l,c,u){for(var h=!0,x=[],p="",v=Sr(t),y=r.s.c;y<=r.e.c;++y)if(i[y]){var E=u.dense?(e[t]||[])[y]:e[i[y]+v];if(E==null)p="";else if(E.v!=null){h=!1,p=""+(u.rawNumbers&&E.t=="n"?E.v:aa(E,null,u));for(var k=0,w=0;k!==p.length;++k)if((w=p.charCodeAt(k))===s||w===l||w===34||u.forceQuotes){p='"'+p.replace(Xx,'""')+'"';break}p=="ID"&&(p='"ID"')}else E.f!=null&&!E.F?(h=!1,p="="+E.f,p.indexOf(",")>=0&&(p='"'+p.replace(Xx,'""')+'"')):p="";x.push(p)}return u.blankrows===!1&&h?null:x.join(c)}function Z1(e,r){var t=[],i=r??{};if(e==null||e["!ref"]==null)return"";var s=Gt(e["!ref"]),l=i.FS!==void 0?i.FS:",",c=l.charCodeAt(0),u=i.RS!==void 0?i.RS:`
`,h=u.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),p="",v=[];i.dense=Array.isArray(e);for(var y=i.skipHidden&&e["!cols"]||[],E=i.skipHidden&&e["!rows"]||[],k=s.s.c;k<=s.e.c;++k)(y[k]||{}).hidden||(v[k]=or(k));for(var w=0,S=s.s.r;S<=s.e.r;++S)(E[S]||{}).hidden||(p=iC(e,s,S,v,c,h,l,i),p!=null&&(i.strip&&(p=p.replace(x,"")),(p||i.blankrows!==!1)&&t.push((w++?u:"")+p)));return delete i.dense,t.join("")}function lC(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Z1(e,r);return t}function oC(e){var r="",t,i="";if(e==null||e["!ref"]==null)return[];var s=Gt(e["!ref"]),l="",c=[],u,h=[],x=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)c[u]=or(u);for(var p=s.s.r;p<=s.e.r;++p)for(l=Sr(p),u=s.s.c;u<=s.e.c;++u)if(r=c[u]+l,t=x?(e[p]||[])[u]:e[r],i="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;i=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}h[h.length]=r+"="+i}return h}function em(e,r,t){var i=t||{},s=+!i.skipHeader,l=e||{},c=0,u=0;if(l&&i.origin!=null)if(typeof i.origin=="number")c=i.origin;else{var h=typeof i.origin=="string"?Vr(i.origin):i.origin;c=h.r,u=h.c}var x,p={s:{c:0,r:0},e:{c:u,r:c+r.length-1+s}};if(l["!ref"]){var v=Gt(l["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),c==-1&&(c=v.e.r+1,p.e.r=c+r.length-1+s)}else c==-1&&(c=0,p.e.r=r.length-1+s);var y=i.header||[],E=0;r.forEach(function(w,S){Hn(w).forEach(function(O){(E=y.indexOf(O))==-1&&(y[E=y.length]=O);var R=w[O],C="z",L="",X=it({c:u+E,r:c+S+s});x=Ki(l,X),R&&typeof R=="object"&&!(R instanceof Date)?l[X]=R:(typeof R=="number"?C="n":typeof R=="boolean"?C="b":typeof R=="string"?C="s":R instanceof Date?(C="d",i.cellDates||(C="n",R=Gr(R)),L=i.dateNF||ot[14]):R===null&&i.nullError&&(C="e",R=0),x?(x.t=C,x.v=R,delete x.w,delete x.R,L&&(x.z=L)):l[X]=x={t:C,v:R},L&&(x.z=L))})}),p.e.c=Math.max(p.e.c,u+y.length-1);var k=Sr(c);if(s)for(E=0;E<y.length;++E)l[or(E+u)+k]={t:"s",v:y[E]};return l["!ref"]=gt(p),l}function cC(e,r){return em(null,e,r)}function Ki(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var i=Vr(r);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Ki(e,it(r)):Ki(e,it({r,c:t||0}))}function uC(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Vu(){return{SheetNames:[],Sheets:{}}}function $u(e,r,t,i){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=c+s)!=-1;++s);}if(K_(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function fC(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=uC(e,r);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[i].Hidden=t}function dC(e,r){return e.z=r,e}function tm(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function hC(e,r,t){return tm(e,"#"+r,t)}function xC(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function pC(e,r,t,i){for(var s=typeof r!="string"?r:Gt(r),l=typeof r=="string"?r:gt(r),c=s.s.r;c<=s.e.r;++c)for(var u=s.s.c;u<=s.e.c;++u){var h=Ki(e,c,u);h.t="n",h.F=l,delete h.v,c==s.s.r&&u==s.s.c&&(h.f=t,i&&(h.D=!0))}return e}var Kx={encode_col:or,encode_row:Sr,encode_cell:it,encode_range:gt,decode_col:Fu,decode_row:Au,split_cell:Ck,decode_cell:Vr,decode_range:Ws,format_cell:aa,sheet_add_aoa:s1,sheet_add_json:em,sheet_add_dom:Y1,aoa_to_sheet:Vs,json_to_sheet:cC,table_to_sheet:Q1,table_to_book:OT,sheet_to_csv:Z1,sheet_to_txt:lC,sheet_to_json:cu,sheet_to_html:DT,sheet_to_formulae:oC,sheet_to_row_object_array:cu,sheet_get_cell:Ki,book_new:Vu,book_append_sheet:$u,book_set_sheet_visibility:fC,cell_set_number_format:dC,cell_set_hyperlink:tm,cell_set_internal_link:hC,cell_add_comment:xC,sheet_set_array_formula:pC,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const rm=({onClose:e,onImport:r})=>{const[t,i]=ee.useState(null),[s,l]=ee.useState(0),[c,u]=ee.useState([]),[h,x]=ee.useState([]),[p,v]=ee.useState([]),[y,E]=ee.useState([]),[k,w]=ee.useState(""),[S,O]=ee.useState(0),[R,C]=ee.useState(""),[L,X]=ee.useState([]),[W,M]=ee.useState(""),[V,G]=ee.useState(""),[oe,B]=ee.useState({}),K=ee.useCallback(pe=>{const N=new FileReader;N.onload=_e=>{try{const Ne=ou(_e.target?.result,{type:"binary",cellDates:!0});E(Ne.SheetNames);const Qe=Ne.SheetNames[0];w(Qe);const Ge=Ne.Sheets[Qe],Pe=Kx.sheet_to_json(Ge,{header:1});if(Pe.length>1){const St=Pe[0].map(Dt=>Dt?Dt.toString().trim():""),Ft=Kx.sheet_to_json(Ge);u(St),x(Ft),O(Ft.length),l(2)}else alert("الملف فارغ أو لا يحتوي على بيانات كافية.")}catch(Ne){console.error("Error reading Excel file:",Ne),alert("حدث خطأ أثناء قراءة الملف. يرجى التأكد من أنه ملف Excel صالح.")}},N.readAsBinaryString(pe)},[]),me=ee.useMemo(()=>{const pe={};return h.length>0&&(c.forEach(N=>{pe[N]=new Set}),h.forEach(N=>{c.forEach(_e=>{N[_e]!==void 0&&N[_e]!==null&&pe[_e].add(N[_e])})})),pe},[h,c]),he=ee.useMemo(()=>p.length===0?h:h.filter(pe=>p.every(N=>!N.column||!N.value?!0:pe[N.column]?.toString()===N.value.toString())),[h,p]),we=pe=>{pe.target.files&&pe.target.files[0]&&K(pe.target.files[0])},Oe=()=>{v([...p,{id:Date.now(),column:"",value:""}])},Ee=pe=>{v(p.filter(N=>N.id!==pe))},Se=(pe,N)=>{v(p.map(_e=>_e.id===pe?{..._e,...N}:_e))},Y=pe=>{const N=(pe.match(/\n/g)||[]).length,_e=(pe.match(/\t/g)||[]).length,Ne=(pe.match(/,/g)||[]).length;return _e>0&&_e>=N?"tab":N>0?"newline":Ne>0?"comma":"space"},xe=(pe,N)=>{let _e=[];switch(N){case"newline":_e=pe.split(`
`);break;case"comma":_e=pe.split(",");break;case"tab":_e=pe.split(`
`).map(Ne=>Ne.split("	")[0]);break;case"space":_e=pe.split(/\s+/);break}return _e.map(Ne=>Ne.trim()).filter(Ne=>Ne.length>0).filter(Ne=>!/^[0-9]+\.?$/.test(Ne)).filter(Ne=>Ne.length>=2)},z=pe=>{if(!pe.trim()){X([]),M("");return}const N=Y(pe),_e=xe(pe,N);X(_e),M(N)},T=pe=>{const N=pe.target.value;C(N),z(N)},J=()=>{if(L.length===0){alert("لا توجد أسماء صالحة للاستيراد");return}const pe=L.map((N,_e)=>({الاسم:N,الرقم:(_e+1).toString()}));r(pe,"الاسم",[])},H=()=>{const pe=c.find(_e=>_e.toLowerCase().includes("name")||_e.toLowerCase().includes("اسم"))||"";G(pe);const N={};c.forEach(_e=>{N[_e]={selected:!1,type:ut.NUMBER,options:""}}),B(N),l(3)},I=(pe,N)=>{B(_e=>({..._e,[pe]:{..._e[pe],selected:N}}))},ne=(pe,N)=>{B(_e=>({..._e,[pe]:{..._e[pe],type:N}}))},fe=(pe,N)=>{B(_e=>({..._e,[pe]:{..._e[pe],options:N}}))},ye=()=>{if(!V){alert("الرجاء تحديد عمود اسم الطالب.");return}const pe=Object.entries(oe).filter(([N,_e])=>_e.selected&&N!==V).map(([N,_e])=>({header:N,type:_e.type,options:_e.type===ut.LIST?_e.options.split(",").map(Ne=>Ne.trim()).filter(Boolean):void 0}));r(he,V,pe)},le=!V,de=()=>{switch(s){case 0:return f.jsxs("div",{children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"اختر طريقة استيراد الأسماء"}),f.jsx("p",{className:"text-slate-600",children:"حدد الطريقة الأنسب لك لاستيراد أسماء الطلاب"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsx("div",{onClick:()=>{i("file"),l(1)},className:"group cursor-pointer p-6 border-2 border-slate-200 rounded-xl hover:border-blue-400 hover:bg-blue-50 transition-all duration-200",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center group-hover:bg-blue-200 transition-colors",children:f.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),f.jsx("h4",{className:"text-lg font-semibold text-slate-800 mb-2",children:"📄 من ملف Excel/CSV"}),f.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"الطريقة التقليدية لاستيراد البيانات من ملفات"}),f.jsxs("div",{className:"text-xs text-slate-500 space-y-1",children:[f.jsx("div",{children:"✅ دعم ملفات Excel و CSV"}),f.jsx("div",{children:"✅ استيراد أعمدة متعددة"}),f.jsx("div",{children:"✅ فلترة البيانات"})]})]})}),f.jsx("div",{onClick:()=>{i("paste"),l(4)},className:"group cursor-pointer p-6 border-2 border-slate-200 rounded-xl hover:border-green-400 hover:bg-green-50 transition-all duration-200",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center group-hover:bg-green-200 transition-colors",children:f.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),f.jsx("h4",{className:"text-lg font-semibold text-slate-800 mb-2",children:"📋 نسخ ولصق"}),f.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"الطريقة الأسهل والأسرع للمستخدمين"}),f.jsxs("div",{className:"text-xs text-slate-500 space-y-1",children:[f.jsx("div",{children:"✅ بساطة قصوى"}),f.jsx("div",{children:"✅ من أي مصدر (Excel، Word)"}),f.jsx("div",{children:"✅ تحليل تلقائي للنص"})]})]})})]})]});case 1:return f.jsxs("div",{children:[f.jsxs("div",{className:"flex flex-col items-center mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full bg-emerald-100 text-emerald-700",children:f.jsx("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M12 4v16m8-8H4",stroke:"#2E8540",strokeWidth:"2",strokeLinecap:"round"})})}),f.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"استيراد الأسماء من ملف Excel"})]}),f.jsx("p",{className:"text-slate-600 text-sm",children:"اختر ملف Excel يحتوي على أسماء الطلاب. الصف الأول يجب أن يكون عناوين الأعمدة."})]}),f.jsxs("div",{className:"border-2 border-dashed border-slate-300 rounded-lg p-8 text-center bg-slate-50",children:[f.jsx("input",{type:"file",onChange:we,accept:".xlsx, .xls, .csv",className:"block w-full text-sm text-slate-900 border border-slate-300 rounded-lg cursor-pointer bg-slate-50 focus:outline-none"}),y.length>0&&f.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 items-center justify-center",children:[f.jsxs("span",{className:"text-xs text-slate-500",children:["عدد الأوراق: ",f.jsx("b",{children:y.length})]}),f.jsxs("span",{className:"text-xs text-slate-500",children:["عدد الصفوف: ",f.jsx("b",{children:S})]}),f.jsxs("span",{className:"text-xs text-slate-500",children:["اسم الورقة: ",f.jsx("b",{children:k})]})]})]}),c.length>0&&h.length>0&&f.jsx("div",{className:"flex justify-end mt-6",children:f.jsx("button",{onClick:H,className:"btn-3d py-2 px-4 text-sm font-medium text-white bg-[#2E8540] rounded-lg hover:bg-[#246b33] transition-colors",children:"التالي"})}),c.length===0&&h.length===0&&f.jsx("p",{className:"mt-4 text-center text-red-500 text-sm",children:"لم يتم تحميل أي بيانات بعد. تأكد من أن الملف يحتوي على صف عناوين وألا يكون فارغًا."})]});case 2:return f.jsxs("div",{children:[f.jsx("p",{className:"mb-4 text-slate-600",children:"الخطوة 2: (اختياري) قم بفلترة البيانات لاستيراد صفوف محددة فقط."}),f.jsxs("div",{className:"space-y-2 mb-4 p-3 bg-slate-50 rounded-lg",children:[p.map(pe=>f.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-2",children:[f.jsxs("select",{value:pe.column,onChange:N=>Se(pe.id,{column:N.target.value,value:""}),className:"bg-white border border-slate-300 text-slate-900 text-sm rounded-lg block w-full md:w-1/3 p-2.5",children:[f.jsx("option",{value:"",children:"اختر عمود..."}),c.map(N=>f.jsx("option",{value:N,children:N},N))]}),f.jsx("span",{className:"text-slate-500",children:"="}),f.jsxs("select",{value:pe.value,onChange:N=>Se(pe.id,{value:N.target.value}),disabled:!pe.column,className:"bg-white border border-slate-300 text-slate-900 text-sm rounded-lg block w-full md:w-1/3 p-2.5",children:[f.jsx("option",{value:"",children:"اختر قيمة..."}),pe.column&&Array.from(me[pe.column]).map(N=>f.jsx("option",{value:N,children:N},N))]}),f.jsx("button",{onClick:()=>Ee(pe.id),className:"text-red-500 hover:text-red-700 p-2",children:f.jsx(iy,{className:"w-4 h-4"})})]},pe.id)),f.jsxs("button",{onClick:Oe,className:"flex items-center gap-2 text-sm text-emerald-600 hover:text-emerald-800",children:[f.jsx(sy,{className:"w-4 h-4"})," إضافة فلتر"]})]}),f.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[f.jsxs("p",{className:"text-sm text-slate-600",children:["معاينة البيانات المفلترة ",f.jsxs("span",{className:"font-bold",children:["(",he.length," سجل)"]})]}),f.jsxs("span",{className:"text-xs text-slate-500",children:["عدد الأعمدة: ",f.jsx("b",{children:c.length})]})]}),f.jsx("div",{className:"overflow-auto max-h-60 border-2 border-emerald-200 rounded-lg bg-white shadow-sm",children:f.jsxs("table",{className:"w-full text-xs text-left",children:[f.jsx("thead",{className:"text-[10px] sm:text-xs md:text-sm uppercase sticky top-0 z-30",style:{backgroundColor:"#fff",borderTopLeftRadius:12,borderTopRightRadius:12,fontFamily:"Noto Sans Arabic, sans-serif",boxShadow:"0 2px 8px -2px #0002"},children:f.jsx("tr",{children:c.map(pe=>f.jsx("th",{className:"p-2 font-semibold text-xs text-center",style:{fontFamily:"Noto Sans Arabic, sans-serif",color:Un("#fff"),letterSpacing:"1px",background:"transparent",boxShadow:"none"},children:pe},pe))})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:he.slice(0,10).map((pe,N)=>f.jsx("tr",{className:"hover:bg-emerald-50/60 transition",children:c.map(_e=>f.jsx("td",{className:"p-2 truncate max-w-xs",children:pe[_e]},_e))},N))})]})})]});case 3:return f.jsxs("div",{children:[f.jsx("p",{className:"mb-4 text-slate-600",children:"الخطوة 3: حدد عمود اسم الطالب، ثم (اختياري) اختر أعمدة إضافية لاستيرادها مع الأسماء."}),f.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border-r-4 border-yellow-400",children:[f.jsx("label",{htmlFor:"studentNameColumn",className:"block mb-2 text-sm font-medium text-slate-900",children:"1. حدد عمود اسم الطالب (إلزامي)"}),f.jsxs("select",{id:"studentNameColumn",value:V,onChange:pe=>G(pe.target.value),className:"bg-white border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full md:w-1/2 p-2.5",children:[f.jsx("option",{value:"",children:"-- اختر عمود اسم الطالب --"}),c.map(pe=>f.jsx("option",{value:pe,children:pe},pe))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-2 text-sm font-medium text-slate-900",children:"2. (اختياري) اختر أعمدة إضافية لاستيرادها مع الأسماء"}),f.jsx("div",{className:"space-y-2 p-3 bg-slate-50 rounded-lg max-h-80 overflow-y-auto",children:c.map(pe=>{const N=pe===V,_e=oe[pe];return f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center p-2 rounded "+(N?"opacity-50":""),children:[f.jsxs("div",{className:"flex items-center col-span-1",children:[f.jsx("input",{id:"checkbox-"+pe,type:"checkbox",checked:!N&&_e?.selected,onChange:Ne=>I(pe,Ne.target.checked),disabled:N,className:"w-5 h-5 text-emerald-600 bg-slate-100 border-slate-300 rounded focus:ring-emerald-500 focus:ring-2"}),f.jsx("label",{htmlFor:"checkbox-"+pe,className:"ms-3 font-semibold",children:pe})]}),f.jsx("div",{className:"col-span-2",children:_e?.selected&&!N&&f.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[f.jsx("select",{value:_e.type,onChange:Ne=>ne(pe,Ne.target.value),className:"bg-white border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5",children:Object.values(ut).map(Ne=>f.jsx("option",{value:Ne,children:Ne},Ne))}),_e.type===ut.LIST&&f.jsx("input",{type:"text",placeholder:"خيارات مفصولة بفاصلة",value:_e.options,onChange:Ne=>fe(pe,Ne.target.value),className:"bg-white border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5"})]})})]},pe)})})]})]});case 4:return f.jsxs("div",{children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:"📋 لصق الأسماء هنا"}),f.jsx("p",{className:"text-slate-600 text-sm",children:"انسخ قائمة الأسماء من أي مصدر والصقها في الصندوق أدناه"})]}),f.jsx("div",{className:"mb-6",children:f.jsx("textarea",{value:R,onChange:T,placeholder:`الصق الأسماء هنا...

أمثلة:
أحمد محمد
فاطمة سالم
محمد علي

أو منسوخة من Excel:
أحمد محمد	85	ممتاز
فاطمة سالم	92	ممتاز`,className:"w-full h-40 p-4 border-2 border-slate-300 rounded-lg text-sm resize-none focus:ring-2 focus:ring-green-500 focus:border-green-500",style:{direction:"rtl",fontFamily:"Arial, sans-serif"}})}),L.length>0&&f.jsxs("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[f.jsx("span",{className:"text-green-600",children:"✅"}),f.jsxs("h4",{className:"font-semibold text-green-800",children:["تم اكتشاف ",L.length," اسم"]}),f.jsxs("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded",children:[W==="tab"&&"من Excel",W==="newline"&&"قائمة أسماء",W==="comma"&&"مفصولة بفاصلة",W==="space"&&"مفصولة بمسافات"]})]}),f.jsxs("div",{className:"max-h-32 overflow-y-auto",children:[f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm",children:L.slice(0,12).map((pe,N)=>f.jsxs("div",{className:"flex items-center gap-1 text-slate-700",children:[f.jsxs("span",{className:"text-green-500 text-xs",children:[N+1,"."]}),f.jsx("span",{className:"truncate",children:pe})]},N))}),L.length>12&&f.jsxs("div",{className:"text-center mt-2 text-sm text-slate-500",children:["... و ",L.length-12," اسم آخر"]})]})]}),R.length===0&&f.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[f.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"💡 أمثلة على التنسيقات المدعومة:"}),f.jsxs("div",{className:"text-sm text-blue-700 space-y-2",children:[f.jsxs("div",{children:[f.jsx("strong",{children:"من Excel:"})," انسخ العمود واللصق (يدعم أعمدة متعددة)"]}),f.jsxs("div",{children:[f.jsx("strong",{children:"قائمة بسيطة:"})," اسم في كل سطر"]}),f.jsxs("div",{children:[f.jsx("strong",{children:"مفصولة بفاصلة:"})," أحمد, فاطمة, محمد"]}),f.jsxs("div",{children:[f.jsx("strong",{children:"مرقمة:"})," 1. أحمد 2. فاطمة 3. محمد"]})]})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("button",{onClick:()=>{C(""),X([])},className:"px-4 py-2 text-sm text-slate-600 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",disabled:R.length===0,children:"مسح النص"}),f.jsxs("button",{onClick:J,disabled:L.length===0,className:"px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors",children:["استيراد ",L.length>0&&`(${L.length})`," الأسماء"]})]})]});default:return null}};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300 p-2 sm:p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 lg:p-8 w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] flex flex-col",children:[f.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold mb-4 sm:mb-6 text-slate-800 text-center",children:s===0?"استيراد الأسماء":t==="paste"?"نسخ ولصق الأسماء":"استيراد الأسماء من ملف الاكسل"}),f.jsx("div",{className:"flex-1 overflow-y-auto pr-1 sm:pr-2",children:de()}),f.jsxs("div",{className:"flex justify-between items-center gap-4 mt-8 pt-4 border-t",children:[f.jsxs("div",{children:[s>0&&s!==4&&f.jsx("button",{onClick:()=>{s===1&&t?(l(0),i(null)):l(pe=>pe-1)},className:"btn-3d py-2 px-4 text-sm font-medium bg-white rounded-lg border hover:bg-slate-100 transition-colors",children:"السابق"}),s===4&&f.jsx("button",{onClick:()=>{l(0),i(null),C(""),X([])},className:"btn-3d py-2 px-4 text-sm font-medium bg-white rounded-lg border hover:bg-slate-100 transition-colors",children:"تغيير الطريقة"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4",children:[f.jsx("button",{onClick:e,className:"btn-3d py-2 px-4 text-sm font-medium bg-white rounded-lg border hover:bg-slate-100 transition-colors order-2 sm:order-1",children:"إلغاء"}),s===2&&f.jsx("button",{onClick:H,className:"btn-3d py-2 px-4 text-sm font-medium text-white bg-[#2E8540] rounded-lg hover:bg-[#246b33] transition-colors order-1 sm:order-2",children:"التالي"}),s===3&&f.jsx("button",{onClick:ye,disabled:le,className:"btn-3d py-2 px-4 text-sm font-medium text-white bg-[#2E8540] rounded-lg hover:bg-[#246b33] disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors order-1 sm:order-2",children:"استيراد الأسماء"})]})]})]})})},nm=({onClose:e,onAddStudent:r})=>{const[t,i]=ee.useState(""),s=l=>{l.preventDefault(),t.trim()&&r(t.trim())};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300",children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-8 w-full max-w-md m-4",children:[f.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-800 dark:text-slate-100",children:"إضافة طالب جديد"}),f.jsxs("form",{onSubmit:s,children:[f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx("label",{htmlFor:"studentName",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"اسم الطالب"}),f.jsx("input",{type:"text",id:"studentName",value:t,onChange:l=>i(l.target.value),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:placeholder-slate-400 dark:text-white",required:!0,autoFocus:!0})]})}),f.jsxs("div",{className:"flex justify-end gap-4 mt-8 pt-4 border-t border-slate-200 dark:border-slate-700",children:[f.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 focus:z-10 focus:ring-4 focus:ring-slate-200 dark:focus:ring-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-600 dark:hover:text-white dark:hover:bg-slate-700 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"submit",disabled:!t.trim(),className:"py-2 px-4 text-sm font-medium text-white bg-[#2E8540] rounded-lg hover:bg-[#246b33] focus:ring-4 focus:ring-green-300 dark:focus:ring-green-800 disabled:bg-slate-400 dark:disabled:bg-slate-600 transition-colors",children:"إضافة طالب"})]})]})]})})},mC=({isOpen:e,onClose:r,onConfirm:t,title:i,message:s})=>e?f.jsxs(f.Fragment,{children:[f.jsx("style",{children:`
        .edu-modal-overlay {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          bottom: 0 !important;
          background: rgba(0, 0, 0, 0.7) !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          z-index: 999999 !important;
          padding: 20px !important;
          font-family: 'Almarai', Arial, sans-serif !important;
          direction: rtl !important;
        }
        
        .edu-modal-content {
          background: white !important;
          border-radius: 12px !important;
          padding: 24px !important;
          max-width: 420px !important;
          width: 100% !important;
          box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3) !important;
          animation: modalFadeIn 0.2s ease-out !important;
          transform: scale(1) !important;
        }
        
        @keyframes modalFadeIn {
          from {
            opacity: 0;
            transform: scale(0.9);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }
        
        .edu-modal-header {
          display: flex !important;
          align-items: center !important;
          gap: 12px !important;
          margin-bottom: 16px !important;
        }
        
        .edu-modal-icon {
          width: 36px !important;
          height: 36px !important;
          background: #dc2626 !important;
          border-radius: 50% !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          color: white !important;
          font-size: 18px !important;
        }
        
        .edu-modal-title {
          font-size: 18px !important;
          font-weight: bold !important;
          color: #1f2937 !important;
          margin: 0 !important;
        }
        
        .edu-modal-message {
          color: #4b5563 !important;
          line-height: 1.6 !important;
          margin: 16px 0 24px 0 !important;
          white-space: pre-line !important;
        }
        
        .edu-modal-actions {
          display: flex !important;
          gap: 12px !important;
          justify-content: flex-end !important;
        }
        
        .edu-modal-btn {
          padding: 8px 20px !important;
          border-radius: 8px !important;
          font-size: 14px !important;
          font-weight: 500 !important;
          border: none !important;
          cursor: pointer !important;
          transition: all 0.2s !important;
        }
        
        .edu-modal-btn-cancel {
          background: #f3f4f6 !important;
          color: #374151 !important;
        }
        
        .edu-modal-btn-cancel:hover {
          background: #e5e7eb !important;
        }
        
        .edu-modal-btn-confirm {
          background: #dc2626 !important;
          color: white !important;
        }
        
        .edu-modal-btn-confirm:hover {
          background: #b91c1c !important;
        }
      `}),f.jsx("div",{className:"edu-modal-overlay",onClick:l=>{l.target===l.currentTarget&&r()},children:f.jsxs("div",{className:"edu-modal-content",children:[f.jsxs("div",{className:"edu-modal-header",children:[f.jsx("div",{className:"edu-modal-icon",children:"⚠️"}),f.jsx("h3",{className:"edu-modal-title",children:i})]}),f.jsx("div",{className:"edu-modal-message",children:s}),f.jsxs("div",{className:"edu-modal-actions",children:[f.jsx("button",{className:"edu-modal-btn edu-modal-btn-cancel",onClick:r,children:"إلغاء"}),f.jsx("button",{className:"edu-modal-btn edu-modal-btn-confirm",onClick:()=>{t(),r()},children:"تأكيد الحذف"})]})]})})]}):null;function gC(e,r){const t=()=>{if(!s||!l)return;const ke=Et("pdf");if(!ke)return;const{tableHeader:je,body:Ue,rowStudentIds:at,themeColor:b}=ke,P=vo(),A=wo(l?.columns||[],P);function D(te,re){try{const ae=`colorfulcell-${te}-${re}`,ve=localStorage.getItem(ae);if(!ve)return"";const{bgColor:Ae,textColor:Me,fontSize:Fe,textAlign:Ce}=JSON.parse(ve);let Ye="";return Ae&&(Ye+=`background:${Ae};`),Me&&(Ye+=`color:${Me};`),Fe&&(Ye+=`font-size:${Fe};`),Ce&&(Ye+=`text-align:${Ce};`),Ye}catch{return""}}let F=`<div style="direction:rtl;font-family:'Almarai','Cairo','Noto Sans Arabic','Amiri',sans-serif;">`;F+='<div style="display:flex; direction:ltr; align-items:center; margin-bottom:16px; text-align:center;">',F+="<div style='flex:1; text-align:left; display:flex; align-items:center;'>",k.logoBase64&&(F+=`<img src='${k.logoBase64}' alt='شعار الوزارة' style='height:100px;width:auto;display:inline-block;object-fit:contain;' />`),F+="</div>",F+=`<div style='flex:1; text-align:center;'><h1 style='font-size:22px;margin:0;'>${Ee||""}</h1></div>`,F+="<div style='flex:1; text-align:right;'>",F+="<div style='font-size:16px;font-weight:bold;'>المملكة العربية السعودية</div>",F+="<div style='font-size:14px;'>وزارة التعليم</div>",F+=`<div style='font-size:14px;'>${k.educationDirectorate||""}</div>`,F+=`<div style='font-size:14px;'>مدرسة: ${k.schoolName||""}</div>`,F+="</div>",F+="</div>";let q=b||"#2E8540";(!q||q.toLowerCase()==="#fff"||q.toLowerCase()==="#ffffff"||q==="white"||q==="transparent")&&(q="#2E8540"),/^#[0-9A-Fa-f]{6}$/.test(q)||(/^#[0-9A-Fa-f]{3}$/.test(q)?q="#"+q.substring(1).split("").map(te=>te+te).join(""):q="#2E8540"),F+="<table border='1' cellspacing='0' cellpadding='4' style='width:100%;border-collapse:collapse;margin-bottom:24px;'>",F+="<thead><tr>"+je.map(te=>`<th style="background:${q} !important;color:${Un(q)};text-align:center;font-weight:bold;">${te}</th>`).join("")+"</tr></thead>",F+="<tbody>",Ue.forEach((te,re)=>{const ae=at[re],ve=s.students.find(Ae=>Ae.id===ae)||s.students[re];F+="<tr>"+te.map((Ae,Me)=>{if(Me<2)return`<td style="border: 1px solid #333; padding: 8px; text-align: ${Me===1?"right":"center"};">${Ae}</td>`;{const Fe=A[Me-2];return`<td style="border: 1px solid #333; padding: 8px; text-align:center; ${D(ve.id,Fe.id)}">${Ae}</td>`}}).join("")+"</tr>"}),F+="</tbody></table>",F+="<table border='1' cellspacing='0' cellpadding='4' style='width:70%;border-collapse:collapse;margin:auto;'>",F+="<tr>"+["م","المنصب","اسم الموقع","التوقيع"].map(te=>`<th style="background:${q} !important;color:${Un(q)};text-align:center;font-weight:bold;">${te}</th>`).join("")+"</tr>",Qe.filter(te=>te.role||te.name).forEach((te,re)=>{F+=`<tr><td style='text-align:center;'>${re+1}</td><td>${te.role}</td><td>${te.name}</td><td style='width:120px;'></td></tr>`}),F+="</table>",F+="</div>";const ce=window.open("","_blank");ce?(ce.document.write(`<html><head><title>${Ee||""}</title><style>@import url('https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800&display=swap');
body{font-family:'Almarai','Cairo','Noto Sans Arabic','Amiri',sans-serif;}
@media print { th, td { -webkit-print-color-adjust: exact; print-color-adjust: exact; } thead { display: table-header-group; } tfoot { display: table-footer-group; } }</style></head><body>${F}<script>window.onload = function() { var waitFonts = (document.fonts && document.fonts.ready) ? document.fonts.ready : Promise.resolve(); var imgs = Array.from(document.images || []); var waitImages = Promise.all(imgs.map(function(img){ if (img.complete) return Promise.resolve(); return new Promise(function(res){ img.addEventListener('load', res); img.addEventListener('error', res); }); })); Promise.all([waitFonts, waitImages]).then(function(){ setTimeout(function(){ window.print(); window.onafterprint = function(){ window.close(); }; }, 100); }); }<\/script></body></html>`),ce.document.close()):Xe.error("تعذر فتح نافذة الطباعة.")},i=()=>{if(!s||!l)return;const ke=Et("excel");if(!ke)return;const{tableHeader:je,body:Ue,themeColor:at}=ke,b=XLSX.utils.book_new();b.Props={Title:Ee,Author:"",CreatedDate:new Date},b.Workbook={Views:[{RTL:!0}]};const P=[["المملكة العربية السعودية"],["وزارة التعليم"],[k.educationDirectorate||""],[`مدرسة: ${k.schoolName||""}`],[Ee||""],[]],A=[je,...Ue],D=[["المنصب","اسم الموقع","التوقيع"],...Qe.filter(lt=>lt.role||lt.name).map(lt=>[lt.role,lt.name,""])],F=[...P,...A,[],...D],j=XLSX.utils.aoa_to_sheet(F),q={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}};let ce=(at||"#2E8540").replace("#","");ce.length===3&&(ce=ce.split("").map(lt=>lt+lt).join("")),ce.length<6&&(ce=ce.padEnd(6,"0"));function te(lt,yt){let Mr=parseInt(lt,16),Br=Mr>>16&255,vr=Mr>>8&255,Wt=Mr&255;return Br=Math.floor(Br*(1-yt)),vr=Math.floor(vr*(1-yt)),Wt=Math.floor(Wt*(1-yt)),(16777216+(Br<<16)+(vr<<8)+Wt).toString(16).slice(1).toUpperCase()}let re=parseInt(ce,16),ae=re>>16&255,ve=re>>8&255,Ae=re&255;ae>220&&ve>220&&Ae>220&&(ce=te(ce,.3));const Me={font:{bold:!0,color:{rgb:"FFFFFFFF"},name:"Noto Sans Arabic"},fill:{fgColor:{rgb:ce.toUpperCase()}},alignment:{horizontal:"center",vertical:"center"},border:q},Fe={alignment:{horizontal:"right",vertical:"center"},border:q,font:{name:"Noto Sans Arabic"}},Ce={alignment:{horizontal:"center",vertical:"center"},border:q,font:{name:"Noto Sans Arabic"}},Ye=P.length;je.forEach((lt,yt)=>{const Mr=XLSX.utils.encode_cell({c:yt,r:Ye});j[Mr]&&(j[Mr].s=Me)}),Ue.forEach((lt,yt)=>{lt.forEach((Mr,Br)=>{const vr=XLSX.utils.encode_cell({c:Br,r:Ye+1+yt});j[vr]&&(j[vr].s=Br===1?Fe:Ce)})});const Nt=je.map((lt,yt)=>({wch:yt===0?5:yt===1?35:Math.max(15,(lt||"").length*1.5)}));j["!cols"]=Nt,j["!pageSetup"]={orientation:"landscape",fitToPage:!0,horizontalCentered:!0,verticalCentered:!1,scale:100},XLSX.utils.book_append_sheet(b,j,"كشف الإدارة"),XLSX.writeFile(b,`كشف_${Ee||"الإدارة"}.xlsx`)},{activeClass:s,activeSubject:l,onAddColumn:c,onDeleteColumn:u,onEditColumn:h,onFillColumn:x,onImportStudents:p,onAddStudent:v,onUpdateStudentData:y,onDeleteStudent:E,settings:k,apiKey:w,onRequestApiKey:S,color:O,onAddClass:R,onAddSubject:C,onExportExcel:L,onExportPdf:X,onOpenSettings:W,onOpenCustomize:M,classes:V,activeClassId:G,activeSubjectId:oe,onClassChange:B,onSubjectChange:K}=e,[me,he]=ee.useState(!1),[we,Oe]=ee.useState(()=>{try{const ke=localStorage.getItem("adminReportNames");if(ke)return JSON.parse(ke)}catch{}return["كشف الحضور","كشف التطوير المهني","كشف الغياب","كشف درجات"]}),[Ee,Se]=ee.useState(we[0]||""),[Y,xe]=ee.useState(""),[z,T]=ee.useState(!1),[J,H]=ee.useState(-1),I=xr.useRef(null);xr.useEffect(()=>{const ke=Ue=>{const at=Ue.target;I.current&&!I.current.contains(at)&&(T(!1),H(-1))},je=Ue=>{Ue.key==="Escape"&&(T(!1),H(-1))};return document.addEventListener("mousedown",ke),document.addEventListener("keydown",je),()=>{document.removeEventListener("mousedown",ke),document.removeEventListener("keydown",je)}},[]);const ne=ke=>{if(!z&&(ke.key==="ArrowDown"||ke.key==="Enter"||ke.key===" ")){ke.preventDefault(),T(!0),H(Math.max(0,we.findIndex(je=>je===Ee)));return}if(z)if(ke.key==="ArrowDown")ke.preventDefault(),H(je=>we.length?(je+1)%we.length:-1);else if(ke.key==="ArrowUp")ke.preventDefault(),H(je=>we.length?je<=0?we.length-1:je-1:-1);else if(ke.key==="Enter"){ke.preventDefault();const je=J>=0?J:we.findIndex(Ue=>Ue===Ee);je>=0&&je<we.length&&(Se(we[je]),T(!1))}else ke.key==="Escape"&&T(!1)},[fe,ye]=ee.useState(null),[le,de]=ee.useState(-1),pe=xr.useRef(null);xr.useEffect(()=>{const ke=Ue=>{const at=Ue.target;pe.current&&!pe.current.contains(at)&&(ye(null),de(-1))},je=Ue=>{Ue.key==="Escape"&&(ye(null),de(-1))};return document.addEventListener("mousedown",ke),document.addEventListener("keydown",je),()=>{document.removeEventListener("mousedown",ke),document.removeEventListener("keydown",je)}},[]);const N=(ke,je)=>Ue=>{if(fe===null&&(Ue.key==="ArrowDown"||Ue.key==="Enter"||Ue.key===" ")){Ue.preventDefault(),ye(ke),de(Math.max(0,_e.findIndex(at=>at===je)));return}if(fe===ke)if(Ue.key==="ArrowDown")Ue.preventDefault(),de(at=>_e.length?(at+1)%_e.length:-1);else if(Ue.key==="ArrowUp")Ue.preventDefault(),de(at=>_e.length?at<=0?_e.length-1:at-1:-1);else if(Ue.key==="Enter"){Ue.preventDefault();const at=le>=0?le:_e.findIndex(b=>b===je);if(at>=0&&at<_e.length){const b=_e[at];Ft(ke,{...Qe[ke],role:b}),ye(null)}}else Ue.key==="Escape"&&ye(null)},[_e,Ne]=ee.useState(()=>{try{const ke=localStorage.getItem("adminRoles");if(ke)return JSON.parse(ke)}catch{}return["عضو لجنة","مدير المدرسة","الموجة الطلابي","وكيل شئون الطلاب","وكيل شئون المعلمين","رئيس لجنة","أخرى..."]});xr.useEffect(()=>{try{localStorage.setItem("adminRoles",JSON.stringify(_e))}catch{}},[_e]);const[Qe,Ge]=ee.useState(()=>{try{const ke=localStorage.getItem("adminSigners");if(ke)return JSON.parse(ke)}catch{}return[{role:"عضو لجنة",name:""}]});xr.useEffect(()=>{try{localStorage.setItem("adminReportNames",JSON.stringify(we))}catch{}},[we]),xr.useEffect(()=>{try{localStorage.setItem("adminSigners",JSON.stringify(Qe))}catch{}},[Qe]),console.log("adminSigners",Qe);const Pe=()=>Ge(ke=>[...ke,{role:_e[0]||"",name:""}]),St=ke=>Ge(je=>je.length===1?je:je.filter((Ue,at)=>at!==ke)),Ft=(ke,je)=>Ge(Ue=>Ue.map((at,b)=>b===ke?je:at)),[Dt,Xt]=ee.useState("");xr.useEffect(()=>{const ke=()=>Xr();return window.addEventListener("export-pdf",ke),()=>window.removeEventListener("export-pdf",ke)},[s,l]);const[Rr,gr]=ee.useState(!1),[qt,nr]=ee.useState(!1),[Pr,Lr]=ee.useState(!1),[It,ur]=ee.useState(!1),Ze=()=>`currentPage-${s?.id||"none"}-${l?.id||"none"}`,[ht,ar]=ee.useState(()=>{const ke=Ze(),je=sessionStorage.getItem(ke);return je?Number(je):1}),_t=ke=>{ar(ke),sessionStorage.setItem(Ze(),String(ke))},[ge,Be]=ee.useState(10),[Ie,Le]=ee.useState("asc");xr.useEffect(()=>{ar(1),sessionStorage.setItem(Ze(),"1")},[s?.id,l?.id]);const et=()=>{ur(!0)},Ke=()=>{if(s&&s.students&&s.students.length>0&&e.setClasses){const ke=s.students.length;try{e.setClasses(je=>je.map(Ue=>Ue.id===s.id?{...Ue,students:[]}:Ue)),Xe.success(`تم حذف ${ke} اسم بنجاح`)}catch(je){console.error("خطأ أثناء حذف جميع الأسماء:",je),Xe.error("فشل في حذف الأسماء")}}},xt=O||l?.themeColor||"#2E8540",dt=ee.useMemo(()=>s?.students?[...s.students].sort((ke,je)=>Ie==="asc"?(ke.name||"").localeCompare(je.name||"","ar"):(je.name||"").localeCompare(ke.name||"","ar")):[],[s?.students,Ie]),st=dt.length||0,bt=Math.ceil(st/ge),Ut=(ht-1)*ge,Rt=Ut+ge,nt=dt.slice(Ut,Rt).map((ke,je)=>({...ke,serial:Ie==="asc"?Ut+je+1:st-Ut-je}))||[],Tt=vo(),Ct=wo(l?.columns||[],Tt),Et=(ke="pdf")=>{if(!s||!l)return null;const je=["م","الاسم",...Ct.map(A=>A.name)],Ue=new Intl.Collator("ar",{sensitivity:"base",ignorePunctuation:!0,numeric:!1}),at=[...s.students].sort((A,D)=>Ue.compare(A?.name||"",D?.name||"")),b=at.map(A=>A.id),P=at.map((A,D)=>[(D+1).toString(),A.name,...Ct.map(F=>{const j=A.records[F.id];if(j==null)return"";if(ke==="excel"){if(F.type===ut.CHECKBOX){let q=typeof j=="string"?j:j===!0?"1":j===!1?"2":"0";return q==="1"?"✔":q==="2"?"✗":"-"}if(F.type===ut.MULTI_CHECKBOX){const q=Math.max(1,Number(F.multiSlots)||8);return(typeof j=="string"?j:"".padEnd(q,"0")).split("").map(ve=>ve==="1"||ve==="2"?ve:"0").join("").padEnd(q,"0").slice(0,q).split("").map(ve=>ve==="1"?"✔":ve==="2"?"✗":"-").join("")}}else{if(F.type===ut.CHECKBOX){let q=typeof j=="string"?j:j===!0?"1":j===!1?"2":"0";return q==="1"?'<span style="display:inline-block;width:24px;height:24px;border:1.5px solid #16a34a;background:#d1fae5;border-radius:6px;text-align:center;vertical-align:middle;line-height:24px;font-size:18px;font-weight:bold;color:#16a34a;">✔</span>':q==="2"?'<span style="display:inline-block;width:24px;height:24px;border:1.5px solid #dc2626;background:#fee2e2;border-radius:6px;text-align:center;vertical-align:middle;line-height:24px;font-size:18px;font-weight:bold;color:#dc2626;">✗</span>':'<span style="display:inline-block;width:24px;height:24px;border:1.5px solid #cbd5e1;background:#f1f5f9;border-radius:6px;text-align:center;vertical-align:middle;line-height:24px;font-size:18px;font-weight:bold;color:#64748b;">–</span>'}if(F.type===ut.MULTI_CHECKBOX){const q=Math.max(1,Number(F.multiSlots)||8);return`<div style="display:flex;gap:2px;justify-content:center;align-items:center;">${(typeof j=="string"?j:"".padEnd(q,"0")).split("").map(ve=>ve==="1"||ve==="2"?ve:"0").join("").padEnd(q,"0").slice(0,q).split("").map(ve=>ve==="1"?'<span style="display:inline-block;width:24px;height:24px;border:1.5px solid #16a34a;background:#d1fae5;border-radius:6px;text-align:center;vertical-align:middle;line-height:24px;font-size:18px;font-weight:bold;color:#16a34a;margin:1px;">✔</span>':ve==="2"?'<span style="display:inline-block;width:24px;height:24px;border:1.5px solid #dc2626;background:#fee2e2;border-radius:6px;text-align:center;vertical-align:middle;line-height:24px;font-size:18px;font-weight:bold;color:#dc2626;margin:1px;">✗</span>':'<span style="display:inline-block;width:24px;height:24px;border:1.5px solid #cbd5e1;background:#f1f5f9;border-radius:6px;text-align:center;vertical-align:middle;line-height:24px;font-size:18px;font-weight:bold;color:#64748b;margin:1px;">–</span>').join("")}</div>`}}return j.toString()})]);return{tableHeader:je,body:P,themeColor:xt,rowStudentIds:b}},Kt=()=>{if(!s||!l)return;const ke=Et("excel");if(!ke)return;const{tableHeader:je,body:Ue,themeColor:at}=ke,b=XLSX.utils.book_new();b.Props={Title:"كشف درجات "+l.name,Author:k.teacherName,CreatedDate:new Date},b.Workbook={Views:[{RTL:!0}]};const P=[je,...Ue],A=XLSX.utils.aoa_to_sheet(P),D={top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},F={font:{bold:!0,color:{rgb:"FFFFFFFF"}},fill:{fgColor:{rgb:at.substring(1)}},alignment:{horizontal:"center",vertical:"center"},border:D},j={alignment:{horizontal:"right",vertical:"center"},border:D},q={alignment:{horizontal:"center",vertical:"center"},border:D};je.forEach((te,re)=>{const ae=XLSX.utils.encode_cell({c:re,r:0});A[ae]&&(A[ae].s=F)}),Ue.forEach((te,re)=>{te.forEach((ae,ve)=>{const Ae=XLSX.utils.encode_cell({c:ve,r:1+re});A[Ae]&&(A[Ae].s=ve===1?j:q)})});const ce=je.map((te,re)=>({wch:re===0?5:re===1?35:Math.max(15,(te||"").length*1.5)}));A["!cols"]=ce,A["!pageSetup"]={orientation:"landscape",fitToPage:!0,horizontalCentered:!0,verticalCentered:!1,scale:100,header:`&Cالمملكة العربية السعودية
وزارة التعليم
${k.educationDirectorate}
مدرسة: ${k.schoolName}
كشف متابعة وتقويم الطلاب
المادة: ${l.name} - الفصل: ${s.name} - ${k.semester} - العام الدراسي: ${k.academicYear}`,footer:`&Lمعلم المادة: ${k.teacherName}
التوقيع: ..........................&Rمدير المدرسة: ${k.principalName}
التوقيع: ..........................`},XLSX.utils.book_append_sheet(b,A,"كشف الدرجات"),XLSX.writeFile(b,`كشف-${s.name}-${l.name}.xlsx`)};xr.useImperativeHandle(r,()=>({exportPdf:Xr,exportExcel:Kt}),[s,l,k,O]);const Xr=()=>{if(!s||!l)return;const ke=Et();if(!ke)return;const{tableHeader:je,body:Ue,rowStudentIds:at}=ke,b=`
      <div style="display:flex; direction:ltr; align-items:center; margin-bottom:16px; text-align:center;">
        <!-- يسار: الشعار -->
        <div style="flex:1; text-align:left; display:flex; align-items:center;">
          ${k.logoBase64?`<img src='${k.logoBase64}' alt='شعار الوزارة' style='height:100px; width:auto; display:inline-block; object-fit:contain;' />`:""}
        </div>
        <!-- وسط: العنوان -->
        <div style="flex:1; text-align:center;">
          <h1 style="font-size:22px; margin:0;">سجل متابعة وتقويم الطلاب</h1>
        </div>
        <!-- يمين: الترويسة -->
        <div style="flex:1; text-align:right;">
          <div style='font-size:16px;font-weight:bold;'>المملكة العربية السعودية</div>
          <div style='font-size:14px;'>وزارة التعليم</div>
          <div style='font-size:14px;'>${k.educationDirectorate}</div>
          <div style='font-size:14px;'>مدرسة: ${k.schoolName}</div>
        </div>
      </div>
      <div style="display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 14px; font-weight: bold;">
        <span>المادة: ${l.name}</span>
        <span>الفصل: ${s.name}</span>
        <span>${k.semester}</span>
        <span>العام الدراسي: ${k.academicYear}</span>
      </div>
    `;function P(j,q){try{const ce=`colorfulcell-${j}-${q}`,te=localStorage.getItem(ce);if(!te)return"";const{bgColor:re,textColor:ae,fontSize:ve,textAlign:Ae}=JSON.parse(te);let Me="";return re&&(Me+=`background:${re};`),ae&&(Me+=`color:${ae};`),ve&&(Me+=`font-size:${ve};`),Ae&&(Me+=`text-align:${Ae};`),Me}catch{return""}}const A=`
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr>
            ${je.map(j=>`<th style="border: 1px solid #333; padding: 8px; background-color: ${xt}; color: ${Un(xt)}; text-align: center; font-weight: bold; font-family: 'Almarai','Cairo','Noto Sans Arabic','Amiri',sans-serif !important;">${j}</th>`).join("")}
          </tr>
        </thead>
        <tbody>
          ${Ue.map((j,q)=>{const ce=at[q],te=s.students.find(re=>re.id===ce)||s.students[q];return`
              <tr>
                ${j.map((re,ae)=>{if(ae<2)return`<td style="border: 1px solid #333; padding: 8px; text-align: ${ae===1?"right":"center"};">${re}</td>`;{const ve=Ct[ae-2];return`<td style="border: 1px solid #333; padding: 8px; text-align:center; ${P(te.id,ve.id)}">${re}</td>`}}).join("")}
              </tr>
            `}).join("")}
        </tbody>
      </table>
    `,D=`
      <div style="display: flex; justify-content: space-around; margin-top: 40px; font-size: 14px; font-weight: bold;">
        <div>
          <p>معلم المادة: ${k.teacherName}</p>
          <p style="margin-top: 25px;">التوقيع: ..........................</p>
        </div>
        <div>
          <p>مدير المدرسة: ${k.principalName}</p>
          <p style="margin-top: 25px;">التوقيع: ..........................</p>
        </div>
      </div>
    `,F=window.open("","_blank");F?(F.document.write("<html><head><title>طباعة سجل - "+l.name+"</title><style>@import url('https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800&display=swap'); body { font-family: 'Almarai','Cairo','Noto Sans Arabic','Amiri',sans-serif; direction: rtl; margin: 20px; } table { font-size: 12px; } @media print { @page { size: A4 landscape; margin: 15mm; } body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } } </style></head><body>"+b+A+D+"<script>window.onload = function() { if (document.fonts && document.fonts.ready) { document.fonts.ready.then(function() { setTimeout(function() { window.print(); window.onafterprint = function() { window.close(); } }, 100); }); } else { setTimeout(function() { window.print(); window.onafterprint = function() { window.close(); } }, 500); } } <\/script></body></html>"),F.document.close()):Xe.error("فشل فتح نافذة الطباعة. الرجاء التأكد من السماح بالنوافذ المنبثقة.")};return!s||!l?f.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-[70vh] min-h-[350px] text-center p-2 bg-white rounded-xl shadow-sm m-0",children:[f.jsx(fy,{className:"w-16 h-16 text-slate-400 mb-4"}),f.jsx("h2",{className:"text-base font-bold text-slate-700",children:s?"مرحباً بك في فصل "+s.name:"مرحباً بك في سجل الدرجات"}),f.jsx("p",{className:"mt-2 max-w-md text-xs text-slate-500",children:s?"الرجاء تحديد مادة دراسية من القائمة الجانبية، أو إضافة مادة جديدة للبدء في رصد الدرجات.":"الرجاء تحديد فصل دراسي أو إنشاء فصل جديد من القائمة الجانبية للبدء."}),f.jsx("div",{className:"mt-6 w-full flex justify-center",children:f.jsx(Vh,{onAddClass:R,onAddSubject:C,onAddStudent:()=>{},onAddColumn:()=>{},onImportStudents:()=>{},onExportExcel:()=>{},onExportPdf:()=>{},onOpenSettings:W,onOpenCustomize:M,onSaveTemplate:e.onSaveTemplate,onUseTemplate:e.onUseTemplate,classType:s?.type})})]}):f.jsxs("div",{className:"w-full min-h-screen flex flex-col p-0 m-0",style:{marginTop:0,paddingTop:0,border:"none"},children:[V&&V.length>0&&f.jsx("div",{className:"w-full flex justify-center mt-2",children:f.jsx(xy,{classes:V,activeClassId:G,activeSubjectId:oe,onClassChange:B,onSubjectChange:K})}),f.jsx(Vh,{onAddClass:R,onAddSubject:C,onAddStudent:()=>Lr(!0),onAddColumn:()=>gr(!0),onImportStudents:()=>nr(!0),onDeleteAllStudents:et,onExportExcel:L,onExportPdf:X,onOpenSettings:W,onOpenCustomize:M,onSaveTemplate:e.onSaveTemplate,onUseTemplate:e.onUseTemplate,classType:s?.type,onAdminExport:()=>he(!0)}),me&&f.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/40 p-2 sm:p-4",onClick:()=>he(!1),children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-[95vw] sm:w-[90vw] md:max-w-2xl lg:max-w-3xl relative max-h-[85vh] overflow-y-auto p-4 sm:p-6 md:p-8",onClick:ke=>ke.stopPropagation(),children:[f.jsx("button",{className:"absolute left-3 top-3 text-slate-500 hover:text-red-500 text-xl font-bold",onClick:()=>he(!1),"aria-label":"إغلاق",children:"×"}),f.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4 text-slate-800",children:"شاشة تصدير الكشوف الإدارية"}),f.jsxs("div",{className:"mb-4 text-slate-700 text-sm",children:[f.jsx("label",{className:"block mb-2 font-semibold",children:"اسم الكشف:"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mb-4",children:[f.jsxs("div",{className:"sm:col-span-2 flex items-center gap-2",children:[f.jsxs("div",{className:"relative w-full",ref:I,children:[f.jsxs("button",{type:"button",className:"w-full px-3 py-2 rounded border border-slate-300 bg-slate-50 text-sm flex items-center justify-between","aria-haspopup":"listbox","aria-expanded":z,onClick:()=>T(ke=>!ke),onKeyDown:ne,children:[f.jsx("span",{className:"truncate",children:Ee||"اختر اسم الكشف"}),f.jsx("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"currentColor",className:"text-slate-500",children:f.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z",clipRule:"evenodd"})})]}),z&&f.jsx("div",{className:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md border border-slate-200 bg-white shadow-lg ring-1 ring-black/5",children:f.jsx("ul",{role:"listbox","aria-label":"اختيار اسم الكشف",children:we.map((ke,je)=>{const Ue=je===J||ke===Ee;return f.jsx("li",{id:`report-opt-${je}`,role:"option","aria-selected":ke===Ee,className:`px-3 py-2 cursor-pointer text-sm ${Ue?"bg-emerald-50 text-emerald-700":"text-slate-700 hover:bg-slate-50"}`,onMouseEnter:()=>H(je),onMouseDown:at=>at.preventDefault(),onClick:()=>{Se(ke),T(!1)},children:ke},je)})})})]}),we.length>1&&f.jsx("button",{className:"shrink-0 text-red-500 hover:text-red-700 text-lg font-extrabold",style:{fontSize:"1.5rem"},title:"حذف اسم الكشف المحدد",onClick:()=>{const ke=we.findIndex(je=>je===Ee);if(ke!==-1&&we.length>1){const je=we.filter((Ue,at)=>at!==ke);Oe(je),Se(je[0]||"")}},children:"×"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{type:"text",className:"flex-1 px-3 py-2 rounded border border-slate-300 bg-slate-50 text-sm",value:Y,onChange:ke=>xe(ke.target.value),placeholder:"إضافة اسم جديد..."}),f.jsx("button",{className:"px-3 py-2 bg-emerald-100 text-emerald-700 rounded text-xs sm:text-sm font-semibold",onClick:()=>{Y&&!we.includes(Y)&&(Oe([...we,Y]),Se(Y),xe(""))},children:"إضافة"})]})]}),f.jsx("label",{className:"block mb-2 font-semibold",children:"الموقعون:"}),f.jsxs("div",{className:"space-y-3",children:[Qe.map((ke,je)=>f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-5 gap-2 items-center",children:[f.jsxs("div",{className:"relative md:col-span-2",ref:je===fe?pe:void 0,children:[f.jsxs("button",{type:"button",className:"w-full px-2 py-2 rounded border border-slate-300 text-sm bg-white text-slate-700 flex items-center justify-between","aria-haspopup":"listbox","aria-expanded":fe===je,onClick:()=>{ye(Ue=>Ue===je?null:je),de(Math.max(0,_e.findIndex(Ue=>Ue===ke.role)))},onKeyDown:N(je,ke.role),children:[f.jsx("span",{className:"truncate",children:ke.role||"اختر المنصب"}),f.jsx("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"currentColor",className:"text-slate-500",children:f.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z",clipRule:"evenodd"})})]}),fe===je&&f.jsx("div",{className:"absolute z-50 mt-1 max-h-56 w-full overflow-auto rounded-md border border-slate-200 bg-white shadow-lg ring-1 ring-black/5",children:f.jsx("ul",{role:"listbox","aria-label":"اختيار المنصب",children:_e.map((Ue,at)=>{const b=at===le||Ue===ke.role;return f.jsx("li",{role:"option","aria-selected":Ue===ke.role,className:`px-3 py-2 cursor-pointer text-sm ${b?"bg-emerald-50 text-emerald-700":"text-slate-700 hover:bg-slate-50"}`,onMouseEnter:()=>de(at),onMouseDown:P=>P.preventDefault(),onClick:()=>{Ft(je,{...ke,role:Ue}),ye(null)},children:Ue},at)})})})]}),f.jsx("input",{type:"text",className:"px-2 py-2 rounded border border-slate-300 text-sm md:col-span-2",value:ke.name,onChange:Ue=>Ft(je,{...ke,name:Ue.target.value}),placeholder:"اسم الموقع"}),f.jsxs("div",{className:"flex items-center gap-2 md:justify-end",children:[f.jsx("input",{type:"text",className:"w-28 px-2 py-2 rounded border border-slate-300 text-sm",value:Dt,onChange:Ue=>Xt(Ue.target.value),placeholder:"إضافة منصب..."}),f.jsx("button",{className:"px-3 py-2 bg-emerald-100 text-emerald-700 rounded text-xs font-semibold",onClick:()=>{Dt&&!_e.includes(Dt)&&(Ne([..._e,Dt]),Ft(je,{...ke,role:Dt}),Xt(""))},children:"+"}),f.jsx("button",{className:"px-3 py-2 text-red-600 hover:text-red-700 rounded text-lg font-bold",title:"حذف الموقع",onClick:()=>St(je),children:"×"})]})]},je)),f.jsx("button",{className:"mt-1 px-3 py-2 rounded bg-emerald-100 text-emerald-700 hover:bg-emerald-200 text-xs sm:text-sm font-semibold",onClick:Pe,children:"+ إضافة موقع"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-6",children:[f.jsx("button",{className:"w-full py-2 rounded-lg bg-green-700 text-white hover:bg-green-800 font-semibold text-sm",onClick:i,children:"تصدير Excel"}),f.jsx("button",{className:"w-full py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 font-semibold text-sm",onClick:t,children:"تصدير PDF"})]})]})}),f.jsxs("div",{className:"full-page-table w-full h-full flex-1 flex flex-col pe-3 md:pe-4 relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 w-3 md:w-4 bg-white pointer-events-none","aria-hidden":"true"}),f.jsx("div",{className:"full-page-table-container w-full h-full flex-1 overflow-x-auto overflow-y-hidden",style:{direction:"rtl"},children:f.jsx(ry,{columns:Ct,students:nt,onEditColumn:(ke,je)=>h(s.id,l.id,String(ke),je),onDeleteColumn:(ke,je)=>u(s.id,l.id,String(ke),je),onDeleteStudent:(ke,je)=>E(s.id,String(ke),je),onFillColumn:(ke,je)=>x(s.id,l.id,String(ke),je),onUpdateStudentData:(ke,je,Ue)=>y(s.id,String(ke),String(je),Ue),themeColor:xt,nameSortOrder:Ie,onNameSortChange:Le})})]}),st>0&&f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-4 p-2 bg-white rounded-lg shadow-md",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 mb-2 sm:mb-0",children:[f.jsx("span",{children:"عرض"}),f.jsxs("select",{value:ge,onChange:ke=>{Be(Number(ke.target.value)),_t(1)},className:"p-1 border rounded bg-slate-50 focus:ring-1 focus:ring-emerald-500",children:[f.jsx("option",{value:"5",children:"5"}),f.jsx("option",{value:"10",children:"10"}),f.jsx("option",{value:"15",children:"15"}),f.jsx("option",{value:"25",children:"25"}),f.jsx("option",{value:"50",children:"50"})]}),f.jsx("span",{children:"صفوف"})]}),f.jsxs("span",{className:"text-sm text-slate-600 mb-2 sm:mb-0",children:["عرض ",Math.min(Ut+1,st),"-",Math.min(Rt,st)," من ",st]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>_t(Math.max(ht-1,1)),disabled:ht===1,className:"p-2 rounded-md hover:bg-slate-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"الصفحة السابقة",children:f.jsx(uy,{className:"w-5 h-5"})}),f.jsxs("span",{className:"text-sm font-semibold",children:["صفحة ",ht," من ",bt||1]}),f.jsx("button",{onClick:()=>_t(Math.min(ht+1,bt)),disabled:ht>=bt||st===0,className:"p-2 rounded-md hover:bg-slate-200 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"الصفحة التالية",children:f.jsx(cy,{className:"w-5 h-5"})})]})]}),Rr&&f.jsx(kp,{onClose:()=>gr(!1),onAddColumn:(ke,je,Ue,at)=>{c(s.id,l.id,ke,je,Ue,at),gr(!1)}}),qt&&f.jsx(rm,{onClose:()=>nr(!1),onImport:(ke,je,Ue)=>{p(s.id,l.id,ke,je,Ue),nr(!1)}}),Pr&&f.jsx(nm,{onClose:()=>Lr(!1),onAddStudent:ke=>{v(s.id,ke),Lr(!1)}}),It&&f.jsx(mC,{isOpen:It,onClose:()=>ur(!1),onConfirm:Ke,title:"تأكيد حذف جميع الأسماء",message:`هل أنت متأكد من حذف جميع الأسماء؟

سيتم حذف ${s?.students?.length||0} اسم نهائياً
هذا الإجراء لا يمكن التراجع عنه`})]})}const vC=xr.forwardRef(gC),wC=[{label:"المهام الأدائية",options:[{name:"واجبات",defaultCount:4},{name:"مشروع",defaultCount:1},{name:"مهام أدائية",defaultCount:4}]},{label:"المشاركة والتفاعل",options:[{name:"أنشطة صفية",defaultCount:4},{name:"مشاركة",defaultCount:4},{name:"تطبيقات عملية",defaultCount:4}]},{label:"القرآن الكريم والتجويد",options:[{name:"التلاوة",defaultCount:5},{name:"الترتيل",defaultCount:5},{name:"التحويد",defaultCount:5},{name:"طلاقة القراءة",defaultCount:4},{name:"الحفظ",defaultCount:5}]},{label:"تطبيقات عملية",options:[{name:"لياقة بدنية",defaultCount:3},{name:"مهارات حركة",defaultCount:3}]},{label:"اختبار قصير",options:[{name:"اختبار قصير",defaultCount:2}]}],Ka=Array.from(new Set(["#10b981","#2563eb","#f59e42","#e11d48","#64748b","#fbbf24","#a21caf","#f472b6","#f87171","#facc15","#4ade80","#22d3ee","#818cf8","#c026d3","#0ea5e9","#f43f5e","#a3e635","#fbbf24","#6366f1","#14b8a6","#eab308","#fca5a5","#a7f3d0","#fcd34d","#f9fafb","#d1fae5","#f3e8ff","#fef3c7","#f1f5f9","#fde68a","#7dd3fc","#c7d2fe","#fbcfe8","#fef9c3","#bbf7d0","#e0e7ff","#f5d0fe","#fef2f2","#ffb300","#ff7043","#8d6e63","#789262","#00bcd4","#d4e157","#ff8a65","#ba68c8","#ffd600","#ff5252","#607d8b","#00e676","#ff1744","#b2ff59","#00bfae","#ffea00","#ff4081","#b388ff","#c51162","#ffab00","#cddc39","#ff6d00","#aeea00","#00e5ff","#ff80ab","#ea80fc","#b2dfdb","#ffccbc","#d7ccc8","#c8e6c9","#f0f4c3","#b3e5fc","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f8bbd0","#f48fb1","#ce93d8","#b39ddb","#9fa8da","#90caf9","#81d4fa","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#ffffff","#f8fafc","#f1f5f9","#e2e8f0","#cbd5e1","#94a3b8","#475569","#334155","#1e293b","#0f172a","#eeeeee","#e0e0e0","#bdbdbd","#9e9e9e","#757575","#616161","#424242","#212121","#fff","#fcfcfc","#f5f5f5","#fafafa","#f4f4f5","#e5e7eb","#d1d5db","#9ca3af","#6b7280","#374151","#111827"])),yC=({open:e,onClose:r,onAddColumn:t,onColorChange:i,classes:s,activeClassId:l,activeSubjectId:c,onEditClass:u,onDeleteClass:h,onEditSubject:x,onDeleteSubject:p,onAddClass:v,onAddSubject:y})=>{const[E,k]=ee.useState(!1),[w,S]=ee.useState({}),[O,R]=ee.useState(null),[C,L]=ee.useState(""),[X,W]=ee.useState(null),[M,V]=ee.useState(null),[G,oe]=ee.useState(""),[B,K]=ee.useState(""),[me,he]=ee.useState("تعليمي"),[we,Oe]=ee.useState(null),[Ee,Se]=ee.useState(()=>{const I={};return s.forEach(ne=>{I[ne.id]=ne.id!==l}),I});ee.useEffect(()=>{Se(()=>{const I={};return s.forEach(ne=>{I[ne.id]=ne.id!==l}),I})},[l,s]);const[Y,xe]=ee.useState(""),[z,T]=ee.useState(!1),[J,H]=ee.useState(null);return f.jsx("div",{className:`fixed top-0 left-0 w-full h-full bg-black/60 backdrop-blur-sm z-[100] 
                  transition-all duration-300 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:r,style:{direction:"rtl"},children:f.jsxs("div",{className:`fixed top-0 right-0 w-full max-w-md h-full bg-white border-l border-gray-200 
                   shadow-2xl z-[110] pt-6 px-6 pb-6 overflow-y-auto flex flex-col 
                   rounded-s-2xl transition-transform duration-300 ease-in-out 
                   ${e?"translate-x-0":"translate-x-full"}`,onClick:I=>I.stopPropagation(),children:[f.jsxs("div",{className:`flex justify-between items-center mb-6 sticky top-0 bg-white rounded-xl p-4 \r
                       border border-gray-200 shadow-lg`,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`w-10 h-10 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-full \r
                           flex items-center justify-center text-white font-bold shadow-lg`,children:"⚙️"}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"إعدادات التخصيص"}),f.jsx("p",{className:"text-sm text-gray-600",children:"إدارة الفصول والمواد"})]})]}),f.jsx("button",{onClick:r,className:`btn-modern p-3 rounded-xl hover:scale-110 transition-all duration-200 group\r
                     bg-gradient-to-br from-red-50 to-red-100 border border-red-200 hover:bg-red-100`,"aria-label":"إغلاق",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 text-red-500 group-hover:text-red-600 group-hover:rotate-90 \r
                          transition-all duration-300`,viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),f.jsxs("div",{className:"mb-6",children:[f.jsxs("h3",{className:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 tracking-tight flex items-center",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-1.5 text-slate-600 dark:text-slate-400",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{d:"M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"})}),"إدارة الفصول والمواد"]}),f.jsxs("form",{className:"flex flex-col gap-2 mb-4",onSubmit:I=>{I.preventDefault(),B.trim()&&(v(B.trim(),me),K(""),he("تعليمي"))},children:[f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",className:"flex-1 border border-slate-300 rounded-lg px-3 py-2 text-sm bg-slate-50 focus:ring-2 focus:ring-emerald-400 transition-all",placeholder:"اسم الفصل الجديد...",value:B,onChange:I=>K(I.target.value)}),f.jsx("button",{type:"submit",className:"btn-3d bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 disabled:bg-slate-400 text-sm font-semibold shadow-sm transition-all",disabled:!B.trim(),children:"إضافة فصل"})]}),f.jsxs("div",{className:"flex gap-4 items-center mt-1",children:[f.jsxs("label",{className:"flex items-center gap-1 text-sm font-medium",children:[f.jsx("input",{type:"radio",name:"classType",value:"تعليمي",checked:me==="تعليمي",onChange:()=>he("تعليمي")}),"تعليمي"]}),f.jsxs("label",{className:"flex items-center gap-1 text-sm font-medium",children:[f.jsx("input",{type:"radio",name:"classType",value:"إداري",checked:me==="إداري",onChange:()=>he("إداري")}),"إداري"]})]})]}),f.jsxs("div",{className:"space-y-2",children:[Array.isArray(s)&&s.length===0&&f.jsx("div",{className:"text-center text-slate-400 text-sm",children:"لا توجد فصول بعد."}),Array.isArray(s)&&s.map((I,ne)=>{const fe=Ka[ne%Ka.length],ye=Ee[I.id];return f.jsxs("div",{className:`rounded-xl p-3 shadow-sm border border-slate-200 bg-white \r
                                          transition-all hover:shadow-md`,style:{boxShadow:"0 2px 8px -2px rgba(0,0,0,0.1)",backgroundColor:"white"},children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>Se(le=>({...le,[I.id]:!le[I.id]})),children:O===I.id?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("input",{className:"font-bold px-3 py-1.5 rounded-lg text-base shadow-sm bg-white border border-emerald-400 text-slate-900",style:{minWidth:80,backgroundColor:"white"},value:C,autoFocus:!0,onChange:le=>L(le.target.value)}),f.jsxs("select",{className:"px-2 py-1 rounded-lg border border-slate-300 text-sm bg-white text-slate-700",value:X??I.type,onChange:le=>W(le.target.value),children:[f.jsx("option",{value:"تعليمي",children:"تعليمي"}),f.jsx("option",{value:"إداري",children:"إداري"})]}),f.jsx("button",{className:"text-emerald-600 hover:bg-emerald-100 rounded-full p-1",title:"حفظ",onClick:le=>{le.stopPropagation(),(C.trim()&&C!==I.name||X&&X!==I.type)&&u({...I,name:C.trim(),type:X??I.type}),R(null),W(null)},children:f.jsx("svg",{width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M5 13l4 4L19 7"})})}),f.jsx("button",{className:"text-red-500 hover:bg-red-100 rounded-full p-1",title:"إلغاء",onClick:le=>{le.stopPropagation(),R(null)},children:f.jsx("svg",{width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):f.jsxs("span",{className:"font-bold px-3 py-1.5 rounded-lg flex items-center gap-2 text-base shadow-sm",style:{backgroundColor:fe,color:"#fff"},children:[I.name,f.jsx("span",{className:"px-2 py-0.5 rounded bg-white/70 text-emerald-700 text-xs font-normal border border-emerald-200",style:{direction:"rtl"},children:I.type}),f.jsx("span",{style:{fontSize:"1.1em"},children:ye?"▼":"▲"})]})}),f.jsxs("div",{className:"flex gap-1 items-center",children:[f.jsx("button",{className:"p-1 rounded-full hover:bg-emerald-100 transition-all",title:"إضافة مادة",onClick:le=>{le.stopPropagation(),Oe(I.id)},children:f.jsx("svg",{width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M12 4v16m8-8H4"})})}),f.jsx("button",{className:"p-1 rounded-full hover:bg-slate-200 transition-all",title:"تعديل الفصل",onClick:le=>{le.stopPropagation(),R(I.id),L(I.name),W(I.type)},children:f.jsx("svg",{width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 112.828 2.828L11.828 15.828a4 4 0 01-1.414.828l-4.243 1.415 1.415-4.243a4 4 0 01.828-1.414z"})})}),f.jsx("button",{className:"p-1 rounded-full hover:bg-red-100/80 hover:ring-2 hover:ring-red-400 transition-all",title:"حذف الفصل",onClick:le=>{le.stopPropagation(),h(I)},children:f.jsx("svg",{width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M1 7h22M8 7V5a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]}),!ye&&we===I.id&&f.jsxs("form",{className:"flex gap-2 mb-2",onSubmit:le=>{le.preventDefault(),Y.trim()&&(y(I,Y.trim()),xe(""),Oe(null))},children:[f.jsx("input",{type:"text",className:"flex-1 border border-slate-300 rounded-lg px-3 py-2 text-sm bg-slate-50 focus:ring-2 focus:ring-blue-400 transition-all",placeholder:"اسم المادة الجديدة...",value:Y,onChange:le=>xe(le.target.value),autoFocus:!0}),f.jsx("button",{type:"submit",className:"btn-3d bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:bg-slate-400 text-sm font-semibold shadow-sm transition-all",disabled:!Y.trim(),children:"إضافة مادة"}),f.jsx("button",{type:"button",className:"btn-3d bg-slate-200 text-slate-700 px-3 py-2 rounded-lg hover:bg-slate-300 text-sm font-semibold transition-all",onClick:()=>{Oe(null),xe("")},children:"إلغاء"})]}),!ye&&f.jsx("div",{className:"ps-4 space-y-1",children:Array.isArray(I.subjects)&&I.subjects.length>0?I.subjects.map((le,de)=>{const pe=le.themeColor||Ka[(ne*7+de*3)%Ka.length];return f.jsxs("div",{className:"flex items-center justify-between text-sm rounded-lg shadow-sm border border-slate-200 bg-white my-1 px-2 py-1 transition-all hover:shadow-md",style:{backgroundColor:"white"},children:[M===le.id?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("input",{className:"font-semibold px-3 py-1 rounded-lg text-sm shadow-sm bg-white border border-emerald-400 text-slate-900",style:{minWidth:60,backgroundColor:"white"},value:G,autoFocus:!0,onChange:N=>oe(N.target.value)}),f.jsx("button",{className:"text-emerald-600 hover:bg-emerald-100 rounded-full p-1",title:"حفظ",onClick:N=>{N.stopPropagation(),G.trim()&&G!==le.name&&x(I,{...le,name:G.trim()}),V(null)},children:f.jsx("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M5 13l4 4L19 7"})})}),f.jsx("button",{className:"text-red-500 hover:bg-red-100 rounded-full p-1",title:"إلغاء",onClick:N=>{N.stopPropagation(),V(null)},children:f.jsx("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):f.jsx("span",{className:"font-semibold px-3 py-1 rounded-lg text-sm shadow-sm",style:{backgroundColor:pe,color:"#fff"},children:le.name}),f.jsxs("span",{className:"flex gap-1 items-center",children:[f.jsx("button",{className:"p-1 rounded-full hover:bg-slate-200 transition-all",title:"تعديل المادة",onClick:()=>{V(le.id),oe(le.name)},children:f.jsx("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 112.828 2.828L11.828 15.828a4 4 0 01-1.414.828l-4.243 1.415 1.415-4.243a4 4 0 01.828-1.414z"})})}),f.jsx("button",{className:"p-1 rounded-full hover:bg-red-100/80 hover:ring-2 hover:ring-red-400 transition-all",title:"حذف المادة",onClick:()=>p(I,le),children:f.jsx("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M1 7h22M8 7V5a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]},le.id)}):null})]},I.id)})]})]}),f.jsxs("div",{className:"mb-6",children:[f.jsxs("h3",{className:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 tracking-tight flex items-center",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-1.5 text-slate-600 dark:text-slate-400",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"})}),"مكونات السجل"]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsxs("button",{onClick:()=>k(I=>!I),className:"w-full py-3 px-4 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-emerald-100 dark:hover:bg-emerald-900/20 border border-slate-200 dark:border-slate-600 text-right transition-all flex items-center justify-between font-semibold shadow-sm",children:[f.jsxs("span",{className:"flex items-center",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),"إضافة أعمدة سريعة"]}),f.jsx("span",{className:`transition-transform ${E?"rotate-90":""}`,children:"▶"})]}),E&&f.jsxs("div",{className:"mt-2 flex flex-col gap-3 border border-slate-200 rounded-lg p-3 bg-gray-50 max-h-[400px] overflow-y-auto shadow-sm",children:[wC.map((I,ne)=>f.jsxs("div",{className:"mb-2 p-2 rounded-lg shadow-sm bg-white border border-gray-200",children:[f.jsx("div",{className:"font-semibold mb-2 text-base text-gray-800",style:{color:Ka[ne%Ka.length]},children:I.label}),f.jsx("div",{className:"flex flex-col gap-1",children:I.options.map(fe=>f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm",children:[f.jsx("input",{type:"checkbox",checked:!!w[fe.name]?.checked,onChange:ye=>{S(le=>{const de=le[fe.name]?.count;return{...le,[fe.name]:{checked:ye.target.checked,count:de!==void 0?de:fe.defaultCount}}})}}),fe.name,w[fe.name]?.checked&&f.jsx("input",{type:"number",min:1,max:20,value:w[fe.name]?.count||fe.defaultCount,onChange:ye=>{const le=Math.max(1,Math.min(20,Number(ye.target.value)));S(de=>({...de,[fe.name]:{...de[fe.name],count:le}}))},className:"w-12 px-1 py-0.5 border border-slate-300 rounded-lg text-xs text-center ml-2 text-slate-800",style:{direction:"ltr"}})]},fe.name))})]},I.label)),f.jsx("button",{className:"mt-2 w-full py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700 text-sm font-semibold shadow-sm transition-all",onClick:()=>{const I=Object.entries(w).filter(([ne,fe])=>fe.checked).map(([ne,fe])=>({name:ne,count:fe.count}));t(I),k(!1),S({})},disabled:Object.values(w).filter(I=>I.checked).length===0,children:"إضافة"})]})]})]}),f.jsxs("div",{className:"mb-6",children:[f.jsxs("h3",{className:"text-lg font-bold mb-3 text-slate-800 dark:text-slate-100 tracking-tight flex items-center",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-1.5 text-slate-600 dark:text-slate-400",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z",clipRule:"evenodd"})}),"ألوان المادة"]}),f.jsxs("button",{className:"w-full py-3 px-4 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-emerald-100 dark:hover:bg-emerald-900/20 border border-slate-200 dark:border-slate-600 text-right transition-all flex items-center justify-between font-semibold shadow-sm",onClick:()=>T(I=>!I),type:"button",children:[f.jsxs("span",{className:"flex items-center",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:f.jsx("path",{fillRule:"evenodd",d:"M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z",clipRule:"evenodd"})}),"اختيار لون المادة"]}),f.jsx("span",{className:`transition-transform ${z?"rotate-90":""}`,children:"▶"})]}),z&&f.jsx("div",{className:"mt-2 flex flex-wrap gap-2 border border-slate-200 rounded-lg p-3 bg-gray-50 shadow-sm",children:Ka.map(I=>f.jsx("button",{className:`w-8 h-8 rounded-full border-2 mb-1 focus:outline-none transition-all hover:scale-110 ${J===I?"ring-2 ring-emerald-500 border-emerald-600":"border-slate-300"}`,style:{backgroundColor:I},title:I,type:"button",onClick:()=>{H(I),c&&i(I,c)}},I))})]})]})})},kC=({settings:e,currentUser:r,onLogout:t})=>f.jsx("header",{className:"glass sticky top-0 z-50 backdrop-blur-xl border-b border-white/20 shadow-lg",children:f.jsx("div",{className:"container mx-auto",children:f.jsxs("div",{className:"flex justify-between items-center py-4",children:[f.jsx("div",{className:"flex items-center gap-6",children:f.jsxs("div",{className:"animate-slide-right",children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-800 tracking-tight",children:e.schoolName}),f.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[f.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"مرحباً"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:`w-8 h-8 rounded-full bg-gradient-to-br from-green-500 to-green-600 \r
                                                   flex items-center justify-center text-white font-bold text-sm\r
                                                   shadow-lg transform transition-transform hover:scale-110`,title:r||"المستخدم",children:r&&r.trim().charAt(0)||"م"}),f.jsx("span",{className:"text-sm font-semibold text-gray-800",children:r||"المستخدم"})]})]})]})}),f.jsx("div",{className:"flex items-center gap-3 animate-fade-in",children:f.jsx("button",{onClick:t,className:`btn-modern p-3 rounded-xl bg-gradient-to-br from-red-50 to-red-100 \r
                                       hover:from-red-100 hover:to-red-200 border border-red-200\r
                                       hover:scale-105 transition-all duration-200 group`,"aria-label":"تسجيل الخروج",title:"تسجيل الخروج",children:f.jsx(oy,{className:`w-5 h-5 text-red-500 group-hover:text-red-600 \r
                                                  group-hover:rotate-12 transition-all duration-300`})})})]})})}),EC=({onClose:e,onAddClass:r})=>{const[t,i]=ee.useState(""),[s,l]=ee.useState(""),c=()=>{if(!t.trim()){l("يرجى إدخال اسم الفصل");return}r(t.trim()),e()};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-6 max-w-xs w-full",children:[f.jsx("div",{className:"text-lg font-bold mb-4 text-slate-800 dark:text-slate-100",children:"إضافة فصل جديد"}),f.jsx("input",{type:"text",className:"w-full p-2 border rounded mb-2 text-right",placeholder:"اسم الفصل...",value:t,onChange:u=>{i(u.target.value),l("")}}),s&&f.jsx("div",{className:"text-red-500 text-xs mb-2",children:s}),f.jsxs("div",{className:"flex gap-2 justify-end mt-4",children:[f.jsx("button",{className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-600 dark:hover:text-white dark:hover:bg-slate-700 transition-colors",onClick:e,children:"إلغاء"}),f.jsx("button",{className:"py-2 px-4 text-sm font-medium text-white bg-emerald-600 rounded-lg hover:bg-emerald-700 transition-colors",onClick:c,children:"إضافة"})]})]})})},SC=({onClose:e,onAddSubject:r,className:t})=>{const[i,s]=ee.useState(""),[l,c]=ee.useState(""),u=()=>{if(!i.trim()){c("يرجى إدخال اسم المادة");return}r(i.trim()),e()};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-6 max-w-xs w-full",children:[f.jsxs("div",{className:"text-lg font-bold mb-4 text-slate-800 dark:text-slate-100",children:["إضافة مادة جديدة ",t&&f.jsxs("span",{className:"text-xs text-slate-500",children:["(",t,")"]})]}),f.jsx("input",{type:"text",className:"w-full p-2 border rounded mb-2 text-right",placeholder:"اسم المادة...",value:i,onChange:h=>{s(h.target.value),c("")}}),l&&f.jsx("div",{className:"text-red-500 text-xs mb-2",children:l}),f.jsxs("div",{className:"flex gap-2 justify-end mt-4",children:[f.jsx("button",{className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-600 dark:hover:text-white dark:hover:bg-slate-700 transition-colors",onClick:e,children:"إلغاء"}),f.jsx("button",{className:"py-2 px-4 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",onClick:u,children:"إضافة"})]})]})})},bC=({onExport:e,onImport:r,isLoading:t})=>{const i=ee.useRef(null);return f.jsxs("div",{className:"flex flex-col gap-2 mt-6",children:[f.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded-lg transition-colors shadow",onClick:e,disabled:t,children:[f.jsx(yo,{className:"w-5 h-5"}),"تصدير نسخة احتياطية"]}),f.jsx("input",{type:"file",accept:"application/json",ref:i,style:{display:"none"},onChange:s=>{s.target.files&&s.target.files[0]&&(r(s.target.files[0]),s.target.value="")}}),f.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-900 text-white font-bold py-2 px-4 rounded-lg transition-colors shadow",onClick:()=>i.current?.click(),disabled:t,children:[f.jsx(yo,{className:"w-5 h-5 rotate-180"}),"استيراد نسخة احتياطية"]})]})};function _C(e){const r={};for(let t=0;t<localStorage.length;t++){const i=localStorage.key(t);if(i)try{const s=localStorage.getItem(i);s!==null&&(r[i]=JSON.parse(s))}catch{}}r.__session={};for(let t=0;t<sessionStorage.length;t++){const i=sessionStorage.key(t);i&&(r.__session[i]=sessionStorage.getItem(i))}return JSON.stringify(r,null,2)}function TC(e,r=!0){try{const t=JSON.parse(e);return r&&(localStorage.clear(),sessionStorage.clear()),Object.keys(t).forEach(i=>{i!=="__session"&&localStorage.setItem(i,JSON.stringify(t[i]))}),t.__session&&Object.keys(t.__session).forEach(i=>{t.__session[i]!==null&&sessionStorage.setItem(i,t.__session[i])}),null}catch{return"فشل الاستيراد: الملف غير صالح أو تالف."}}const CC=({settings:e,onSave:r,onClose:t})=>{const[i,s]=ee.useState(e),[l,c]=ee.useState(!1),[u,h]=ee.useState(null),[x,p]=ee.useState(!1),v=ee.useRef(null),y=ee.useRef(null),E="/EDU-DOC/logo.png",k=C=>{const{name:L,value:X,type:W,files:M}=C.target;if(W==="file"&&M&&M[0]){const V=new FileReader;V.onload=G=>{s(oe=>({...oe,logoBase64:G.target?.result}))},V.readAsDataURL(M[0])}else s(V=>({...V,[L]:X}))},w=C=>{C.preventDefault(),r(i)};Object.keys(localStorage).filter(C=>C.startsWith("student-gradebook-"));const S=()=>{const C=_C(),L=new Blob([C],{type:"application/json"}),X=URL.createObjectURL(L),W=document.createElement("a");W.href=X,W.download="EDU-DOC-backup.json",document.body.appendChild(W),W.click(),setTimeout(()=>{document.body.removeChild(W),URL.revokeObjectURL(X)},100)},O=C=>{h(null),v.current=C,p(!0)},R=async()=>{c(!0),p(!1);try{const C=v.current;if(!C)return;const L=await C.text(),X=TC(L,!0);X?h(X):window.location.reload()}catch{h("فشل الاستيراد: الملف غير صالح أو تالف.")}finally{c(!1)}};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 sm:p-10 w-full max-w-3xl m-2 sm:m-6 border border-slate-200 relative",children:[f.jsx("img",{src:i.logoBase64||E,alt:"شعار",className:"absolute top-3 right-3 h-20 w-auto rounded-md pointer-events-none select-none",style:{objectFit:"contain"}}),f.jsx("h2",{className:"text-2xl font-bold mb-8 text-slate-800 text-center",children:"الإعدادات"}),f.jsxs("form",{onSubmit:w,children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-h-[65vh] overflow-y-auto scrollbar-thin scrollbar-thumb-slate-300 pr-1",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[f.jsx("label",{htmlFor:"logoBase64",className:"sm:w-32 text-sm font-medium text-slate-700 whitespace-nowrap",children:"تغيير الشعار"}),f.jsx("input",{ref:y,type:"file",id:"logoBase64",name:"logoBase64",accept:"image/*",onChange:k,className:"hidden"}),f.jsx("button",{type:"button",onClick:()=>y.current?.click(),className:"px-2 py-1 text-xs font-semibold rounded bg-emerald-100 text-emerald-700 hover:bg-emerald-200 border border-emerald-200",children:"تغيير الشعار"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[f.jsx("label",{htmlFor:"schoolName",className:"sm:w-32 text-sm font-medium text-slate-700 whitespace-nowrap",children:"اسم المدرسة"}),f.jsx("input",{type:"text",id:"schoolName",name:"schoolName",value:i.schoolName,onChange:k,className:"flex-1 bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 p-2.5 min-w-0"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[f.jsx("label",{htmlFor:"teacherName",className:"sm:w-32 text-sm font-medium text-slate-700 whitespace-nowrap",children:"اسم المعلم"}),f.jsx("input",{type:"text",id:"teacherName",name:"teacherName",value:i.teacherName,onChange:k,className:"flex-1 bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 p-2.5 min-w-0"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[f.jsx("label",{htmlFor:"principalName",className:"sm:w-32 text-sm font-medium text-slate-700 whitespace-nowrap",children:"اسم مدير المدرسة"}),f.jsx("input",{type:"text",id:"principalName",name:"principalName",value:i.principalName,onChange:k,className:"flex-1 bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 p-2.5 min-w-0"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[f.jsx("label",{htmlFor:"educationDirectorate",className:"sm:w-32 text-sm font-medium text-slate-700 whitespace-nowrap",children:"الإدارة التعليمية"}),f.jsx("input",{type:"text",id:"educationDirectorate",name:"educationDirectorate",value:i.educationDirectorate,onChange:k,className:"flex-1 bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 p-2.5 min-w-0"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[f.jsx("label",{htmlFor:"semester",className:"sm:w-32 text-sm font-medium text-slate-700 whitespace-nowrap",children:"الفصل الدراسي"}),f.jsxs("select",{id:"semester",name:"semester",value:i.semester,onChange:k,className:"flex-1 bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 p-2.5 min-w-0",children:[f.jsx("option",{value:"الفصل الدراسي الأول",children:"الفصل الدراسي الأول"}),f.jsx("option",{value:"الفصل الدراسي الثاني",children:"الفصل الدراسي الثاني"})]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[f.jsx("label",{htmlFor:"academicYear",className:"sm:w-32 text-sm font-medium text-slate-700 whitespace-nowrap",children:"العام الدراسي"}),f.jsx("input",{type:"text",id:"academicYear",name:"academicYear",value:i.academicYear,onChange:k,className:"flex-1 bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 p-2.5 min-w-0"})]})]}),f.jsx(bC,{onExport:S,onImport:O,isLoading:l}),u&&f.jsx("div",{className:"text-red-600 text-sm mt-2",children:u}),f.jsxs("div",{className:"flex justify-end gap-4 mt-8 pt-4 border-t border-slate-200",children:[f.jsx("button",{type:"button",onClick:t,className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 focus:z-10 focus:ring-4 focus:ring-slate-200 transition-colors",children:"إغلاق"}),f.jsx("button",{type:"submit",className:"py-2 px-4 text-sm font-medium text-white bg-[#2E8540] rounded-lg hover:bg-[#246b33] focus:ring-4 focus:ring-green-300 transition-colors",disabled:l,children:"حفظ التغييرات"})]}),x&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-xs w-full",children:[f.jsx("div",{className:"text-lg font-bold mb-4 text-slate-800",children:"تأكيد الاستيراد"}),f.jsx("div",{className:"mb-4 text-slate-700 text-sm",children:"سيتم حذف جميع البيانات الحالية واستبدالها بالنسخة الاحتياطية. هل أنت متأكد؟"}),f.jsxs("div",{className:"flex gap-4 justify-end",children:[f.jsx("button",{className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 transition-colors",onClick:()=>p(!1),children:"إغلاق"}),f.jsx("button",{className:"py-2 px-4 text-sm font-medium text-white bg-[#E74856] rounded-lg hover:bg-[#b91c1c] transition-colors",onClick:R,disabled:l,children:"تأكيد الاستيراد"})]})]})})]})]})})},NC=({message:e,onConfirm:r,onCancel:t,confirmLabel:i})=>f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[9999] transition-opacity duration-300",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-title",children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-8 w-full max-w-md m-4",children:[f.jsx("h2",{id:"confirm-title",className:"text-xl font-bold mb-4 text-slate-800 dark:text-slate-100",children:"تأكيد الإجراء"}),f.jsx("p",{className:"my-6 text-slate-700 dark:text-slate-300",children:e}),f.jsxs("div",{className:"flex justify-end gap-4 mt-8 pt-4 border-t border-slate-200 dark:border-slate-700",children:[f.jsx("button",{type:"button",onClick:t,className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 focus:z-10 focus:ring-4 focus:ring-slate-200 dark:focus:ring-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-600 dark:hover:text-white dark:hover:bg-slate-700 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"button",onClick:r,className:"py-2 px-4 text-sm font-medium text-white rounded-lg transition-colors bg-red-600 hover:bg-red-700 focus:ring-4 focus:ring-red-300",children:i||"تأكيد الحذف"})]})]})}),AC=({onSave:e,onClose:r})=>{const[t,i]=ee.useState(""),s=l=>{l.preventDefault(),t.trim()&&e(t.trim())};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity duration-300",children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-8 w-full max-w-md m-4",children:[f.jsx("h2",{className:"text-2xl font-bold mb-4 text-slate-800 dark:text-slate-100",children:"مطلوب مفتاح Gemini API"}),f.jsx("p",{className:"mb-6 text-slate-600 dark:text-slate-400",children:"لتمكين ميزة الذكاء الاصطناعي، يرجى إدخال مفتاح Google Gemini API الخاص بك. سيتم حفظ المفتاح في جلسة المتصفح الحالية فقط."}),f.jsxs("form",{onSubmit:s,children:[f.jsx("label",{htmlFor:"apiKey",className:"block mb-2 text-sm font-medium text-slate-700 dark:text-slate-300",children:"مفتاح API"}),f.jsx("input",{type:"password",id:"apiKey",value:t,onChange:l=>i(l.target.value),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-slate-700 dark:border-slate-600 dark:text-white",required:!0,autoFocus:!0}),f.jsxs("div",{className:"flex justify-end gap-4 mt-8 pt-4 border-t border-slate-200 dark:border-slate-700",children:[f.jsx("button",{type:"button",onClick:r,className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-600 dark:hover:bg-slate-700",children:"إلغاء"}),f.jsx("button",{type:"submit",disabled:!t.trim(),className:"py-2 px-4 text-sm font-medium text-white bg-[#2E8540] rounded-lg hover:bg-[#246b33] focus:ring-green-300 disabled:bg-slate-400",children:"حفظ واستمرار"})]})]})]})})},FC=({onClose:e,onSave:r,columns:t})=>{const[i,s]=ee.useState(""),[l,c]=ee.useState(""),[u]=ee.useState(!1),[h,x]=ee.useState(""),p=v=>{if(v.preventDefault(),!i.trim()){x("يرجى إدخال اسم للقالب");return}r(i,l,u),e()};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[9999]",onClick:e,children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-md m-4",onClick:v=>v.stopPropagation(),children:[f.jsx("h2",{className:"text-xl font-bold mb-4 text-slate-800 dark:text-slate-100",children:"حفظ التصميم كقالب"}),f.jsxs("form",{onSubmit:p,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"templateName",className:"block mb-1 text-sm font-medium text-slate-700 dark:text-slate-300",children:"اسم القالب*"}),f.jsx("input",{id:"templateName",type:"text",className:"w-full p-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-100",value:i,onChange:v=>s(v.target.value),placeholder:"مثال: قالب كشف الحضور"}),h&&f.jsx("p",{className:"mt-1 text-sm text-red-500",children:h})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"block mb-1 text-sm font-medium text-slate-700 dark:text-slate-300",children:"وصف القالب"}),f.jsx("textarea",{id:"description",className:"w-full p-2 border border-slate-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-100",value:l,onChange:v=>c(v.target.value),rows:3,placeholder:"وصف مختصر لمحتوى ووظيفة هذا القالب..."})]}),f.jsxs("div",{className:"flex justify-between border-t border-slate-200 dark:border-slate-700 pt-4",children:[f.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"submit",className:"py-2 px-4 text-sm font-medium text-white bg-emerald-600 rounded-lg hover:bg-emerald-700 transition-colors",children:"حفظ القالب"})]})]})]})})},DC=({template:e,onConfirm:r,onCancel:t})=>f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[9999] transition-opacity duration-300",role:"dialog","aria-modal":"true",children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-md m-4 animate-scale-in",onClick:i=>i.stopPropagation(),children:[f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-16 h-16 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center mb-4",children:f.jsx("svg",{className:"w-8 h-8 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),f.jsx("h2",{className:"text-xl font-bold mb-2 text-slate-800 dark:text-slate-100",children:"حذف القالب"}),f.jsxs("p",{className:"mb-6 text-slate-600 dark:text-slate-300",children:["هل أنت متأكد من حذف قالب ",f.jsxs("span",{className:"font-bold text-red-600 dark:text-red-400",children:['"',e.name,'"']}),"؟",f.jsx("br",{}),f.jsx("span",{className:"text-sm",children:"لا يمكن التراجع عن هذا الإجراء."})]})]}),f.jsxs("div",{className:"flex justify-between items-center gap-4 mt-6",children:[f.jsx("button",{type:"button",onClick:t,className:"flex-1 py-2 px-4 text-sm font-medium text-slate-700 bg-white rounded-lg border border-slate-300 hover:bg-slate-100 transition-colors dark:bg-slate-800 dark:text-slate-300 dark:border-slate-600 dark:hover:bg-slate-700",children:"إلغاء"}),f.jsx("button",{type:"button",onClick:r,className:"flex-1 py-2 px-4 text-sm font-medium text-white rounded-lg transition-colors bg-red-600 hover:bg-red-700",children:"حذف"})]})]})}),OC=({onClose:e,onUseTemplate:r,templates:t,onExportTemplate:i,onShowImport:s,onRenameTemplate:l,onDeleteTemplate:c})=>{const[u,h]=ee.useState(""),[x,p]=ee.useState("all"),[v,y]=ee.useState(""),[E,k]=ee.useState(!1),[w,S]=ee.useState(""),[O,R]=ee.useState(null);ee.useEffect(()=>{t.length>0&&h(t[0].id)},[t]);const C=t.filter(L=>{if(x==="my"&&!L.isOwner||x==="imported"&&!L.isImported)return!1;if(v){const X=v.toLowerCase();return L.name.toLowerCase().includes(X)||L.description&&L.description.toLowerCase().includes(X)}return!0});return f.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[9999]",onClick:e,children:[f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-6 w-full max-w-3xl m-4 max-h-[80vh] flex flex-col",onClick:L=>L.stopPropagation(),children:[f.jsx("h2",{className:"text-xl font-bold mb-4 text-slate-800 dark:text-slate-100",children:"استخدام قالب"}),f.jsxs("div",{className:"mb-4 flex flex-wrap gap-3",children:[f.jsxs("div",{className:"flex items-center rounded-lg overflow-hidden border border-slate-300 dark:border-slate-600",children:[f.jsx("button",{className:`px-3 py-1 text-xs font-medium ${x==="all"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,onClick:()=>p("all"),children:"جميع القوالب"}),f.jsx("button",{className:`px-3 py-1 text-xs font-medium ${x==="my"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,onClick:()=>p("my"),children:"قوالبي"}),f.jsx("button",{className:`px-3 py-1 text-xs font-medium ${x==="imported"?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300"}`,onClick:()=>p("imported"),children:"قوالب مضافة"})]}),f.jsx("input",{type:"text",className:"flex-grow px-3 py-1 text-sm border border-slate-300 dark:border-slate-600 rounded-lg",placeholder:"بحث...",value:v,onChange:L=>y(L.target.value)})]}),f.jsx("div",{className:"flex-grow overflow-auto mb-4 border border-slate-200 dark:border-slate-700 rounded-lg",children:C.length===0?f.jsx("div",{className:"p-8 text-center text-slate-500 dark:text-slate-400",children:"لا توجد قوالب متطابقة مع معايير البحث"}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4",children:C.map(L=>f.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${u===L.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700"}`,onClick:()=>h(L.id),children:[f.jsxs("div",{className:"flex justify-between items-start",children:[E&&u===L.id?f.jsx("div",{className:"flex-grow mb-2",children:f.jsx("input",{type:"text",className:"w-full p-1 text-sm border border-blue-300 rounded",value:w,onChange:X=>S(X.target.value),autoFocus:!0,onClick:X=>X.stopPropagation(),onKeyDown:X=>{X.key==="Enter"&&l&&w.trim()?(l(L.id,w),k(!1)):X.key==="Escape"&&k(!1),X.stopPropagation()}})}):f.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-200",children:L.name}),f.jsx("div",{className:"flex space-x-1 rtl:space-x-reverse",children:L.isOwner&&!E&&f.jsxs("div",{className:"flex items-center space-x-1 rtl:space-x-reverse",children:[f.jsx("button",{onClick:X=>{X.stopPropagation(),S(L.name),k(!0)},className:"text-blue-600 hover:text-blue-800 p-1 hover:bg-blue-100 dark:hover:bg-blue-900/20 rounded-full transition-colors",title:"تعديل اسم القالب",children:f.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),f.jsx("button",{onClick:X=>{X.stopPropagation(),c&&R(L.id)},className:"text-red-600 hover:text-red-800 p-1 hover:bg-red-100 dark:hover:bg-red-900/20 rounded-full transition-colors",title:"حذف القالب",children:f.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})})]}),f.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["بواسطة: ",L.ownerName]}),L.description&&f.jsx("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-300",children:L.description}),f.jsxs("div",{className:"mt-3 text-xs text-slate-500",children:["عدد الأعمدة: ",L.columnCount]})]},L.id))})}),f.jsxs("div",{className:"flex flex-col gap-3 border-t border-slate-200 dark:border-slate-700 pt-4",children:[f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("button",{type:"button",className:"py-2 px-4 mx-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-transparent rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",onClick:s,"aria-label":"استيراد قالب",children:f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"استيراد قالب"]})}),u&&i&&f.jsx("button",{type:"button",className:"py-2 px-4 mx-2 text-sm font-medium text-green-600 dark:text-green-400 bg-transparent rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors",onClick:()=>{const L=t.find(X=>X.id===u);L&&i(L)},"aria-label":"تصدير القالب",disabled:!u||C.length===0,children:f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 8.586V16a1 1 0 11-2 0V8.586l-1.293 1.293a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),"تصدير القالب"]})})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("button",{type:"button",onClick:e,className:"py-2 px-4 text-sm font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 rounded-lg border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"button",className:"py-2 px-4 text-sm font-medium text-white bg-blue-500 rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>r(u),disabled:!u||C.length===0,children:"استخدام القالب"})]})]})]}),O&&f.jsx(DC,{template:t.find(L=>L.id===O),onConfirm:()=>{c&&O&&(c(O),R(null))},onCancel:()=>R(null)})]})},jC=({onClose:e,template:r})=>{const[t,i]=ee.useState(!1),s=()=>{i(!0);try{const l={...r,exportDate:new Date().toISOString()},c=JSON.stringify(l,null,2),u=new Blob([c],{type:"application/json;charset=utf-8"}),x=`${r.name.replace(/[\\/:*?"<>|]/g,"_").replace(/\s+/g,"_")}_قالب.json`,p=document.createElement("a");p.href=URL.createObjectURL(u),p.download=x,p.style.display="none",document.body.appendChild(p),p.click(),setTimeout(()=>{document.body.removeChild(p),URL.revokeObjectURL(p.href),i(!1)},100),Xe.success("تم تصدير القالب بنجاح")}catch(l){console.error("خطأ في تصدير القالب:",l),Xe.error("حدث خطأ أثناء تصدير القالب"),i(!1)}};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[9999]",onClick:e,children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-4 w-full max-w-xs m-2",onClick:l=>l.stopPropagation(),style:{maxWidth:"90vw",maxHeight:"85vh",overflow:"auto",width:"320px"},children:[f.jsx("h2",{className:"text-lg font-bold mb-3 text-center text-slate-800 dark:text-slate-100",children:"تصدير قالب"}),f.jsxs("div",{className:"mb-3",children:[f.jsxs("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-2",children:['سيتم تصدير القالب "',r.name,'" كملف JSON يمكن استيراده لاحقًا.']}),f.jsx("div",{className:"flex justify-center mt-4 mb-3",children:f.jsx("svg",{className:"w-12 h-12 text-blue-500 dark:text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})}),f.jsx("div",{children:f.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 text-center",children:"اضغط على زر التصدير أدناه لحفظ القالب كملف JSON"})})]}),f.jsxs("div",{className:"flex justify-between mt-3 border-t border-slate-200 dark:border-slate-700 pt-3",children:[f.jsx("button",{type:"button",onClick:e,className:"py-1.5 px-3 text-xs font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 rounded border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:"إلغاء"}),f.jsx("button",{type:"button",onClick:s,disabled:t,className:"py-1.5 px-3 text-xs font-medium text-white bg-blue-500 rounded hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:t?f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsxs("svg",{className:"animate-spin h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري التصدير..."]}):"تصدير القالب"})]})]})})},IC=({onClose:e,onImport:r,currentImportCount:t,maxImportCount:i})=>{const[s,l]=ee.useState(""),[c,u]=ee.useState(!1),h=p=>{const v=p.target.files?.[0];if(!v){l("يرجى اختيار ملف");return}if(v.type!=="application/json"&&!v.name.endsWith(".json")){l("يرجى اختيار ملف بصيغة JSON");return}u(!0),l("");const y=new FileReader;y.onload=E=>{try{const k=JSON.parse(E.target?.result);if(!k.name||!k.columns||!Array.isArray(k.columns)){l("ملف القالب غير صالح"),u(!1);return}const w={...k,id:`imported-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,isImported:!0,importedDate:Date.now(),importedFrom:k.ownerName||"ملف خارجي"};r(w)}catch{l("حدث خطأ أثناء قراءة الملف"),u(!1)}},y.onerror=()=>{l("حدث خطأ أثناء قراءة الملف"),u(!1)},y.readAsText(v)},x=t>=i;return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[9999]",onClick:e,children:f.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-xl p-4 w-full max-w-xs m-2",onClick:p=>p.stopPropagation(),style:{maxWidth:"90vw",maxHeight:"85vh",overflow:"auto",width:"320px"},children:[f.jsx("h2",{className:"text-lg font-bold mb-3 text-center text-slate-800 dark:text-slate-100",children:"استيراد قالب"}),x?f.jsxs("div",{className:"text-center py-4",children:[f.jsxs("div",{className:"text-amber-600 dark:text-amber-400 text-base mb-2",children:[f.jsx("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"وصلت للحد الأقصى من القوالب المستوردة"]}),f.jsxs("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:["يمكنك استيراد ",i," قوالب كحد أقصى. لإضافة قالب جديد، قم بحذف قالب مستورد سابقاً."]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"mb-3",children:[f.jsx("div",{className:"flex justify-center mb-3",children:f.jsx("svg",{className:"w-12 h-12 text-blue-500 dark:text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:f.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})})}),f.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-2 text-center",children:"اختر ملف JSON لاستيراد القالب"}),f.jsxs("div",{className:"mt-3",children:[f.jsx("label",{className:"block mb-2 text-xs font-medium text-slate-700 dark:text-slate-300",children:"اختر ملف القالب (JSON)"}),f.jsx("input",{type:"file",accept:".json,application/json",onChange:h,className:`block w-full text-xs text-slate-700 dark:text-slate-300\r
                           file:mr-3 file:py-1 file:px-3\r
                           file:rounded-md file:border-0\r
                           file:text-xs file:font-medium\r
                           file:bg-blue-50 file:text-blue-700\r
                           dark:file:bg-blue-900/20 dark:file:text-blue-300\r
                           hover:file:bg-blue-100 dark:hover:file:bg-blue-900/30`}),s&&f.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:s})]})]}),f.jsxs("div",{className:"text-[10px] text-slate-500 dark:text-slate-400 mb-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{children:"الحد الأقصى للقوالب المستوردة:"}),f.jsxs("span",{className:"font-bold",children:[t," من ",i]})]}),f.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-1 my-1",children:f.jsx("div",{className:"bg-blue-500 h-1 rounded-full",style:{width:`${t/i*100}%`}})})]})]}),f.jsxs("div",{className:"flex justify-between mt-3 border-t border-slate-200 dark:border-slate-700 pt-3",children:[f.jsx("button",{type:"button",onClick:e,className:"py-1.5 px-3 text-xs font-medium text-slate-700 dark:text-slate-300 bg-white dark:bg-slate-800 rounded border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:"إلغاء"}),!x&&f.jsx("button",{type:"button",onClick:()=>document.querySelector('input[type="file"]')?.click(),disabled:c,className:"py-1.5 px-3 text-xs font-medium text-white bg-blue-500 rounded hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsxs("svg",{className:"animate-spin h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"جاري الاستيراد..."]}):"استيراد القالب"})]})]})})};function Wc(e,r){const[t,i]=ee.useState(()=>{try{const s=window.localStorage.getItem(e);return s?JSON.parse(s):r}catch(s){return console.error('Error reading localStorage key "'+e+'":',s),r}});return ee.useEffect(()=>{try{const s=window.localStorage.getItem(e);i(s?JSON.parse(s):r)}catch(s){console.error('Error re-reading localStorage key "'+e+'":',s),i(r)}},[e]),ee.useEffect(()=>{try{window.localStorage.setItem(e,JSON.stringify(t))}catch(s){console.error('Error writing to localStorage key "'+e+'":',s)}},[e,t]),[t,i]}const RC="4.0.0",PC=Date.now(),Vc=new Date("2025-09-20"),LC=Vc.getFullYear().toString().substring(2)+(Vc.getMonth()+1).toString().padStart(2,"0")+Vc.getDate().toString().padStart(2,"0")+"1400",ra=`${RC}-${LC}`,MC=({isOpen:e,onClose:r})=>{const[t,i]=ee.useState(!1),s=()=>{r(t)};return ee.useEffect(()=>{if(!e)return;const l=(h,x)=>{const p=document.createElement("div");p.innerHTML=h,p.className=x,p.style.position="fixed",p.style.pointerEvents="none",p.style.zIndex="9999",p.style.fontSize="24px",p.style.left=Math.random()*100+"vw",p.style.animationDuration=Math.random()*3+2+"s",p.style.animationDelay=Math.random()*2+"s",document.body.appendChild(p),setTimeout(()=>{p.parentNode&&p.parentNode.removeChild(p)},5e3)},c=document.createElement("style");c.textContent=`
      @keyframes fall-and-sway {
        0% {
          transform: translateY(-100vh) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }
      
      @keyframes confetti-fall {
        0% {
          transform: translateY(-100vh) rotateZ(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(100vh) rotateZ(720deg);
          opacity: 0;
        }
      }
      
      @keyframes bubble-float {
        0% {
          transform: translateY(100vh) scale(0);
          opacity: 0.7;
        }
        50% {
          transform: translateY(50vh) scale(1);
          opacity: 1;
        }
        100% {
          transform: translateY(-100vh) scale(0.5);
          opacity: 0;
        }
      }
      
      .floating-flower {
        animation: fall-and-sway linear infinite;
      }
      
      .floating-confetti {
        animation: confetti-fall linear infinite;
      }
      
      .floating-bubble {
        animation: bubble-float linear infinite;
        border-radius: 50%;
        border: 2px solid rgba(255,255,255,0.3);
        backdrop-filter: blur(2px);
      }
      
      .floating-bubble.large {
        width: 30px;
        height: 30px;
      }
      
      .floating-bubble.small {
        width: 15px;
        height: 15px;
      }
    `,document.head.appendChild(c);const u=setInterval(()=>{const h=["🌹","🌸","🌺","🌻","🌷","🌼","💐","🏵️","🌿","🍃"],x=["🎊","🎉","✨","⭐","🎈","🎀","💫","🌟","💥","🔥","⚡","💎"],p=["#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#feca57","#ff9ff3","#54a0ff","#5f27cd"],v=window.innerWidth<640,y=v?1:3,E=v?2:4,k=v?2:5;for(let w=0;w<y;w++)if(Math.random()>.3){const S=h[Math.floor(Math.random()*h.length)];l(S,"floating-flower")}for(let w=0;w<E;w++)if(Math.random()>.2){const S=x[Math.floor(Math.random()*x.length)];l(S,"floating-confetti")}for(let w=0;w<k;w++)if(Math.random()>.1){const S=document.createElement("div"),O=["small","","large"],R=O[Math.floor(Math.random()*O.length)];S.className=`floating-bubble ${R}`,S.style.position="fixed",S.style.pointerEvents="none",S.style.zIndex="9999",S.style.left=Math.random()*100+"vw",S.style.backgroundColor=p[Math.floor(Math.random()*p.length)],S.style.boxShadow=`0 0 ${Math.random()*20+10}px rgba(255,255,255,0.8), inset 0 0 20px rgba(255,255,255,0.3)`,S.style.animationDuration=Math.random()*4+3+"s",S.style.animationDelay=Math.random()*1+"s",S.style.width=R==="large"?"35px":R==="small"?"12px":"22px",S.style.height=S.style.width,document.body.appendChild(S),setTimeout(()=>{S.parentNode&&S.parentNode.removeChild(S)},8e3)}},200);return()=>{clearInterval(u),document.head.removeChild(c),document.querySelectorAll(".floating-flower, .floating-confetti, .floating-bubble").forEach(x=>{x.parentNode&&x.parentNode.removeChild(x)})}},[e]),e?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-2 sm:p-4 backdrop-blur-sm",children:f.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-2xl max-w-2xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-y-auto relative border-2 sm:border-4 border-gradient-to-r border-pink-300",children:[f.jsxs("div",{className:"bg-gradient-to-r from-emerald-700 via-teal-700 to-green-600 text-white p-4 sm:p-6 rounded-t-xl sm:rounded-t-2xl relative overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-20 transform -skew-x-12 animate-ping pointer-events-none"}),f.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-yellow-400 via-transparent to-transparent opacity-10 animate-pulse pointer-events-none"}),f.jsxs("div",{className:"flex justify-between items-center relative z-10",children:[f.jsxs("div",{children:[f.jsxs("h2",{className:"text-lg sm:text-2xl font-bold mb-2",children:["🎉✨ ما الجديد في الإصدار ",ra," ✨🎉"]}),f.jsx("p",{className:"opacity-90 text-sm sm:text-lg",children:"نقلة نوعية في الشكل والوظائف 🚀"})]}),f.jsx("button",{onClick:s,className:"text-white hover:bg-white hover:bg-opacity-30 rounded-full p-2 transition-all transform hover:scale-110 hover:rotate-90",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),f.jsxs("div",{className:"p-4 sm:p-6 relative",children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-yellow-50 via-pink-50 to-blue-50 opacity-30 rounded-b-xl sm:rounded-b-2xl pointer-events-none"}),f.jsxs("div",{className:"space-y-4 sm:space-y-6 relative z-10",children:[f.jsx("div",{className:"rounded-xl sm:rounded-2xl border-2 border-emerald-300 bg-gradient-to-br from-emerald-50 via-white to-emerald-50 p-4 sm:p-6 shadow-md",children:f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-6",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"inline-flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-xs font-bold text-white bg-emerald-600 px-2 py-0.5 rounded-full",children:"جديد كليًا"}),f.jsx("span",{className:"text-xs font-semibold text-emerald-700 bg-emerald-100 px-2 py-0.5 rounded-full",children:"ثوري"})]}),f.jsx("h3",{className:"text-xl sm:text-2xl font-extrabold text-emerald-800 mb-1",children:"مجموعة مربعات (Multi‑Checkbox)"}),f.jsx("p",{className:"text-sm sm:text-base text-slate-700 mb-3",children:"صمّم خانة واحدة تحتوي عدة مربعات داخلها، بثلاث حالات (صح ✓ / خطأ ✗ / فارغ –)، وحدد بسهولة عدد الخانات والعناوين، مع عدّاد اختياري."}),f.jsxs("ul",{className:"text-sm text-slate-700 space-y-1 list-disc ms-4",children:[f.jsx("li",{children:"اختيار عدد الخانات (1 إلى أي عدد يناسبك)"}),f.jsx("li",{children:"عداد تلقائي لعدد الخانات المستخدمة (مثلاً 4/8)"}),f.jsx("li",{children:"تسميات اختيارية لكل خانة (أسبوع 1، أسبوع 2...)"}),f.jsx("li",{children:"عرض رائع في التقارير: رموز كبيرة وواضحة بالألوان"})]})]}),f.jsxs("div",{className:"flex-shrink-0 w-full sm:w-auto",children:[f.jsxs("div",{className:"mx-auto sm:ms-0 w-full max-w-[320px] bg-white/70 border border-emerald-200 rounded-xl p-3 shadow",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-xs font-semibold text-slate-600",children:"عدد الخانات: 8"}),f.jsx("span",{className:"text-[11px] font-bold text-emerald-700 bg-emerald-100 px-2 py-0.5 rounded-full",children:"4/8"})]}),f.jsxs("div",{className:"grid grid-cols-8 gap-1.5",children:[f.jsx("div",{className:"w-6 h-6 rounded border border-emerald-600 bg-[rgba(22,163,74,0.13)] flex items-center justify-center text-emerald-700 text-sm",children:"✔"}),f.jsx("div",{className:"w-6 h-6 rounded border border-red-600 bg-[rgba(255,26,26,0.18)] flex items-center justify-center text-red-700 text-sm",children:"✗"}),f.jsx("div",{className:"w-6 h-6 rounded border border-slate-300 bg-white flex items-center justify-center text-slate-500 text-sm",children:"–"}),f.jsx("div",{className:"w-6 h-6 rounded border border-emerald-600 bg-[rgba(22,163,74,0.13)] flex items-center justify-center text-emerald-700 text-sm",children:"✔"}),f.jsx("div",{className:"w-6 h-6 rounded border border-red-600 bg-[rgba(255,26,26,0.18)] flex items-center justify-center text-red-700 text-sm",children:"✗"}),f.jsx("div",{className:"w-6 h-6 rounded border border-slate-300 bg-white flex items-center justify-center text-slate-500 text-sm",children:"–"}),f.jsx("div",{className:"w-6 h-6 rounded border border-emerald-600 bg-[rgba(22,163,74,0.13)] flex items-center justify-center text-emerald-700 text-sm",children:"✔"}),f.jsx("div",{className:"w-6 h-6 rounded border border-slate-300 bg-white flex items-center justify-center text-slate-500 text-sm",children:"–"})]}),f.jsxs("div",{className:"mt-2 grid grid-cols-4 gap-1 text-[10px] text-slate-500",children:[f.jsx("span",{className:"truncate",children:"أسبوع 1"}),f.jsx("span",{className:"truncate",children:"أسبوع 2"}),f.jsx("span",{className:"truncate",children:"أسبوع 3"}),f.jsx("span",{className:"truncate",children:"أسبوع 4"})]})]}),f.jsx("button",{onClick:()=>{try{s(),setTimeout(()=>window.dispatchEvent(new Event("try-multi-checkbox")),0)}catch{}},className:"mt-3 w-full bg-emerald-600 hover:bg-green-700 text-white text-sm font-bold py-2 px-4 rounded-lg shadow",title:"جرّب إضافة عمود مجموعة مربعات الآن",children:"جرّبها الآن"})]})]})}),f.jsx("div",{className:"border-2 border-emerald-300 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-lg sm:rounded-xl p-4 sm:p-6 hover:shadow-xl transition-all transform hover:scale-105 hover:border-emerald-400",children:f.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[f.jsx("div",{className:"text-2xl sm:text-4xl animate-pulse",children:"🌈"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg sm:text-xl font-bold text-emerald-800 mb-2 sm:mb-3",children:"أبرز ما في الإصدار 4.0"}),f.jsxs("ul",{className:"space-y-1 sm:space-y-2 text-slate-700",children:[f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"🏷️"}),f.jsx("span",{children:"إضافة شعار الوزارة مع إمكانية رفع شعار مخصص من الإعدادات"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"♻️"}),f.jsx("span",{children:"تغيير الشعار بسهولة عبر زر “تغيير الشعار” مع معاينة فورية"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"🧾"}),f.jsx("span",{children:"التقارير (الطلاب والإدارية) تُظهر الشعار دائماً مع انتظار التحميل لضمان ظهوره في الطباعة"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"🖼️"}),f.jsx("span",{children:"شعار افتراضي تلقائي عند عدم رفع شعار مخصص"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"🎨"}),f.jsx("span",{children:"سمة ألوان جديدة متناسقة مع هوية وزارة التعليم (أخضر/تركوازي)"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"📋"}),f.jsx("span",{children:"قائمة منسدلة مخصصة داخل المودال لاسم الكشف مع حصر كامل داخل النافذة ودعم لوحة المفاتيح"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"👤"}),f.jsx("span",{children:"قائمة منسدلة مخصصة لمنصب الموقعين مع تنقل لوحة المفاتيح وإغلاق ذكي"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"🖨️"}),f.jsx("span",{children:"تحسين تقارير الإدارة: ظهور ألوان الحقول المخصصة تماماً مثل تقارير الطلاب + توسيط تسلسل الموقعين"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"🖌️"}),f.jsx("span",{children:"أداة تلوين الخلايا أكثر ذكاءً على اللمس (ضغط مطوّل فقط، وإلغاء أثناء السحب) مع تمركز دقيق في منتصف الشاشة"})]}),f.jsxs("li",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"📱"}),f.jsx("span",{children:"تحسين الاستجابة للمودالات الكبيرة ومنع خروج القوائم عن الحدود على الشاشات الصغيرة"})]})]})]})]})}),f.jsx("div",{className:"border-2 border-green-300 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg sm:rounded-xl p-4 sm:p-6 hover:shadow-xl transition-all transform hover:scale-105 hover:border-green-400",children:f.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[f.jsx("div",{className:"text-2xl sm:text-4xl animate-pulse",children:"✨"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg sm:text-xl font-bold text-green-800 mb-2 sm:mb-3",children:"تحسينات واجهة وتقارير"}),f.jsxs("ul",{className:"space-y-1 sm:space-y-2",children:[f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-xs sm:text-sm mt-1",children:"🧭"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"تحسين محاذاة الجدول مع البادنق الأيسر (RTL)"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"🧾"}),f.jsx("span",{className:"text-sm",children:"توسيط كل الحقول في PDF ما عدا الاسم"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"🪲"}),f.jsx("span",{className:"text-sm",children:"إصلاحات تمنع الشاشة البيضاء عند تغيير نوع العمود"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"🧩"}),f.jsx("span",{className:"text-sm",children:'حل مشكلة "Rendered more hooks" في إدارة الأعمدة'})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"☑️"}),f.jsx("span",{className:"text-sm",children:"إضافة نوع عمود جديد: مجموعة مربعات (Multi‑Checkbox) مع إمكانية اختيار عدد المربعات والعناوين"})]})]})]})]})}),f.jsx("div",{className:"border-2 border-emerald-300 bg-gradient-to-r from-emerald-50 to-green-50 rounded-lg sm:rounded-xl p-4 sm:p-6 hover:shadow-xl transition-all transform hover:scale-105 hover:border-emerald-400",children:f.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[f.jsx("div",{className:"text-2xl sm:text-4xl animate-pulse",children:"🛠️"}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-emerald-800 mb-2 sm:mb-3 flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[f.jsx("span",{children:"تحسينات تقنية وأداء"}),f.jsx("span",{className:"text-xs sm:text-sm bg-emerald-200 text-emerald-800 px-2 py-1 rounded-full self-start",children:"محدث!"})]}),f.jsxs("ul",{className:"space-y-1 sm:space-y-2",children:[f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-xs sm:text-sm mt-1",children:"⚡"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"تحسين سرعة التطبيق والاستجابة"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"🐛"}),f.jsx("span",{className:"text-sm",children:"إصلاح مشاكل وأخطاء في النظام"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"🎨"}),f.jsx("span",{className:"text-sm",children:"تحسين تصميم واجهة استيراد البيانات"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"🔧"}),f.jsx("span",{className:"text-sm",children:"تحسين كود التطبيق وتنظيمه"})]})]})]})]})}),f.jsx("div",{className:"border border-red-200 bg-red-50 rounded-lg p-4 hover:shadow-md transition-shadow",children:f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"text-3xl",children:"🗑️"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"نظام حذف محسن ومهني"}),f.jsxs("ul",{className:"space-y-2",children:[f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"✅"}),f.jsx("span",{className:"text-sm",children:"تأكيدات واضحة عند الحذف"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"🔒"}),f.jsx("span",{className:"text-sm",children:"منع الحذف العرضي للبيانات المهمة"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"🎯"}),f.jsx("span",{className:"text-sm",children:"تحسين الأمان والموثوقية"})]}),f.jsxs("li",{className:"flex items-start gap-2 text-gray-600",children:[f.jsx("span",{className:"text-sm mt-1",children:"📋"}),f.jsx("span",{className:"text-sm",children:"رسائل توضيحية لكل عملية حذف"})]})]})]})]})})]}),f.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:f.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"text-2xl",children:"💡"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-gray-800",children:"نصيحة للاستخدام"}),f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"جرب الآن ميزة استيراد الطلاب الجديدة! يمكنك نسخ قائمة بأسماء الطلاب من أي مكان ولصقها مباشرة في التطبيق."})]})]})})}),f.jsx("div",{className:"mt-6 flex items-center justify-center",children:f.jsxs("label",{className:"flex items-center gap-2 text-gray-600 text-sm cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:t,onChange:l=>i(l.target.checked),className:"rounded border-gray-300 text-emerald-600 focus:ring-emerald-500"}),"عدم إظهار هذه الرسالة مرة أخرى"]})}),f.jsx("div",{className:"mt-4 sm:mt-6 flex justify-center",children:f.jsxs("button",{onClick:s,className:"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white px-6 sm:px-12 py-3 sm:py-4 rounded-full hover:shadow-2xl transition-all transform hover:scale-110 animate-pulse hover:animate-none relative overflow-hidden group w-full sm:w-auto",children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 transform -skew-x-12 group-hover:animate-ping"}),f.jsx("span",{className:"relative z-10 text-base sm:text-lg font-bold",children:"ابدأ الاستخدام 🚀✨🎉"})]})})]})]})}):null},BC=({onLogin:e})=>{const[r,t]=ee.useState(""),[i,s]=ee.useState(""),[l,c]=ee.useState(""),[u,h]=ee.useState(!1),[x,p]=ee.useState({name:"",phone:"",password:"",confirm:""}),[v,y]=ee.useState(""),E=()=>{try{return JSON.parse(localStorage.getItem("users")||"[]")}catch{return[]}},k=R=>{localStorage.setItem("users",JSON.stringify(R))},w=R=>{R.preventDefault();const L=E().find(X=>X.phone===r&&X.password===i);L?(sessionStorage.setItem("gradebook-user",L.name),e(L.name)):r==="0501234567"&&i==="123456"?(sessionStorage.setItem("gradebook-user","المستخدم التجريبي"),e("المستخدم التجريبي")):c("رقم الجوال أو كلمة المرور غير صحيحة.")},S=R=>{if(R.preventDefault(),y(""),!x.name||!x.phone||!x.password||!x.confirm){y("جميع الحقول مطلوبة");return}if(x.password!==x.confirm){y("كلمتا المرور غير متطابقتين");return}const C=E();if(C.find(L=>L.phone===x.phone)){y("رقم الجوال مستخدم مسبقًا");return}C.push({name:x.name,phone:x.phone,password:x.password}),k(C),h(!1),t(x.phone),s(x.password),p({name:"",phone:"",password:"",confirm:""}),setTimeout(()=>{sessionStorage.setItem("gradebook-user",x.name),e(x.name)},300)},O=()=>{const R="المستخدم التجريبي";sessionStorage.setItem("gradebook-user",R),e(R)};return f.jsx(f.Fragment,{children:f.jsxs("div",{className:"flex flex-col min-h-screen bg-gradient-to-br from-emerald-100 via-slate-100 to-emerald-200 relative justify-between overflow-x-hidden",children:[f.jsxs("div",{className:"absolute inset-0 z-0 pointer-events-none",children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-200/60 via-white/60 to-teal-100/70 blur-xl"}),f.jsx("div",{className:"absolute -top-32 -end-32 w-96 h-96 bg-emerald-300/30 rounded-full blur-3xl"}),f.jsx("div",{className:"absolute -bottom-32 -start-32 w-96 h-96 bg-teal-400/20 rounded-full blur-2xl"})]}),f.jsx("main",{className:"flex flex-1 items-center justify-center z-10 w-full px-2 py-8",children:u?f.jsxs("div",{className:"w-full max-w-sm p-8 space-y-6 bg-white/60 backdrop-blur-2xl rounded-3xl shadow-2xl border border-white/40 ring-1 ring-emerald-200/40 relative mx-auto animate-scale-in",style:{boxShadow:"0 8px 32px 0 rgba(16,185,129,0.10), 0 1.5px 8px 0 rgba(20,184,166,0.10)"},children:[f.jsx("div",{className:"text-center mb-2",children:f.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"تسجيل مستخدم جديد"})}),f.jsxs("form",{className:"space-y-4",onSubmit:S,children:[f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-slate-700",children:"الاسم"}),f.jsx("input",{type:"text",value:x.name,onChange:R=>p({...x,name:R.target.value}),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-slate-700",children:"رقم الجوال"}),f.jsx("input",{type:"tel",value:x.phone,onChange:R=>p({...x,phone:R.target.value}),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5",required:!0,placeholder:"05xxxxxxxx"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-slate-700",children:"كلمة المرور"}),f.jsx("input",{type:"password",value:x.password,onChange:R=>p({...x,password:R.target.value}),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block mb-1 text-sm font-medium text-slate-700",children:"تأكيد كلمة المرور"}),f.jsx("input",{type:"password",value:x.confirm,onChange:R=>p({...x,confirm:R.target.value}),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5",required:!0})]}),v&&f.jsx("p",{className:"text-sm text-red-500 text-center",children:v}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{type:"submit",className:"btn-3d w-full px-4 py-2 text-white bg-[#10B981] rounded-lg hover:bg-[#059669] focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium transition-all duration-300",children:"تسجيل"}),f.jsx("button",{type:"button",className:"btn-3d w-full px-4 py-2 text-[#10B981] bg-slate-200 rounded-lg hover:bg-slate-300 focus:ring-4 focus:outline-none focus:ring-emerald-100 font-medium transition-all duration-300",onClick:()=>h(!1),children:"إلغاء"})]})]})]}):f.jsxs("div",{className:"w-full max-w-sm p-8 space-y-6 bg-white/50 backdrop-blur-2xl rounded-3xl shadow-2xl border border-white/40 ring-1 ring-emerald-200/40 relative mx-auto animate-scale-in",style:{boxShadow:"0 8px 32px 0 rgba(16,185,129,0.10), 0 1.5px 8px 0 rgba(20,184,166,0.10)"},children:[f.jsxs("div",{className:"text-center",children:[f.jsx("h1",{className:"text-4xl font-extrabold text-emerald-700 drop-shadow-sm mb-1",children:"سجلات المعلم"}),f.jsx("p",{className:"text-emerald-900/80 mt-2 font-medium",children:"مرحباً بك، الرجاء تسجيل الدخول"})]}),f.jsxs("form",{className:"space-y-6",onSubmit:w,children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"mobileNumber",className:"block mb-2 text-sm font-medium text-slate-700",children:"رقم الجوال"}),f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none",children:f.jsx(dy,{className:"w-5 h-5 text-slate-400"})}),f.jsx("input",{type:"tel",id:"mobileNumber",value:r,onChange:R=>t(R.target.value),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full ps-10 p-2.5",required:!0,placeholder:"05xxxxxxxx",inputMode:"numeric",autoComplete:"tel"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-slate-700",children:"كلمة المرور"}),f.jsxs("div",{className:"relative",children:[f.jsx("span",{className:"absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none",children:f.jsx(hy,{className:"w-5 h-5 text-slate-400"})}),f.jsx("input",{type:"password",id:"password",value:i,onChange:R=>s(R.target.value),className:"bg-slate-50 border border-slate-300 text-slate-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full ps-10 p-2.5",required:!0,autoComplete:"current-password"})]})]}),l&&f.jsx("p",{className:"text-sm text-red-500 text-center",children:l}),f.jsx("button",{type:"submit",className:"w-full px-4 py-3 text-white bg-gradient-to-r from-emerald-500 via-teal-600 to-emerald-400 shadow-lg rounded-xl hover:from-emerald-600 hover:to-teal-500 focus:ring-4 focus:outline-none focus:ring-emerald-200 font-bold text-lg tracking-wide transition-all duration-300 backdrop-blur",children:"دخول"}),f.jsx("button",{type:"button",onClick:O,className:"w-full px-4 py-2 mt-2 text-emerald-700 bg-white/70 border border-emerald-100 rounded-xl hover:bg-emerald-50 focus:ring-4 focus:outline-none focus:ring-emerald-100 font-semibold transition-all duration-300",title:"تجربة سريعة بدون تسجيل",children:"دخول كمستخدم تجريبي"}),f.jsx("button",{type:"button",className:"w-full px-4 py-3 mt-2 text-emerald-700 bg-white/70 border border-emerald-100 rounded-xl hover:bg-emerald-50 focus:ring-4 focus:outline-none focus:ring-emerald-100 font-semibold transition-all duration-300",onClick:()=>h(!0),children:"مستخدم جديد"}),f.jsxs("div",{className:"w-full text-center pt-4 text-[15px] text-emerald-800/90 font-medium drop-shadow-sm",children:["هذه الأداة هدية إلى كل معلم ومعلمة",f.jsx("br",{}),f.jsx("span",{className:"text-emerald-700/80",children:"تطوير وبرمجة المهندس : محمد بن سالم الدوسري"}),f.jsx("br",{}),f.jsx("a",{href:"mailto:msaldossary.sa@gmail.com",className:"underline hover:text-emerald-600",children:"msaldossary.sa@gmail.com"}),f.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:["الإصدار: ",ra]})]})]})]})})]})})};class UC extends xr.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,t){console.error("ErrorBoundary caught an error:",r,t),this.setState({error:r,errorInfo:t})}render(){return this.state.hasError?f.jsx("div",{className:"min-h-screen bg-red-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-lg w-full",children:[f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx("div",{className:"bg-red-100 rounded-full p-2 mr-3",children:f.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L3.368 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"حدث خطأ في التطبيق"})]}),f.jsx("p",{className:"text-gray-600 mb-4",children:"عذراً، حدث خطأ غير متوقع. يرجى تحديث الصفحة والمحاولة مرة أخرى."}),f.jsx("div",{className:"mb-4",children:f.jsxs("details",{className:"text-sm text-gray-500",children:[f.jsx("summary",{className:"cursor-pointer font-medium mb-2",children:"تفاصيل الخطأ (للمطورين)"}),f.jsxs("pre",{className:"bg-gray-100 p-2 rounded text-xs overflow-auto max-h-32",children:[this.state.error?.message,`

`,this.state.error?.stack]})]})}),f.jsxs("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[f.jsx("button",{onClick:()=>window.location.reload(),className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"تحديث الصفحة"}),f.jsx("button",{onClick:()=>this.setState({hasError:!1,error:void 0,errorInfo:void 0}),className:"flex-1 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors",children:"إعادة المحاولة"})]})]})}):this.props.children}}const HC=()=>{const[e,r]=ee.useState(()=>sessionStorage.getItem("gradebook-user")),[t,i]=ee.useState(!1);ee.useEffect(()=>{const ge=setInterval(()=>{const Be=sessionStorage.getItem("gradebook-user");r(Ie=>Ie!==Be?Be:Ie)},1e3);return()=>clearInterval(ge)},[]),ee.useEffect(()=>{e&&(localStorage.getItem(`whatsNewDontShow-${ra}`)==="true"||setTimeout(()=>{i(!0)},1e3))},[e]);const s=ge=>{e&&ge&&(localStorage.setItem(`edu-doc-last-seen-version-${e}`,ra),localStorage.setItem(`whatsNewDontShow-${ra}`,"true")),i(!1)};ee.useEffect(()=>{e&&localStorage.removeItem("whatsNewDontShow")},[e]);const l="student-gradebook-settings-"+e,c="student-gradebook-classes-"+e,u=()=>({schoolName:"مدرستي",teacherName:"اسمي",principalName:"اسم المدير",educationDirectorate:"إدارة التعليم بمنطقة...",academicYear:`${new Date().getFullYear()}`,semester:"الفصل الدراسي الأول"}),[h,x]=Wc(l,u());ee.useEffect(()=>{h.academicYear==="1445هـ"&&x(ge=>({...ge,academicYear:new Date().getFullYear().toString()}))},[]);const[p,v]=Wc(c,[]),[y,E]=ee.useState(!1),[k,w]=ee.useState(null),[S,O]=ee.useState(()=>sessionStorage.getItem("gemini-api-key")),[R,C]=ee.useState(!1),[L,X]=ee.useState(!1),[W,M]=ee.useState(!1),[V,G]=ee.useState(!1),[oe,B]=ee.useState(!1),[K,me]=ee.useState(!1),[he,we]=ee.useState(!1),[Oe,Ee]=ee.useState(!1),[Se,Y]=ee.useState(!1),[xe,z]=ee.useState(!1),[T,J]=ee.useState(!1),[H,I]=ee.useState(null),[ne,fe]=Wc("column-templates-"+e,[]),[ye,le]=ee.useState(null),[de,pe]=ee.useState(()=>{const ge=localStorage.getItem("activeClassId");return ge&&p.find(Be=>Be.id===ge)?ge:p.length>0?p[0].id:""}),[N,_e]=ee.useState("");ee.useEffect(()=>{p.length>0&&!p.find(ge=>ge.id===de)&&pe(p[0].id)},[p]),ee.useEffect(()=>{de&&localStorage.setItem("activeClassId",de)},[de]);const Ne=p.find(ge=>ge.id===de)||null;ee.useEffect(()=>{Ne&&Ne.subjects.length>0?Ne.subjects.find(ge=>ge.id===N)||_e(Ne.subjects[0].id):_e("")},[Ne]);const Qe=Ne&&Ne.subjects.length>0?Ne.subjects.find(ge=>ge.id===N)||Ne.subjects[0]:null,Ge=ee.useRef(null),Pe=()=>{Ge.current&&typeof Ge.current.exportExcel=="function"?Ge.current.exportExcel():Xe.error("تعذر تصدير Excel.")},St=()=>{Ge.current&&typeof Ge.current.exportPdf=="function"?Ge.current.exportPdf():Xe.error("تعذر تصدير PDF.")},Ft=(ge,Be)=>{v(Ie=>Ie.map(Le=>Le.id===ge?{...Le,students:[...Le.students,{id:Date.now().toString()+"-"+Math.random(),name:Be,records:{}}]}:Le)),Xe.success("تمت إضافة الطالب بنجاح.")},Dt=(ge,Be,Ie="")=>{w({message:`هل أنت متأكد من حذف ${Ie||"هذا الشخص"}؟`,onConfirm:()=>{v(Le=>Le.map(et=>et.id===ge?{...et,students:et.students.filter(Ke=>Ke.id!==Be)}:et)),Xe.success(`تم حذف ${Ie||"الشخص"} بنجاح.`),w(null)}})},Xt=(ge,Be,Ie,Le)=>{v(et=>et.map(Ke=>{if(Ke.id!==ge)return Ke;const dt=Ke.subjects.find(Rt=>Rt.id===Be)?.columns.find(Rt=>String(Rt.id)===String(Ie)),st=dt?.type,bt=!!dt&&(st===ut.MULTI_CHECKBOX||st==="MULTI_CHECKBOX"||st==="مجموعة مربعات"),Ut=bt?Math.max(1,Number(dt.multiSlots)||8):0;if(bt&&Le&&typeof Le=="object"&&!Array.isArray(Le)){if(Le.__mcSlotUpdate&&typeof Le.__mcSlotUpdate.index=="number"&&typeof Le.__mcSlotUpdate.value=="string"){const Rt=Math.max(0,Math.min(Ut-1,Le.__mcSlotUpdate.index)),nt=Le.__mcSlotUpdate.value==="1"||Le.__mcSlotUpdate.value==="2"?Le.__mcSlotUpdate.value:"0";return{...Ke,students:Ke.students.map(Tt=>{const Ct=Tt.records[Ie],Kt=(typeof Ct=="string"?Ct:"".padEnd(Ut,"0")).padEnd(Ut,"0").slice(0,Ut).split("");Kt[Rt]=nt;const Xr=Kt.join("");return{...Tt,records:{...Tt.records,[Ie]:Xr}}})}}if(Le.__mcClear){const Rt="".padEnd(Ut,"0");return{...Ke,students:Ke.students.map(nt=>({...nt,records:{...nt.records,[Ie]:Rt}}))}}}return{...Ke,students:Ke.students.map(Rt=>({...Rt,records:{...Rt.records,[Ie]:Le}}))}})),Xe.success("تم تطبيق التعميم على العمود.")},Rr=(ge,Be,Ie,Le,et,Ke)=>{v(xt=>xt.map(dt=>dt.id===ge?{...dt,subjects:dt.subjects.map(st=>st.id===Be?{...st,columns:[...st.columns,{id:Date.now().toString()+"-"+Math.random(),name:Ie,type:Le,options:et,...Ke||{}}]}:st)}:dt)),Xe.success("تمت إضافة العمود بنجاح.")},gr=(ge,Be,Ie,Le)=>{w({message:`هل أنت متأكد من حذف العمود "${Le||""}"؟ سيتم حذف جميع بيانات هذا العمود للطلاب.`,confirmLabel:"تأكيد الحذف",onConfirm:()=>{v(et=>et.map(Ke=>{if(Ke.id!==ge)return Ke;const xt=Ke.subjects.map(st=>st.id!==Be?st:{...st,columns:st.columns.filter(bt=>bt.id!==Ie)}),dt=Ke.students.map(st=>{const bt={...st.records};return delete bt[Ie],{...st,records:bt}});return{...Ke,subjects:xt,students:dt}})),Xe.success("تم حذف العمود بنجاح."),w(null)}})},qt=(ge,Be,Ie,Le)=>{try{console.log("editColumn called:",{classId:ge,subjectId:Be,columnId:Ie,updatedData:Le}),v(et=>et.map(Ke=>{if(Ke.id!==ge)return Ke;console.log("Processing class:",Ke.id);let xt=0,dt=0,st=null,bt=null;const Ut=Ke.subjects.map(nt=>{if(nt.id!==Be)return nt;console.log("Processing subject:",nt.id);const Tt=nt.columns.map(Ct=>{if(Ct.id!==Ie)return Ct;console.log("Processing column:",Ct.id,"old type:",Ct.type,"new type:",Le.type),st=Ct.type,bt=Le.type||Ct.type,Ct.type===ut.MULTI_CHECKBOX&&(xt=Number(Ct.multiSlots)||8);let Et={...Ct,...Le};return Et.type!==ut.MULTI_CHECKBOX?(console.log("Removing multi-checkbox settings"),delete Et.multiSlots,delete Et.multiShowCounter,delete Et.multiCountMode,delete Et.multiLabels):(dt=Math.max(1,Math.min(64,Number(Le.multiSlots??Et.multiSlots??8))),Et.multiSlots=dt,console.log("Multi-checkbox slots:",dt),Et.multiCountMode||(Et.multiCountMode="both")),Et});return{...nt,columns:Tt}});let Rt=Ke.students;return xt&&dt&&xt!==dt&&(console.log("Migrating student data for slot change:",xt,"->",dt),Rt=Ke.students.map(nt=>{try{const Tt=nt.records[Ie];let Et=(typeof Tt=="string"?Tt:"".padEnd(xt,"0")).padEnd(xt,"0");return dt<xt?Et=Et.slice(0,dt):dt>xt&&(Et=Et.padEnd(dt,"0")),{...nt,records:{...nt.records,[Ie]:Et}}}catch(Tt){return console.error("Error migrating student data for student:",nt.id,Tt),nt}})),st&&bt&&st!==bt&&(console.log("Type changed from",st,"to",bt,"- cleaning student data"),Rt=Ke.students.map(nt=>{try{const Tt={...nt.records};return st===ut.MULTI_CHECKBOX&&bt!==ut.MULTI_CHECKBOX?(console.log("Clearing multi-checkbox data for student:",nt.id),delete Tt[Ie]):st!==ut.MULTI_CHECKBOX&&bt===ut.MULTI_CHECKBOX?(console.log("Initializing multi-checkbox data for student:",nt.id),Tt[Ie]="".padEnd(dt||8,"0")):(st===ut.CHECKBOX||bt===ut.CHECKBOX)&&(console.log("Handling checkbox type change for student:",nt.id),bt===ut.CHECKBOX?Tt[Ie]="0":delete Tt[Ie]),{...nt,records:Tt}}catch(Tt){return console.error("Error updating student records for student:",nt.id,Tt),nt}})),console.log("Updated class data successfully"),{...Ke,subjects:Ut,students:Rt}})),Le.name&&Xe.success("تم تعديل اسم العمود."),(Le.type===ut.MULTI_CHECKBOX||Le.multiSlots!==void 0)&&Xe.success("تم تحديث إعدادات مجموعة المربعات."),console.log("editColumn completed successfully")}catch(et){throw console.error("Error in editColumn:",et),Xe.error("حدث خطأ أثناء تعديل العمود. يرجى المحاولة مرة أخرى."),et}},nr=(ge,Be,Ie,Le,et)=>{v(Ke=>Ke.map(xt=>{if(xt.id!==ge)return xt;const dt=et.map(nt=>({id:Date.now().toString()+"-"+Math.random(),name:nt.header,type:nt.type,options:nt.options})),st={};dt.forEach(nt=>{st[nt.name]=nt.id});const bt=xt.subjects.map(nt=>nt.id!==Be?nt:{...nt,columns:[...nt.columns,...dt]});let Ut=[...xt.students];const Rt=[];return Ie.forEach(nt=>{const Tt=nt[Le]?.toString().trim();if(!Tt)return;const Ct={};et.forEach(Kt=>{const Xr=st[Kt.header];if(Xr){const ke=nt[Kt.header];if(Kt.type===ut.NUMBER){const je=parseFloat(ke);Ct[Xr]=isNaN(je)?null:je}else Ct[Xr]=ke??null}});const Et=Ut.findIndex(Kt=>Kt.name===Tt);if(Et>-1){const Kt=Ut[Et];Ut[Et]={...Kt,records:{...Kt.records,...Ct}}}else Rt.push({id:Date.now().toString()+"-"+Math.random(),name:Tt,records:Ct})}),{...xt,subjects:bt,students:[...Ut,...Rt]}})),Xe.success("تم استيراد "+Ie.length+" سجل بنجاح.")},Pr=ge=>{ge?(sessionStorage.setItem("gemini-api-key",ge),O(ge),Xe.success("تم حفظ مفتاح API بنجاح.")):(sessionStorage.removeItem("gemini-api-key"),O(null)),C(!1)},Lr=(ge,Be,Ie)=>{if(!Ne||!N){Xe.error("يرجى تحديد فصل ومادة أولاً");return}const Le=Ne.subjects.find(Ke=>Ke.id===N);if(!Le||!Le.columns.length){Xe.error("لا توجد أعمدة لحفظها كقالب");return}const et={id:`template-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,name:ge,description:Be,columns:[...Le.columns],isPublic:Ie,isOwner:!0,ownerName:h.teacherName||"معلم",columnCount:Le.columns.length,createdAt:Date.now()};fe(Ke=>[et,...Ke]),Xe.success("تم حفظ القالب بنجاح"),Ee(!1)},It=ge=>{if(!Ne||!N){Xe.error("يرجى تحديد فصل ومادة أولاً");return}const Be=ne.find(Le=>Le.id===ge);if(!Be){Xe.error("لم يتم العثور على القالب");return}const Ie=Ne.subjects.find(Le=>Le.id===N);Ie&&Ie.columns.length>0?w({message:"سيتم استبدال الأعمدة الحالية بأعمدة القالب. هل تريد المتابعة؟",onConfirm:()=>{_t(Be),w(null)},confirmLabel:"متابعة"}):_t(Be),Y(!1)},ur=ge=>{I(ge),z(!0)},Ze=(ge,Be)=>{if(!Be.trim()){Xe.error("لا يمكن أن يكون اسم القالب فارغًا");return}fe(Ie=>Ie.map(Le=>Le.id===ge?{...Le,name:Be.trim()}:Le)),Xe.success("تم تعديل اسم القالب بنجاح")},ht=ge=>{fe(Be=>Be.filter(Ie=>Ie.id!==ge)),Xe.success("تم حذف القالب بنجاح")},ar=ge=>{try{const Be=ne.filter(et=>et.isImported).length,Ie=10;if(Be>=Ie){Xe.error(`لا يمكن استيراد أكثر من ${Ie} قوالب. يرجى حذف بعض القوالب المستوردة أولاً.`);return}if(ne.some(et=>et.name===ge.name)&&(ge.name=`${ge.name} (مستورد)`),!ge.columns||!Array.isArray(ge.columns)||ge.columns.length===0)throw new Error("القالب المستورد لا يحتوي على أعمدة صالحة");fe(et=>[ge,...et]),Xe.success("تم استيراد القالب بنجاح!"),J(!1)}catch(Be){console.error("خطأ في استيراد القالب:",Be),Xe.error("حدث خطأ أثناء استيراد القالب. تأكد من صحة البيانات المستوردة.")}},_t=ge=>{v(Be=>Be.map(Ie=>Ie.id===de?{...Ie,subjects:Ie.subjects.map(Le=>Le.id===N?{...Le,columns:ge.columns.map(et=>({...et,id:`col-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}))}:Le)}:Ie)),Xe.success("تم تطبيق القالب بنجاح")};return e?f.jsx(UC,{children:f.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50",children:[f.jsx(kC,{settings:h,currentUser:e||"",onLogout:()=>{r(null),sessionStorage.removeItem("gradebook-user")}}),f.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden transition-all duration-300",style:{direction:"rtl"},children:[f.jsxs("div",{className:"w-full flex gap-2 items-center justify-center bg-white border-b border-slate-200 py-2 px-2 sticky top-0 z-50",children:[f.jsx("select",{className:"border rounded-lg px-2 py-1 text-sm bg-slate-50 text-slate-800",value:de,onChange:ge=>pe(ge.target.value),children:p.map(ge=>f.jsx("option",{value:ge.id,children:ge.name},ge.id))}),f.jsx("select",{className:"border rounded-lg px-2 py-1 text-sm bg-slate-50 text-slate-800",value:N,onChange:ge=>_e(ge.target.value),disabled:!de||!p.find(ge=>ge.id===de)?.subjects.length,children:(p.find(ge=>ge.id===de)?.subjects||[]).map(ge=>f.jsx("option",{value:ge.id,children:ge.name},ge.id))})]}),f.jsx("div",{className:"w-full overflow-x-auto overflow-y-visible p-2 sm:p-4 md:p-6",style:{marginRight:"0.2cm",minWidth:0,boxSizing:"border-box"},children:f.jsx(vC,{ref:Ge,activeClass:Ne||void 0,activeSubject:Qe||void 0,onAddColumn:Rr,onDeleteColumn:gr,onEditColumn:qt,onFillColumn:Xt,onImportStudents:nr,onAddStudent:Ft,onUpdateStudentData:(ge,Be,Ie,Le)=>{v(et=>et.map(Ke=>Ke.id===ge?{...Ke,students:Ke.students.map(xt=>xt.id===Be?{...xt,records:{...xt.records,[Ie]:Le}}:xt)}:Ke)),Xe.success("تم الحفظ تلقائيًا",{duration:1200})},onDeleteStudent:Dt,settings:h,apiKey:S,onRequestApiKey:()=>C(!0),onAddClass:()=>B(!0),onAddSubject:()=>me(!0),onExportExcel:Pe,onExportPdf:St,onOpenSettings:()=>E(!0),onOpenCustomize:()=>we(!0),onSaveTemplate:()=>Ee(!0),onUseTemplate:()=>Y(!0),onAdminExport:()=>Ge.current&&Ge.current.openAdminModal&&Ge.current.openAdminModal(),setClasses:v},de+"-"+N)}),f.jsx(yC,{open:he,onClose:()=>we(!1),onAddColumn:ge=>{!Ne||!Qe||(ge.forEach(Be=>{const Ie=Math.max(1,Number(Be.count)||1);for(let Le=0;Le<Ie;Le++)Rr(Ne.id,Qe.id,Be.name,ut.NUMBER,void 0)}),Xe.success("تمت إضافة الأعمدة بنجاح."))},onColorChange:(ge,Be)=>{const Ie=Be||N;!de||!Ie||v(Le=>Le.map(et=>et.id===de?{...et,subjects:et.subjects.map(Ke=>Ke.id===Ie?Ke.themeColor===ge?Ke:{...Ke,themeColor:ge}:Ke)}:et))},classes:p,activeClassId:de,activeSubjectId:N,onEditClass:ge=>{ge.name&&ge.name.trim()&&(v(Be=>Be.map(Ie=>Ie.id===ge.id?{...Ie,name:ge.name.trim(),type:ge.type}:Ie)),Xe.success("تم تعديل بيانات الفصل."))},onDeleteClass:ge=>{w({message:"هل أنت متأكد من حذف الفصل؟ سيتم حذف جميع بياناته.",confirmLabel:"تأكيد الحذف",onConfirm:()=>{v(Be=>Be.filter(Ie=>Ie.id!==ge.id)),Xe.success("تم حذف الفصل."),w(null)}})},onEditSubject:(ge,Be)=>{Be.name&&Be.name.trim()&&(v(Ie=>Ie.map(Le=>Le.id===ge.id?{...Le,subjects:Le.subjects.map(et=>et.id===Be.id?{...et,name:Be.name.trim()}:et)}:Le)),Xe.success("تم تعديل اسم المادة."))},onDeleteSubject:(ge,Be)=>{w({message:"هل أنت متأكد من حذف المادة؟ سيتم حذف جميع بياناتها.",confirmLabel:"تأكيد الحذف",onConfirm:()=>{v(Ie=>Ie.map(Le=>Le.id===ge.id?{...Le,subjects:Le.subjects.filter(et=>et.id!==Be.id)}:Le)),Xe.success("تم حذف المادة."),w(null)}})},onAddClass:(ge,Be)=>{v(Ie=>[...Ie,{id:Date.now().toString()+"-"+Math.random(),name:ge,type:Be,subjects:[],students:[]}]),Xe.success("تمت إضافة الفصل بنجاح.")},onAddSubject:(ge,Be)=>{v(Ie=>Ie.map(Le=>Le.id===ge.id?{...Le,subjects:[...Le.subjects||[],{id:Date.now().toString()+"-"+Math.random(),name:Be,columns:[]}]}:Le)),Xe.success("تمت إضافة المادة بنجاح.")}})]}),L&&f.jsx(nm,{onClose:()=>X(!1),onAddStudent:ge=>{Ne&&Ft(Ne.id,ge),X(!1)}}),oe&&f.jsx(EC,{onClose:()=>B(!1),onAddClass:ge=>{v(Be=>[...Be,{id:Date.now().toString()+"-"+Math.random(),name:ge,type:"تعليمي",subjects:[],students:[]}]),Xe.success("تمت إضافة الفصل بنجاح.")}}),W&&Ne&&Qe&&f.jsx(kp,{onClose:()=>M(!1),onAddColumn:(ge,Be,Ie,Le)=>{Rr(Ne.id,Qe.id,ge,Be,Ie,Le),M(!1)}}),K&&Ne&&f.jsx(SC,{onClose:()=>me(!1),className:Ne.name,onAddSubject:ge=>{v(Be=>Be.map(Ie=>Ie.id===Ne.id?{...Ie,subjects:[...Ie.subjects||[],{id:Date.now().toString()+"-"+Math.random(),name:ge,columns:[]}]}:Ie)),Xe.success("تمت إضافة المادة بنجاح.")}}),V&&Ne&&Qe&&f.jsx(rm,{onClose:()=>G(!1),onImport:(ge,Be,Ie)=>{nr(Ne.id,Qe.id,ge,Be,Ie),G(!1)}}),y&&f.jsx(CC,{settings:h,onSave:x,onClose:()=>E(!1)}),k&&f.jsx(NC,{message:k.message,onConfirm:k.onConfirm,onCancel:()=>{ye!==null&&le(null),w(null)},confirmLabel:k.confirmLabel}),R&&f.jsx(AC,{onSave:Pr,onClose:()=>C(!1)}),Oe&&Ne&&Qe&&f.jsx(FC,{onClose:()=>Ee(!1),onSave:(ge,Be,Ie)=>Lr(ge,Be,Ie),columns:Qe.columns}),Se&&Ne&&Qe&&f.jsx(OC,{onClose:()=>Y(!1),onUseTemplate:ge=>It(ge),templates:ne,onExportTemplate:ur,onShowImport:()=>J(!0),onRenameTemplate:Ze,onDeleteTemplate:ht}),xe&&H&&f.jsx(jC,{onClose:()=>z(!1),template:H}),T&&f.jsx(IC,{onClose:()=>J(!1),onImport:ar,currentImportCount:ne.filter(ge=>ge.isImported).length,maxImportCount:10}),f.jsx(MC,{isOpen:t,onClose:s})]})}):f.jsx(BC,{onLogin:r})};function zC(){const e=localStorage.getItem("edu-doc-version-id"),r=PC.toString();e!==r&&(console.log(`تم اكتشاف إصدار جديد: ${ra}`),"caches"in window&&caches.keys().then(function(t){return Promise.all(t.filter(function(i){return i.startsWith("edu-doc")}).map(function(i){return console.log(`تنظيف التخزين المؤقت: ${i}`),caches.delete(i)}))}),localStorage.setItem("edu-doc-version-id",r))}window.addEventListener("load",function(){zC(),console.log(`تم تحميل التطبيق - ${ra}`);const e=sessionStorage.getItem("edu-doc-seen-version");e&&e!==ra&&console.log("تم تثبيت إصدار جديد من التطبيق"),sessionStorage.setItem("edu-doc-seen-version",ra)});Qg.createRoot(document.getElementById("root")).render(f.jsx(xr.StrictMode,{children:f.jsx(HC,{})}));
